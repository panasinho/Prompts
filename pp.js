(()=>{const e=!1,t="_actors_ifdt";let n=globalThis[t];(()=>{if(n)return;const o={};n=function t(n){const a={},r=new Proxy(n,{get:(i,s)=>"assign"===s?e=>{Object.assign(r,e)}:(s in n||(n[s]={},a[s]=t(n[s]),n===o&&e&&(globalThis[s]=n[s])),s in a?a[s]:n[s]),set:(t,r,i)=>(n[r]=i,a[r]=i,n===o&&e&&(globalThis[r]=n[r]),!0)});return r}(o),globalThis[t]=n,e&&(globalThis.app=o)})(),(()=>{const{$store:e,$utils:t}=n;e.adapter={_TTL:5*t.time.MINUTE,_bound_:Symbol("bound"),create(n){let o=!1;if(t.is.object(n)){o=!0;const e=n;n=()=>e}const a=new t.TempMap(this._TTL),r=(t=null)=>{if(a.has(t))return a.get(t);const o=n(t),r=()=>o.get(e.state),i=r();if(!this._wrappable(i))return i;const s=this._wrap(i,r,o);return a.set(t,s),s};return o?r():r},_wrap(n,o,a={}){a.update=function(n){e.transaction((()=>{if(t.is.object(n))Object.assign(o(),n);else{if(!t.is.function(n))throw new Error("invalid updater",{updater:n});n(o())}}))};const r=new Proxy(n,{get:(e,n)=>{if("$"===n)return o().$;const i=a.__lookupGetter__(n);if(i)return i.call(r);const s=a[n];return t.is.function(s)?s[this._bound_]?s:(a[n]=a[n].bind(r),a[n][this._bound_]=!0,a[n]):(t.is.string(n)&&n.startsWith("$")&&(n=n.slice(1)),o()[n])},set:(t,n,i)=>{const s=a.__lookupSetter__(n);return s?(e.transaction((()=>s.call(r,i))),!0):(o()[n]=i,!0)},deleteProperty:(t,n)=>(e.transaction((()=>delete o()[n])),!0)});return r},_wrappable:e=>t.is.object(e)||t.is.array(e)}})(),(()=>{const{$store:e,$utils:t,$mobx:o}=n;e.createProxy=n=>{if(!t.is.object(n))throw new Error("$store.createProxy can only accept Objects");const a={};for(const e in n){const t=n.__lookupGetter__(e);t&&(a[e]=t)}const r=o.makeAutoObservable(n);return new Proxy({},{get(t,n){if(e.controller?.isInTransaction){const e=a[n];return e?e.call(r):r[n]||void 0}return r[n]},set:(e,t,n)=>(r[t]=n,!0)})}})(),(()=>{const{$store:e,$mobx:t,$bus:o,$env:a,$shell:r,$task:i,$logger:s,$idb:l,$utils:c,$chrome:d}=n,u=[e=>t.toJS(e)];e.controller={DEBUG_ACTIONS:!1,async init(){a.is.bg?await this.initBgState():await this.initPpState(),this.isInTransaction=!1,e.state=this.state,e.commit=this.commit.bind(this),e.transaction=this.transaction.bind(this),o.on("store.applyState",this.applyState.bind(this)),o.on("store.applyActions",this.applyActions.bind(this)),o.on("store.resetState",this.resetState.bind(this)),this.setupDevState(),a.is.bg&&await e.versioner.init()},async initBgState(){const n=await d.tabs.query({}),a=c.url.ext("/harpa.html");let r;!!n.find((e=>e.url===a))&&(r=await o.send("store.getPpState")),r||(r=await this.readStateFromIdb()),r||(r=e.template.state()),this.state=t.observable(r),o.on("store.getBgState",(()=>t.toJS(this.state))),o.on("store.saveStateToIdb",(()=>this.saveStateToIdb(0)))},async initPpState(){const e=await o.send("store.getBgState");this.state=t.observable(e),o.on("store.getPpState",(()=>t.toJS(this.state)))},transaction(n){if(this.isInTransaction)return n(e.deducer.getCurrentProxy()),Promise.resolve();let a=[];try{this.isInTransaction=!0,t.runInAction((()=>{a=e.deducer.modify(this.state,(t=>{e.state=t,n(t),e.state=this.state})),this.isInTransaction=!1}))}finally{this.isInTransaction=!1}return this.debugActions(a),this.saveStateToIdb(),o.send("store.applyActions",a)},applyActions(t){this.modifyState((()=>{e.deducer.applyActions(this.state,t)}))},async applyState(e){this.modifyState((()=>{Object.keys(this.state).forEach((e=>delete this.state[e])),Object.assign(this.state,e)}))},modifyState(e){t.runInAction(e),this.saveStateToIdb()},async readStateFromIdb(){try{return await l.read("store.state")}catch(e){throw s.critical("[$store] failed to read state from idb",e),e}},debugActions(n){e.controller.DEBUG_ACTIONS&&console.warn("action applied",n.map((e=>({...e,value:t.toJS(e.value)}))))},saveStateToIdb(e=2e3){if(!a.is.bg)return;const t=this.saveStateToIdb;t.saving?t.pending=!0:(0===e&&(t.saving=!0),clearTimeout(t.timeout),t.timeout=setTimeout((async()=>{t.saving=!0;try{const e={catch:!1},t=await c.durationOf((()=>u.reduce(((e,t)=>t(e)),this.state)),e),n=await c.durationOf((()=>l.write("store.state",t.result)),e);s.dev(`[$store] state saved in prep = ${t.ms}ms and write = ${n.ms}ms`)}catch(e){s.warn("[$store] saving state failed",e)}t.saving=!1,t.pending&&(t.pending=!1,this.saveStateToIdb())}),e))},async commit(){o.send("store.applyState",e.state)},setupDevState(){a.is.development&&Object.defineProperty(globalThis,"state",{get:()=>t.toJS(e.state)})},async resetState(){let t;if(a.is.desktop){const e=r.proxy.tabs;t=e.find((e=>e.fixed)),chrome.tabs.update(t.id,{active:!0});for(const t of e)t.closed||t.fixed||await d.tabs.remove(t.id)}e.transaction((t=>{const n=e.template.state();for(const e in t)delete t[e];for(const e in n)t[e]=n[e]})),await l.clear(),a.is.desktop&&e.transaction((e=>{e.shell.tabs.push(t),e.shell.activeTabId=t.id})),await i.recipeLoader.readAllRecipes()}}})(),(()=>{const{$store:e,$utils:t,$mobx:o}=n;e.deducer={_replicaKey:Symbol("replica"),_currentProxy:null,_arrayMethods:new Set(["pop","push","shift","unshift","splice","reverse"]),modify(e,t){const n=[],o=this._proxify(e,n);return this._currentProxy=o,t(o),this._currentProxy=null,n},applyActions(e,t=[]){for(const n of t){const t=this._get(e,n.getter);"call"===n.type?t[n.method](...n.args):"set"===n.type?t[n.key]=n.value:"delete"===n.type&&delete t[n.key]}},getCurrentProxy(){return this._currentProxy},_proxify(e,n=[],a=[]){if(this._isProxy(e))return e;const r=t.is.array(e),i=t.is.object(e);if(!r&&!i)return e;const s=r?[...e]:{...e};return new Proxy(s,{get:(t,o)=>o===this._replicaKey?s:o in s?r&&this._isArrayMethod(o)?(...t)=>(n.push({type:"call",method:o,getter:a,args:t}),e[o](...t),s[o](...t)):(s[o]=this._proxify(s[o],n,[...a,o]),s[o]):void 0,set:(r,i,l)=>(e[i]=this._deproxify(l),s[i]=this._proxify(e[i],n,[...a,i]),t.is.symbol(i)||n.push({type:"set",key:i,getter:a,value:o.toJS(e[i])}),!0),deleteProperty:(o,r)=>(delete e[r],delete s[r],t.is.symbol(r)||n.push({type:"delete",key:r,getter:a}),!0)})},_deproxify(e){if(!this._isProxy(e))return e;const t=e[this._replicaKey];for(const e in t)t[e]=this._deproxify(t[e]);return t},_isProxy(e){return!(!e||!e[this._replicaKey])},_get(e,t=[]){let n=e;for(const e of t)n=n[e];return n},_isArrayMethod(e){return this._arrayMethods.has(e)}}})(),(()=>{const{$store:e}=n;e.portal={create(n,o={}){const a=(t=e.controller.state)=>n(t),r={get self(){return a()},transaction(t){e.transaction((e=>t(a(e))))},close(){l()}},i=new Set([...Object.keys(r),...Object.keys(o)]),{proxy:s,revoke:l}=Proxy.revocable({},{get(e,t){if(r.hasOwnProperty(t))return r[t];if(o.hasOwnProperty(t)){const e=o[t];return"function"==typeof e?e(a()):e}return a()[t]},set:(e,n,o)=>(t(i,n,"set"),a()[n]=o,!0),deleteProperty:(e,n)=>(t(i,n,"deleteProperty"),delete a()[n],!0),defineProperty:(e,n,o)=>(t(i,n,"defineProperty"),Object.defineProperty(a(),n,o),!0),preventExtensions:e=>(Object.preventExtensions(a()),!0),setPrototypeOf:(e,t)=>(Object.setPrototypeOf(a(),t),!0),apply:(e,t,n)=>a().apply(t,n),construct:(e,t)=>new(a())(...t),getOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(a(),t),getPrototypeOf:e=>Object.getPrototypeOf(a()),has:(e,t)=>!(t in o)&&t in a(),isExtensible:e=>Object.isExtensible(a()),ownKeys(e){const t=a();return[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)]}});return s}};const t=(e,t,n)=>{if(e.has(t))throw new Error(`$store.portal can not call ${n} operation on immutable key ${t}`)}})(),(()=>{const{$store:e,$nanoid:t}=n,o="1234567890abcdefghijklmnopqrstuvwxyz",a=t.customAlphabet(o,16),r=t.customAlphabet(o,12);e.idGenerator={agent:()=>`agent-${a()}`,task:()=>`task-${r()}`,job:()=>`job-${r()}`}})(),(()=>{const{$store:e,$ai:t}=n;e.template.ai=()=>({presetConnectionDone:!1,connections:[{id:"openai-session:text-davinci-002-render-sha",type:"openai-session",slug:"text-davinci-002-render-sha",title:"GPT-3.5",maxTokens:8191},{id:"openai-license",type:"openai-license",slug:t.proxy.openaiLicenseDefaultModel.slug,apiKey:"",showAdvanced:!1,temperature:null,presencePenalty:null,frequencyPenalty:null,systemPrompt:null,proxyUrl:null},{id:"bard-session",type:"bard-session",token:null}],openaiSession:{status:null,loading:!1,accessToken:null,help:{useTab:!1,verify:!1}}})})(),(()=>{const{$store:e,$nanoid:t}=n;e.template.chat=({tabId:n=null,connectionId:o=null}={})=>({id:t(),tabId:n,connectionId:o,bardCursor:null,openaiChatId:null,running:!1,input:"",command:null,params:{},memory:Boolean(e.state?.settings?.enableChatContext),explorer:{show:!1,category:null,commandName:null,editCommandName:null},messages:[]})})(),(()=>{const{$store:e}=n;e.template.commands=()=>({list:[{version:1,meta:{name:"MwNwg0uWG8rt8E6-X0mKV",title:"Sample custom command: 5 facts",description:"This is a sample GPT-powered command. Use it as a reference, feel free to edit or remove.",category:"User"},steps:[{type:"ask",selected:!1,param:"p1",message:"ðŸ‘‹ This is a sample command. Enter a country name or a topic, and I will provide 5 surprising facts.",default:"Finland"},{type:"gpt",selected:!1,prompt:"Please ignore all previous instructions. Please provide 5 not so well known / surprising facts about {{p1}}. Format every fact:\n\n- [relevant fact emoji] [fact]\n\nFacts:"}]}],favouriteCommandNames:[],selectedCommandNames:[]})})(),(()=>{const{$store:e}=n;e.template.creator=()=>({pageUrl:null,parseStatus:null,parseError:null,screen:"templates",editingTaskId:null,templateIndex:-1,configMode:"simple",templates:[],frame:{wide:!1,open:!1,collapsed:!1},trapper:{data:[],grabbing:!1,text:""}})})(),(()=>{const{$store:e}=n;e.template.dashboard=()=>({aggregation:"none",stoppedTasks:[],selectedTasks:[],predefinedImportedAt:null})})(),(()=>{const{$store:e}=n;e.template.journal=()=>({filters:{period:"all-time",filterString:"",types:["task-management","task-results","action","system"]},events:[{ms:Date.now(),type:"system",code:"ok",content:"HARPA agent is installed and ready to run automations",taskName:"SYSTEM"}]})})(),(()=>{const{$store:e,$library:t}=n;e.template.library=()=>({recipesUpdateAt:null,recipes:[],recipeIdeas:[],upvotedRecipes:[],recipeIdeaCard:t.recipeIdeaCardModel(),domains:{}})})(),(()=>{const{$store:e}=n;e.template.news=()=>({show:!1,rated:null,reviewed:!1,feedbackMessage:"",feedbackEmail:"",feedbackStatus:null,lastSeenVersion:null,lastSeenAnno:null})})(),(()=>{const{$store:e}=n;e.template.peeker=()=>({show:!1,fixed:!1,taskId:null,recordMs:null,steps:null,screenshot:null,stepsCollapsed:!1,widgetCollapsed:!1,screenshotCollapsed:!1})})(),(()=>{const{$store:e}=n;e.template.record=()=>({ms:null,value:null,metric:null,status:null,color:null,triggered:!1,dispatched:null,info:null})})(),(()=>{const{$store:e}=n;e.template.runner=()=>({netStable:navigator.onLine,queue:[],actions:{notification:{testStatus:null},sound:{testStatus:null,voices:[]},email:{testStatus:null,testMessage:null},webhook:{testStatus:null,testMessage:null},make:{testStatus:null,testMessage:null}}})})(),(()=>{const{$store:e}=n;e.template.settings=()=>({show:!1,showContext:!0,promptLanguage:"english",connectionId:null,autoClearDialogs:!0,storageLimit:5e3,scheduledTimeframe:{enabled:!1,from:"18:00",till:"8:00"},silenceActions:{enabled:!1},maxParallelTasks:1,autoCloseHiddenWindow:!1,serpTemplate:"smart",serpTemplateCustom:'I am searching for "{{query}}" online. Can you give me info on the topic or answer the question? If possible, give me some relevant links as well. If it is a code related question, please only output the code:',enableChatContext:!0,showScrollbars:!1,sendOnEnter:!0})})(),(()=>{const{$store:e}=n;e.template.shortcut=()=>{const e=navigator.platform.toLowerCase();return{enabled:!0,key:"A",code:65,label:e.startsWith("mac")?"âŒƒ A":"Alt + A",ctrlKey:e.startsWith("mac"),altKey:!e.startsWith("mac"),metaKey:!1,hint:!0,commands:[{id:"rephrase",label:"Improve & rephrase"},{id:"shorten",label:"Shorten"},{id:"expand",label:"Expand"},{id:"rewrite",label:"Rewriteâ€¦"},{id:"fix-grammar",label:"Fix grammar"},{id:"translate",label:"Translate"},{id:"reply",label:"Replyâ€¦"},{id:"favourites",label:"Favourites"}]}}})(),(()=>{const{$store:e,$env:t}=n;e.template.state=()=>({version:e.version,agentId:e.idGenerator.agent(),installedMs:null,theme:"day",mainScreen:"dashboard",ai:e.template.ai(),news:e.template.news(),settings:e.template.settings(),shortcut:e.template.shortcut(),commands:e.template.commands(),dashboard:e.template.dashboard(),peeker:e.template.peeker(),runner:e.template.runner(),library:e.template.library(),journal:e.template.journal(),tab:{},chats:[],tasks:[],global:{},billing:{hrpCookie:null},feature:{updatedAt:-1,hash:null},recipes:{},redactor:{show:!1,taskId:null},sandbox:{isRunning:!1,tests:[]},welcome:{shown:!1,step:1,stepsSubtitle:"AI agent is missing",guidesSubtitle:"COMING SOON"},stats:{taskRuns:0,clickedJoinDiscord:!1},...t.is.desktop&&{shell:e.template.shell()}})})(),(()=>{const{$store:e}=n;e.template.tab=()=>({screen:"ai",creator:e.template.creator(),shortcutCommand:null})})(),(()=>{const{$store:e}=n;e.template.task=({id:t}={})=>({id:t||e.idGenerator.task(),version:e.version,createdMs:Date.now(),recipeId:"watcher.monitorChanges",name:"",enabled:!0,inputScreen:"overview",inputs:{},widgets:{},records:[],state:{}})})(),(()=>{const{$store:e,$env:t}=n;e.__defineGetter__("version",(()=>t.is.bg?Math.max(...Object.keys(e.versions).map(Number)):e.state.version))})(),(()=>{const{$welcome:e,$chrome:t,$env:o}=n;e.controller={init(){3!==e.proxy.step&&1===e.proxy.step&&(e.proxy.update({step:2}),this._pushState())},startTask(t){t.inputs.page?.url===o.welcomeUrl&&e.proxy.update({step:3})},async _pushState(){(await t.tabs.query({})).filter((e=>e.url===o.welcomeUrl)).map((e=>e.id)).forEach((t=>{chrome.tabs.sendMessage(t,{type:"welcome.setState",state:e.proxy.state})}))}}})(),(()=>{const{$welcome:e,$store:t}=n;e.proxy=t.adapter.create({get:e=>e.welcome,get state(){return t.state.welcome}})})(),(()=>{const{$twitter:e,$utils:t}=n;e.controller={MAX_TWEET_LENGTH:280,MAX_GET_PARAM_LENGTH:1e3,send(e){const n=" #HarpaAI";(e.length>=this.MAX_TWEET_LENGTH||e.length+n.length<=this.MAX_TWEET_LENGTH)&&(e+=n),e.length>this.MAX_GET_PARAM_LENGTH&&(e=t.string.shorten(e,this.MAX_GET_PARAM_LENGTH));const o=t.url.create("twitter.com/intent/tweet",{text:e});window.open(o)}}})(),(()=>{const{$timer:e}=n;e.controller={init(){e.workerController.init()}}})(),(()=>{const{$timer:e,$logger:t}=n;e.workerController={init(){this.MAX_ID=2147483647,this.lastId=0,this.idToCallback={},this._setupWorker("/js/timer-worker.min.js")},_generateId(){do{this.lastId===this.MAX_ID?this.lastId=0:this.lastId++}while(this.idToCallback.hasOwnProperty(this.lastId));return this.lastId},_setupWorker(e){const n=this.idToCallback;try{const o=new Worker(e);window.setInterval=(e,t)=>{const a=this._generateId();return n[a]={callback:e,parameters:Array.prototype.slice.call(arguments,2)},o.postMessage({name:"setInterval",id:a,time:t}),a},window.clearInterval=e=>{n.hasOwnProperty(e)&&(delete n[e],o.postMessage({name:"clearInterval",id:e}))},window.setTimeout=(e,t)=>{const a=this._generateId();return n[a]={callback:e,parameters:Array.prototype.slice.call(arguments,2),isTimeout:!0},o.postMessage({name:"setTimeout",id:a,time:t}),a},window.clearTimeout=e=>{n.hasOwnProperty(e)&&(delete n[e],o.postMessage({name:"clearTimeout",id:e}))},o.onmessage=e=>{const o=e.data.id;if(!o||!n.hasOwnProperty(o))return;const a=n[o],r=a.parameters;let i=a.callback;if(a.isTimeout&&delete n[o],"string"==typeof i)try{i=new Function(i)}catch(e){t.error("[$timer] error parsing callback code string",e)}"function"==typeof i&&i.apply(window,r)},o.onerror=e=>{t.error("[$timer] worker posted an error event",e)}}catch(e){t.error("[$timer] failed setting up timer worker",e)}}}})(),(()=>{const{$task:e}=n;e.languages={auto:"Do not force language",en_US:"English (United States)",en_GB:"English (United Kingdom)",af:"Afrikaans",af_NA:"Afrikaans (Namibia)",af_ZA:"Afrikaans (South Africa)",ak:"Akan",ak_GH:"Akan (Ghana)",sq:"Albanian",sq_AL:"Albanian (Albania)",am:"Amharic",ar:"Arabic",am_ET:"Amharic (Ethiopia)",ar_DZ:"Arabic (Algeria)",ar_BH:"Arabic (Bahrain)",ar_EG:"Arabic (Egypt)",ar_IQ:"Arabic (Iraq)",ar_JO:"Arabic (Jordan)",ar_KW:"Arabic (Kuwait)",ar_LB:"Arabic (Lebanon)",ar_LY:"Arabic (Libya)",ar_MA:"Arabic (Morocco)",ar_OM:"Arabic (Oman)",ar_QA:"Arabic (Qatar)",ar_SA:"Arabic (Saudi Arabia)",ar_SD:"Arabic (Sudan)",ar_SY:"Arabic (Syria)",ar_TN:"Arabic (Tunisia)",ar_AE:"Arabic (United Arab Emirates)",ar_YE:"Arabic (Yemen)",hy:"Armenian",hy_AM:"Armenian (Armenia)",as:"Assamese",as_IN:"Assamese (India)",asa:"Asu",asa_TZ:"Asu (Tanzania)",az:"Azerbaijani",az_Cyrl:"Azerbaijani (Cyrillic)",az_Cyrl_AZ:"Azerbaijani (Cyrillic, Azerbaijan)",az_Latn:"Azerbaijani (Latin)",az_Latn_AZ:"Azerbaijani (Latin, Azerbaijan)",bm:"Bambara",bm_ML:"Bambara (Mali)",eu:"Basque",eu_ES:"Basque (Spain)",be:"Belarusian",be_BY:"Belarusian (Belarus)",bem:"Bemba",bem_ZM:"Bemba (Zambia)",bez:"Bena",bez_TZ:"Bena (Tanzania)",bn:"Bengali",bn_BD:"Bengali (Bangladesh)",bn_IN:"Bengali (India)",bs:"Bosnian",bs_BA:"Bosnian (Bosnia and Herzegovina)",bg:"Bulgarian",bg_BG:"Bulgarian (Bulgaria)",my:"Burmese",my_MM:"Burmese (Myanmar [Burma])",yue_Hant_HK:"Cantonese (Traditional, Hong Kong SAR China)",ca:"Catalan",ca_ES:"Catalan (Spain)",tzm:"Central Morocco Tamazight",tzm_Latn:"Central Morocco Tamazight (Latin)",tzm_Latn_MA:"Central Morocco Tamazight (Latin, Morocco)",chr:"Cherokee",chr_US:"Cherokee (United States)",cgg:"Chiga",cgg_UG:"Chiga (Uganda)",zh:"Chinese",zh_Hans:"Chinese (Simplified Han)",zh_Hans_CN:"Chinese (Simplified Han, China)",zh_Hans_HK:"Chinese (Simplified Han, Hong Kong SAR China)",zh_Hans_MO:"Chinese (Simplified Han, Macau SAR China)",zh_Hans_SG:"Chinese (Simplified Han, Singapore)",zh_Hant:"Chinese (Traditional Han)",zh_Hant_HK:"Chinese (Traditional Han, Hong Kong SAR China)",zh_Hant_MO:"Chinese (Traditional Han, Macau SAR China)",zh_Hant_TW:"Chinese (Traditional Han, Taiwan)",kw:"Cornish",kw_GB:"Cornish (United Kingdom)",hr:"Croatian",hr_HR:"Croatian (Croatia)",cs:"Czech",cs_CZ:"Czech (Czech Republic)",da:"Danish",da_DK:"Danish (Denmark)",nl:"Dutch",nl_BE:"Dutch (Belgium)",nl_NL:"Dutch (Netherlands)",ebu:"Embu",ebu_KE:"Embu (Kenya)",en:"English",en_AS:"English (American Samoa)",en_AU:"English (Australia)",en_BE:"English (Belgium)",en_BZ:"English (Belize)",en_BW:"English (Botswana)",en_CA:"English (Canada)",en_GU:"English (Guam)",en_HK:"English (Hong Kong SAR China)",en_IN:"English (India)",en_IE:"English (Ireland)",en_IL:"English (Israel)",en_JM:"English (Jamaica)",en_MT:"English (Malta)",en_MH:"English (Marshall Islands)",en_MU:"English (Mauritius)",en_NA:"English (Namibia)",en_NZ:"English (New Zealand)",en_MP:"English (Northern Mariana Islands)",en_PK:"English (Pakistan)",en_PH:"English (Philippines)",en_SG:"English (Singapore)",en_ZA:"English (South Africa)",en_TT:"English (Trinidad and Tobago)",en_UM:"English (U.S. Minor Outlying Islands)",en_VI:"English (U.S. Virgin Islands)",en_ZW:"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",et_EE:"Estonian (Estonia)",ee:"Ewe",ee_GH:"Ewe (Ghana)",ee_TG:"Ewe (Togo)",fo:"Faroese",fo_FO:"Faroese (Faroe Islands)",fil:"Filipino",fil_PH:"Filipino (Philippines)",fi:"Finnish",fi_FI:"Finnish (Finland)",fr:"French",fr_BE:"French (Belgium)",fr_BJ:"French (Benin)",fr_BF:"French (Burkina Faso)",fr_BI:"French (Burundi)",fr_CM:"French (Cameroon)",fr_CA:"French (Canada)",fr_CF:"French (Central African Republic)",fr_TD:"French (Chad)",fr_KM:"French (Comoros)",fr_CG:"French (Congo - Brazzaville)",fr_CD:"French (Congo - Kinshasa)",fr_CI:"French (CÃ´te dâ€™Ivoire)",fr_DJ:"French (Djibouti)",fr_GQ:"French (Equatorial Guinea)",fr_FR:"French (France)",fr_GA:"French (Gabon)",fr_GP:"French (Guadeloupe)",fr_GN:"French (Guinea)",fr_LU:"French (Luxembourg)",fr_MG:"French (Madagascar)",fr_ML:"French (Mali)",fr_MQ:"French (Martinique)",fr_MC:"French (Monaco)",fr_NE:"French (Niger)",fr_RW:"French (Rwanda)",fr_RE:"French (RÃ©union)",fr_BL:"French (Saint BarthÃ©lemy)",fr_MF:"French (Saint Martin)",fr_SN:"French (Senegal)",fr_CH:"French (Switzerland)",fr_TG:"French (Togo)",ff_SN:"Fulah (Senegal)",ff:"Fulah",gl:"Galician",gl_ES:"Galician (Spain)",lg:"Ganda",lg_UG:"Ganda (Uganda)",ka:"Georgian",ka_GE:"Georgian (Georgia)",de:"German",de_AT:"German (Austria)",de_BE:"German (Belgium)",de_DE:"German (Germany)",de_LI:"German (Liechtenstein)",de_LU:"German (Luxembourg)",de_CH:"German (Switzerland)",el:"Greek",el_CY:"Greek (Cyprus)",el_GR:"Greek (Greece)",gu:"Gujarati",gu_IN:"Gujarati (India)",guz:"Gusii",guz_KE:"Gusii (Kenya)",ha:"Hausa",ha_Latn:"Hausa (Latin)",ha_Latn_GH:"Hausa (Latin, Ghana)",ha_Latn_NE:"Hausa (Latin, Niger)",ha_Latn_NG:"Hausa (Latin, Nigeria)",haw:"Hawaiian",haw_US:"Hawaiian (United States)",he:"Hebrew",he_IL:"Hebrew (Israel)",hi:"Hindi",hi_IN:"Hindi (India)",hu:"Hungarian",hu_HU:"Hungarian (Hungary)",is:"Icelandic",is_IS:"Icelandic (Iceland)",ig:"Igbo",ig_NG:"Igbo (Nigeria)",id:"Indonesian",id_ID:"Indonesian (Indonesia)",ga:"Irish",ga_IE:"Irish (Ireland)",it:"Italian",it_IT:"Italian (Italy)",it_CH:"Italian (Switzerland)",ja:"Japanese",ja_JP:"Japanese (Japan)",kea:"Kabuverdianu",kea_CV:"Kabuverdianu (Cape Verde)",kab:"Kabyle",kab_DZ:"Kabyle (Algeria)",kl:"Kalaallisut",kl_GL:"Kalaallisut (Greenland)",kln:"Kalenjin",kln_KE:"Kalenjin (Kenya)",kam:"Kamba",kam_KE:"Kamba (Kenya)",kn:"Kannada",kn_IN:"Kannada (India)",kk:"Kazakh",kk_Cyrl:"Kazakh (Cyrillic)",kk_Cyrl_KZ:"Kazakh (Cyrillic, Kazakhstan)",km:"Khmer",km_KH:"Khmer (Cambodia)",ki:"Kikuyu",ki_KE:"Kikuyu (Kenya)",rw:"Kinyarwanda",rw_RW:"Kinyarwanda (Rwanda)",kok:"Konkani",kok_IN:"Konkani (India)",ko:"Korean",ko_KR:"Korean (South Korea)",khq:"Koyra Chiini",khq_ML:"Koyra Chiini (Mali)",ses:"Koyraboro Senni",ses_ML:"Koyraboro Senni (Mali)",lag:"Langi",lag_TZ:"Langi (Tanzania)",lv:"Latvian",lv_LV:"Latvian (Latvia)",lt:"Lithuanian",lt_LT:"Lithuanian (Lithuania)",luo:"Luo",luo_KE:"Luo (Kenya)",luy:"Luyia",luy_KE:"Luyia (Kenya)",mk:"Macedonian",mk_MK:"Macedonian (Macedonia)",jmc:"Machame",jmc_TZ:"Machame (Tanzania)",kde:"Makonde",kde_TZ:"Makonde (Tanzania)",mg:"Malagasy",mg_MG:"Malagasy (Madagascar)",ms:"Malay",ms_BN:"Malay (Brunei)",ms_MY:"Malay (Malaysia)",ml:"Malayalam",ml_IN:"Malayalam (India)",mt:"Maltese",mt_MT:"Maltese (Malta)",gv:"Manx",gv_GB:"Manx (United Kingdom)",mr:"Marathi",mr_IN:"Marathi (India)",mas:"Masai",mas_KE:"Masai (Kenya)",mas_TZ:"Masai (Tanzania)",mer:"Meru",mer_KE:"Meru (Kenya)",mfe:"Morisyen",mfe_MU:"Morisyen (Mauritius)",naq:"Nama",naq_NA:"Nama (Namibia)",ne:"Nepali",ne_IN:"Nepali (India)",ne_NP:"Nepali (Nepal)",nd:"North Ndebele",nd_ZW:"North Ndebele (Zimbabwe)",nb:"Norwegian BokmÃ¥l",nb_NO:"Norwegian BokmÃ¥l (Norway)",nn:"Norwegian Nynorsk",nn_NO:"Norwegian Nynorsk (Norway)",nyn:"Nyankole",nyn_UG:"Nyankole (Uganda)",or:"Oriya",or_IN:"Oriya (India)",om:"Oromo",om_ET:"Oromo (Ethiopia)",om_KE:"Oromo (Kenya)",ps:"Pashto",ps_AF:"Pashto (Afghanistan)",fa:"Persian",fa_AF:"Persian (Afghanistan)",fa_IR:"Persian (Iran)",pl:"Polish",pl_PL:"Polish (Poland)",pt:"Portuguese",pt_BR:"Portuguese (Brazil)",pt_GW:"Portuguese (Guinea-Bissau)",pt_MZ:"Portuguese (Mozambique)",pt_PT:"Portuguese (Portugal)",pa:"Punjabi",pa_Arab:"Punjabi (Arabic)",pa_Arab_PK:"Punjabi (Arabic, Pakistan)",pa_Guru:"Punjabi (Gurmukhi)",pa_Guru_IN:"Punjabi (Gurmukhi, India)",ro:"Romanian",ro_MD:"Romanian (Moldova)",ro_RO:"Romanian (Romania)",rm:"Romansh",rm_CH:"Romansh (Switzerland)",rof:"Rombo",rof_TZ:"Rombo (Tanzania)",ru:"Russian",ru_MD:"Russian (Moldova)",ru_RU:"Russian (Russia)",ru_UA:"Russian (Ukraine)",rwk:"Rwa",rwk_TZ:"Rwa (Tanzania)",saq:"Samburu",saq_KE:"Samburu (Kenya)",sg:"Sango",sg_CF:"Sango (Central African Republic)",seh:"Sena",seh_MZ:"Sena (Mozambique)",sr:"Serbian",sr_Cyrl:"Serbian (Cyrillic)",sr_Cyrl_BA:"Serbian (Cyrillic, Bosnia and Herzegovina)",sr_Cyrl_ME:"Serbian (Cyrillic, Montenegro)",sr_Cyrl_RS:"Serbian (Cyrillic, Serbia)",sr_Latn:"Serbian (Latin)",sr_Latn_BA:"Serbian (Latin, Bosnia and Herzegovina)",sr_Latn_ME:"Serbian (Latin, Montenegro)",sr_Latn_RS:"Serbian (Latin, Serbia)",sn:"Shona",sn_ZW:"Shona (Zimbabwe)",ii:"Sichuan Yi",ii_CN:"Sichuan Yi (China)",si:"Sinhala",si_LK:"Sinhala (Sri Lanka)",sk:"Slovak",sk_SK:"Slovak (Slovakia)",sl:"Slovenian",sl_SI:"Slovenian (Slovenia)",xog:"Soga",xog_UG:"Soga (Uganda)",so:"Somali",so_DJ:"Somali (Djibouti)",so_ET:"Somali (Ethiopia)",so_KE:"Somali (Kenya)",so_SO:"Somali (Somalia)",es:"Spanish",es_AR:"Spanish (Argentina)",es_BO:"Spanish (Bolivia)",es_CL:"Spanish (Chile)",es_CO:"Spanish (Colombia)",es_CR:"Spanish (Costa Rica)",es_DO:"Spanish (Dominican Republic)",es_EC:"Spanish (Ecuador)",es_SV:"Spanish (El Salvador)",es_GQ:"Spanish (Equatorial Guinea)",es_GT:"Spanish (Guatemala)",es_HN:"Spanish (Honduras)",es_419:"Spanish (Latin America)",es_MX:"Spanish (Mexico)",es_NI:"Spanish (Nicaragua)",es_PA:"Spanish (Panama)",es_PY:"Spanish (Paraguay)",es_PE:"Spanish (Peru)",es_PR:"Spanish (Puerto Rico)",es_ES:"Spanish (Spain)",es_US:"Spanish (United States)",es_UY:"Spanish (Uruguay)",es_VE:"Spanish (Venezuela)",sw:"Swahili",sw_KE:"Swahili (Kenya)",sw_TZ:"Swahili (Tanzania)",sv:"Swedish",sv_FI:"Swedish (Finland)",sv_SE:"Swedish (Sweden)",gsw:"Swiss German",gsw_CH:"Swiss German (Switzerland)",shi:"Tachelhit",shi_Latn:"Tachelhit (Latin)",shi_Latn_MA:"Tachelhit (Latin, Morocco)",shi_Tfng:"Tachelhit (Tifinagh)",shi_Tfng_MA:"Tachelhit (Tifinagh, Morocco)",dav:"Taita",dav_KE:"Taita (Kenya)",ta:"Tamil",ta_IN:"Tamil (India)",ta_LK:"Tamil (Sri Lanka)",te:"Telugu",te_IN:"Telugu (India)",teo:"Teso",teo_KE:"Teso (Kenya)",teo_UG:"Teso (Uganda)",th:"Thai",th_TH:"Thai (Thailand)",bo:"Tibetan",bo_CN:"Tibetan (China)",bo_IN:"Tibetan (India)",ti:"Tigrinya",ti_ER:"Tigrinya (Eritrea)",ti_ET:"Tigrinya (Ethiopia)",to:"Tonga",to_TO:"Tonga (Tonga)",tr:"Turkish",tr_TR:"Turkish (Turkey)",uk:"Ukrainian",uk_UA:"Ukrainian (Ukraine)",ur:"Urdu",ur_IN:"Urdu (India)",ur_PK:"Urdu (Pakistan)",uz_Arab:"Uzbek (Arabic)",uz_Arab_AF:"Uzbek (Arabic, Afghanistan)",uz:"Uzbek",uz_Cyrl:"Uzbek (Cyrillic)",uz_Cyrl_UZ:"Uzbek (Cyrillic, Uzbekistan)",uz_Latn:"Uzbek (Latin)",uz_Latn_UZ:"Uzbek (Latin, Uzbekistan)",vi:"Vietnamese",vi_VN:"Vietnamese (Vietnam)",vun:"Vunjo",vun_TZ:"Vunjo (Tanzania)",cy:"Welsh",cy_GB:"Welsh (United Kingdom)",yo:"Yoruba",yo_NG:"Yoruba (Nigeria)",zu:"Zulu",zu_ZA:"Zulu (South Africa)"}})(),(()=>{const{$task:e}=n;e.mediumTypes=[{id:"tab",name:"tab",label:"Tab"},{id:"pinned-tab",name:"pinned tab",label:"Pinned Tab"},{id:"hidden-tab",name:"hidden frame",label:"Hidden Frame"}],e.mediumTypesWithAutoClosing=e.mediumTypes.map((e=>[{id:`t:${e.id}`,name:`${e.name} (auto-close)`,label:`${e.label} (auto-close)`},{id:`p:${e.id}`,name:`${e.name} (persistent)`,label:`${e.label} (persistent)`}])).flat()})(),(()=>{const{$task:e,$store:t,$library:o,$utils:a,$ui:r}=n;e.proxy=t.createProxy({get recipes(){return t.state.recipes},set recipes(e){t.transaction((t=>{t.recipes=e||{}}))},recipeById(e){return this.recipes[e]},recipeName(e){return this._computeMetaValue("name",e)},recipeIcon(e){const t=this._computeMetaValue("icon",e);return r.Icon.icons[t]},recipeTitle(e){return this._computeMetaValue("title",e)},recipeUnderDevelopment(e){return this._computeMetaValue("underDevelopment",e)},recipeShowGrabber(e){return this._computeMetaValue("showGrabber",e)},_computeMetaValue(t,n){const o="string"==typeof n?e.proxy.recipeById(n):e.proxy.recipeById(n.recipeId),a="string"!=typeof n&&n;return e.evaluate(o.meta[t],{recipe:o,task:a})},get tasks(){return t.state.tasks},set tasks(e){t.transaction((t=>{t.tasks=e||[]}))},taskById(e){return e?this.tasks.find((t=>t.id===e)):null},taskByTabId(e){return e?this.tasks.find((t=>t.inputs.schedule?.mediumId===e)):null},taskIndex(e){return e?this.tasks.findIndex((t=>t.id===e)):null},get taskIds(){return this.tasks.map((e=>e.id))},taskDomain(e){const t=e.inputs?.page?.url;return t?a.url.getDomain(t,{canonical:!0,noTld:!0}):null},get taskMediumIds(){return this.tasks.map((e=>e.inputs.schedule?.mediumId)).filter((e=>!!e))},taskLastRecord:e=>e.records.at(-1),updateFavicons(t,n){t=a.ensureArray(t);const r=n&&e.proxy.taskDomain(n);0!==t.length&&(t.map((e=>"string"==typeof e?{favicon:e,hq:!0}:e)).map((e=>(e.domain||(e.domain=r),e))).filter((e=>Boolean(e.domain))),o.proxy.setDomainFavicons(t))},updateTask(e,n={},o=null){const a=this.taskIndex(e);if(-1===a)throw new Error(`no task found for id ${e}`);t.transaction((e=>{let t=e.tasks[a];o&&(t=t[o]),"function"==typeof n?n(t):Object.assign(t,n)}))},removeRecords(e){t.transaction((t=>{for(const n in e){const o=t.tasks.find((e=>e.id===n));o&&(o.records=o.records.filter((t=>!e[n].has(t.ms))))}}))}})})(),(()=>{const{$task:e}=n;e.scheduleFrequencies=[{id:"15s",label:"Every 15 seconds",selectedLabel:"15 seconds"},{id:"1m",label:"Every minute",selectedLabel:"1 minute"},{id:"5m",label:"Every 5 minutes",selectedLabel:"5 mins"},{id:"15m",label:"Every 15 minutes",selectedLabel:"15 mins"},{id:"1h",label:"Every hour",selectedLabel:"1 hour"},{id:"3h",label:"Every 3 hours",selectedLabel:"3 hours"},{id:"12h",label:"Every 12 hours",selectedLabel:"12 hours"},{id:"1d",label:"Every day",selectedLabel:"1 day"},{id:"1w",label:"Every week",selectedLabel:"1 week"},{id:"1mo",label:"Every month",selectedLabel:"1 month"}]})(),(()=>{const{$task:e}=n;e.trackingItems=[{id:"between-checks",label:"between checks"},{id:"to-first-check",label:"to the first check made"}]})(),(()=>{const{$task:e}=n;e.userAgents={"macbook-13.4":{name:"MacBook 13.4'",icon:"mac",viewportWidth:1366,viewportHeight:768,userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36"},"windows-pc":{name:"Windows PC",icon:"win",viewportWidth:1600,viewportHeight:900,userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36"},"galaxy-s5":{name:"Galaxy S5",icon:"android",viewportWidth:360,viewportHeight:480,userAgent:"Mozilla/5.0 (Linux; Android 5.0; SM-G900P Build/LRX21T) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Mobile Safari/537.36"},"iphone-x":{name:"iPhone X",icon:"iphone",viewportWidth:375,viewportHeight:812,userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 13_3_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.5 Mobile/15E148 Safari/604.1"}}})(),(()=>{const{$task:e,$recipe:t,$store:o,$mobx:a,$utils:r,$critical:i,$env:s}=n;e.Adapter=class{static ofTask(t){return t?new e.Adapter(t):null}constructor(e){if(!e)throw new Error("$task.Adapter task argument must be defined");this._task=e}get taskProxy(){return this._task}get taskObject(){return a.toJS(this._task)}transaction(e){const t=this._task.id;o.transaction((n=>{const o=(s.is.pp?n.tab[i.proxy.tabId]?.creator:null)?.templates.find((e=>e.id===t))||n.tasks.find((e=>e.id===t));o&&e(o,n)}))}resetTaskState(e=!0){const n=o.template.task({id:this.id});e&&Object.entries(t.inputs).forEach((([e,t])=>{const o=this._task.inputs[e];n.inputs[e]=o&&t.persistState?o:t.state})),this.transaction((e=>{Object.keys(n).forEach((t=>{e[t]=n[t]})),Object.keys(e).filter((e=>!n.hasOwnProperty(e))).forEach((t=>delete e[t]))}))}get id(){return this._task.id}set id(e){this.transaction((t=>t.id=e))}get name(){return this._task.name}set name(e){this.transaction((t=>t.name=e))}get enabled(){return this._task.enabled}set enabled(e){this.transaction((t=>t.enabled=e))}toggleEnabled(){this.transaction((e=>e.enabled=!e.enabled))}get createdMs(){return this._task.createdMs}get recipeId(){return this._task.recipeId}set recipeId(e){this.transaction((t=>t.recipeId=e))}get recipe(){return e.proxy.recipeById(this.recipeId)}get state(){return this._task.state}updateState(e={}){this.transaction((t=>Object.assign(t.state,e)))}get inputScreen(){return this._task.inputScreen}set inputScreen(e){this.transaction((t=>t.inputScreen=e))}get records(){return this._task.records}resetRecords(){const e=o.template.task();this.transaction((t=>t.records=e.records))}get firstRecord(){return this.records[0]}set firstRecord(e){this.transaction((t=>t.records[0]=e))}get lastRecord(){return this.records.at(-1)||{}}set lastRecord(e){const t=this.records.length;this.transaction((n=>{0===t?n.records.push(e):n.records[t-1]=e}))}get previousRecord(){const e=this.trackingValue,t=this.records.filter((e=>"warning"!==e.status&&"error"!==e.status));return e&&"between-checks"!==e?"to-first-check"===e?t.length>1?t[0]:{}:null:t.length>1?t.at(-2):{}}dropToFirstRecord(){const e=this.firstRecord;e&&this.transaction((t=>t.records=[e]))}get inputs(){return this._task.inputs}input(e){return this.ensureInput(e),this._task.inputs[e]}ensureInput(e){this._task.inputs[e]||this.transaction((n=>n.inputs[e]=t.proxy.input(e).state))}updateInput(e,t){this.ensureInput(e),this.transaction((n=>Object.assign(n.inputs[e],t)))}get page(){return this.input("page")}updatePage(e){this.transaction((t=>Object.assign(t.inputs.page,e)))}get pageUrl(){return this.page.url}set pageUrl(e){this.updatePage({url:e})}get ua(){return this.input("ua")}updateUa(e){this.transaction((t=>Object.assign(t.inputs.ua,e)))}get uaVlang(){return this.input("ua").vlang}set uaVlang(e){this.updateUa({vlang:e})}get uaVua(){return this.input("ua").vua}set uaVua(e){this.updateUa({vua:e})}get uaCustomViewport(){return this.input("ua").customViewport}set uaCustomViewport(e){this.updateUa({customViewport:e})}get uaViewportWidth(){return this.input("ua").viewportWidth}set uaViewportWidth(e){this.updateUa({viewportWidth:e})}get uaViewportHeight(){return this.input("ua").viewportHeight}set uaViewportHeight(e){this.updateUa({viewportHeight:e})}get pageMediumSize(){const t=this.input("ua");return{width:t.customViewport?t.viewportWidth||"100%":e.userAgents[t.vua]?.viewportWidth||"100%",height:t.customViewport?t.viewportHeight||"100%":e.userAgents[t.vua]?.viewportHeight||"100%"}}get before(){return this.input("before")}updateBefore(e,t){"string"!=typeof e?(t=e,this.transaction((e=>Object.assign(e.inputs.before,t)))):this.transaction((n=>Object.assign(n.inputs.before[e],t)))}get beforeIdleCheckEnabled(){return this.before.idleCheck.enabled}set beforeIdleCheckEnabled(e){this.updateBefore("idleCheck",{enabled:e})}get beforeIdleCheckTimeout(){return this.before.idleCheck.timeout}set beforeIdleCheckTimeout(e){this.updateBefore("idleCheck",{timeout:e})}get beforeIdleCheckOnTimeout(){return this.before.idleCheck.onTimeout}set beforeIdleCheckOnTimeout(e){this.updateBefore("idleCheck",{onTimeout:e})}get beforeTextCheckEnabled(){return this.before.textCheck.enabled}set beforeTextCheckEnabled(e){this.updateBefore("textCheck",{enabled:e})}get beforeTextCheckSearchText(){return this.before.textCheck.searchText}set beforeTextCheckSearchText(e){this.updateBefore("textCheck",{searchText:e})}get beforeTextCheckTimeout(){return this.before.textCheck.timeout}set beforeTextCheckTimeout(e){this.updateBefore("textCheck",{timeout:e})}get beforeTextCheckOnTimeout(){return this.before.textCheck.onTimeout}set beforeTextCheckOnTimeout(e){this.updateBefore("textCheck",{onTimeout:e})}get beforeDropBannersEnabled(){return this.before.dropBanners.enabled}set beforeDropBannersEnabled(e){this.updateBefore("dropBanners",{enabled:e})}get beforeDropBannersText(){return this.before.dropBanners.text}set beforeDropBannersText(e){this.updateBefore("dropBanners",{text:e})}get beforeScrollEnabled(){return this.before.scroll.enabled}set beforeScrollEnabled(e){this.updateBefore("scroll",{enabled:e})}get beforeScrollMaxDuration(){return this.before.scroll.maxDuration}set beforeScrollMaxDuration(e){this.updateBefore("scroll",{maxDuration:e})}get schedule(){return this.input("schedule")}updateSchedule(e,t){"string"!=typeof e?(t=e,this.transaction((e=>Object.assign(e.inputs.schedule,t)))):this.transaction((n=>Object.assign(n.inputs.schedule[e],t)))}get scheduleMediumType(){return this.schedule.mediumType}set scheduleMediumType(e){this.updateSchedule({mediumType:e})}get scheduleMediumId(){return this.schedule.mediumType}set scheduleMediumId(e){this.updateSchedule({mediumId:e})}get scheduleType(){return this.schedule.type}set scheduleType(e){this.updateSchedule({type:e})}get schedulePeriodicalFrequency(){return this.schedule.periodical.frequency}set schedulePeriodicalFrequency(e){this.updateSchedule("periodical",{frequency:e})}get scheduleAutoCloseTab(){return this.schedule.autoCloseTab}set scheduleAutoCloseTab(e){this.updateSchedule({autoCloseTab:e})}get tracking(){return this.input("tracking")}updateTracking(e){this.transaction((t=>Object.assign(t.inputs.tracking,e)))}get trackingValue(){return this.tracking.value}set trackingValue(e){this.updateTracking({value:e})}get actions(){return this.input("actions")}updateAction(e,t){this.transaction((n=>Object.assign(n.inputs.actions[e],t)))}actionEnabled(e){return this.input("actions")[e].enabled}toggleActionEnabled(e){this.transaction((t=>t.inputs.actions[e].enabled=!t.inputs.actions[e].enabled))}actionTestStatus(e){return o.state.runner.actions[e].testStatus}actionTestMessage(e){return o.state.runner.actions[e].testMessage}get actionSoundValue(){return this.input("actions").sound.value}set actionSoundValue(e){this.updateAction("sound",{value:e})}get actionSoundVolume(){return this.input("actions").sound.volume}set actionSoundVolume(e){this.updateAction("sound",{volume:e})}get actionSoundUtterance(){return this.input("actions").sound.utterance}set actionSoundUtterance(e){this.updateAction("sound",{utterance:e})}actionSendOn(e){return this.input("actions")[e].sendOn}setActionSendOn(e,t){this.transaction((n=>n.inputs.actions[e].sendOn=t))}actionLimitActions(e){return this.input("actions")[e].limitActions}setActionLimitActions(e,t){this.transaction((n=>n.inputs.actions[e].limitActions=t))}get changeUpIs(){return this.input("changeUpIs")}updateChangeUpIs(e){this.transaction((t=>Object.assign(t.inputs.changeUpIs,e)))}get changeUpIsValue(){return this.changeUpIs.value}set changeUpIsValue(e){this.updateChangeUpIs({value:e})}get trigger(){return this.input("trigger")}updateTrigger(e){this.transaction((t=>Object.assign(t.inputs.trigger,e)))}get triggerMinThreshold(){return this.trigger.minThreshold}set triggerMinThreshold(e){this.updateTrigger({minThreshold:e})}get triggerX(){return this.trigger.x}set triggerX(e){this.updateTrigger({x:e})}get triggerY(){return this.trigger.y}set triggerY(e){this.updateTrigger({y:e})}get triggerSearchText(){return this.trigger.searchText}set triggerSearchText(e){this.updateTrigger({searchText:e})}get triggerHttpCodes(){return this.trigger.httpCodes}set triggerHttpCodes(e){this.updateTrigger({httpCodes:e})}get triggerIcon(){return this.trigger.icon}set triggerIcon(e){this.updateTrigger({icon:e})}get triggerColor(){return this.trigger.color}set triggerColor(e){this.updateTrigger({color:e})}get lastRecordValue(){if(!this.lastRecord)return{value:"N/A"};let{value:e,metric:t,type:n,error:o,status:a}=this.lastRecord;return"error"===a?{value:e}:o?{value:o?.text||o}:null==e?{value:"N/A"}:r.formatter.format(e,t||n,{format:"object",maxInt:1e7})}get lastRecordValueText(){const e=this.lastRecordValue;return`${e.sign||""}${e.value}`}get lastRecordValuePrefix(){return this.lastRecordValue.prefix||""}get lastRecordValueSuffix(){const e=this.lastRecordValue;return`${e.suffix||""} ${e.metric||""}`.trim()}get lastRecordValueDimmed(){return!0===this.lastRecord.valueDimmed||null==this.lastRecord.value}get lastRecordMetric(){return this.lastRecord.metric}get lastRecordStatus(){return this.lastRecord.status}get lastRecordColor(){return this.lastRecord.color}get lastRecordTriggered(){return this.lastRecord.triggered}get lastRecordDispatched(){return this.lastRecord.dispatched}get lastRecordDelta(){return this.lastRecord&&this.lastRecord.hasOwnProperty("value")?"number"!=typeof this.lastRecord.value?null:this.previousRecord&&this.previousRecord.hasOwnProperty("value")?"number"!=typeof this.previousRecord.value?null:this.lastRecord.value-this.previousRecord.value:null:null}get lastRecordDeltaText(){const e=this.lastRecordDelta;return e?"number"==typeof e?r.formatter.format(e,this.lastRecord.metric):e:null}get lastRecordDeltaColor(){const e=this.lastRecordDelta;if(!e)return null;const t=this.changeUpIsValue;return t?"neutral"===t?"neutral":e>0?"good"===t?"positive":"negative":e<0?"bad"===t?"positive":"negative":"neutral":null}get lastRecordDeltaDirection(){const e=this.lastRecordDelta;return e?"number"!=typeof e?null:e<0?"down":"up":null}get lastRecordDeltaSymbol(){const e=this.lastRecordDeltaDirection;return null===e?"":e<0?"â–¼":"â–²"}get lastRecordDate(){const{ms:e}=this.lastRecord;return r.time.formatDate(e||Date.now(),{hour:"2-digit",minute:"2-digit"})}get lastRecordDescription(){const{ms:e}=this.lastRecord;return r.time.formatRelativeDate(e||Date.now())}get lastRecordInfo(){const{info:e}=this.lastRecord;return r.toElement(e)}get lastRecordInfoString(){const{info:e}=this.lastRecord;return r.clearFromTags(e)}get lastRecordStatusIcon(){const{status:e}=this.lastRecord;return e||"ok"}get lastRecordStatusIconColor(){const{color:e}=this.lastRecord;return e||"sublime"}set previewUrl(e){this.transaction((t=>t.previewUrl=e))}}})(),(()=>{const{$task:e,$recipe:t}=n;e.evaluate=(e,...n)=>{if(!e)return e;if("string"!=typeof e)return e;if(e.startsWith("=="))return e.substr(1);if(!e.startsWith("="))return e;let o=e.substr(1);if(o.startsWith("func(")&&o.endsWith(")")){o=o.substr(5),o=o.substr(0,o.length-1);const[e,a]=o.split("."),r=t.proxy.adapter(e);return r[a].call(r,...n)}return o}})(),(()=>{const{$tabs:e,$env:t,$chrome:o}=n;e.openAppTab=async(e=!0)=>{const n=chrome.runtime.getURL("/harpa.html");let a=(await o.tabs.query({})).find((e=>e.url===n));const r=!!a;r?await o.tabs.update(a.id,{active:!0}):a=await o.tabs.create({url:n,active:!0});const i=await o.windows.get(a.windowId);if(i){const e={focused:!0,state:"minimized"===i.state?"maximized":i.state};await o.windows.update(a.windowId,e)}if(!e||t.is.bg)return r;window.close()}})(),(()=>{const{$tabs:e,$uaParserJs:t,$utils:o,$library:a,$critical:r,$chrome:i,$settings:s,$store:l,$tab:c,$bus:d,$chat:u}=n;e.controller={async init(){await this.updateTabList(),this._autoRefreshFavicons(),setTimeout((()=>this._cleanupOldTabs()),1e3)},async updateTabList(){const n=t(navigator.userAgent);e.proxy.tabs=await this._fetchTabs(n),e.proxy.currentTab=this._getCurrentTab(e.proxy.tabs);const o=this._getFavicons(e.proxy.tabs);return a.proxy.setDomainFavicons(o),{currentTab:e.proxy.currentTab,tabs:e.proxy.tabs}},async reloadCurrentTab(){await i.tabs.reload(e.controller.currentTabId)},async _fetchTabs(e){let t=await i.tabs.query({});return t=t.map((t=>this._normalizeTab(t,e))),t},_normalizeTab:(e,t)=>({id:e.id,active:e.active,favicon:e.favIconUrl,title:e.title,url:e.url,width:e.width,height:e.height,isAutomatable:r.isAutomatable(e),ua:t}),_getCurrentTab:e=>e.find((e=>e.id===r.proxy.tabId)),_getFavicons:e=>e.filter((e=>e.url&&e.favicon)).filter((e=>e.url.startsWith("http://")||e.url.startsWith("https://"))).filter((e=>!e.url.startsWith("https://harpa.ai/automation"))).map((e=>({domain:o.url.getDomain(e.url,{canonical:!0,noTld:!0}),favicon:e.favicon}))),_autoRefreshFavicons(){chrome.tabs.onUpdated.addListener((async(t,n)=>{e.proxy.updateTabFavicon(t,n.favIconUrl)}))},async _cleanupOldTabs(){const e=(await i.tabs.query({})).map((e=>e.id)),t=Object.keys(l.state.tab).map(Number).filter((t=>!e.includes(t)));s.proxy.autoClearDialogs&&d.send("dialog.delete",t),l.transaction((e=>{for(const n of t)delete e.tab[n]}));for(const e of t)u.proxy.removeChat(e);c.proxy.cleanupCache(t),d.send("tab.cleanupProxyCache",t)}}})(),(()=>{const{$tabs:e,$mobx:t}=n;e.model=t.observable({currentTab:null,tabs:[]})})(),(()=>{const{$tabs:e,$store:t}=n;e.proxy=t.createProxy({get tabs(){return e.model.tabs},set tabs(t){e.model.tabs=t},get currentTab(){return e.model.currentTab},set currentTab(t){e.model.currentTab=t},get currentTabId(){return this.currentTab?.id},updateActiveBrowserTab(e){this.currentTab={...this.currentTab,...e}},updateTabFavicon(t,n){if(!t||!n)return;const o=e.model.tabs.findIndex((e=>e.id===t));-1!==o&&(e.model.tabs[o].favicon=n)},get isCurrentTabAutomatable(){return this.currentTab?.isAutomatable},get currentTabUrl(){return this.currentTab?.url},get currentTabProtocol(){const e=this.currentTab;return e?e.url.split("/")[0]+"//":null},get currentTabDomain(){const e=this.currentTab;if(!e)return null;const t=e.url.split("/").slice(2)[0];return t.startsWith("www.")?t.substr(4):t},get currentTabPath(){const e=this.currentTab;if(!e)return null;let t=e.url.split("/").slice(3).join("/");return t&&(t="/"+t),t}})})(),(()=>{const{$tab:e,$tabs:t,$env:o,$store:a,$creator:r}=n;e.proxy={get screen(){return this.of().screen},set screen(e){this.of().screen=e},get shortcutCommand(){return this.of().shortcutCommand},set shortcutCommand(e){this.of().shortcutCommand=e},get dialog(){return this.of().dialog},get creator(){return this.of().creator},of(n){if(o.is.pp&&!n&&(n=t.proxy.currentTabId),!n)return null;const a=this._cache||(this._cache={});return a[n]||(a[n]={get screen(){return e.proxy.getState(n).screen},set screen(t){e.proxy.transaction(n,(e=>e.screen=t))},get shortcutCommand(){return e.proxy.getState(n).shortcutCommand},set shortcutCommand(t){e.proxy.transaction(n,(e=>e.shortcutCommand=t))},creator:new r.Adapter(n)}),a[n]},cleanupCache(e=[]){this._cache&&e.forEach((e=>delete this._cache[e]))},getState(e){return this._ensureState(e),a.state.tab[e]},transaction(e,t){this._ensureState(e),a.transaction((n=>t(n.tab[e])))},_ensureState(e){let n=a.state.tab[e];if(n||(n=a.template.tab(),a.transaction((t=>t.tab[e]=n))),o.is.pp&&!n.creator.pageUrl){const n=t.proxy.currentTabUrl;a.transaction((t=>t.tab[e].creator.pageUrl=n))}}}})(),(()=>{const{$stats:e,$store:t}=n;e.proxy=t.createProxy({get value(){return t.state.stats},get clickedJoinDiscord(){return this.value.clickedJoinDiscord},set clickedJoinDiscord(e){this._update({clickedJoinDiscord:e})},get taskRuns(){return this.value.taskRuns||0},taskRunsAdd(){this._update({taskRuns:this.taskRuns+1})},_update(e={}){t.transaction((t=>{Object.assign(t.stats,e)}))}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$snackbar:o,$ui:a,$news:r,$stats:i}=n;o.Container=a.component("SnackbarContainer",{get show(){return i.proxy.taskRuns>5&&!r.proxy.show&&!["5-star-ok","5-star-cancel","X-star-ok","X-star-cancel"].includes(r.proxy.feedbackStatus)},render(){if(!this.show)return null;const{c:n}=this;return e(1,"column",n.block,t(2,r.SectionRateUs,{snack:!0}),2)}})})(),(()=>{const{$shortcut:e,$bus:t}=n;e.listener=e=>{const n=async o=>{const a=e.config;if(a&&a.code&&a.enabled&&a.code===o.keyCode&&Boolean(a.altKey)===Boolean(o.altKey)&&Boolean(a.ctrlKey)===Boolean(o.ctrlKey)&&Boolean(a.metaKey)===Boolean(o.metaKey)){o.preventDefault();try{await t.send("browser.toggleFrame",{preferClose:!o.shiftKey}),e.onShortcutPress&&e.onShortcutPress()}catch(o){o.message?.startsWith("Extension context invalidated")||window.removeEventListener("keydown",n)}}};window.addEventListener("keydown",n)}})(),(()=>{const{$shortcut:e,$store:t,$env:o}=n;e.proxy=t.createProxy({get shortcut(){return t.state.shortcut},set shortcut(e){(e={...e}).label||(e.label=this.computeLabel(e)),t.transaction((t=>t.shortcut=e))},get enabled(){return this.shortcut.enabled},get hint(){return this.shortcut.hint},get label(){return this.shortcut.label},computeLabel(e){const{key:t,ctrlKey:n,metaKey:a,altKey:r}=e,i=o.platform;let s;return s="mac"===i?a?["âŒ˜",t]:n?["âŒƒ",t]:r?["âŒ¥",t]:[t]:"linux"===i?a?["â–",t]:n?["Ctrl",t]:r?["Alt",t]:[t]:a?["Win",t]:n?["Ctrl",t]:r?["Alt",t]:[t],s=s.filter(Boolean),s="win"===i?s.join(" + "):s.join(" "),s}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$shortcut:o,$ui:a}=n;o.Input=a.component("ShortcutInput",{state:()=>({focused:!1,label:null,value:null}),get value(){return this.state.focused?this.state.value||"":o.proxy.label},get label(){return this.state.label||"Shortcut"},get enabled(){return o.proxy.enabled},get icon(){return this.enabled?a.Checkbox.icons.on:a.Checkbox.icons.off},init(){this.ref("block")},render(){const{c:n}=this,o="Shortcut is "+(this.enabled?"enabled":"disabled");return e(1,"row",n.block,[t(2,a.Tooltip,{content:o,children:e(1,"column",n.icon({on:this.enabled}),t(2,a.Icon,{name:this.icon}),2,{"x-center":!0,"y-center":!0,onClick:this.onEnableClick})}),t(2,a.Input,{label:this.label,value:this.value,disabled:!this.enabled,class:n.input,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown})],4,{gap:"g1"},null,this.blockRef)},onFocus(){this.setState({focused:!0,value:null,label:"Modifier + Key"})},onBlur(){this.setState({focused:!1,value:null,label:null})},onKeyDown(e){if(e.preventDefault(),e.stopPropagation(),"Meta"===e.key)return;if(!(e.metaKey||e.ctrlKey||e.altKey))return;const t=e.key.toUpperCase();1===t.length&&(/[^\x20-\x7E\u005B-\u005D\u005C\u005E-\u0060\u007B-\u007E]/.test(t)||(o.interceptor.updateShortcut({key:t,code:e.keyCode,metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,label:null}),this.setState({label:null,value:null}),this.blockRef.current?.querySelector("input")?.blur()))},onEnableClick(){o.interceptor.updateShortcut({enabled:!o.proxy.enabled})}})})(),(()=>{const{$shortcut:e,$tab:t,$dialog:o,$mobx:a}=n;e.controller={init(){a.reaction((()=>t.proxy.shortcutCommand),this.runCommand.bind(this),{fireImmediately:!0})},runCommand(e){if(e&&0!==e.length)switch(t.proxy.shortcutCommand=null,e[0]){case"rephrase":o.controller.launchCommand("rewrite",{inputs:["{{page.selection}}","Rephrase to improve writing, flow, readability and coherence. Fix grammar and spelling."]});break;case"shorten":o.controller.launchCommand("rewrite",{inputs:["{{page.selection}}","SHORTEN"]});break;case"expand":o.controller.launchCommand("rewrite",{inputs:["{{page.selection}}","EXPAND"]});break;case"rewrite":o.controller.launchCommand("rewrite",{inputs:["{{page.selection}}"]});break;case"fix-grammar":o.controller.launchCommand("rewrite",{inputs:["{{page.selection}}","Output the text as is, but fix spelling errors if the text contains them."]});break;case"translate":o.controller.launchCommand("translate",{inputs:["{{page.selection}}","{{language}}"]});break;case"reply":o.controller.launchCommand("reply",{inputs:["{{page.selection}}"]});break;default:o.controller.launchCommand(e[0])}}}})(),(()=>{const{$shortcut:e}=n;e.interceptor={get config(){return e.proxy.shortcut},async init(){e.listener(this)},async updateShortcut(t){e.proxy.shortcut={...e.proxy.shortcut,...t}}}})(),(()=>{const{$settings:e}=n,t=[{id:"chinese",label:"ä¸­æ–‡ (Chinese)"},{id:"catalan",label:"Catalan"},{id:"korean",label:"Korean"},{id:"japanese",label:"Japanese"},{id:"spanish",label:"Spanish"},{id:"french",label:"French"},{id:"german",label:"German"},{id:"turkish",label:"Turkish"},{id:"italian",label:"Italian"},{id:"portuguese",label:"Portuguese"},{id:"polish",label:"Polish"},{id:"dutch",label:"Dutch"},{id:"czech",label:"Czech"},{id:"serbian",label:"Serbian"},{id:"slovak",label:"Slovak"},{id:"slovenian",label:"Slovenian"},{id:"georgian",label:"Georgian"},{id:"romanian",label:"Romanian"},{id:"croatian",label:"Croatian"},{id:"greek",label:"Greek"},{id:"russian",label:"Russian"},{id:"ukrainian",label:"Ukrainian"},{id:"belarusian",label:"Belarusian"},{id:"armenian",label:"Armenian"},{id:"swedish",label:"Swedish"},{id:"finnish",label:"Finnish"},{id:"hungarian",label:"Hungarian"},{id:"norwegian bokmÃ¥l",label:"Norwegian BokmÃ¥l"},{id:"norwegian nynorsk",label:"Norwegian Nynorsk"},{id:"danish",label:"Danish"},{id:"hindi-urdu",label:"Hindi Urdu"},{id:"kannada",label:"Kannada"},{id:"indonesian",label:"Indonesian"},{id:"malay",label:"Malay"},{id:"arabic",label:"Arabic"},{id:"bengali",label:"Bengali"},{id:"marathi",label:"Marathi"},{id:"telugu",label:"Telugu"},{id:"vietnamese",label:"Vietnamese"},{id:"gujarati",label:"Gujarati"},{id:"persian",label:"Persian Farsi"},{id:"tamil",label:"Tamil"},{id:"burmese",label:"Burmese"},{id:"thai",label:"Thai"},{id:"lao",label:"Lao"},{id:"swahili",label:"Swahili"},{id:"punjabi",label:"Punjabi"},{id:"uzbek",label:"Uzbek"},{id:"azerbaijani",label:"Azerbaijani"},{id:"kirghiz",label:"Kirghiz"},{id:"mongolian",label:"Mongolian"},{id:"dari",label:"Dari"}].sort(((e,t)=>e.label>t.label?1:-1));t.unshift({id:"english",label:"English"});const o=new Set(t.map((e=>e.id))),a=t.reduce(((e,t)=>(e[t.id]=t,e)),{}),r={id:"custom",label:"Custom"};t.unshift(r),e.languages=t,e.languageIds=o,e.languageMap=a,e.customLanguage=r})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a,$news:r,$shortcut:i}=n;o.Content=a.component("SettingsContent",{props:()=>({hideRate:Boolean}),render(){const{c:n}=this;return e(1,"column",null,[e(1,"column",null,[e(1,"row",null,[t(2,o.SectionTheme),t(2,i.Input)],4,{"x-between":!0}),t(2,o.SectionShowShortcutHint),t(2,o.SectionSendOnEnter),t(2,o.SectionShowScrollbars)],4,{gap:"g1"}),e(1,"column",null,[e(1,"div",n.title,"AI CONNECTION",16),t(2,a.Spacer,{height:"g1h"}),e(1,"column",null,[t(2,o.SectionConnectionType),t(2,o.SectionApiKey),t(2,o.SectionModelSession),t(2,o.SectionModelLicense),t(2,o.SectionLicenseAdvanced),t(2,o.SectionClearDialogs)],4,{gap:"g2"})],4),e(1,"column",null,[e(1,"div",n.title,"AI AGENT",16),t(2,a.Spacer,{height:"g1h"}),e(1,"column",null,[t(2,o.SectionPromptLanguage),t(2,o.SectionSerpTemplate),t(2,o.SectionChatContext)],4,{gap:"g2"})],4),e(1,"column",null,[e(1,"div",n.title,"MONITOR",16),t(2,a.Spacer,{height:"g1h"}),t(2,o.SectionMaxParallelTasks),t(2,a.Spacer,{height:"g2"}),t(2,o.SectionStorageLimit),t(2,a.Spacer,{height:"g3"}),t(2,o.SectionScheduledTimeframe),t(2,a.Spacer,{height:"g3"}),t(2,o.SectionSilenceActions),t(2,a.Spacer,{height:"g3"}),t(2,o.SectionAutoCloseHiddenWindow)],4),!this.props.hideRate&&t(2,r.SectionRateUs)],0,{gap:"g4"})}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$settings:t,$ui:o}=n;t.Panel=o.component("SettingsPanel",{get show(){return t.proxy.show},render(){const{c:n}=this;return e(2,o.SidePanel,{class:n.block,show:this.show,children:[e(2,t.SectionHeader),e(2,t.Content,{hideRate:!0})]})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$settings:r,$ui:i,$ai:s}=n;r.SectionApiKey=i.component("SettingsSectionApiKey",{get show(){return"openai-license"===r.proxy.connectionId},get apiKey(){return s.proxy.connection("openai-license").apiKey},get info(){return{tooltip:{content:[t([a("Get OpenAI API key by visiting OpenAI website and signing up for an account.")],4),t([a("Navigate to the API section or get there by clicking "),e(1,"b",null,"Profile",16),a(" "),a("and selecting "),e(1,"b",null,"View API keys",16),a(".")],0),t([a("Click "),e(1,"b",null,"Create new secret key",16),a(".")],4),t([a("Grab your new OpenAI API key. Be sure to remember to save the OpenAI API key somewhere secure. You wonâ€™t be able to view it again if you forget it or misplace it.")],4)]}}},render(){if(!this.show)return;const{c:e}=this;return o(2,i.Input,{class:e.block,inputClass:e.input,label:this.renderLabel(),placeholder:"sk-xxx",value:this.apiKey,info:this.info,onInput:this.onInput})},renderLabel(){const{c:t}=this;return e(1,"row",null,[e(1,"div",null,"api key",16),e(1,"a",t.link,[a("view my keys"),o(2,i.Icon,{width:11,height:11,name:"link"})],4,{href:"https://platform.openai.com/account/api-keys",target:"_blank"})],4,{"x-between":!0})},onInput(e){s.proxy.connection("openai-license").update({apiKey:e})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionAutoCloseHiddenWindow=a.component({name:"SettingsSectionAutoCloseHiddenWindow",get autoCloseHiddenWindow(){return o.proxy.autoCloseHiddenWindow},render(){const{c:n}=this;return e(1,"column",n.block,[t(2,a.Switch,{class:n.switch,label:"Auto-close hidden window",value:this.autoCloseHiddenWindow,onChange:this.onAutoCloseHiddenWindowChange}),e(1,"p",n.info,"Turn ON to automatically close the hidden window if no tasks are running.",16)],4)},onAutoCloseHiddenWindowChange(e){o.proxy.autoCloseHiddenWindow=!e}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionChatContext=a.component("SettingsSectionChatContext",{get value(){return o.proxy.enableChatContext},render(){const{c:n}=this;return e(1,"column",n.block,[t(2,a.Switch,{class:n.switch,label:"Enable page mode by default",value:this.value,onChange:this.onChange}),e(1,"p",n.info,"Turn ON to send relevant page content along with GPT prompts by default. Turn OFF for vanilla chat experience.",16)],4)},onChange(e){o.proxy.enableChatContext=!e}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$settings:a,$ui:r,$ai:i}=n;a.SectionClearDialogs=r.component("SettingsSectionClearDialogs",{get show(){return"openai-session"===i.proxy.connection(a.proxy.connectionId).type},get value(){return a.proxy.autoClearDialogs},render(){if(!this.show)return null;const{c:n}=this;return e(1,"column",n.block,[t(2,r.Switch,{class:n.switch,label:"Clear dialog when tab is closed",value:this.value,onChange:this.onChange}),e(1,"p",n.info,[o("Turn ON to automatically delete ChatGPT conversations whenever tab closes. Turn OFF to retain conversations in"),o(" "),e(1,"a",null,"ChatGPT web app",16,{href:"https://chat.openai.com/",target:"_blank"})],0)],4)},onChange(e){a.proxy.autoClearDialogs=!e}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$settings:r,$ui:i}=n;r.SectionConnectionType=i.component({name:"SettingsSectionConnectionType",get items(){return[{id:"openai-session",label:"OpenAI Browser session"},{id:"openai-license",label:"OpenAI API key"},{id:"bard-session",label:"Bard Browser session"}]},get value(){const e=r.proxy.connectionId;return e?e.split(":")[0]:"openai-session"},get info(){return{tooltip:{content:[t([e(1,"b",null,"Session",16),a(" â€” HARPA will use current browser session to connect to OpenAI. Works with Free and OpenAI Plus subscriptions. May require re-authentication every few hours.")],4),t([e(1,"b",null,"API Key",16),a(" â€” More reliable than ChatGPT free session. Requires an OpenAI paid account and is billed by OpenAI based on usage.")],4),t([e(1,"b",null,"Google Bard",16),a(" â€” Uses Google Bard browser session. Experimental, may require VPN in countries where Google is blocked.")],4),t([a("GPT-4 models available to OpenAI Plus subscribers and organizations shortlisted by OpenAI.")],4)]}}},render(){const{c:e}=this;return o(2,i.Dropdown,{class:e.block,label:"connection type",value:this.value,items:this.items,info:this.info,onChange:this.onChange})},onChange(e){r.proxy.connectionId="openai-session"===e.id?null:e.id}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionHeader=a.component("SettingsSectionHeader",{didMount(){this.initKeyboardShortcuts()},render(){const{c:n}=this;return e(1,"row",n.block,[e(1,"column",null,e(1,"h2",n.title,"Settings",16),2),t(2,a.Tooltip,{content:"Close, ESC",children:e(1,"button",n.action,t(2,a.Icon,{name:"close"}),2,{onClick:this.close})})],0,{"x-between":!0})},initKeyboardShortcuts(){this.tillUnmount.addEventListener(document,"keydown",(e=>{"Escape"===e.key&&this.close()}))},close(){o.proxy.show=!1}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$settings:a,$ui:r,$ai:i}=n;a.SectionLicenseAdvanced=r.component({name:"SettingsSectionLicenseAdvanced",state:()=>({temperature:null,presencePenalty:null,frequencyPenalty:null}),get show(){return"openai-license"===a.proxy.connectionId},get connection(){return i.proxy.connection("openai-license")},get showAdvanced(){return this.connection.showAdvanced},get temperature(){return null!==this.state.temperature?this.state.temperature:this.connection.temperature},get presencePenalty(){return null!==this.state.presencePenalty?this.state.presencePenalty:this.connection.presencePenalty},get frequencyPenalty(){return null!==this.state.frequencyPenalty?this.state.frequencyPenalty:this.connection.frequencyPenalty},get proxyUrl(){return this.connection.proxyUrl},get systemPrompt(){return this.connection.systemPrompt},render(){if(!this.show)return;const{c:t}=this;return e(1,"column",t.block,[this.renderShowAdvanced(),e(1,"row",t.tpfControls,[this.renderTemperature(),this.renderPresencePenalty(),this.renderFrequencyPenalty()],0,{"full-width":!0}),this.renderProxyUrl(),this.renderSystemPrompt()],0)},renderShowAdvanced(){const{c:t}=this;return e(1,"row",t.showAdvanced({on:this.showAdvanced}),[e(1,"row",t.triangle,o(2,r.Icon,{name:"triangle"}),2,{"x-center":!0,"y-center":!0}),e(1,"span",null,"ADVANCED SETTINGS",16)],4,{onClick:this.onShowAdvancedClick})},onShowAdvancedClick(){this.connection.update({showAdvanced:!this.showAdvanced})},renderTemperature(){return this.showAdvanced?o(2,r.Input,{label:"temperature",value:this.temperature,info:["Higher values like 0.8 will make the output more random, while lower values like 0.2 will make it more focused and deterministic.","The value must be between 0 and 2.0"],placeholder:"Auto",onInput:this.onTemperatureInput,onChange:this.onTemperatureChange}):null},onTemperatureInput(e){this.setState({temperature:e})},onTemperatureChange(e){this.setState({temperature:null}),e=0===(e=e.trim().replace(/[^0-9.]/g,"")).length?NaN:Number(e),Number.isNaN(e)?this.connection.update({temperature:null}):(e<0?e=0:e>2&&(e=2),this.connection.update({temperature:e}))},renderPresencePenalty(){return this.showAdvanced?o(2,r.Input,{label:"presence penalty",value:this.presencePenalty,info:["How much to penalize new tokens based on whether they appear in the text so far. Increases the model's likelihood to talk about new topics.","The value must be between -2.0 and 2.0"],placeholder:"Auto",onInput:this.onPresencePenaltyInput,onChange:this.onPresencePenaltyChange}):null},onPresencePenaltyInput(e){this.setState({presencePenalty:e})},onPresencePenaltyChange(e){this.setState({presencePenalty:null}),e=0===(e=e.trim().replace(/[^-0-9.]/g,"")).length?NaN:Number(e),Number.isNaN(e)?this.connection.update({presencePenalty:null}):(e<-2?e=-2:e>2&&(e=2),this.connection.update({presencePenalty:e}))},renderFrequencyPenalty(){return this.showAdvanced?o(2,r.Input,{label:"frequency penalty",value:this.frequencyPenalty,info:["How much to penalize new tokens based on their existing frequency in the text so far. Decreases the model's likelihood to repeat the same line verbatim.","The value must be between -2.0 and 2.0"],placeholder:"Auto",onInput:this.onFrequencyPenaltyInput,onChange:this.onFrequencyPenaltyChange}):null},onFrequencyPenaltyInput(e){this.setState({frequencyPenalty:e})},onFrequencyPenaltyChange(e){this.setState({frequencyPenalty:null}),e=0===(e=e.trim().replace(/[^-0-9.]/g,"")).length?NaN:Number(e),Number.isNaN(e)?this.connection.update({frequencyPenalty:null}):(e<-2?e=-2:e>2&&(e=2),this.connection.update({frequencyPenalty:e}))},renderProxyUrl(){return this.showAdvanced?t([o(2,r.Spacer,{height:"g1h"}),o(2,r.Input,{label:"api proxy url",value:this.proxyUrl,info:"Custom OpenAI API proxy URL. Please exclude API version and method path e.g. https://api.openai.com/v1/chat/completions â†’ https://api.openai.com (correct)",placeholder:"https://api.openai.com",onInput:this.onProxyUrlInput})],4):null},onProxyUrlInput(e){this.connection.update({proxyUrl:e})},renderSystemPrompt(){return this.showAdvanced?t([o(2,r.Spacer,{height:"g1h"}),o(2,r.Input,{label:"system prompt",value:this.systemPrompt,info:["System prompt to send at the beginning of every conversation. This message is sent once, at the beginning of a fresh chat."],lines:2,placeholder:"e.g. You are a helpful AI assistant named HARPA. Please only reply in {{language}}.",inputType:"textarea",autoExpand:!0,onInput:this.onSystemPromptInput})],4):null},onSystemPromptInput(e){this.connection.update({systemPrompt:e})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionMaxParallelTasks=a.component("SettingsSectionMaxParallelTasks",{state:()=>({maxParallelTasks:o.proxy.maxParallelTasks}),render(){const{c:n,state:o}=this;return e(1,"column",n.block,t(2,a.Input,{label:"max parallel tasks",info:{tooltip:["HARPA will not run more than the specified number of tasks simultaneously.","Keep value low to save CPU, increase to speed up scheduled tasks."]},value:o.maxParallelTasks,onInput:this.onMaxParallelTasksInput,onChange:this.onMaxParallelTasksChange}),2)},onMaxParallelTasksInput(e){this.setState({maxParallelTasks:e})},onMaxParallelTasksChange(e){e=e.trim(),(e=Number(e))||(e=o.proxy.maxParallelTasks),e<1&&(e=1),this.setState({maxParallelTasks:e}),o.proxy.maxParallelTasks=e}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$settings:r,$ui:i,$utils:s,$ai:l}=n;r.SectionModelLicense=i.component("SettingsSectionModelLicense",{get show(){return"openai-license"===r.proxy.connectionId},get value(){return l.proxy.connection("openai-license").slug},get placeholder(){return l.proxy.openaiLicenseDefaultModel.slug},get info(){return{tooltip:{content:[t([a("Enter the "),e(1,"b",null,"Chat Model",16),a(" name: "),e(1,"b",null,"gpt-3.5-turbo",16),a(","),a(" "),e(1,"b",null,"gpt-3.5-turbo-16k",16),a(" or "),e(1,"b",null,"gpt-4",16),a(" if your organization has GPT-4 access.")],0)]}}},render(){if(!this.show)return;const{c:t}=this;return e(1,"column",t.block,o(2,i.Input,{value:this.value,placeholder:this.placeholder,label:this.renderLabel(),info:this.info,onInput:this.onInput,onBlur:this.onBlur}),2)},renderLabel(){const{c:t}=this;return e(1,"row",null,[e(1,"div",null,"chat model",16),e(1,"a",t.link,[a("view my models"),o(2,i.Icon,{width:11,height:11,name:"link"})],4,{href:"https://platform.openai.com/playground?mode=chat",target:"_blank"})],4,{"x-between":!0})},onInput(e){l.proxy.connection("openai-license").update({slug:e})},onBlur(){s.string.empty(this.value)&&l.proxy.connection("openai-license").update({slug:l.proxy.openaiLicenseDefaultModel.slug})}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$settings:a,$ui:r,$ai:i}=n,s={tooltip:{content:["ChatGPT model is sent to OpenAI along with every Chat request and influences speed, stability and quality of responses."]}};a.SectionModelSession=r.component("SettingsSectionModelSession",{get connections(){return i.proxy.connections.filter((e=>"openai-session"===e.type))},get items(){const e=this.value;return[{id:"auto",label:"Auto: Fastest available",selected:"auto"===e},...this.connections.map((t=>({id:t.id,label:t.title,desc:t.description,maxTokens:t.maxTokens,selected:e===t.id})))]},get value(){return a.proxy.connectionId||"auto"},get show(){const e=a.proxy.connectionId;return"openai-session"===i.proxy.connection(e).type},render(){if(!this.show)return null;const{c:n}=this;return e(1,"column",n.block,t(2,r.Dropdown,{label:"preferred chat model",items:this.items,value:this.value,renderer:this.renderItem,info:s,onChange:this.onChange}),2)},renderItem(t){const{c:n}=this,{label:a,desc:r,selected:i,maxTokens:s}=t;return e(1,"column",n.item,[a&&e(1,"div",n.itemLabel,a,0),r&&e(1,"div",n.itemDesc,[r,o(" "),s&&`Max tokens: ${s}`],0),i&&e(1,"div",n.itemMarker)],0,{gap:"g0h"})},onChange(e){a.proxy.connectionId="auto"===e.id?null:e.id}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n,r={tooltip:{content:["Instruct HARPA to provide answers in the given language if the command supports it.","Use {{language}} parameter in requests to reference the prompt language.","HARPA will inject language into every prompt if Context mode is ON."]}};o.SectionPromptLanguage=a.component({name:"SettingsSectionPromptLanguage",get isCustomLanguage(){return!o.languageIds.has(o.proxy.promptLanguage)},get language(){return this.isCustomLanguage?o.customLanguage.id:o.proxy.promptLanguage},get customLanguage(){return this.isCustomLanguage?o.proxy.promptLanguage:""},render(){const{c:n,isCustomLanguage:i}=this;return e(1,"row",n.block,[t(2,a.Dropdown,{label:"preferred chat language",items:o.languages,value:this.language,info:r,maxHeight:"14i",onChange:this.onPromptLanguageChange}),i&&t(2,a.Spacer,{width:"g2"}),i&&t(2,a.Input,{label:"custom language",value:this.customLanguage,onChange:this.onPromptLanguageChange})],0)},onPromptLanguageChange(e){"custom"===e.id?o.proxy.promptLanguage="Catalan":o.proxy.promptLanguage=e.id&&o.languageIds.has(e.id)?e.id:e}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionScheduledTimeframe=a.component({name:"SettingsSectionScheduledTimeframe",state:()=>({from:o.proxy.scheduledTimeframeFrom,till:o.proxy.scheduledTimeframeTill}),get scheduledTimeframeEnabled(){return o.proxy.scheduledTimeframeEnabled},get scheduledTimeframeFrom(){return o.proxy.scheduledTimeframeFrom},get scheduledTimeframeTill(){return o.proxy.scheduledTimeframeTill},render(){const{c:n,state:o}=this;return e(1,"column",n.block,[t(2,a.Switch,{class:n.switch,label:"Limit background tasks",value:this.scheduledTimeframeEnabled,onChange:this.onScheduledTimeframeEnabledChange}),e(1,"p",n.info,"Only run scheduled background tasks within given time frame.",16),e(1,"row",null,[t(2,a.Input,{class:n.input({off:!this.scheduledTimeframeEnabled}),label:"from",value:o.from,onInput:this.onScheduledTimeframeFromInput,onChange:this.onScheduledTimeframeFromChange}),t(2,a.Spacer,{width:"g2"}),t(2,a.Input,{class:n.input({off:!this.scheduledTimeframeEnabled}),label:"till",value:o.till,onInput:this.onScheduledTimeframeTillInput,onChange:this.onScheduledTimeframeTillChange})],4)],4)},onScheduledTimeframeEnabledChange(e){o.proxy.scheduledTimeframeEnabled=!e},onScheduledTimeframeFromInput(e){this.setState({from:e})},onScheduledTimeframeFromChange(e){e=this.parseTime(e),this.setState({from:e}),o.proxy.scheduledTimeframeFrom=e},onScheduledTimeframeTillInput(e){this.setState({till:e})},onScheduledTimeframeTillChange(e){e=this.parseTime(e),this.setState({till:e}),o.proxy.scheduledTimeframeTill=e},parseTime(e){e=e.trim();let[t,n]=e.includes(":")?e.split(":"):e.includes(".")?e.split("."):e.includes("-")?e.split("-"):e.includes(" ")?e.split(" "):e.split(",");return t=Number(t),!t||t<0?t=0:t>23&&(t=23),t=String(t),n=Number(n),!n||n<0?n=0:n>59&&(n=59),n=String(n),n.length<2&&(n=`0${n}`),`${t}:${n}`}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionSendOnEnter=a.component({name:"SettingsSectionSendOnEnter",get value(){return o.proxy.sendOnEnter},render(){const{c:n}=this;return e(1,"column",n.block,t(2,a.Checkbox,{class:n.switch,label:"Send prompts on enter",value:this.value,info:{tooltip:"Turn ON to automatically send questions to AI on pressing Enter."},onChange:this.onChange}),2)},onChange(){o.proxy.sendOnEnter=!this.value}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$settings:r,$ui:i}=n;r.SectionSerpTemplate=i.component("SettingsSectionSerpTemplate",{get serpTemplate(){return r.proxy.serpTemplate},get serpTemplateCustom(){return r.proxy.serpTemplateCustom},get info(){return{tooltip:{content:[e(1,"div",null,"HARPA sends specified prompt to GPT when you search on Google, Bing, Yahoo etc:",16),e(1,"ul",null,[e(1,"li",null,[e(1,"b",null,"Smart",16),a(" â€” enriches prompt with search page content, making GPT aware of the events past year 2021.")],4),e(1,"li",null,[e(1,"b",null,"Simple",16),a(" â€” sends query to GPT as is. Spends less token.")],4),e(1,"li",null,[e(1,"b",null,"Custom",16),a(" â€” sends custom prompt. Use "),a("{{query}}"),a(" parameter to reference search query in custom prompt template.")],0)],4)]}}},get items(){return[{value:"smart",label:"Smart â€” send query & page content"},{value:"simple",label:"Simple â€” send query as is"},{value:"custom",label:"Custom â€” send custom prompt"}]},render(){const{c:n}=this;return e(1,"column",n.block,[o(2,i.Dropdown,{class:n.dropdown,label:"search prompt template",items:this.items,value:this.serpTemplate,info:this.info,onChange:this.onChange}),"custom"===this.serpTemplate&&t([o(2,i.Spacer,{height:"g2"}),o(2,i.Input,{label:"Custom prompt template",value:this.serpTemplateCustom,onChange:this.onSerpTemplateCustomChange,autoExpand:!0,inputType:"textarea",info:"Reference search query by including {{query}} parameter in your template."})],4)],0)},onChange(e){r.proxy.serpTemplate=e.value},onSerpTemplateCustomChange(e){r.proxy.serpTemplateCustom=e}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionShowScrollbars=a.component({name:"SettingsSectionShowScrollbars",get value(){return o.proxy.showScrollbars},render(){const{c:n}=this;return e(1,"column",n.block,t(2,a.Checkbox,{class:n.switch,label:"Show scrollbars",value:this.value,info:{tooltip:"Turn ON to show scroll-bars across the UI."},onChange:this.onChange}),2)},onChange(){o.proxy.showScrollbars=!this.value}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a,$shortcut:r}=n;o.SectionShowShortcutHint=a.component("SettingsShowShortcutHint",{get value(){return r.proxy.hint},render(){const{c:n}=this;return e(1,"column",n.block,t(2,a.Checkbox,{class:n.switch,label:"Show floating quick-access bar",value:this.value,info:{tooltip:"Turn ON to show quick-access commands on web pages whenever a text is selected."},onChange:this.onChange}),2)},onChange(){r.interceptor.updateShortcut({hint:!r.proxy.hint})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionSilenceActions=a.component({name:"SettingsSectionSilenceActions",get silenceActionsEnabled(){return o.proxy.silenceActionsEnabled},render(){const{c:n}=this;return e(1,"column",n.block,[t(2,a.Switch,{class:n.switch,label:"Silence actions",value:this.silenceActionsEnabled,onChange:this.onSilenceActionsEnabledChange}),e(1,"p",n.info,"Turn ON to silence all HARPA actions and IFTTT events: sounds, notifications, emails, webhooks.",16)],4)},onSilenceActionsEnabledChange(e){o.proxy.silenceActionsEnabled=!e}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.SectionStorageLimit=a.component("SettingsSectionStorageLimit",{state:()=>({storageLimit:o.proxy.storageLimit}),render(){const{c:n,state:o}=this;return e(1,"column",n.block,t(2,a.Input,{label:"max storage size, MB",info:"HARPA will automatically clean up the oldest screenshots and task data upon reaching the specified storage memory limit.",value:o.storageLimit,onInput:this.onStorageLimitInput,onChange:this.onStorageLimitChange}),2)},onStorageLimitInput(e){this.setState({storageLimit:e})},onStorageLimitChange(e){e=e.trim(),(e=Number(e))||(e=o.proxy.storageLimitDefault),e<100&&(e=100),this.setState({storageLimit:e}),o.proxy.storageLimit=e}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$store:a,$ui:r,$harpa:i}=n;o.SectionTheme=r.component("SettingsSectionTheme",{get theme(){return a.state.theme},render(){const{c:n}=this;return e(1,"column",n.block,[e(1,"div",n.label,"App theme",16),e(1,"row",null,[t(2,r.Button,{label:"Day",type:"pill",status:"day"===this.theme?"on":"off",icon:i.ThemeSwitch.icons.day,onClick:this.onDayClick}),t(2,r.Spacer,{width:"g1h"}),t(2,r.Button,{label:"Night",type:"pill",status:"night"===this.theme?"on":"off",icon:i.ThemeSwitch.icons.night,onClick:this.onNightClick})],4)],4)},onDayClick(){r.theme.setTheme("day")},onNightClick(){r.theme.setTheme("night")}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$settings:o,$ui:a}=n;o.Tab=a.component("SettingsTab",{render(){const{c:n}=this;return t(2,a.Scroll,{class:n.block,children:e(1,"column",n.content,t(2,o.Content),2)})}})})(),(()=>{const{$settings:e,$store:t,$news:o,$peeker:a}=n;e.proxy=t.createProxy({get show(){return t.state.settings.show},set show(e){e&&(o.proxy.show=!1,a.proxy.show=!1,a.proxy.fixed=!1),t.transaction((t=>{t.settings.show=e}))},get showContext(){return t.state.settings.showContext},set showContext(e){t.transaction((t=>t.settings.showContext=e))},get showScrollbars(){return t.state.settings.showScrollbars},set showScrollbars(e){t.transaction((t=>t.settings.showScrollbars=e))},get sendOnEnter(){return t.state.settings.sendOnEnter},set sendOnEnter(e){t.transaction((t=>t.settings.sendOnEnter=e))},get promptLanguage(){return t.state.settings.promptLanguage||"english"},set promptLanguage(e){t.transaction((t=>{t.settings.promptLanguage=e}))},get connectionId(){return t.state.settings.connectionId},set connectionId(e){t.transaction((t=>{t.settings.connectionId=e}))},get promptLanguageValue(){const t=this.promptLanguage;return e.languageMap[t]?.label||t},get autoClearDialogs(){return t.state.settings.autoClearDialogs},set autoClearDialogs(e){t.transaction((t=>{t.settings.autoClearDialogs=e}))},get enableChatContext(){return t.state.settings.enableChatContext},set enableChatContext(e){t.transaction((t=>{t.settings.enableChatContext=e}))},get storageLimit(){return t.state.settings.storageLimit},get storageLimitDefault(){return t.template.state().settings.storageLimit},set storageLimit(e){t.transaction((t=>{t.settings.storageLimit=e}))},get scheduledTimeframeEnabled(){return t.state.settings.scheduledTimeframe.enabled},set scheduledTimeframeEnabled(e){t.transaction((t=>{t.settings.scheduledTimeframe.enabled=e}))},get scheduledTimeframeFrom(){return t.state.settings.scheduledTimeframe.from},set scheduledTimeframeFrom(e){t.transaction((t=>{t.settings.scheduledTimeframe.from=e}))},get scheduledTimeframeTill(){return t.state.settings.scheduledTimeframe.till},set scheduledTimeframeTill(e){t.transaction((t=>{t.settings.scheduledTimeframe.till=e}))},get scheduledTimeframe(){return this.scheduledTimeframeEnabled?{from:this.scheduledTimeframeFrom,till:this.scheduledTimeframeTill}:null},get silenceActionsEnabled(){return t.state.settings.silenceActions.enabled},set silenceActionsEnabled(e){t.transaction((t=>{t.settings.silenceActions.enabled=e}))},get autoCloseHiddenWindow(){return t.state.settings.autoCloseHiddenWindow},set autoCloseHiddenWindow(e){t.transaction((t=>{t.settings.autoCloseHiddenWindow=e}))},get maxParallelTasks(){return t.state.settings.maxParallelTasks},set maxParallelTasks(e){t.transaction((t=>{t.settings.maxParallelTasks=e}))},get serpTemplate(){return t.state.settings.serpTemplate},set serpTemplate(e){t.transaction((t=>t.settings.serpTemplate=e))},get serpTemplateCustom(){return t.state.settings.serpTemplateCustom},set serpTemplateCustom(e){t.transaction((t=>t.settings.serpTemplateCustom=e))},get serpTemplateValue(){const e=t.state.settings.serpTemplate;return"smart"===e?'I am searching for "{{query}}" on {{page.domain}}.\n\nCan you answer my search query and give me up to 5 paragraphs of information on the topic? If possible, please give me up to 5 related keywords or search queries I might be interested in, in a markdown numbered list format.\n\nPlease be factual. Do not hallucinate and do not apologise. Please reply in {{language}}. Please reply in the following format (do not echo search section names):\n\n[Answer or information on the topic of search]\n\n[Numbered list of related keywords or queries, if any]\n\nAs your knowledge is cut off by the mid 2021, you may also use information that Google Search has on the topic:\n\n{{page}}\n\nYour response:':"simple"===e?"{{query}}":"custom"===e?t.state.settings.serpTemplateCustom||"{{query}}":void 0}})})(),(()=>{const{$runner:e,$store:t}=n;e.emailProxy=t.createProxy({get uid(){return t.state.agentId},get testStatus(){return t.state.runner.actions.email.testStatus},set testStatus(e){t.transaction((t=>{t.runner.actions.email.testStatus=e}))},get testMessage(){return t.state.runner.actions.email.testMessage},set testMessage(e){t.transaction((t=>{t.runner.actions.email.testMessage=e}))}})})(),(()=>{const{$runner:e,$store:t}=n;e.makeProxy=t.createProxy({get uid(){return t.state.agentId},get testStatus(){return t.state.runner.actions.make.testStatus},set testStatus(e){t.transaction((t=>{t.runner.actions.make.testStatus=e}))},get testMessage(){return t.state.runner.actions.make.testMessage},set testMessage(e){t.transaction((t=>{t.runner.actions.make.testMessage=e}))}})})(),(()=>{const{$runner:e,$store:t}=n;e.notificationProxy=t.createProxy({get testStatus(){return t.state.runner.actions.notification.testStatus},set testStatus(e){t.transaction((t=>{t.runner.actions.notification.testStatus=e}))}})})(),(()=>{const{$runner:e,$store:t,$utils:o,$settings:a}=n;e.proxy=t.createProxy({get tasks(){return t.state.tasks},taskById(e){return this.tasks.find((t=>t.id===e))},taskIndex(e){return this.tasks.findIndex((t=>t.id===e))},get queue(){return t.state.runner.queue},set queue(e){t.transaction((t=>t.runner.queue=e))},generateJobId:()=>t.idGenerator.job(),jobById(e){return this.queue.find((t=>t.id===e))},jobByTaskId(e){return this.queue.find((t=>t.taskId===e))},setJobProgress(e,t){this.updateJob(e,{progress:t})},getJobProgress(e){return this.jobById(e)?.progress||0},addJob(e){e={id:this.generateJobId(),progress:1,by:"system",...e},t.transaction((()=>t.state.runner.queue.push(e)))},updateJob(e,n){t.transaction((()=>{const o=t.state.runner.queue.find((t=>t.id===e));o&&Object.assign(o,n)}))},deleteJob(e){this.queue=this.queue.filter((t=>t.id!==e))},get netStable(){return t.state.runner.netStable},set netStable(e){t.transaction((t=>t.runner.netStable=e))},get schedules(){return this.tasks.filter((e=>e.enabled)).map((e=>{const t=e.inputs.schedule.type;return{id:e.id,type:t,...e.inputs.schedule[t]}}))},computeNextRunMs(e){if(!e||!e.enabled)return-1;if("periodical"===e.inputs.schedule.type){const t=e.inputs.schedule.periodical.frequency,n=o.time.frequencyToMs(t),a=e.records.at(-1)?.ms||-1,r=Math.max(a+n,Date.now());return this._adjustNextRunMsToTimeframe(r)}return-1},_adjustNextRunMsToTimeframe(e){const t=a.proxy.scheduledTimeframe;if(!t)return e;let n=new Date(e);n=60*n.getHours()+n.getMinutes();let r=new Date(e);r.setHours(0,0,0,0),r=r.getTime();const i=60*(Number(t.from.split(":")[0])||0)+(Number(t.from.split(":")[1])||0),s=60*(Number(t.till.split(":")[0])||0)+(Number(t.till.split(":")[1])||0);if(i<=s){if(i<=n&&n<=s)return e;if(n<i)return r+i*o.time.MINUTE;if(n>s)return r+i*o.time.MINUTE+o.time.DAY}if(i>s)return n<=s||n>=i?e:r+i*o.time.MINUTE;throw new Error("unreachable code reached")}})})(),(()=>{const{$runner:e,$store:t,$utils:o}=n;e.soundProxy=t.createProxy({get voices(){return t.state.runner.actions.sound.voices},set voices(e){t.transaction((t=>{t.runner.actions.sound.voices=e}))},get sounds(){return e.sounds.map((({id:e,label:t})=>({id:`sound:${e}`,label:`Sound, ${t}`,src:`/sounds/${e}.mp3`})))},get items(){return[...this.sounds,...this.voices]},value(e){return e.inputs.actions.sound.value||this.items[0].id},volume:e=>o.number.minmax(e.inputs.actions.sound.volume||50,0,100),utterance:e=>e.inputs.actions.sound.utterance,utterancePlaceholder:()=>"Task triggered",get testStatus(){return t.state.runner.actions.sound.testStatus},set testStatus(e){t.transaction((t=>{t.runner.actions.sound.testStatus=e}))}})})(),(()=>{const{$runner:e,$store:t}=n;e.webhookProxy=t.createProxy({get uid(){return t.state.agentId},get testStatus(){return t.state.runner.actions.webhook.testStatus},set testStatus(e){t.transaction((t=>{t.runner.actions.webhook.testStatus=e}))},get testMessage(){return t.state.runner.actions.webhook.testMessage},set testMessage(e){t.transaction((t=>{t.runner.actions.webhook.testMessage=e}))}})})(),(()=>{const{$runner:e}=n;e.sounds=[{id:"pop",label:"Pop"},{id:"sonar",label:"Sonar Short"},{id:"sonar-2",label:"Sonar Long"},{id:"register",label:"Old Register"},{id:"banknotes",label:"Banknotes"},{id:"triangle",label:"Triangle"},{id:"wine",label:"Wine"}]})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$redactor:o,$editor:a,$task:r,$ui:i}=n;o.PanelOverlay=i.component("RedactorPanelOverlay",{state:()=>({prevInputScreen:null}),init(){this.hideOnResize()},get task(){return o.proxy.task},get screenIndex(){return this.task?"overview"===this.task.inputScreen?0:1:0},get slideShiftStyle(){const e=this.screenIndex;return{transform:`translateX(${0===e?0:-e+"00%"}`}},render(){const{c:t}=this;return e(1,"div",t.block({show:o.proxy.show}),[this.renderBackground(),this.renderPanel()],0)},renderBackground(){const{c:t}=this;return e(1,"div",t.background,null,1,{onClick:this.onBackgroundClick})},renderPanel(){const{c:n}=this;return e(1,"div",n.panel,this.task&&e(1,"row",n.slide,[t(2,i.Scroll,{class:n.screen,children:this.renderConfigScreen()}),t(2,i.Scroll,{class:n.screen,children:this.renderInputScreen()})],4,{style:this.slideShiftStyle}),0)},renderConfigScreen(){const{c:n}=this;return t(2,a.TaskProvider,{task:this.task,children:[t(2,a.OverviewHeader,{onOpenInEditorClick:this.onOpenInEditorClick}),e(1,"column",n.overviewScreen,t(2,a.OverviewScreen,{configMode:"advanced",onInputSelect:this.onInputSelect}),2)]})},renderInputScreen(){const{c:n,state:o}=this;return t(2,a.TaskProvider,{task:this.task,children:[t(2,a.InputHeader,{class:n.inputHeader,onBackClick:this.onBackClick}),e(1,"column",n.inputScreen,t(2,a.InputScreen,{fallbackScreen:o.prevInputScreen}),2)]})},onBackgroundClick(){o.proxy.show=!1;const e=o.proxy.taskId;setTimeout((()=>{o.proxy.taskId===e&&(o.proxy.taskId=null,r.proxy.updateTask(e,{inputScreen:"overview"}))}),300)},onOpenInEditorClick(){o.controller.openInEditor()},onInputSelect(e){this.setState({prevInputScreen:e.inputName})},onBackClick(){r.Adapter.ofTask(this.task).inputScreen="overview"},hideOnResize(){this.tillUnmount.addEventListener(window,"resize",(()=>{o.proxy.show=!1}))}})})(),(()=>{const{$redactor:e,$creator:t,$engine:o,$task:a,$chrome:r,$store:i}=n;e.controller={init(){if(e.proxy.show=!1,e.proxy.task){const t=e.proxy.taskId;a.proxy.updateTask(t,{inputScreen:"overview"})}},async openInEditor(){let n=e.proxy.task;if(!n)return;e.proxy.show=!1;const{mediumId:o,mediumType:a}=n.inputs.schedule||{};if(o&&["tab","pinned-tab"].includes(a)&&await this._openEditorTab(o))return;const r=Object.entries(i.state.tab).find((([e,t])=>t.creator.editingTaskId===n.id))?.creator;return r&&await this._openEditorTab(r[0])?void 0:t.controller.editTaskInTab(n.id)},async _openEditorTab(e){if(!(e=Number(e)))return!1;const t=(await r.tabs.query({})).find((t=>t.id===e));return!(!t||t.windowId===o.hiddenWindowController.windowId)&&(await r.tabs.update(t.id,{active:!0}),!0)}}})(),(()=>{const{$redactor:e,$store:t,$task:o}=n;e.proxy=t.createProxy({get show(){return t.state.redactor.show},set show(e){this._update({show:e})},get taskId(){return t.state.redactor.taskId},set taskId(e){this._update({taskId:e})},get task(){return o.proxy.taskById(this.taskId)},_update(e={}){t.transaction((t=>{Object.assign(t.redactor,e)}))}})})(),(()=>{const{$recipe:e,$engine:t,$jsyaml:o,$utils:a}=n;e.adapters.watcher={icon({task:e}){const{recipeId:t}=e;if("watcher.monitorChanges"===t){const t=e.inputs["watcher.changes"]?.whatToMonitor;switch(t){case"text":{const t=this._triggerCondition(e);return["contains-text","missing-text"].includes(t)?"recipe-watcher.monitorText":"recipe-watcher.monitorChanges"}case"html":return"recipe-watcher.monitorHtml";case"data":return"recipe-watcher.monitorData";default:return"recipe-watcher.monitorChanges"}}if("watcher.monitorElement"===t){const t=e.inputs["watcher.element"]?.selector?.at(-1)?.$parse;switch(t){case"text":return"recipe-watcher.monitorText";case"number":return"recipe-watcher.monitorNumber";case"price":case"currency":return"recipe-watcher.monitorPrice";case"time":return"recipe-watcher.monitorTime";case"copyright":case"date":return"recipe-watcher.monitorDate";default:return"recipe-watcher.monitorElement"}}return"watcher.monitorHealth"===t?"recipe-watcher.monitorHealth":"watcher.monitorPrice"===t?"recipe-watcher.monitorPrice":"recipe-watcher.monitorChanges"},title({task:e}){const{recipeId:t}=e;if("watcher.monitorChanges"===t){const t=this._triggerCondition(e);if("contains-text"===t){return`CONTAINS TEXT: ${(e.inputs.trigger.searchText.split("\n").filter((e=>!!e))[0]||"").toUpperCase()}`}if("missing-text"===t){return`TEXT REMOVED: ${(e.inputs.trigger.searchText.split("\n").filter((e=>!!e))[0]||"").toUpperCase()}`}return`PAGE ${e.inputs["watcher.changes"].whatToMonitor} CHANGES`.toUpperCase()}if("watcher.monitorElement"===t){let t=this._monitoredElementType(e);"number"===t&&(t="value");let n=this._triggerCondition(e);return n={"value-is-up":"INCREASES","value-is-down":"DROPS","value-contains-text":"CONTAINS TEXT","value-missing-text":"MISSING TEXT","item-is-removed":"REMOVED"}[n]||"changes",`${t} ${n}`.toUpperCase()}if("watcher.monitorHealth"===t){return{"web-page-is-down":"AUTO-REFRESH PAGE","web-page-is-up":"AUTO-REFRESH PAGE","web-page-returns-http-code":"HTTP STATUS CODE"}[this._triggerCondition(e)]||"PAGE STATUS"}return"watcher.monitorPrice"===t?"PRICE VALUE":"MONITOR PAGE"},async buildChangesTemplates(e){let{text:t,template:n}=e,o=[];t=t.toLowerCase();const r=["out of stock","not in stock","not available","unavailable"];for(const i of r){if(!a.occurrences.regex(t,i))continue;const r=n();r.inputs["watcher.changes"].whatToMonitor="text",r.inputs["watcher.trigger"].monitorChangesText="missing-text",r.inputs["watcher.trigger"].monitorChangesHtml="missing-text",r.inputs.trigger.color="positive",r.inputs.trigger.searchText=i,await this.updateChangesTemplate(r,e),o.push({priority:20,task:r});break}{const t=n();t.inputs["watcher.changes"].whatToMonitor="text",t.inputs["watcher.trigger"].monitorChangesText="contains-text",t.inputs["watcher.trigger"].monitorChangesHtml="contains-text",t.inputs.trigger.color="positive",t.inputs.trigger.searchText="discount\nrabatt\nrabat\nalennus\ndiskon\nsleva\nsconto\ndescuento",await this.updateChangesTemplate(t,e),o.push({priority:30,task:t})}{const t=n();t.inputs["watcher.changes"].whatToMonitor="text",t.inputs["watcher.trigger"].monitorChangesText="content-changes",t.inputs["watcher.trigger"].monitorChangesHtml="content-changes",t.inputs.trigger.color="positive",await this.updateChangesTemplate(t,e),o.push({priority:40,task:t})}{const t=n();t.inputs["watcher.changes"].whatToMonitor="text",t.inputs["watcher.trigger"].monitorChangesText="content-changes",t.inputs["watcher.trigger"].monitorChangesHtml="content-changes",t.inputs.trigger.color="positive",t.records.push(this.compare(t,null,e)),o.push({priority:20,dropdown:{icon:"recipe-watcher.monitorChanges",name:"MONITOR PAGE UPDATES"},task:t})}return o},async updateChangesTemplate(e,t){const n=this.compare(e,null,t);if(!e.dropdown){const t=this._triggerCondition(e);if("content-changes"===t||"none"===t)n.value=32,n.info="Reports if page content has changed";else if("contains-text"===t){const t=e.inputs.trigger.searchText.split("\n").filter((e=>!!e))[0]||"";n.info=`Monitors ${t.toUpperCase()} text, alerts if it is found on page`}else if("missing-text"===t){const t=e.inputs.trigger.searchText.split("\n").filter((e=>!!e))[0]||"";n.info=`Monitors ${t.toUpperCase()} text, alerts if it is missing`}}const o=0===e.records.length?0:e.records.length-1;e.records[o]=n},async buildElementTemplates(e){const{page:t,data:n,template:o}=e;let a=[];e:{const r=n.filter((e=>"price"===e.type)).filter((e=>0!==e.value)).sort(this._sortByVisibility);if(0===r.length)break e;const i=[],s=new Set;for(const e of r)if(!s.has(e.value)&&(s.add(e.value),i.push(e),i.length>=3))break;for(const n of i){e.item=n;const r=o();r.inputs["watcher.trigger"].monitorElement="value-is-down",r.inputs.trigger.color="positive",r.inputs.changeUpIs.value="bad",r.state.item=n;const i=await t.inspect(n.container,{computeAiLocator:!0,noIdle:!0});i.locator.selector.push({$parse:"price",at:n.at}),r.inputs["watcher.element"].selector=i.locator.selector,await this.updateElementTemplate(r,e),a.push({priority:10,task:r})}}e:{const r=new Set;n.filter((e=>"time"===e.type||"date"===e.type)).forEach((e=>e.elements.forEach((e=>r.add(e.id)))));const i=n.filter((e=>"number"===e.type)).filter((e=>0!==e.value)).filter((e=>!e.elements.some((e=>r.has(e.id))))).sort(this._sortByVisibility);if(0===i.length)break e;const s=new Set,l=[];for(const e of i)if(!s.has(e.value)&&(s.add(e.value),l.push(e),l.length>=3))break;for(const n of l){e.item=n;const r=o();r.inputs["watcher.trigger"].monitorElement="value-changes",r.inputs.trigger.color="positive",r.inputs.changeUpIs.value="good",r.state.item=n;const i=await t.inspect(n.container,{computeAiLocator:!0,noIdle:!0});i.locator.selector.push({$parse:"number",at:n.at}),r.inputs["watcher.element"].selector=i.locator.selector,await this.updateElementTemplate(r,e),a.push({priority:50,task:r})}}e:{const r=this.biggestItem(n);if(!r)break e;e.item=r;const i=o();i.inputs["watcher.trigger"].monitorElement="value-changes",i.inputs.trigger.color="positive",i.inputs.changeUpIs.value="good",i.state.item=r;const s=await t.inspect(r.container,{computeAiLocator:!0,noIdle:!0});s.locator.selector.push({$parse:"text",at:0}),i.inputs["watcher.element"].selector=s.locator.selector,i.records.push(this.compare(i,null,e)),a.push({priority:50,dropdown:{icon:"recipe-watcher.monitorElement",name:"MONITOR ELEMENT"},task:i})}return a},_sortByVisibility:(e,t)=>e.data.isVisible&&!t.data.isVisible?-1:!e.data.isVisible&&t.data.isVisible?1:e.data.isInViewport&&!t.data.isInViewport?-1:!e.data.isInViewport&&t.data.isInViewport?1:e.data.isInViewport?e.cr.top-t.cr.top:t.data.fontSize!==e.data.fontSize?t.data.fontSize-e.data.fontSize:e.cr.top-t.cr.top,async updateElementTemplate(e,t){t={...t,item:e.state.item};const n=this._monitoredElementType(e);let o=this._triggerCondition(e);o={"value-is-up":"increases","value-is-down":"drops","value-contains-text":"contains text","value-missing-text":"missing text","item-is-removed":"removed"}[o]||"changes";const a=this.compare(e,null,t);e.dropdown||(a.info=`Monitors ${n} and alerts if it ${o}`),e.records[0]=a},async storeElementTemplate(e){e.state?.item&&delete e.state.item},async buildPriceTemplates(e){const{template:t}=e,n=[];{const o=t();o.inputs["watcher.trigger"].monitorElement="value-changes",o.inputs.trigger.color="positive",o.inputs.changeUpIs.value="bad",await this.updatePriceTemplate(o,e),n.push({priority:10,dropdown:{icon:"recipe-watcher.monitorPrice",name:"MONITOR PRICE"},task:o})}return n},async updatePriceTemplate(e,t){e.records[0]=this.compare(e,null,t)},async buildHealthTemplates(e){const{template:t}=e,n=[];{const o=t();o.inputs.trigger.icon="alert",o.inputs.trigger.color="positive",o.inputs.schedule.mediumType="tab",o.inputs.schedule.periodical.frequency="5m",o.inputs.schedule.autoCloseTab=!1,o.records.push({...this.compare(o,null,e),info:"Auto-refreshes page and monitors it's status. Useful to auto-refresh data dashboards and manual monitoring."}),n.push({priority:60,task:o})}{const o=t();o.inputs.trigger.icon="alert",o.inputs.trigger.color="positive",o.inputs.schedule.mediumType="hidden-tab",o.records.push(this.compare(o,null,e)),n.push({priority:30,dropdown:{icon:"status-heart-ok",name:"MONITOR PAGE HEALTH"},task:o})}{const o=t();o.inputs.trigger.icon="alert",o.inputs.trigger.color="positive",o.inputs.schedule.mediumType="tab",o.inputs.schedule.periodical.frequency="5m",o.inputs.schedule.autoCloseTab=!1,o.records.push(this.compare(o,null,e)),n.push({priority:40,dropdown:{icon:"recipe-watcher.monitorHealth",name:"AUTO-REFRESH PAGE"},task:o})}return n},async updateHealthTemplate(e,t){const n=this.compare(e,null,t);e.dropdown||(n.info="Auto-refreshes page and monitors it's status. Useful to auto-refresh data dashboards and manual monitoring."),e.records[0]=n},biggestItem:e=>e.filter((e=>"text"===e.type)).sort(((e,t)=>e.data.isVisible&&!t.data.isVisible?-1:!e.data.isVisible&&t.data.isVisible?1:e.data.isInViewport&&!t.data.isInViewport?-1:!e.data.isInViewport&&t.data.isInViewport?1:"H1"===e.data.tag&&"H1"!==t.data.tag?-1:"H1"!==e.data.tag&&"H1"===t.data.tag?1:t.data.fontSize-e.data.fontSize))[0],async queryItem(e,n){if("string"==typeof n){if(0===n.trim().length)return{type:"warning",content:"Selector is empty"};try{n=o.load(n)}catch(e){return{type:"warning",content:"Selector is not a CSS / XPath / HARPA query"}}}let r=null;try{r=t.Locator.of(n,e)}catch(e){return{type:"warning",content:a.string.toCapitalFirst(e.message)}}let i=await e.query(r,{noIdle:!0,noThrow:!0,mult:!0});return i instanceof Error?{type:"warning",content:i.message}:0===i.length?null:i.length>1?{type:"warning",content:`Found ${i.length} elements matching selector`}:(i=i[0],i instanceof t.Element?{type:"element",value:await e.content(i,{noIdle:!0})}:a.removeKeys({type:i.type,value:i.value,metric:i.metric,content:i.content,context:i.context,index:i.index}))},findPrice(e,t,n=!1){t=t||[];const o=e=>{if(n)return null;throw new Error(e)};let r=this.filterItemsByType(t,"price");if(0===r.length)return o("No prices found on page");let{pickup:i,anchorText:s,n:l}=e.inputs["watcher.price"];if("visually-largest"===i){const e=e=>e.context.length/e.content.length>4?1.2*e.data.fontSize:e.cr.bottom-e.cr.top;return r.reduce(((t,n)=>e(t)>e(n)?t:n))}if("first"===i)return r[0];if("last"===i)return r.at(-1);if("nth"===i){if((!l||l<1)&&(l=1),l>r.length){const e=1===r.length?"price":"prices";return o(`Only ${r.length} ${e} found on page`)}return r[l-1]}if("lowest"===i||"highest"===i||"average"===i||"median"===i){const e=a.frequency(r,(e=>e.metric)),t=Array.from(e.entries()).reduce(((e,t)=>t[1]>e[1]?t:e))[0];if(r=r.filter((e=>e.metric===t)),"lowest"===i)return r.reduce(((e,t)=>e.value>t.value?t:e));if("highest"===i)return r.reduce(((e,t)=>e.value<t.value?t:e));if("average"===i)return{type:"price",value:r.reduce(((e,t)=>e+t.value),0)/r.length,metric:t};if("median"===i){const e=r.slice().sort(((e,t)=>e.value-t.value)),n=Math.floor(e.length/2);return{type:"price",value:e.length%2==0?(e[n-1].value+e[n].value)/2:e[n].value,metric:t}}}if("closest-to"===i){if(!s)return r[0];const e=this.filterItemsByType(t,"text").filter((e=>a.occurrences.regex(e.value,s)));if(0===e.length)return o("No elements found for anchor text");const n=e=>e.left+(e.right-e.left)/2,i=e=>e.top+(e.bottom-e.top)/2,c=(e,t)=>Math.pow(n(e)-n(t),2)+Math.pow(i(e)-i(t),2);let d=[];if(r.forEach((t=>d.push({p:t,d:e.reduce(((e,n)=>Math.min(e,c(n.cr,t.cr))),Number.MAX_VALUE)}))),d=d.sort(((e,t)=>e.d-t.d)),(!l||l<1)&&(l=1),l>d.length){const e=1===r.length?"price":"prices";return o(`Only ${r.length} ${e} found on page`)}return d[l-1].p}return o(`Pickup parameter ${i} not supported`)},filterItemsByType(e,t){const n=e||[];return t?n.filter((e=>e.type===t)):n},reduceTaskStorage(e,t){if(!e||!t)return;const n=t.first||{},o=t.last||{},{recipeId:a,inputs:r}=e;"watcher.monitorHealth"!==a&&(delete n.prefetch,delete o.prefetch),"watcher.monitorElement"!==a&&(delete n.item,delete o.item),"watcher.monitorChanges"===a&&"data"===r["watcher.changes"].whatToMonitor||(delete n.data,delete o.data),"watcher.monitorChanges"===a&&"html"===r["watcher.changes"].whatToMonitor||(delete n.html,delete o.html),"monitorChanges"!==a&&"text"!==r["watcher.changes"].whatToMonitor&&(delete n.text,delete o.text),n?.error||delete n.error,o?.error||delete o.error},_monitoredElementType:e=>{const t=e.inputs["watcher.element"]?.selector;if(!Array.isArray(t))return"element";return t.filter((e=>e.$parse)).at(-1)?.$parse||"element"},compare(e,t,n){try{const o={task:e,previous:t,current:n,trigger:this._trigger(e),condition:this._triggerCondition(e)};switch(e.recipeId){case"watcher.monitorHealth":return o.config=e.inputs["watcher.health"],this._compareHealth(o);case"watcher.monitorPrice":return o.config=e.inputs["watcher.price"],this._comparePrice(o);case"watcher.monitorElement":return o.config=e.inputs["watcher.element"],this._compareElement(o);case"watcher.monitorChanges":return o.config=e.inputs["watcher.changes"],this._compareChanges(o);default:return this._recordError("This automation task is under development","Under Dev")}}catch(e){return console.error("comparing watcher data failed:",e),this._recordError(e.message,e.value)}},_compareHealth({current:e,trigger:t,condition:n}){if(!e)return this._recordWarning("Could not fetch page status");const{statusCode:o,statusText:a}=e.prefetch,r=o>=200&&o<=299,i=`<b>${o||0} / ${a||"Unknown"}</b>`;let s=r?`Page is <b>UP</b> with status ${i}`:`Page is <b>DOWN</b> with status ${i}`,l=!1;if("web-page-is-down"===n&&(l=!r),"web-page-is-up"===n&&(l=r),"web-page-returns-http-code"===n){const e=String(o);l=t.httpCodes.some((t=>e.length===t.length&&[...e].every(((e,n)=>"x"===t[n]||t[n]===e))))}return this._recordValue(s,r?"Up":"Down",null,l?t.icon:r?"heart-ok":"heart-nok",l?t.color:null,l)},_comparePrice({task:e,current:t,trigger:n,condition:o}){if(!t)return this._recordWarning("Could not parse prices from page");let r=null;{const t=e.records.at(-1);t?.metric?.startsWith("CUR:")&&(r={value:t.value,metric:t.metric})}let i=null;try{i=this.findPrice(e,t?.data)}catch(e){return this._recordWarning(e.message)}const s=e.inputs.changeUpIs.value,{x:l,y:c}=n,d=`<b>${a.formatter.format(l,null,{long:!0})}</b>`,u=e=>{if(!e)return null;return`<b>${a.formatter.format(e.value,e.metric,{long:!0,currencyFormat:"namePlural"})}</b>`},p=u(r),h=u(i);let m=!1,g=`Parsed ${h}`;"price-changes"===o&&(m=Boolean(r&&r.value!==i.value),g=m?`Changed ${p} â†’ ${h}`:`Parsed ${h}`),"price-is-up"===o&&(m=Boolean(r&&r.value<i.value),g=m?`Price UP ${p} â†’ ${h}`:`Parsed ${h}`),"price-is-down"===o&&(m=Boolean(r&&r.value>i.value),g=m?`Price DOWN ${p} â†’ ${h}`:`Parsed ${h}`),"price-is-over-x"===o&&(m=i.value>l,g=m?`Price ${h} is over ${d}`:`Parsed ${h}`),"price-is-under-x"===o&&(m=i.value<l,g=m?`Price ${h} is below ${d}`:`Parsed ${h}`),"price-is-within-x-y"===o&&(m=i.value>=l&&i.value<=c,g=m?`Price ${h} is in range`:`Parsed ${h}`),"price-is-outside-x-y"===o&&(m=i.value<l||i.value>c,g=m?`Price ${h} is not in range`:`Parsed ${h}`);return this._recordValue(g,i.value,i.metric,m?n.icon:r?r.value<i.value?"up":r.value>i.value?"down":"ok":"ok",m?n.color:s&&"neutral"!==s&&r?r.value<i.value?"good"===s?"positive":"negative":r.value>i.value?"good"===s?"negative":"positive":null:null,m)},_compareElement({task:e,previous:t,current:n,trigger:o,condition:r}){if(!n)return this._recordWarning("Could not parse elements from page");if("warning"===n?.item?.type)return this._recordWarning(n.item.content);if("error"===n?.item?.type)return this._recordError(n.item.content);const i=e.inputs.changeUpIs.value,{itemParameter:s,x:l,y:c,searchText:d}=o,u=`<b>${a.formatter.format(l,null,{long:!0})}</b>`,p=e=>{if(!e?.item)return{content:null,text:"N/A"};const t={content:e.item,type:e.item.type,metric:e.item.metric,value:e.item.value,text:`<b>${e.item.content||e.item.value}</b>`};return"link"===t.type&&"content"===s&&(t.value=t.content.content),"string"!=typeof t.value||["none","value-changes","value-missing-text","value-contains-text","item-is-removed"].includes(r)||(t.value=t.value?t.value.length:0),t.metric=t.metric||t.type,t};let h=!1;const m=p(t),g=p(n);if("item-is-removed"===r)return h=!n?.item,this._recordValue(h?`Item ${m.text} is removed from page`:`Item ${g.text} is found on page`,g.content?"Found":"Missing",null,h?o.icon:"ok",h?o.color:null,h);if(!g.content)return this._recordWarning("Could not find element on page");let y=`Parsed ${g.text}`,b=g.value,f=g.metric;if("value-changes"===r&&(h=Boolean(m.content&&m.value!==g.value),y=h?`Changed ${m.text} â†’ ${g.text}`:`Parsed ${g.text}`),"value-is-up"===r&&(h=Boolean(m.content&&m.value<g.value),y=h?`Value UP ${m.text} â†’ ${g.text}`:`Parsed ${g.text}`),"value-is-down"===r&&(h=Boolean(m.content&&m.value>g.value),y=h?`Value DOWN ${m.text} â†’ ${g.text}`:`Parsed ${g.text}`),"value-is-over-x"===r&&(h=g.value>l,y=h?`Value ${g.text} is over ${u}`:`Parsed ${g.text}`),"value-is-under-x"===r&&(h=g.value<l,y=h?`Value ${g.text} is below ${u}`:`Parsed ${g.text}`),"value-is-within-x-y"===r&&(h=g.value>=l&&g.value<=c,y=h?`Value ${g.text} is in range`:`Parsed ${g.text}`),"value-is-outside-x-y"===r&&(h=g.value<l||g.value>c,y=h?`Value ${g.text} is not in range`:`Parsed ${g.text}`),"value-contains-text"===r||"value-missing-text"===r){const e=a.occurrences.regex(String(g.value),d),t=1===e?"once":e+" times";h="value-contains-text"===r?e>0:0===e,y=e>0?`Search text is found <b>${t}</b>`:"Search text is not found",b=e,f=null}return this._recordValue(y,b,f,(()=>{if(h)return o.icon;if(!m.content)return"ok";const e="string"==typeof m.value?m.value.length:m.value,t="string"==typeof g.value?g.value.length:g.value;return e<t?"up":e>t?"down":"ok"})(),(()=>{if(h)return o.color;if(!i||"neutral"===i)return null;if(!m.content)return null;const e="string"==typeof m.value?m.value.length:m.value,t="string"==typeof g.value?g.value.length:g.value;return e<t?"good"===i?"positive":"negative":e>t?"good"===i?"negative":"positive":null})(),h)},_compareChanges({task:e,previous:t,current:n,trigger:o,condition:r,config:i}){if(t=t||{},!n)return this._recordWarning("Could not parse page content");const{whatToMonitor:s,itemTypes:l}=i,c=e.inputs.changeUpIs.value,d=o.searchText,u=o.minThreshold||0,p=(e,t)=>e?o.color:!t||t<=0?null:c&&"neutral"!==c?"good"===c?"positive":"negative":null,h=(e,t)=>e?o.icon:!t||t<=0?"nok":"up";if("data"===s){let e=n.data;if(!e)return this._recordWarning("Page data is not available");let o=t.data;if(!o)return this._recordValue("Page data has not changed",0,"%","ok");l&&(o=o.filter((e=>l.includes(e.type))),e=e.filter((e=>l.includes(e.type))));const a={},i={added:0,removed:0};o.forEach((e=>{const{type:t,value:n}=e;a[t]||(a[t]=new Map);const o=a[t].get(n)||0;a[t].set(n,o-1)})),e.forEach((e=>{const{type:t,value:n}=e;a[t]||(a[t]=new Map);const o=a[t].get(n)||0;a[t].set(n,o+1)})),Object.values(a).forEach((e=>{Array.from(e.values()).forEach((e=>{e<0?i.removed++:e>0&&i.added++}))})),i.total=Math.max(o.length,e.length),i.changed=Math.max(i.added,i.removed);const s=100*i.changed==0?0:i.changed/i.total,c=`<b>${s.toFixed(1)}%</b>`;if(0===s)return this._recordValue("Page content has not changed",0,"%","ok");const d="none"!==r&&s>=u;return this._recordValue(s<.01?"Page data has changed":`${c} of page data has changed`,s,"%",h(d,s),p(d,s),d)}if("html"===s||"text"===s){if(t="text"===s?t.text:t.html,!(n="text"===s?n.text:n.html))return this._recordWarning("Page content is not available");if("html"===s&&(t=this._replaceInjectedHtml(t),n=this._replaceInjectedHtml(n)),"contains-text"===r||"missing-text"===r){const e=a.occurrences.regex(n,d),t="contains-text"===r?e>0:0===e;return this._recordValue(0===e?"Search text is not found on page":1===e?"Search text is found <b>1</b> time":`Search text is found <b>${e}</b> times`,e,"matches",h(t,e),p(t,e),t)}if("none"===r||"content-changes"===r){if(!t)return this._recordValue("Page content has not changed",0,"%","ok");const e=100*a.diff(t,n,s),o=`<b>${e.toFixed(1)}%</b>`;if(0===e)return this._recordValue("Page content has not changed",0,"%","ok");const i="none"!==r&&e>=u;return this._recordValue(e<.01?"Page content has changed":`${o} of page content has changed`,e,"%",h(i,e),p(i,e),i)}return this._recordError(`Condition ${r} is not supported`)}return this._recordError(`Monitoring ${s} is not supported`)},_replaceInjectedHtml(e){if(!e)return;return[/__hrp="[^"']+"/g,/<__hrp__[^<]+<\/__hrp__>/g].forEach((t=>{e=e.replaceAll(t,"")})),e},_recordValue(e,t,n,o,a,r){const i={ms:Date.now(),value:t};return e&&(i.info=e),n&&(i.metric=n),o&&(i.status=o),a&&(i.color=a),r&&(i.triggered=r),i},_recordError:(e,t)=>({ms:Date.now(),info:e,value:t,status:"error",color:"sublime"}),_recordWarning:(e,t)=>({ms:Date.now(),info:e,value:t,status:"warning",color:"sublime"}),_trigger:e=>({...e.inputs["watcher.trigger"],...e.inputs.trigger}),_triggerCondition(e){const t=this._trigger(e);switch(e.recipeId){case"watcher.monitorHealth":return t.monitorHealth;case"watcher.monitorPrice":return t.monitorPrice;case"watcher.monitorElement":return t.monitorElement;case"watcher.monitorChanges":{const n=e.inputs["watcher.changes"].whatToMonitor;if("html"===n)return t.monitorChangesHtml;if("data"===n)return t.monitorChangesData;if("text"===n)return t.monitorChangesText;throw new Error(`monitoring ${n} is not supported`)}default:return null}},_isCondition(e,t,n){const o=this._trigger(e);return n.includes(o[t])}}})(),(()=>{const{$recipe:e}=n;e.inputs.actions={get state(){const e={sendOn:"first-trigger",limitActions:"do-not-limit"},t={sendOn:"task-success",limitActions:"do-not-limit"};return{widget:{enabled:!0},notification:{enabled:!0,...e},sound:{enabled:!1,value:"sound:sonar",utterance:"Task triggered",volume:50,...e},email:{enabled:!1,to:"",customSmtpEnabled:!1,customSmtpFrom:'"HARPA AI Web Monitor" <monitor@harpa.ai>',customSmtpHost:"smtp.gmail.com:465",customSmtpUsername:"",customSmtpPassword:"",...e,limitActions:"once-a-day"},webhook:{enabled:!1,url:"https://webhook.site/...",basicAuthEnabled:!1,basicAuthUsername:"",basicAuthPassword:"",...t},make:{enabled:!1,url:"https://hook.eu1.make.com/...",...t},push:{enabled:!1,...e},sms:{enabled:!1,...e},slack:{enabled:!1,...e},telegram:{enabled:!1,...e},discord:{enabled:!1,...e},zapier:{enabled:!1,...t}}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs.before={get state(){return{idleCheck:{enabled:!0,timeout:15,onTimeout:"carry-on"},dropBanners:{enabled:!0,text:"cookie"},textCheck:{enabled:!1,searchText:"",timeout:15,onTimeout:"report-error"},scroll:{enabled:!1,maxDuration:15}}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs.changeUpIs={get state(){return{value:"neutral"}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs.page={get state(){return{url:null,timeout:30}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs.schedule={get state(){return{type:"periodical",periodical:{frequency:"3h"},interval:{},week:{},month:{},mediumType:"hidden-tab",mediumId:null,autoCloseTab:!0}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs.tracking={get state(){return{value:"between-checks"}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs.trigger={get state(){return{minThreshold:5,searchText:"discount\noff\npromo",httpCodes:["4xx","5xx"],x:89.99,y:99.99,itemParameter:"value",icon:"alert",color:"negative",doubleCheck:"off"}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs.ua={get state(){return{vlang:null,vua:null,customViewport:!1,viewportWidth:null,viewportHeight:null}},get persistState(){return!0}}})(),(()=>{const{$recipe:e}=n;e.inputs["watcher.changes"]={get state(){return{whatToMonitor:"html",itemTypes:["text","icon","image","video","link","date","time","copyright","number","currency","price"]}}}})(),(()=>{const{$recipe:e}=n;e.inputs["watcher.element"]={get state(){return{selector:null,selectorType:"ai"}}}})(),(()=>{const{$recipe:e}=n;e.inputs["watcher.price"]={get state(){return{pickup:"visually-largest",n:1,anchorText:""}}}})(),(()=>{const{$recipe:e}=n;e.inputs["watcher.trigger"]={get state(){return{monitorChangesText:"content-changes",monitorChangesHtml:"content-changes",monitorChangesData:"content-changes",monitorElement:"value-changes",monitorPrice:"price-changes",monitorHealth:"web-page-is-down"}}}})(),(()=>{const{$recipe:e,$store:t,$env:o}=n,a=(e,t,n,o=!0)=>{if(o&&!n.hasOwnProperty(t))throw new Error(`no recipe ${e} ${t} found`);return n[t]};e.proxy=t.createProxy({adapter:(t,n=!0)=>a("adapter",t,e.adapters,n),input:(t,n=!0)=>a("input",t,e.inputs,n),step(t,n=!0){if(o.is.pp)throw new Error("not supported");return a("step",t,e.steps,n)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$peeker:a,$ui:r,$utils:i}=n;a.Panel=r.component("PeekerPanel",{icons:{prev:'<svg viewBox="0 0 15 15"><path fill="none" d="M0 0h15v15H0z"/><path d="m6.52 8.485 4.837 4.872H8.978L2.829 7.282l6.149-6.048h2.379L6.52 6.106 5.131 7.282Z" fill="currentColor"/></svg>',next:'<svg viewBox="0 0 15 15"><path fill="none" d="M15 15H0V0h15z"/><path d="M8.48 6.515 3.643 1.643h2.379l6.149 6.075-6.149 6.048H3.643L8.48 8.894l1.389-1.176Z" fill="currentColor"/></svg>',last:'<svg viewBox="0 0 15 15"><path fill="none" d="M15 15H0V0h15z"/><path d="M4.837 6.515 0 1.643h2.379l6.149 6.075-6.149 6.048H0l4.837-4.872 1.389-1.176Z" fill="currentColor"/><path d="M11.309 6.515 6.472 1.643h2.379L15 7.718l-6.149 6.048H6.472l4.837-4.872 1.389-1.176Z" fill="currentColor"/></svg>',drop:'<svg viewBox="0 0 18 14.4"><path d="M14.7,16.8h3.6v1.8H14.7Zm0-7.2H21v1.8H14.7Zm0,3.6h5.4V15H14.7ZM3.9,18.6a1.805,1.805,0,0,0,1.8,1.8h5.4a1.805,1.805,0,0,0,1.8-1.8v-9h-9ZM13.8,6.9H11.1L10.2,6H6.6l-.9.9H3V8.7H13.8Z" transform="translate(-3 -6)" fill="currentColor"/></svg>'},didMount(){a.proxy.reset(),this.initKeyboardShortcuts()},get show(){return a.proxy.show&&!!a.proxy.record},get fixed(){return a.proxy.fixed},get task(){return a.proxy.task},get record(){return a.proxy.record},get prevRecord(){return this.task.records.findLast((e=>e.ms<this.record.ms))},get nextRecord(){return this.task.records.find((e=>e.ms>this.record.ms))},get lastRecord(){return this.task.records.at(-1)},get title(){return i.time.formatRelativeDate(this.record.ms)},render(){const{c:e}=this;return o(2,r.SidePanel,{class:e.block({fixed:this.fixed}),show:this.show,children:this.renderContent()})},renderContent(){if(this.record)return t([this.renderHeader(),o(2,a.SectionWidget),o(2,a.SectionSteps),o(2,a.SectionScreenshot)],0)},renderHeader(){const{c:t}=this;return e(1,"row",t.header,[e(1,"div",t.title,this.title,0),e(1,"row",t.actions,[e(1,"button",t.action,o(2,r.Icon,{name:this.icons.prev}),2,{disabled:!this.prevRecord,onClick:this.goToPrevRecord}),o(2,r.Spacer,{width:"g1"}),e(1,"button",t.action,o(2,r.Icon,{name:this.icons.next}),2,{disabled:!this.nextRecord,onClick:this.goToNextRecord}),o(2,r.Spacer,{width:"g1"}),e(1,"button",t.action,o(2,r.Icon,{name:this.icons.last}),2,{disabled:this.record===this.lastRecord,onClick:this.goToLastRecord}),o(2,r.Spacer,{width:"g2"}),o(2,r.Tooltip,{content:"Drop Record, âŒ«",children:e(1,"button",t.action,o(2,r.Icon,{name:this.icons.drop}),2,{onClick:this.dropRecord})}),o(2,r.Spacer,{width:"g1"}),o(2,r.Tooltip,{content:"Close, ESC",children:e(1,"button",t.action,o(2,r.Icon,{name:"close"}),2,{onClick:this.close})})],0)],0,{"x-between":!0,"y-center":!0})},initKeyboardShortcuts(){this.tillUnmount.addEventListener(document,"keydown",(e=>{this.fixed&&("Escape"===e.key?this.close():"ArrowLeft"===e.key?this.goToPrevRecord():"ArrowRight"===e.key?this.goToNextRecord():"ArrowDown"===e.key?this.goToLastRecord():"Backspace"===e.key&&this.dropRecord())}))},goToPrevRecord(){this.prevRecord&&(a.proxy.recordMs=this.prevRecord.ms)},goToNextRecord(){this.nextRecord&&(a.proxy.recordMs=this.nextRecord.ms)},goToLastRecord(){a.proxy.recordMs=this.lastRecord.ms},dropRecord(){const{taskId:e,recordMs:t}=a.proxy;this.nextRecord?this.goToNextRecord():this.prevRecord?this.goToPrevRecord():this.close(),a.proxy.dropRecord(e,t)},close(){a.proxy.update({show:!1,fixed:!1})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$peeker:o,$ui:a}=n;o.SectionScreenshot=a.component("PeekerSectionScreenshot",{get collapsed(){return o.proxy.screenshotCollapsed},get screenshot(){return o.controller.state.screenshot},render(){if(!this.screenshot)return;const{c:n}=this;return t(2,o.Section,{class:n.block,title:"SCREENSHOT",collapsed:this.collapsed,onToggle:this.onToggle,children:e(1,"div",n.screenshot,[e(1,"img",n.image,null,1,{src:this.screenshot,onError:this.onScreenshotError}),e(1,"div",n.border)],4,{onClick:this.onScreenshotClick})})},onToggle(){o.proxy.screenshotCollapsed=!o.proxy.screenshotCollapsed},onScreenshotClick(e){chrome.tabs.create({url:this.screenshot,active:!e.ctrlKey&&!e.metaKey})},onScreenshotError(){o.controller.rereadCurrentRecordStorage()}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$peeker:a,$ui:r}=n;a.SectionSteps=r.component("PeekerSectionSteps",{get collapsed(){return a.proxy.stepsCollapsed},get recordMs(){return a.proxy.recordMs},get steps(){return a.controller.state.steps||[]},render(){const{c:e}=this;if(0!==this.steps.length)return t(2,a.Section,{class:e.block,title:this.renderTitle(),collapsed:this.collapsed,onToggle:this.onToggle,children:t(2,r.ProgressJournal,{events:this.steps})})},renderTitle:()=>e(1,"row",null,[o("AUTOMATION STEPS"),t(2,r.Spacer,{width:"g1"}),t(2,r.Icon,{name:"running"})],4,{"y-center":!0}),onToggle(){a.proxy.stepsCollapsed=!a.proxy.stepsCollapsed}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$peeker:t,$ui:o,$dashboard:a}=n;t.SectionWidget=o.component("PeekerSectionWidget",{get collapsed(){return t.proxy.widgetCollapsed},get task(){return{...t.proxy.task,records:t.proxy.task.records.filter((e=>e.ms<=this.record.ms))}},get record(){return t.proxy.record},render(){const{c:n}=this;return e(2,t.Section,{class:n.block,title:"RESULT",collapsed:this.collapsed,onToggle:this.onToggle,children:e(2,a.ValueWidget,{task:this.task,record:this.record,titleEditable:!1})})},onToggle(){t.proxy.widgetCollapsed=!t.proxy.widgetCollapsed}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$peeker:o,$ui:a}=n;o.Section=a.component("PeekerSection",{props:()=>({class:Class,title:Element,collapsed:Boolean,children:Element,onToggle:Listener}),render(){const{c:n,props:o}=this;return e(1,"div",[n.block({collapsed:this.props.collapsed}),o.class],[e(1,"div",n.header,[e(1,"div",n.triangle,t(2,a.Icon,{name:"triangle"}),2),e(1,"div",n.title,o.title,0)],0,{onClick:o.onToggle}),e(1,"div",n.body,o.children,0)],0)}})})(),(()=>{const{$peeker:e,$mobx:t,$bus:o,$idb:a}=n;e.controller={init(){this._cache=new Map,this._maxCacheSize=100,this._lastRecordKey=null,this._lastRereadRecordKey=null,this._scheduleReadRecordStorageJob(),this.state=t.observable({steps:null,screenshot:null})},async rereadCurrentRecordStorage(){const e=this._currentRecordKey();this._lastRereadRecordKey!==e&&(this._lastRereadRecordKey=e,this._cache.delete(e),await this._readRecordStorage(e))},_scheduleReadRecordStorageJob(){t.reaction((()=>this._currentRecordKey()),(e=>this._readRecordStorage(e)))},_currentRecordKey:()=>e.proxy.taskId&&e.proxy.recordMs?`${e.proxy.taskId}:${e.proxy.recordMs}`:null,async _readRecordStorage(t){if(t&&this._cache.has(t)){const e=this._cache.get(t);return this.state.steps=e.steps,void(this.state.screenshot=e.screenshot)}if(this.state.steps=null,this.state.screenshot=null,!t)return;this._lastRecordKey=t;const n=await o.send("task.getRecordIdbKey",e.proxy.taskId,e.proxy.recordMs),r=await a.read(n);if(r){if(r.screenshot instanceof Blob&&(r.screenshot=URL.createObjectURL(r.screenshot)),this._cache.set(t,{steps:r.steps,screenshot:r.screenshot}),this._cache.size>=this._maxCacheSize){const e=Math.floor(.8*this._maxCacheSize);this._cache=new Map([...this._cache].slice(this._cache.size-e))}this._lastRecordKey===t&&(this.state.steps=r.steps,this.state.screenshot=r.screenshot)}}}})(),(()=>{const{$peeker:e,$store:t,$task:o,$news:a,$settings:r}=n;e.proxy=t.createProxy({get show(){return t.state.peeker.show},set show(e){e&&(a.proxy.show=!1,r.proxy.show=!1),this.update({show:e})},get fixed(){return t.state.peeker.fixed},set fixed(e){this.update({fixed:e})},get taskId(){return t.state.peeker.taskId},set taskId(e){this.update({taskId:e})},get task(){const e=t.state.peeker.taskId;return o.proxy.taskById(e)},get recordMs(){return t.state.peeker.recordMs},set recordMs(e){this.update({recordMs:e})},get record(){if(!this.task)return null;const e=t.state.peeker.recordMs;return this.task.records.find((t=>t.ms===e))},get widgetCollapsed(){return t.state.peeker.widgetCollapsed},set widgetCollapsed(e){this.update({widgetCollapsed:e})},get stepsCollapsed(){return t.state.peeker.stepsCollapsed},set stepsCollapsed(e){this.update({stepsCollapsed:e})},get screenshotCollapsed(){return t.state.peeker.screenshotCollapsed},set screenshotCollapsed(e){this.update({screenshotCollapsed:e})},reset(){const e=t.template.state();this.update(e.peeker)},dropRecord(e,n){e&&n&&t.transaction((t=>{const o=t.tasks.find((t=>t.id===e));o&&(o.records=o.records.filter((e=>e.ms!==n)))}))},update(e={}){t.transaction((t=>{Object.assign(t.peeker,e)}))}})})(),(()=>{const{$offscreen:e,$utils:t,$runner:o,$bus:a}=n;e.audioController={init(){this._synth=window.speechSynthesis,this._sounds={},this._voices={},this._preloadSounds(),this._preloadVoices(),a.on("offscreen.playAudio",this._play,this),a.on("offscreen.stopAudio",this._stop,this)},_play({id:e,volume:n,message:o}){n/=100;const a=this._sounds[e];if(a)return a.pause(),a.currentTime=0,void setTimeout((()=>{a.volume=n,a.play()}));const r=this._voices[e];r&&(this._synth.cancel(),setTimeout((()=>{const e=new window.SpeechSynthesisUtterance;e.text=t.clearFromTags(o),e.voice=r,e.volume=n,this._synth.speak(e)})))},_stop(){this._synth.cancel()},_preloadSounds(){for(const e of o.sounds)this._sounds[`sound:${e.id}`]=new Audio(`/sounds/${e.id}.mp3`)},_preloadVoices(){const e=()=>{this._synth.getVoices().forEach((e=>this._voices[e.name]=e))};e(),this._synth.onvoiceschanged=e}}})(),(()=>{const{$offscreen:e,$bus:t}=n;e.controller={init(){e.audioController.init(),e.imageController.init(),e.timerController.init(),e.tokenizerController.init(),t.on("offscreen.canBeClosed",this._canBeClosed,this),this._keepBgAlive()},_keepBgAlive(){setInterval((()=>t.send("timer.keepBgAlive")),2e4)},_canBeClosed:()=>!e.timerController.hasTimers()}})(),(()=>{const{$offscreen:e,$bus:t,$utils:o}=n;e.imageController={init(){t.on("offscreen.svgToImage",this._svgToImage,this),t.on("offscreen.createImagePreview",this._createImagePreview,this)},async _svgToImage({svgCode:e,width:t,height:n,dpr:a,quality:r}){const i=new Blob([e],{type:"image/svg+xml"}),s=await new Promise(((e,t)=>{const n=new FileReader;n.onerror=t,n.onload=()=>e(n.result),n.readAsDataURL(i)})),l=document.createElement("img");await new Promise(((e,t)=>{l.src=s,l.onload=e,l.onerror=()=>t("failed to load svg data url")}));const c=document.createElement("canvas"),d=c.getContext("2d");c.width=t*a,c.height=n*a,d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height),d.drawImage(l,0,0,t,n,0,0,c.width,c.height);const u=await o.canvasToBlob(c,"image/webp",r);return URL.createObjectURL(u)},async _createImagePreview(e){const t=document.createElement("img"),n=URL.createObjectURL(e);t.src=n,await new Promise(((e,n)=>{t.onload=e,t.onerror=n}));const a=document.createElement("canvas");let r,i;a.width=660,a.height=462;const s=t.naturalWidth,l=t.naturalHeight,c=s/l,d=a.width/a.height;c<d?(r=s,i=s/d):(i=l,r=l*d);return a.getContext("2d").drawImage(t,0,0,r,i,0,0,a.width,a.height),await o.canvasToBlob(a,"image/webp",.5)}}})(),(()=>{const{$offscreen:e,$bus:t}=n;e.timerController={init(){this._timerIds=new Set,this._intervalsById={},t.on("offscreen.setTimeout",this._setTimeout,this),t.on("offscreen.clearTimeout",this._clearTimeout,this),t.on("offscreen.setInterval",this._setInterval,this),t.on("offscreen.clearInterval",this._clearInterval,this)},hasTimers(){return this._timerIds.size>0},async _setTimeout(e,t){this._timerIds.add(e),await new Promise((n=>{setTimeout((()=>{this._timerIds.delete(e),n()}),t)}))},_clearTimeout(e){this._timerIds.delete(e)},_setInterval(e,n){this._timerIds.add(e),this._intervalsById[e]=setInterval((()=>{t.send(`offscreen.setIntervalCall:${e}`)}),n)},_clearInterval(e){this._timerIds.delete(e),clearInterval(this._intervalsById[e]),delete this._intervalsById[e]}}})(),(()=>{const{$offscreen:e,$ai:t,$bus:o}=n;e.tokenizerController={init(){o.on("offscreen.countTokens",this._countTokens,this)},_countTokens:async e=>await t.tokenizer.countTokens(e)}})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$news:t,$ui:o}=n;t.CloseButton=o.component("NewsCloseButton",{render(){const{c:t}=this;return e(2,o.Icon,{name:"close",class:t.block,onClick:this.onClick})},onClick(){t.proxy.resetLastSeenAnno()}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$news:t,$ui:o}=n;t.Panel=o.component("NewsPanel",{get show(){return t.proxy.show},render(){const{c:n}=this;return e(2,o.SidePanel,{class:n.block,show:this.show,children:[e(2,t.SectionHeader),e(2,t.SectionRateUs),e(2,t.SectionUpdates)]})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$news:o,$ui:a}=n;o.SectionHeader=a.component("NewsSectionHeader",{didMount(){this.initKeyboardShortcuts()},render(){const{c:n}=this;return e(1,"row",n.block,[e(1,"column",null,[e(1,"h2",n.title,"Whatâ€™s New",16),e(1,"div",n.subtitle,"A history of updates shipped with every product version",16)],4),t(2,a.Tooltip,{content:"Close, ESC",children:e(1,"button",n.action,t(2,a.Icon,{name:"close"}),2,{onClick:this.close})})],0,{"x-between":!0})},initKeyboardShortcuts(){this.tillUnmount.addEventListener(document,"keydown",(e=>{"Escape"===e.key&&this.close()}))},close(){o.proxy.show=!1}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$news:o,$harpa:a,$ui:r,$env:i}=n;o.SectionRateUs=r.component("NewsSectionRateUs",{props:()=>({snack:Boolean}),state:e=>({render:!e.snack,starHovered:0,reqStatus:null}),get rated(){return o.proxy.rated},get reviewed(){return o.proxy.reviewed},get feedbackStatus(){return o.proxy.feedbackStatus},get feedbackMessage(){return o.proxy.feedbackMessage},get feedbackEmail(){return o.proxy.feedbackEmail},didMount(){this.props.snack&&setTimeout((()=>this.setState({render:!0})),1e3)},render(){const{c:t,props:n,state:o}=this;return e(1,"column",t.block({snack:n.snack,render:o.render}),[this.renderStars(),this.renderForm5Star(),this.renderFormXStar(),this.renderFormXStarSent()],0)},renderStars(){const{c:n,state:o}=this,a=[null,"5-star-ok","5-star-cancel","X-star-ok","X-star-cancel"].includes(this.feedbackStatus),i=e=>a&&o.starHovered?e<=o.starHovered:e<=this.rated;return e(1,"row",null,[e(1,"span",null,"PLEASE RATE THE APP",16),e(1,"row",null,[1,2,3,4,5].map((o=>e(1,"div",n.star({selected:i(o)}),t(2,r.Icon,{name:"star"}),2,{"data-rate":o,onMouseEnter:a&&this.onStarHover,onClick:a&&this.onStarClick},o))),0,{onMouseLeave:this.onStarsUnhover})],4,{"y-center":!0,"x-between":!0})},renderForm5Star(){if("5-star"!==this.feedbackStatus)return null;const{c:n}=this;return e(1,"column",n.form,[e(1,"p",null,"Thank you! Please take a moment to hit a 5* review button on WebStore",16),e(1,"row",n.actions,[t(2,r.Button,{type:"link",label:"OK, SURE!",onClick:this.onLeaveReviewClick}),t(2,r.Spacer,{width:"g3"}),t(2,r.Button,{type:"link",status:"secondary",label:"NO, LATER",onClick:this.onCancelReviewClick})],4)],4)},renderFormXStar(){if("X-star"!==this.feedbackStatus)return null;const{c:n,state:o}=this;return e(1,"column",n.form,[e(1,"p",null,"Thank you for your feedback. Please let us know how we can make HARPA better:",16),t(2,r.Spacer,{height:"g0h"}),t(2,r.Input,{label:"your feedback",placeholder:"e.g. feature request, idea, bug reportâ€¦",lines:3,value:this.feedbackMessage,onInput:this.onFeedbackMessageChange}),t(2,r.Spacer,{height:"g1h"}),t(2,r.Input,{label:"your email, optional",placeholder:"my.address@gmail.com",value:this.feedbackEmail,onInput:this.onFeedbackEmailChange}),t(2,r.Spacer,{height:"g0h"}),e(1,"row",n.actions,[t(2,r.Button,{type:"link",label:"SEND FEEDBACK",disabled:!this.feedbackMessage,onClick:this.onSendFeedbackClick}),t(2,r.Spacer,{width:"g3"}),t(2,r.Button,{type:"link",status:"secondary",label:"CANCEL",onClick:this.onCancelFeedbackClick}),t(2,r.Spacer,{style:{flex:"1 0 auto"}}),t(2,r.ProgressRing,{class:n.progress({show:"sending"===o.reqStatus}),value:30,size:16,color:r.getColor("sublime"),background:r.getColor("bg-base"),spinning:!0})],4),"failed"===o.reqStatus&&e(1,"row",n.error,[t(2,r.Icon,{name:"status-warning-mini"}),t(2,r.Spacer,{width:"g1h"}),e(1,"span",null,"Could not send the feedback. Please check Internet connection or try again later.",16)],4)],0)},renderFormXStarSent(){if("X-star-sent"!==this.feedbackStatus)return null;const{c:n}=this;return e(1,"column",n.form,[e(1,"p",null,"Your feedback is sent to customer support team. Thank you for sharing! We will reach out if we need more information.",16),e(1,"row",n.actions,t(2,r.Button,{type:"link",label:"OK, CLOSE",onClick:this.onSendFeedbackOkClick}),2)],4)},onStarHover(e){const t=e.target.dataset.rate;this.setState({starHovered:t})},onStarsUnhover(){this.setState({starHovered:0})},onStarClick(e){const t=Number(e.target.closest(`.${this.c.star}`).dataset.rate);o.proxy.rated=t,o.proxy.feedbackStatus=5!==t||this.reviewed?"X-star":"5-star"},onFeedbackMessageChange(e){o.proxy.feedbackMessage=e},onFeedbackEmailChange(e){o.proxy.feedbackEmail=e},onLeaveReviewClick(){chrome.tabs.create({url:i.extUrl.reviews,active:!0}),o.proxy.feedbackStatus="5-star-ok",o.proxy.reviewed=!0},onCancelReviewClick(){o.proxy.feedbackStatus="5-star-cancel"},async onSendFeedbackClick(){const{state:e}=this;if("sending"===e.reqStatus)return;try{this.setState({reqStatus:"sending"});const e=await a.api.feedback(o.proxy.feedbackMessage||"",o.proxy.feedbackEmail||"",this.rated),t=await e.json();if("ok"!==t.status)throw t;setTimeout((()=>{o.proxy.feedbackStatus="X-star-sent",o.proxy.feedbackMessage="",o.proxy.feedbackEmail="",this.setState({reqStatus:null})}),300)}catch(e){setTimeout((()=>{this.setState({reqStatus:"failed"})}),300)}},onSendFeedbackOkClick(){o.proxy.feedbackStatus="X-star-ok"},onCancelFeedbackClick(){const{state:e}=this;"sending"!==e.reqStatus&&(this.setState({reqStatus:null}),o.proxy.feedbackStatus="X-star-cancel",o.proxy.feedbackMessage="",o.proxy.feedbackEmail="")}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$news:a,$ui:r,$utils:i}=n;a.SectionUpdates=r.component("NewsSectionUpdates",{icons:{engine:'<svg width="36" height="37" viewBox="0 0 36 37"><path d="M36,37H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0H36ZM16.932,27.084h2.137V31h1.7V27.084H22.9V31h1.7V27.084h2.486V24.6H31V22.9H27.083V20.765H31v-1.7H27.083V16.932H31v-1.7H27.083V13.1H31V11.4H27.083V8.917H24.6V5H22.9V8.917H20.765V5h-1.7V8.917H16.932V5h-1.7V8.917H13.1V5H11.4V8.917H8.917V11.4H5v1.7H8.917v2.137H5v1.7H8.917v2.138H5v1.7H8.917V22.9H5v1.7H8.917v2.487H11.4V31h1.7V27.084h2.137V31h1.7V27.085Zm-3.67-5.068H11.655l.73-1.435,3.361-6.6,3.362,6.6.729,1.433H18.23L17.5,20.58l-1.749-3.437L14,20.58l-.734,1.435Zm10.309,0H22.139V13.987h1.432v8.024Z" fill="#f49434"/></svg>',fix:'<svg width="36" height="37" viewBox="0 0 36 37"><path d="M-544,5423a4,4,0,0,1-4-4v-29a4,4,0,0,1,4-4h32v37h-32Zm18.8-17.592-2.922,2.922,2.653,2.652a4.02,4.02,0,0,0-.118.975,4.033,4.033,0,0,0,.317,1.573,4.012,4.012,0,0,0,.867,1.285,4.055,4.055,0,0,0,1.285.867,4.02,4.02,0,0,0,1.575.317,4.006,4.006,0,0,0,1.573-.317,4.044,4.044,0,0,0,1.285-.867,4.012,4.012,0,0,0,.867-1.285,4.012,4.012,0,0,0,.317-1.573,4.026,4.026,0,0,0-.317-1.575,4.036,4.036,0,0,0-.867-1.285,4,4,0,0,0-1.285-.866,4.006,4.006,0,0,0-1.573-.318,4.086,4.086,0,0,0-1.019.129l-2.636-2.635h0Zm-12.555,5.569h0l1.856.5.5,1.866-2.417,2.421a4.019,4.019,0,0,0,1.357.233,4.02,4.02,0,0,0,1.575-.317,4.054,4.054,0,0,0,1.285-.867,4.018,4.018,0,0,0,.867-1.285,4.035,4.035,0,0,0,.317-1.573,4.035,4.035,0,0,0-.114-.959l10.025-10.027a4.031,4.031,0,0,0,.961.115,4.018,4.018,0,0,0,1.573-.317,4.038,4.038,0,0,0,1.285-.867,4.033,4.033,0,0,0,.867-1.285,4.012,4.012,0,0,0,.317-1.573,4.025,4.025,0,0,0-.283-1.489l-2.463,2.469-1.856-.5-.5-1.865,2.417-2.422a4.054,4.054,0,0,0-1.357-.233,4.048,4.048,0,0,0-1.575.317,4.048,4.048,0,0,0-1.285.867,4.045,4.045,0,0,0-.867,1.285,4.047,4.047,0,0,0-.317,1.575,4.047,4.047,0,0,0,.133,1.033l-9.971,9.971a4.051,4.051,0,0,0-1.034-.133,4.006,4.006,0,0,0-1.573.318,4.011,4.011,0,0,0-1.285.866,4.036,4.036,0,0,0-.867,1.285,4.023,4.023,0,0,0-.317,1.575,4.02,4.02,0,0,0,.283,1.489l2.463-2.468Zm2.271-10.01h0l2.632,2.632,2.922-2.922-2.616-2.616a4.052,4.052,0,0,0,.129-1.018,4.051,4.051,0,0,0-.317-1.575,4.043,4.043,0,0,0-.867-1.285,4.045,4.045,0,0,0-1.285-.867,4.048,4.048,0,0,0-1.575-.317,4.034,4.034,0,0,0-1.573.317,4.04,4.04,0,0,0-1.285.867,4.045,4.045,0,0,0-.867,1.285,4.025,4.025,0,0,0-.317,1.575,4.009,4.009,0,0,0,.317,1.573,4.033,4.033,0,0,0,.867,1.285,4.039,4.039,0,0,0,1.285.867,4.018,4.018,0,0,0,1.573.317,4.042,4.042,0,0,0,.975-.119Zm13.945,12.912h0l-1.674-.965-.005-1.923,1.669-.957,1.673.966.005,1.922-1.667.957Zm-14.915-14.914h0l-1.672-.966-.005-1.922,1.667-.957,1.674.966.005,1.922-1.668.957Z" transform="translate(548 -5386)" fill="#74be86"/></svg>',feature:'<svg width="36" height="37" viewBox="0 0 36 37"><path d="M36,37H4a4,4,0,0,1-4-4V4A4,4,0,0,1,4,0H36ZM6.279,27.288a1.188,1.188,0,0,0-1.187,1.187v3.558h12V28.475a1.188,1.188,0,0,0-1.186-1.187h-.257l-.471-4.025-.329.706L14.837,24a4.212,4.212,0,0,1-3.673,2.353,3.907,3.907,0,0,1-2.154-.659,4.713,4.713,0,0,1-1.962-2.914c-.011-.047-.022-.1-.033-.158l-.543,4.668Zm22.592-4.93v2.459L29.89,26.31l1.018-1.493V22.358Zm-3.266,0v2.459l1.019,1.493,1.018-1.493V22.358ZM15.72,8.091,7.979,19.819a3.7,3.7,0,0,0,3.184,5.573,3.717,3.717,0,0,0,3.191-1.824l5.254-10.1-2.9-2.753a3.434,3.434,0,0,1-.993-2.623Zm12.536,7.252A2.654,2.654,0,0,0,25.6,17.995V21.81h5.3V17.995A2.654,2.654,0,0,0,28.256,15.343ZM19.477,4.967a3.2,3.2,0,0,0-2.354,5.369l7.927,7.53a3.209,3.209,0,0,1,4.288-2.892L21.833,6A3.21,3.21,0,0,0,19.477,4.967Zm-8.312,18.2h0a1.475,1.475,0,1,1,1.273-.728A1.475,1.475,0,0,1,11.165,23.168Zm17.091-4.219a1.035,1.035,0,1,1,1.036-1.035A1.036,1.036,0,0,1,28.256,18.949ZM19.479,9.388a1.224,1.224,0,0,1-.9-.394,1.219,1.219,0,0,1,.9-2.046,1.22,1.22,0,0,1,0,2.44Z" fill="#74be86"/></svg>'},get content(){return Object.keys(a.updates).map((e=>({value:a.proxy.toNumber(e),k:e}))).sort(((e,t)=>t.value-e.value)).map((e=>a.updates[e.k])).flat()},get lastSeenVersion(){return a.proxy.toNumber(a.proxy.lastSeenVersion)},render(){const{c:t}=this;return e(1,"div",t.block,this.content.map((e=>this.renderItem(e))),0)},renderItem(n){n=this._normalize(n);const{c:s,icons:l}=this,c=this.c.item({type:n.type});if("p"===n.type)return e(1,"p",c,i.toElement(n.content),0);if("h1"===n.type)return e(1,"h1",c,i.toElement(n.content),0);if("version"===n.type){const i=a.proxy.toNumber(n.version)>this.lastSeenVersion;return e(1,"row",c,[o("v"),n.version,t(2,r.Spacer,{width:"g1h"}),n.title,i&&e(1,"div",s.dot)],0,{"y-center":!0})}return"card"===n.type?e(1,"column",c,[e(1,"div",s.title,n.title,0),e(1,"div",s.content,i.toElement(n.content),0),t(2,r.Icon,{class:s.icon,name:l[n.icon]})],4):void 0},_normalize(e){if(i.is.object(e)){if(e.version)return{...e,type:"version"};if("engine"===e.card)return{...e,type:"card",icon:"engine"};if("fix"===e.card)return{...e,type:"card",icon:"fix"};if("feature"===e.card)return{...e,type:"card",icon:"feature"};throw new Error(`unsupported item type ${e.type}`)}if(i.is.string(e))return e.startsWith("# ")?{type:"h1",content:e.substr(2)}:{type:"p",content:e};throw new Error("unsupported item type "+typeof e)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$news:o,$ui:a}=n,r=[{name:"logo-twitter",onClick:()=>o.controller.shareOnTwitter()},{name:"logo-facebook",onClick:()=>o.controller.shareOnFacebook()},{name:"logo-pinterest",onClick:()=>o.controller.shareOnPinterest()},{name:"logo-linkedin",onClick:()=>o.controller.shareOnLinkedIn()}];o.SocialLinks=a.component("NewsSocialLinks",{render(){const{c:t}=this;return e(1,"row",t.block,r.map((e=>this.renderLink(e))),0,{"x-center":!0,gap:"g1h"})},renderLink(e){const{c:n}=this;return t(2,a.Icon,{class:n.link,name:e.name,onClick:e.onClick},e.name)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$news:o,$ui:a}=n;o.VideoGuide=a.component("NewsVideoGuide",{render(){const{c:n}=this;return e(1,"div",n.block,[t(2,a.Image,{width:370,height:210,src:"/img/misc/video-guide.png"}),e(1,"div",n.title,this.props.title,0)],4,{onClick:this.onClick})},onClick(){chrome.tabs.create({url:this.props.url||"https://www.youtube.com/watch?v=Vqmx_QBb1DA",active:!0})}})})(),(()=>{const{$news:e}=n;e.annos={}})(),(()=>{const{$news:e,$store:t,$peeker:o,$settings:a}=n;e.proxy=t.createProxy({get show(){return t.state.news.show},set show(t){if(!t&&this.show){const t=Object.keys(e.updates).map((t=>({value:e.proxy.toNumber(t),k:t}))).sort(((e,t)=>t.value-e.value))[0]?.k;t&&(e.proxy.lastSeenVersion=t)}t&&(o.proxy.update({show:!1,fixed:!1}),a.proxy.show=!1),this._update({show:t})},get rated(){return t.state.news.rated},set rated(e){this._update({rated:e})},get reviewed(){return t.state.news.reviewed},set reviewed(e){this._update({reviewed:e})},get feedbackStatus(){return t.state.news.feedbackStatus},set feedbackStatus(e){this._update({feedbackStatus:e})},get feedbackMessage(){return t.state.news.feedbackMessage},set feedbackMessage(e){this._update({feedbackMessage:e})},get feedbackEmail(){return t.state.news.feedbackEmail},set feedbackEmail(e){this._update({feedbackEmail:e})},get lastSeenVersion(){return t.state.news.lastSeenVersion},set lastSeenVersion(e){this._update({lastSeenVersion:e})},get anno(){let t=this.lastSeenAnno;if(!t)return null;t=e.proxy.toNumber(t);const n=Object.keys(e.annos).filter((n=>e.proxy.toNumber(n)>t));return 0===n.length?null:e.annos[n.sort(((e,t)=>t.value-e.value))[0]]},get lastSeenAnno(){return t.state.news.lastSeenAnno},set lastSeenAnno(e){this._update({lastSeenAnno:e})},resetLastSeenAnno(){const t=Object.keys(e.annos).map((t=>({value:e.proxy.toNumber(t),k:t}))).sort(((e,t)=>t.value-e.value))[0]?.k;t&&(e.proxy.lastSeenAnno=t)},_update(e={}){t.transaction((t=>{Object.assign(t.news,e)}))},toNumber(e){e=e||"0.0.0";const[t,n,o]=e.split(".");return 1e6*(Number(t)||0)+1e3*(Number(n)||0)+(Number(o)||0)}})})(),(()=>{const{$news:e}=n;e.updates={}})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$news:r}=n;r.annos["5.4.0"]={version:"5.4",title:"Requests Automation",content:t([e(1,"p",null,[a("ðŸ“¡Â Â HARPA now supports "),e(1,"b",null,"REQUEST",16),a(" step in custom commands. Use it to send HTTP requests to any API, get info from web pages and web services, or send data to Zapier, Integromat, IFTTT.")],4),e(1,"p",null,"âš¡Â Â OpenAI API connection now supports temperature, frequency penalty, presence penalty, proxy url and system prompt controls.",16),e(1,"p",null,[a("âš™ï¸Â Â Global parameters. Prefix any parameter name with"),a(" "),e(1,"b",null,"global",16),a(", e.g. "),e(1,"b",null,"{{global.email}}",0),a(" and it will be stored and available in every chat or command.")],0),e(1,"p",null,"If you ðŸ’› HARPA AI, please share it with the world, your friends and colleagues.",16),o(2,r.SocialLinks),o(2,r.CloseButton)],4)}})(),(()=>{const{$news:e}=n;e.updates["1.0.0"]=[{version:"1.0",title:"Core Monitor Features"},"This product version brings support for lightweight website monitoring. Use HARPA to monitor prices, parse KPIs from web pages, track text and html changes.",{card:"feature",title:"PRICE MONITOR",content:"Monitors prices on a web page."},{card:"feature",title:"TEXT MONITOR",content:"Monitors for text to appear / disappear from a web page."},{card:"feature",title:"CONTENT MONITOR",content:"Watches HTML and text content of a web page for changes."},{card:"feature",title:"WEB HEALTH MONITOR",content:"Pings web page and monitors website uptime and downtime metrics."},{card:"engine",title:"MONITOR RECIPE",content:"Core web monitoring automation recipe."},{card:"feature",title:"TASK CREATOR",content:"App UI module letting you to create new web page automations."},{card:"feature",title:"SOUND ACTION",content:"Plays a sound or AI-generated text-to-speech line whenever task triggers."},{card:"feature",title:"NOTIFICATION ACTION",content:"Shows a browser notification whenever task triggers."},{card:"feature",title:"DARK THEME",content:"Support for dark and light themes."},{card:"feature",title:"TASK TESTING MODE",content:"UI Module and Task Running Mode that verifies a newly created task performs as expected."},{card:"feature",title:"ITEM TRAPPER",content:"Item Trapper allows selecting items for tracking right from the monitored web page."},{card:"feature",title:"JOURNAL",content:"App module and UI screen that logs and renders all operations taken by HARPA."},{card:"feature",title:"LIBRARY",content:"App module and screen that manages and renders all 3rd party HARPA-compatible automation recipes."},{card:"engine",title:"SCHEDULER",content:"Keeps track of tasks, schedules and runs them as required."},{card:"feature",title:"DASHBOARD UI",content:"App screen that renders and manages tasks, task results and statuses."},{card:"feature",title:"VALUE WIDGET",content:"Renders last task value and delta on a Task Dashboard."},{card:"feature",title:"HISTOGRAM WIDGET",content:"Renders task data in a histogram."},{card:"feature",title:"TASK D&D",content:"Drag & drop support for task reordering on automations dashboard."},{card:"feature",title:"BULK TASK OPERATIONS",content:"Select multiple tasks on a task dashboard and apply a bulk operation."},{card:"engine",title:"UA / LANG MANAGER",content:"Changes user agent and website language to simulate running websites from various mobile and desktop devices."},{card:"engine",title:"SCROLLER",content:"Automates web page scrolling."},{card:"engine",title:"INSPECTOR",content:"Inspects elements and data on websites for visibility and actionability."},{card:"engine",title:"IDLE MONITOR",content:"Engine module that monitors web page for changes and understands when it stops updating."},{card:"engine",title:"INJECTOR",content:"Injects engine modules into controlled web pages to facilitate data parsing and automation."},{card:"engine",title:"AI DATA EXTRACTOR",content:"Parses numbers, dates, prices and other numeric data from the web pages."},{card:"engine",title:"AI PARSER",content:"Groups content on web pages into blocks, builds page semantics and intra-block relationship models."},{card:"engine",title:"AUTOMATION ENGINE",content:"Engine runs websites in a sand-boxed background process, automates actions and provides browser APIs for HARPA recipes."}]})(),(()=>{const{$news:e}=n;e.updates["1.1.0"]=[{version:"1.1",title:"Monitor Usability"},"Improved app stability, data watching quality, optimized engine speed.",{card:"engine",title:"MEMOIZER",content:"Speeds up AI Parser by memoizing data extraction operations."},{card:"engine",title:"MUTER",content:"Automatically mutes and prevents video and audio elements from playing to reduce network usage."},{card:"fix",title:"IMPROVED TEXT GROUPING",content:"AI Parser quality has been improved. AI will now takes more parameters into account to decide whether to group text elements into data blocks or split them up."},{card:"fix",title:"IMPROVED NUMBERS RENDERING",content:"Numbers are automatically shortened and formatted on the dashboard."},{card:"fix",title:"IMPROVED % RENDERING",content:"Percentages e.g. 95% are now rendered correctly in task widgets."},{card:"fix",title:"IMPROVED CURRENCIES PARSING",content:"Added support for alternative currency symbols detection such as CA$."},{card:"fix",title:"IMPROVED NUMBERS PARSING",content:"HARPA now parses 1m on websites as both 1 minute and 1.000.000."},{card:"fix",title:"STORAGE OPTIMIZATION",content:"HARPA now keeps less data per task to reduce memory footprint."},{card:"fix",title:"IDLE MONITOR SPEED-UP",content:"Speed up engine to detect web page idle state faster and more reliably."}]})(),(()=>{const{$news:e}=n;e.updates["1.2.0"]=[{version:"1.2",title:"Monitor Editing"},"This release brings support for monitors editing and customization operations.","If you need to create a list of similar monitors, simply clone an existing task and edit the clone's parameters.",{card:"feature",title:"IMPROVED TASK UI",content:"Monitor creation and editing interface has been redesigned to streamline the task configuration process."},{card:"feature",title:"TASK EDITING",content:"Click a gear button on a value widget to edit corresponding task after it has been created."},{card:"feature",title:"HISTOGRAM AGGREGATIONS",content:"Data records on histogram widgets can be grouped by hour, day, week or month."}]})(),(()=>{const{$news:e}=n;e.updates["1.3.0"]=[{version:"1.3",title:"Screenshots"},"To improve monitors transparency, HARPA will now automatically take screenshots and record command steps during task runs.",{card:"feature",title:"AUTOMATION STEPS TRACKING",content:"Individual task results and steps can now be inspected by selecting them in a histogram widget."},{card:"feature",title:"SCREENSHOTS",content:"HARPA will now take a screenshot of the web page during task runs. The screenshots history is stored locally."},{card:"engine",title:"SCREENSHOT CAPTURE MODULE",content:"Screenshotter module supports taking screenshots of a web page being automated."}]})(),(()=>{const{$news:e}=n;e.updates["1.4.0"]=[{version:"1.4",title:"Architecture Redesign"},"This release brings a complete redesign of the product architecture, radical performance improvements, stability enhancements and new features.","Machine Learning model became much smarter, making your automations resilient to HTML code changes.","Alas, due to the sheer volume of changes, version 1.4 monitors are <b>not backward compatible</b>. Starting from the version 1.4 your monitors will not break between the updates because of the state versioner module.",{card:"feature",title:"EMAIL ACTION",content:"HARPA can now send emails whenever task condition is triggered."},{card:"feature",title:"COOKIE BANNERS DETECTION",content:"HARPA can now automatically detect and hide cookie consent banners."},{card:"feature",title:"TEXT DETECTION",content:"HARPA can now check if the monitored page contains given text, phrase or regular expression before running the monitor."},{card:"engine",title:"AI ELEMENT LOCATOR",content:"Element locators are now built using a Machine Learning model which ensures task resilience across page updates."},{card:"engine",title:"OFFLINE TRACKER",content:"Monitors Internet connectivity to automatically silence tasks running in the background."},{card:"engine",title:"STATE VERSIONER",content:"Migrates internal data storage between app versions to ensure backward task compatibility."},{card:"fix",title:"IMPROVED TEXT GROUPING",content:"AI Parser now takes more parameters into account whenever it decides to group text elements into data items or split them up."}]})(),(()=>{const{$news:e}=n;e.updates["2.0.0"]=[{version:"2.0",title:"Host Tabs and Auto-refresh Mode"},"HARPA now runs automations directly in browser tabs: normal, pinned or hidden. This radically improves task stability and allows watching running monitors live.","App UI was redesigned and will render tasks directly in extension popup. HARPA will automatically suggest automation recipes whenever you click extension icon.","Auto-refresh mode, webhooks and CSV data exports introduced. 50+ bug fixes are shipped with this release.",{card:"engine",title:"HOST TABS",content:"HARPA now runs tasks directly in browser tabs. Regular, pinned and hidden tabs supported. Setting can be changed under schedule config."},{card:"feature",title:"WEBHOOK ACTION",content:"Integrate HARPA with 3rd party services: send data to server webhook."},{card:"feature",title:"AUTO-REFRESH MODE",content:"Build KPI monitoring dashboards by navigating to any web page, clicking extension icon and setting up auto-refresh task."},{card:"feature",title:"AI SUGGESTIONS",content:"Whenever you click extension icon, HARPA will parse the opened web page and suggest a few monitoring targets automatically."},{card:"feature",title:"WEB PAGE PREVIEW",content:"A screenshot preview is rendered alongside every task to streamline task management."},{card:"feature",title:"TASK CSV DATA EXPORT",content:"Export a single or multiple tasks data to a CSV / XLS file."},{card:"fix",title:"BETTER NUMBER PARSER",content:"AI engine takes element sizes into account when parsing fractional numbers."}]})(),(()=>{const{$news:e}=n;e.updates["2.1.0"]=[{version:"2.1",title:"Max Parallel Tasks"},"Now you can use settings button in the sidebar to limit the number of tasks HARPA runs at once. By default HARPA will conservatively limit the number of tasks to one at a time to save CPU and memory.","The task schedule medium (normal / pinned / hidden tab) can be edited right from the dashboard.","HARPA will export URL, task name and ID to CSV files.",{card:"feature",title:"PARALLEL TASKS SETTING",content:"Limit the number of tasks running at once."}]})(),(()=>{const{$news:e}=n;e.updates["2.2.0"]=[{version:"2.2",title:"Integromat / Make.com integration"},"Connect HARPA AI with over 1000+ apps via Make.com.","Now you can instruct HARPA to send data events to your scenarios and trigger actions in 1000+ web apps and systems: store data in Google Sheets, Airtable, Google Drive, send messages to Slack, Telegram, Discord, create tasks in Trello, Todoist, Google Tasks, trigger actions in ActiveCampaign, MailChimp, HubSpot, you name it.","You can find Make.com / Integromat integration under Task Settings â†’ Actions.",{card:"feature",title:"MAKE.COM INTEGRATION",content:"Trigger Make.com scenarios whenever website updates and send data to 3rd party systems."}]})(),(()=>{const{$news:e}=n;e.updates["3.0.0"]=[{version:"3.0",title:"ChatGPT integration"},"HARPA's hybrid AI now integrates ChatGPT.","This allows running page-aware natural-language queries, display ChatGPT answers on Google Search result pages, summarize web pages into posts and tweets, generate SEO content, articles and email replies, extract data from websites and much more.","For now you need to create a free OpenAI account to run ChatGPT queries with HARPA. We have plans to improve this in the future. Stay tuned.",{card:"engine",title:"CHATGPT AI MODULE",content:"Run page-aware ChatGPT queries in HARPA."},{card:"feature",title:"CHATGPT REPLIES ALONGSIDE SERP",content:"Show answers from ChatGPT alongside search result pages. Supports all popular engines."},{card:"feature",title:"SUMMARIZE PAGES",content:"Summarize and rephrase any page content into a few paragraphs of text, a Twitter's tweet, a Facebook or Instagram blog post."},{card:"feature",title:"GENERATE CONTENT",content:"Generate text content from Instagram posts, Facebook comments, hashtag lists to email replies and complete SEO articles."},{card:"feature",title:"EXTRACT DATA",content:"Extract SEO keywords, key-value pairs, tabular data and prices from any web page in a few clicks."},{card:"feature",title:"CUSTOM PROMPTS",content:"Write, reuse and share your own context-aware custom ChatGPT prompts."}]})(),(()=>{const{$news:e}=n;e.updates["3.3.0"]=[{version:"3.3",title:"100+ ChatGPT prompts"},"Over 100 page-aware ChatGPT prompts have been added to the HARPA platform with this release.","Get to the list of prompts by typing a slash (/) in the HARPA AI tab. There are prompts for Copywriting, SEO, Marketing, Social Media Marketing, Productivity, HR & Job Search, Software Engineering, Learning.","HARPA AI now supports grabbing the context right from the page with the help of a Context Grab button.","You can now switch to your preferred chat response language in the app settings.",{card:"feature",title:"CHATGPT COMMANDS",content:"Quickly access one of 100 battle-tested page-aware ChatGPT commands."},{card:"feature",title:"LANGUAGE SELECTOR",content:"Switch preferred ChatGPT language to one of the 10 options."},{card:"feature",title:"CONTEXT SELECTOR",content:"Grab text context for your commands right from the web page."},{card:"feature",title:"ALT+A QUICK ACCESS",content:"Access HARPA AI from any page by pressing [Alt] + [A] on Windows or [âŒƒ] + [A] on Mac."}]})(),(()=>{const{$news:e}=n;e.updates["3.4.0"]=[{version:"3.4",title:"User-Defined Commands"},"Turn any chat message to a reusable, parameterizable page-aware command or create your own commands from scratch right from the command list interface.","Now you can use page.desc, page.url, page.domain parameters in your prompts as well as define your own custom parameters with p1, p2, p3â€¦","Clear and reset AI chats with /clear command.","A ton of improvements and bug fixes under the hood, e.g. HARPA will now re-run Google Search queries if you edit the query.",{card:"engine",title:"USER-DEFINED COMMANDS",content:"Create and reuse custom parameterizable AI commands."},{card:"feature",title:"PAGE VARIABLES",content:"Variables for page title, description, url, domain."},{card:"fix",title:"IMPROVED CHAT UX",content:"Chat UI has been polished, streamlined and simplified."}]})(),(()=>{const{$news:e}=n;e.updates["3.5.0"]=[{version:"3.5",title:"YouTube Transcripts"},"HARPA can now parse transcripts of YouTube videos.","Added ChatGPT prompts for YouTube summary and YouTube target audience analysis.","You can create custom video transcript-aware commands by utilizing {{youtube.transcript}} parameter in prompts.",{card:"engine",title:"CHATGPT TOKENIZER",content:"Breaks ChatGPT requests into tokens to ensure requests reliably fit the ChatGPT model limit."},{card:"feature",title:"YOUTUBE TRANSCRIPTS",content:"Use {{youtube.transcript}} parameter in your prompts and instruct HARPA to parse a video transcript from the opened video page."},{card:"fix",title:"40+ LANGUAGE OPTIONS",content:"Added more options for the {{language}} parameter."}]})(),(()=>{const{$news:e}=n;e.updates["4.0.0"]=[{version:"4.0",title:"Text Composer"},'Text "Composer" Writer has been released. Type /compose command in chat to write any type of text content including emails, email replies, direct messages, tweets, LinkedIn / Facebook / Instagram posts, press releases, todo lists, poems etc.',"Use Text Composer to improve or rewrite any text on the web. HARPA now supports quick text grabbing from any page. Chat UI has been streamlined.","Parameter {{context}} has been renamed to {{page}}.",{card:"feature",title:"TEXT COMPOSER",content:"Compose command writes, rewrites, improves any type of text."},{card:"feature",title:"PASTE TO PAGE",content:"Paste any AI reply to web page with a click of a button."},{card:"engine",title:"GPT-4",content:"HARPA AI supports model GPT-4, which is available on ChatGPT Plus."},{card:"fix",title:"GRAB SPEED",content:"Improved text grabbing performance."},{card:"fix",title:"CHATGPT CLOUDFLARE FIX",content:"Improved ChatGPT connectivity and stability."}]})(),(()=>{const{$news:e}=n;e.updates["4.1.0"]=[{version:"4.1",title:"Summarize YouTube Videos"},"Call /youtube-summary command in HARPA chat to get key takeaways from the opened YouTube video.","This is made possible by request chunking. HARPA now breaks down long video transcripts to bite-sizeable chunks ands sends them to ChatGPT one by one.","LinkedIn commands were reworked to support parsing Job Descriptions and CVs from the web page.","Added user guides to website: https://harpa.ai/guides",{card:"engine",title:"REQUEST CHUNKING",content:"HARPA AI engine can now break down long text parameters, feeding them to ChatGPT piece by piece."},{card:"feature",title:"CATEGORIES BAR UX",content:"Improved categories navigation in the commands explorer."},{card:"fix",title:"IMPROVED YOUTUBE COMMANDS",content:"HARPA can now extract key takeaways and summarize hours-long videos."},{card:"fix",title:"IMPROVED LINKEDIN COMMANDS",content:"Reworked and improved LinkedIn commands."},{card:"fix",title:"STABILITY FIXES",content:"Stability fixes and under-the-hood improvements."}]})(),(()=>{const{$news:e}=n;e.updates["4.2.0"]=[{version:"4.2",title:"Commands Export & Import"},"Version 4.2 brings ability to export, import and mark custom commands as favourites.","This gives control over your automations, allowing you to save, share or sell your custom automation commands and page-aware ChatGPT prompts.",{card:"feature",title:"COMMANDS EXPORT & IMPORT",content:"Select custom commands from the commands explorer and export to JSON file. Share, sell or import commands."},{card:"fix",title:"GPT-4 INTEGRATION",content:"Use HARPA AI with GPT-4, which is available for OpenAI Plus users."}]})(),(()=>{const{$news:e}=n;e.updates["5.0.0"]=[{version:"5.0",title:"API Keys & Selection Commands"},"HARPA AI now extracts information from SERP pages (Google, Bing, Yahoo etc.) to enrich GPT results with information on events past 2021.","OpenAI API keys / license support, making AI Agent reliable and solving the disconnection and CloudFlare issues. Enter your API key in settings.","HARPA AI commands can be invoked from web pages by selecting a block of text and pressing <b>Alt + A</b>. This works similar to Notion AI and allows improving, translating, fixing, paraphrasing and extracting information from any block of text on any website.",{card:"engine",title:"OPENAI API KEYS",content:"OpenAI API keys / license support, making AI Agent reliable and solving the disconnection and CloudFlare issues."},{card:"engine",title:"AUTOMATION STEPS",content:"Custom commands now support SAY, ASK, GPT, PASTE and COMMAND automation steps."},{card:"engine",title:"COMMANDS CHAINING",content:"Custom HARPA AI commands can reference other commands, e.g. Compose, Reply and Rewrite. Useful for creating shortcuts and higher order commands."},{card:"feature",title:"PAGE SELECTION COMMANDS",content:"HARPA AI commands can be invoked from web pages by selecting a block of text and pressing Alt + A."},{card:"feature",title:"SELECTION AND GPT PARAMETERS",content:"HARPA AI supports {{page.selection}} and {{gpt}} parameters for page text selection and commands chaining."},{card:"feature",title:"HOTKEYS CUSTOMIZATION",content:"Default Alt + A hotkey combination can now be changed e.g. to Ctrl + /. Keyboard shortcuts for copying and pasting the last message to page."},{card:"feature",title:"CUSTOM CHAT LANGUAGE",content:"Specify custom GPT reply language, e.g. Catalan, Klingon, Quenya in settings."},{card:"feature",title:"REPLY & REWRITE COMMANDS",content:"Added extra commands: Reply and Rewrite, for crafting email and post replies and rewriting / improving text, similar to Notion AI."},{card:"fix",title:"SUMMARY CHUNKING",content:"Summary and Grammarly commands now support text content chunking (splitting), similar to YouTube Summary command, and can process large web pages."},{card:"fix",title:"COMPOSER REFINEMENT LOOP",content:"Composer command can now write comments for Instagram, Facebook and LinkedIn social networks. Composer also features a text refinement loop and pasting text to page."}]})(),(()=>{const{$news:e}=n;e.updates["5.1.0"]=[{version:"5.1",title:"Context Mode & Quick Access Buttons"},"HARPA will parse web page content and locate relevant information whenever you send a question in chat. It will also recollect relevant messages from the dialog history.","This implements STM (short-term-memory), makes HARPA dialogues highly-contextual and means you can talk to HARPA about the page content.","You can turn context off and switch back to normal Chat mode at any time by clicking a context button at the bottom of the chat.",{card:"engine",title:"GENERATIVE AGENT CONTEXT",content:"HARPA can locate locate relevant information in web pages and inject it into GPT prompt."},{card:"feature",title:"QUICK ACCESS COMMANDS",content:"Select any text on a web page to quickly rephrase, shorten / expand, fix spelling and grammar, translate, write a reply etc."},{card:"feature",title:"QUICK ACCESS CUSTOMIZATION",content:"Favourite your commands to add them to the quick access panel."},{card:"feature",title:"GPT CHUNKING",content:"Custom HARPA commands now support GPT chunking. This way you can slice up large web pages and process them chunk by chunk, similar to YouTube summary command."},{card:"feature",title:"DRAWING CHARTS",content:"Use new /chart command to draw charts."},{card:"fix",title:"AUTO-CLEAR CHATS",content:"New option to prevent HARPA from automatically clearing ChatGPT dialogs on tab closing."},{card:"fix",title:"USABILITY & FIXES",content:"Code in answers can now be copied with a click of a button. Improved prompts consistency, fixed bugs."}]})(),(()=>{const{$news:e}=n;e.updates["5.2.0"]=[{version:"5.2",title:"PDF Support"},'HARPA can now read online PDF documents. Navigate to a PDF online, bring HARPA AI and ask it questions about the document: e.g. "what questions this document answers"?',"Added {{context}} parameter, which retrieves page content relevant to user prompt. Improved context search algorithm and heuristics for speed and quality.","HARPA now supports OpenAI GPT-4 Browsing model. Fixed a number of bugs and improved user experience.",{card:"engine",title:"PDF PARSER",content:"Engine module that extracts text content from online PDF documents."},{card:"feature",title:"BROWSING MODEL",content:"Support for GPT-4 browsing model."},{card:"feature",title:"CONTEXT PARAMETER",content:"Use {{context}} in your prompts to inject page content relevant to your prompts."},{card:"fix",title:"USABILITY & FIXES",content:"Fixed a problem that caused HARPA to stop generating long articles and replies."}]})(),(()=>{const{$news:e}=n;e.updates["5.3.0"]=[{version:"5.3",title:"Google Bard Support"},"HARPA now supports Google Bard as AI model provider.",{card:"engine",title:"GOOGLE BARD INTEGRATION",content:"Switch to Google Bard model to run your AI queries."}]})(),(()=>{const{$news:e}=n;e.updates["5.4.0"]=[{version:"5.4",title:"Requests Automation"},"HARPA now supports HTTP requests in commands. Send requests to any API, get info from web pages and web services, or send data to Zapier, Integromat, IFTTT.","OpenAI API connection now has temperature, frequency penalty, presence penalty, proxy url and system prompt settings.","Prefix any parameter name with global, e.g. {{global.email}} and it will be stored and available in every chat.",{card:"engine",title:"REQUEST STEP",content:"Use request step to query data from web services or send data to webhooks."},{card:"feature",title:"OPENAI API SETTINGS",content:"Temperature, frequency penalty, presence penalty, proxy url and system prompt settings."},{card:"feature",title:"GLOBAL PARAMETERS",content:'Parameters prefixed with "global" are stored across chats and commands.'}]})(),(()=>{const{$news:e}=n,t="https://harpa.ai",o="ðŸ”¥ Boost your productivity and automate web tasks with HARPA AI for Chrome. #HARPAAI #Automation #GPT";e.controller={init(){e.proxy.lastSeenAnno||e.proxy.resetLastSeenAnno()},shareOnFacebook(e){e={link:t,text:o,...e};const n="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(e.link)+"&quote="+encodeURIComponent(e.text);this._openWindow(n,600,700)},shareOnLinkedIn(e){e={link:t,text:o,title:"ChatGPT & Automation for Chrome with HARPA.AI",source:"HARPA AI",...e};const n="https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(e.link)+"&title="+encodeURIComponent(e.title)+"&summary="+encodeURIComponent(e.text)+"&source="+encodeURIComponent(e.source);this._openWindow(n,600,700)},shareOnTwitter(e){e={link:t,text:o,...e};const n="https://twitter.com/intent/tweet?url="+encodeURIComponent(e.link)+"&text="+encodeURIComponent(e.text);this._openWindow(n)},shareOnPinterest(e){e={link:t,...e};const n="https://www.pinterest.com/pin/create/button/?url="+encodeURIComponent(e.link);this._openWindow(n,750,741)},_openWindow(e,t=600,n=400){const o=screen.width/2-t/2,a=screen.height/2-n/2;window.open(e,"_blank",`width=${t},height=${n},left=${o},top=${a}`)}}})(),(()=>{const{$netRules:e,$bus:t}=n;e.controller={init(){e.register=(...e)=>t.send("netRules.register",...e),e.unregister=(...e)=>t.send("netRules.unregister",...e)}}})(),(()=>{const{$logger:e,$env:t}=n;e.controller={init(){e.log=this.log.bind(this),e.dev=this.dev.bind(this),e.warn=this.warn.bind(this),e.error=this.error.bind(this),e.critical=this.critical.bind(this)},log(...e){console.log(...e)},dev(...e){t.is.development&&console.log(...e)},warn(...e){console.warn(...e)},error(...e){console.error(...e)},critical(...e){console.error("[critical]",...e),alert("critical error")}},e.controller.init()})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$library:a,$tabs:r,$env:i,$ui:s}=n;a.ExploreButton=s.component("LibraryExploreButton",{get currentTab(){return r.proxy.currentTab},get isCurrentTabAutomatable(){return r.proxy.isCurrentTabAutomatable},get currentTabDomain(){return r.proxy.currentTabDomain},get domainRecipes(){return a.proxy.domainRecipes},get title(){const{c:t}=this,n=this.domainRecipes.length;return n>1?e(1,"div",t.title,[n,o(" RECIPES FOUND")],0):e(1,"div",t.title,1===n?"AUTOMATION RECIPE FOUND":"RECIPE LIBRARY",16)},get text(){const{c:t}=this;return 0===this.domainRecipes.length?e(1,"div",t.text,"Run an open-source recipe made by HARPA dev community or suggest your automation idea",16):1===this.domainRecipes.length?e(1,"div",t.text,[o("Ready-to-use recipe for "),e(1,"span",null,this.currentTabDomain,0)],4):e(1,"div",t.text,[o("Ready-to-use recipes for "),e(1,"span",null,this.currentTabDomain,0)],4)},render(){if(!i.features.library)return null;if(!this.isCurrentTabAutomatable)return null;const{c:n}=this;return e(1,"row",n.block,[this.renderIcon(),t(2,s.Spacer,{width:"g1h"}),this.renderContent()],0,{"full-width":!0,onClick:this.onClick})},renderIcon(){const{c:n}=this,o=this.domainRecipes.length>0;return e(1,"div",null,t(2,s.Icon,{class:n.icon({highlight:o}),name:s.ScreenHeader.icons.library,width:28,height:36}),2)},renderContent(){return e(1,"column",null,[this.title,t(2,s.Spacer,{height:"g0h"}),this.text],0)},onClick(){this.props.onClick()}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$library:o,$ui:a,$utils:r,$store:i}=n;o.Favicon=a.component("LibraryFavicon",{props:()=>({class:Class,url:Url,size:Number}),state:()=>({dark:!1,grayscale:!1,loading:!0,showSpinner:!1,error:!1}),init(){this.state.loading=!!this.props.url,this.updateImageData(this.props.url)},didMount(){this.tillUnmount.setTimeout((()=>{this.setState({showSpinner:!0})}),300)},willUpdate({p1:e,p2:t}){e.url!==t.url&&this.updateImageData(t.url)},get invert(){return!!this.state.grayscale&&("day"===this.theme&&this.state.light||"night"===this.theme&&this.state.dark)},get theme(){return i.state.theme},get style(){return{width:`${this.props.size}px`,height:`${this.props.size}px`}},render(){const{c:t}=this;return e(1,"div",[this.props.class,t.block({invert:this.invert,loading:this.state.loading})],[this.renderIcon(),this.renderSpinner()],0,{style:this.style})},renderIcon(){const{c:e}=this;return!this.props.url||this.state.error?this.renderFallback():t(2,a.Image,{class:e.icon,src:this.props.url,fallback:this.renderFallback(),noCache:!0,onLoad:this.onImageLoad,onError:this.onImageError})},renderFallback(){const{c:e}=this;return t(2,a.Icon,{class:e.icon({fallback:!0}),name:"planet"})},renderSpinner(){if(!this.state.loading)return null;const{c:n}=this;return e(1,"div",n.spinner({show:this.state.showSpinner}),t(2,a.ProgressRing,{value:50,size:this.props.size,color:a.getColor("sublime"),background:a.getColor("bg-base"),spinning:!0}),2)},async updateImageData(e){if(!e)return;const t=await r.image.analyze(e);t?this.setState({grayscale:t.grayscale,dark:t.dark}):this.setState({loading:!1,error:!0})},onImageLoad(){this.setState({loading:!1})},onImageError(){this.setState({loading:!1})}})})(),(()=>{const{createVNode:e,createComponentVNode:t,normalizeProps:o,createTextVNode:a}=n.$inferno,{$library:r,$ui:i,$store:s}=n;r.RecipeCard=i.component("LibraryRecipeCard",{props:()=>({recipe:Object,expanded:Boolean,onClick:Listener}),state:()=>({hovered:!1}),icons:{underDevelopment:'<svg width="24" height="24" viewBox="0 0 24 24"><path d="M6.435,11.694a1.04,1.04,0,0,0-.624-.233H4.877v5.6h.935a1.04,1.04,0,0,0,.624-.233.817.817,0,0,0,.312-.7V12.394a.821.821,0,0,0-.312-.7ZM21.648,2.25H2.352A2.352,2.352,0,0,0,0,4.6V23.9A2.352,2.352,0,0,0,2.352,26.25h19.3A2.352,2.352,0,0,0,24,23.9V4.6A2.352,2.352,0,0,0,21.648,2.25ZM8.261,16.135A2.447,2.447,0,0,1,5.67,18.666H3.184V9.8H5.723A2.446,2.446,0,0,1,8.26,12.335Zm5.394-4.75H10.8v2.058h1.745v1.584H10.8v2.058h2.855V18.67H10.324a1.082,1.082,0,0,1-1.11-1.055v-6.7A1.083,1.083,0,0,1,10.27,9.8h3.385Zm5.552,6.176c-.707,1.647-1.974,1.319-2.541,0L14.6,9.8h1.745L17.937,15.9,19.521,9.8h1.745l-2.06,7.757Z" transform="translate(0 -2.25)" fill="currentColor"/></svg>'},get recipe(){return this.props.recipe},get domain(){return this.recipe.domains[0]},get domainFavicon(){const e=this.recipe.favicon;return e?`/img/favicons/${e}`:s.state.library.domains[this.domain]?.favicon||""},get isUpvoted(){return r.proxy.isUpvoted(this.recipe)},render(){const{c:t}=this;return e(1,"column",t.block,[this.renderTitle(),this.renderDesc(),this.renderTags(),this.renderInfo(),this.renderUnderDevelopment(),this.renderComingSoon()],0,{"full-width":!0,onClick:this.onClick})},renderTitle(){const{c:n}=this;return e(1,"row",n.titleContainer,[t(2,i.Image,{class:n.domain,src:this.domainFavicon,fallback:"/img/misc/recipe-watcher.svg"}),t(2,i.Spacer,{width:"g1"}),e(1,"div",n.title({isComingSoon:this.recipe.comingSoon}),this.recipe.title,0)],4,{"y-center":!0})},renderDesc(){const t=this.recipe.desc;if(!t)return null;const{c:n}=this;return e(1,"div",n.desc,t,0)},renderTags(){const t=this.recipe.tags;if(0===t?.length)return null;const{c:n}=this;return e(1,"row",n.tags,t.map((t=>e(1,"span",null,[a("#"),t],0))),0)},renderInfo(){if(!this.props.expanded)return null;const t=this.recipe.info;if(!t)return null;const{c:n}=this;return e(1,"div",n.info,t.map((t=>t.startsWith("* ")?e(1,"p",null,[a("Â Â â—Â Â "),t.substr(2)],0):e(1,"p",null,t,0))),0)},renderUnderDevelopment(){if(!this.props.expanded)return null;if(!this.recipe.comingSoon)return null;if(!this.recipe.info)return null;const{c:n}=this;return e(1,"row",n.underDevelopment,[t(2,i.Icon,{name:this.icons.underDevelopment}),t(2,i.Spacer,{width:"g1h"}),a("This recipe is planned for future releases,"),e(1,"br"),a("upvote it to let us know what to focus on next")],4)},renderComingSoon(){if(!this.recipe.comingSoon)return null;const{c:n,state:a}=this;return o(e(1,"row",n.comingSoonPill,t(2,i.Button,{type:"pill",status:this.isUpvoted?"primary":"off",buttonStyle:{"min-width":"82px","justify-content":"center",background:this.isUpvoted?null:i.getColor("bg-group")},label:this.isUpvoted?"UPVOTED":a.hovered?"UPVOTE":"PLANNED",onClick:this.isUpvoted?null:this.onUpvoteClick}),2,{"x-end":!0,...i.hoverState(this)}))},onUpvoteClick(){this.upvoteClicked=!0,r.proxy.upvote(this.recipe)},onClick(){this.upvoteClicked?this.upvoteClicked=!1:this.props.onClick&&this.props.onClick(this.recipe)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$library:a,$tabs:r,$store:i,$ui:s,$utils:l}=n;a.RecipeIdeaCard=s.component("LibraryRecipeIdeaCard",{get model(){return i.state.library.recipeIdeaCard},setModel(e){i.transaction((t=>{t.library.recipeIdeaCard={...t.library.recipeIdeaCard,...e}}))},render(){const{c:t}=this;return"link"===this.model.view?this.renderLink():"form"===this.model.view?e(1,"column",t.block,[this.renderInputs(),this.renderButtons()],0):"submitted"===this.model.view?e(1,"column",t.block,this.renderConfirmation(),0):void 0},renderLink(){const{c:t}=this;return e(1,"div",t.link,o(2,s.Button,{type:"link",label:"SUBMIT A RECIPE IDEA",onClick:this.onLinkClick}),2)},renderConfirmation(){return e(1,"column",null,[e(1,"div",null,"Your feedback has been submitted, thank you! Our team will review, publish for voting and prioritize your idea.",16),o(2,s.Spacer,{height:"g2"}),e(1,"row",null,[o(2,s.Button,{label:"OK, GREAT!",type:"link",onClick:this.onSubmittedOkClick}),o(2,s.Spacer,{width:"g3"}),o(2,s.Button,{label:"SUBMIT ANOTHER IDEA",type:"link",status:"secondary",onClick:this.onSubmitAnotherClick})],4)],4)},renderInputs(){return t([o(2,s.Input,{value:this.model.domain,error:this.model.domainError,onChange:e=>this.setModel({domain:e}),onInput:()=>this.setModel({domainError:null}),label:"web service to automate *",placeholder:"e.g. AirBnB"}),o(2,s.Spacer,{height:"g1h"}),o(2,s.Input,{value:this.model.suggestion,error:this.model.suggestionError,onChange:e=>this.setModel({suggestion:e}),onInput:()=>this.setModel({suggestionError:null}),label:"your suggestion *",lines:4,placeholder:"e.g. Iâ€™d like HARPA to parse and export all available homes in a given area from AirBnB website to a GoogleSheet document"}),o(2,s.Spacer,{height:"g1h"}),o(2,s.Input,{value:this.model.email,error:this.model.emailError,warning:this.model.emailWarning,onChange:e=>this.setModel({email:e}),onInput:()=>this.setModel({emailError:null,emailWarning:null}),label:"your email address, optional",placeholder:"my.name@google.com"}),o(2,s.Spacer,{height:"g2"})],4)},renderButtons(){return e(1,"row",null,[o(2,s.Button,{label:this.model.emailWarning?"CONFIRM EMAIL AND SEND":"SEND SUGGESTION",type:"link",onClick:this.onSendClick}),o(2,s.Spacer,{width:"g3"}),o(2,s.Button,{label:"CANCEL",type:"link",status:"secondary",onClick:this.onCancelClick})],4)},onLinkClick(){this.setModel({view:"link"===this.model.view?"form":"link"})},onSendClick(){0===this.model.domain.trim().length&&this.setModel({domainError:"service or domain name is required"}),0===this.model.suggestion.trim().length&&this.setModel({suggestionError:"suggestion or idea is required"});const e=this.model.email?l.email.check(this.model.email):{status:"ok"};"error"===e.status?this.setModel({emailError:e.error}):"typo"!==e.status||this.model.emailWarning?this.setModel({emailError:null,emailWarning:null}):this.setModel({emailWarning:`Did you mean ${e.fix}?`}),this.model.domainError||this.model.suggestionError||this.model.emailError||this.model.emailWarning||(i.transaction((e=>{e.library.recipeIdeas=[...e.library.recipeIdeas,{on:l.time.formatDate(new Date,{timeZone:"UTC"}),domain:this.model.domain.trim(),suggestion:this.model.suggestion.trim(),email:this.model.email.trim(),currentTabUrl:r.proxy.currentTabUrl}]})),this.setModel(a.recipeIdeaCardModel()),this.setModel({view:"submitted"}))},onCancelClick(){this.setModel(a.recipeIdeaCardModel())},onSubmittedOkClick(){this.setModel(a.recipeIdeaCardModel())},onSubmitAnotherClick(){this.setModel({view:"form"})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$library:r,$ui:i,$harpa:s,$tabs:l,$critical:c}=n;r.Screen=i.component("LibraryScreen",{state:()=>({expandedRecipe:null}),get popup(){return"popup"===c.proxy.pageType},get domainRecipes(){const e=r.proxy.domainRecipes;return 0===e.length?r.proxy.recipes:e},get recipeIdeaCardView(){return r.proxy.recipeIdeaCardView},get currentTabDomain(){return l.proxy.currentTabDomain},get isCurrentTabAutomatable(){return l.proxy.isCurrentTabAutomatable},get subtitle(){return"Web automation recipes are under development, please upvote the recipes you'd like to get first."},get notFoundText(){return this.isCurrentTabAutomatable?t([a("No recipes available yet for"),e(1,"br"),this.currentTabDomain],0):t([a("No recipes available yet for"),e(1,"br"),a("this website yet")],4)},render(){const{c:t}=this;return e(1,"column",t.block({popup:this.popup}),[o(2,s.NavHeader,{class:t.header,onBackButtonClick:this.onBackButtonClick,nameButtonLabel:"RECIPES",onNameButtonClick:this.onNameButtonClick}),o(2,i.Scroll,{children:[o(2,i.Spacer,{class:t.headerSpacer,height:"g2"}),e(1,"column",t.content,[o(2,i.ScreenHeader,{icon:"library",title:"Automation Recipes",subtitle:this.subtitle,childrenAlign:"bottom"}),o(2,r.RecipeIdeaCard),this.renderRecipes(),o(2,i.Spacer,{height:"g1h"})],0)]})],4,{"full-width":!0})},renderRecipes(){const{c:t,state:n}=this;return e(1,"column",t.recipesContainer,[e(1,"div",t.recipes,this.domainRecipes.map((a=>e(1,"div",t.recipe,o(2,r.RecipeCard,{recipe:a,expanded:n.expandedRecipe===a.id,onClick:this.onRecipeClick}),2))),0),0===this.domainRecipes.length&&"link"===this.recipeIdeaCardView&&o(2,i.NotFound,{paddingTop:"25vh",paddingBottom:"30vh",text:this.notFoundText})],0)},onBackButtonClick(){this.props.onBackButtonClick()},onNameButtonClick(){s.proxy.mainScreen="library",l.openAppTab()},onRecipeClick(e){const t=this.state.expandedRecipe===e.id?null:e.id;this.setState({expandedRecipe:t})}})})(),(()=>{const{$library:e,$bus:t}=n;e.controller={init(){t.send("library.updateRecipes")}}})(),(()=>{const{$library:e,$store:t,$tabs:o,$critical:a}=n;e.proxy=t.createProxy({get recipes(){return t.state.library.recipes},get domainRecipes(){let e=this.recipes;if("popup"===a.proxy.pageType){const t=o.proxy.currentTabDomain;if(!t)return e;e=e.filter((e=>!e.domains||e.domains.some((e=>t.includes(e)))))}return e},domainFavicon(e){if(!e)return null;for(e=e.split(".");e.length>0;){const n=e.join("."),o=t.state.library.domains[n],a=o?.faviconHq||o?.favicon;if(a)return a.startsWith("/")?chrome.runtime.getURL(a):a;e.shift()}return null},setDomainFavicon(e,t,n=!1){this.setDomainFavicons([{domain:e,favicon:t,hq:n}])},setDomainFavicons(e){t.transaction((t=>{e.filter((e=>e.domain&&e.favicon)).forEach((e=>{const{domain:n,favicon:o,hq:a}=e;t.library.domains[n]=t.library.domains[n]||{},a?t.library.domains[n].faviconHq=o:t.library.domains[n].favicon=o}))}))},isUpvoted(e){const n=this._recipeHash(e);return t.state.library.upvotedRecipes.includes(n)},upvote(e){if(this.isUpvoted(e))return;const n=this._recipeHash(e);t.transaction((e=>{e.library.upvotedRecipes.push(n)}))},get recipeIdeaCardView(){return t.state.library.recipeIdeaCard.view},_recipeHash:e=>`${e.id}:${e.title}`})})(),(()=>{const{$library:e}=n;e.recipeIdeaCardModel=()=>({view:"link",domain:"",domainError:null,suggestion:"",suggestionError:null,email:"",emailError:null,emailWarning:null})})(),(()=>{const{$library:e,$env:t}=n;e.libraryRecipes=()=>{const e=t.is.desktop?"desktop":"extension";return[{id:"mentions",title:"Brand and Social Mentions",domains:["mention","notify","mediatoolkit","f5bot","mentionlytics","reddit","instagram","facebook","twitter","youtube","medium","ycombinator","alternativeto"],tags:["marketing","pr","media","social","forums","press"],favicon:"mentions.png",desc:"Monitor the Web, online and social media for @mentions of your brand, social profiles or competitors.",info:["This recipe does the routine part of looking for @mentions of your brand for you, so that you focus on uncovering trends in conversations and communicating back with your audience.","It monitors all major web sources to find new conversations that @mention your brand, including:","* Social networks: Twitter, Facebook and Instagram","* Online media platforms","* Blogs and forums","* Press articles","* Review sites","Listen to your audience, pinpoint important conversations or analyze your competitors. You can also add custom mention sources to monitor."]},{id:"contact-details",title:"Contact Details Extractor",domains:["contact-details"],tags:["marketing","leads"],favicon:"contact-details.png",desc:"Extract contact details from any website to quickly generate leads for marketing and sales teams.",info:["This recipe can crawl any website and extract the following contact information for individuals listed on the website:","* Email addresses","* Phone numbers (from phone links or extracted from text)","* LinkedIn profiles","* Twitter handles","* Instagram profiles","* Facebook user profiles or pages"]},{id:"facebook-page-export",title:"Facebook Page Export",domains:["facebook"],tags:["smm","social","marketing","export"],desc:"This recipe extracts publicly available data from Facebook Pages. It can download posts, likes, comments, reviews, contact details, social media profiles, address etc.",info:["The following publicly available data can be extracted:","* Posts, comments and reviews","* Likes count","* Address","* Instagram and Twitter profile","* Website","* Services","* Messenger URL","* Telephone number","* Check-ins","* All other public text information such as price range, mission, awards etc","All data is downloadable in JSON, CSV and XML forms."]},{id:"linkedin-lead-export",title:"LinkedIn Lead Export",domains:["linkedin"],tags:["leads","sales","export"],desc:"Extract, clean & enrich leads from LinkedIn Sales Navigator in a few clicks.",info:["This recipe generates leads for your business by searching through LinkedIn Sales Navigator. It can:","* Extract leads from LinkedIn and enrich data with profiles and company info","* Cleanup data for your CRM or Cold Outreach campaigns","* Filter leads by detecting those that dont match with your Sales Navigator search filters","* Find lead emails by connecting to your email finder"]},{id:"google-maps-export",title:"Google Maps Export",domains:["google"],tags:["maps","geo","export"],favicon:"google-maps.ico",desc:"Export or monitor reviews, photos, prices, opening hours, popular times, ratings from Google Maps.",info:["This recipe enables you to monitor specific places or extract the following information on multiple places from the Google Maps service:","* Title, subtitle, category, place ID, and URL","* Address, location, code and coordinates","* Phone and website if available","* Menu and price if available","* Temporarily or permanently closed status","* Popular times - histogram & live occupancy","* Average rating, review count, and review distribution","* List of images","* List of detailed characteristics","* Opening hours","* People also search","This recipe also supports extracting all the detailed information about reviews:","* Review text, stars and published date","* Response from owner including text and published date","* Review ID & URL"]},{id:"instagram-analytics",title:"Instagram Analytics",domains:["instagram"],tags:["smm","social","marketing","analytics"],desc:"Compile Instagram profile and post analytics reports: unfollowers and new follower lists, ghost, churning and spam followers, secret admirers, best and worst performing hashtags and more.",info:["This recipe is designed to access publicly available data that was removed from the Instagram API in 2020 and enables anyone to extract this data from Instagram:","* Instagram account followers and unfollowers","* Spam followers","* Ghost followers - accounts that follow you but do not engage with your profile","* Churning followers - accounts that have stopped engaging with your profile","* Secret admirers - accounts that engage with your profile but do not follow you","* Mutual and unilateral followers","* Your content posts and hashtags ranked by performance","* Post likes and comments","* Places / locations posts","You can use this recipe to get data on any public account, including yours. All data is downloadable in JSON, CSV and XML forms."]},{id:"instagram-growth",title:"Instagram Growth Bot",domains:["instagram"],tags:["smm","social","marketing","automation"],desc:"Automate your Instagram profile engagement: auto-like, follow and watch stories to grow your account. Retain and regain lost followers and monitor comments.",info:["This all-in-one profile engagement automation recipe for Instagram can be used to build up, retain and regain your followers base:","* Gain new followers by automatically finding Instagram users that might be interested in your Profile content, like or follow their content and convert into followers","* Regain lost followers by detecting and engaging with churning Instagram followers that have recently unfollowed you or stopped engaging with your account","* Unfollow mass-followers and spammy accounts who have followed and then unfollowed your profile","* Watch stories from your feed or from accounts that have liked your posts recently","* Auto-like posts from your home feed, hashtags, locations, users or followers","* Periodically check your recent profile posts to gather and promptly reply to new comments"]},{id:"instagram-export",title:"Instagram Export",domains:["instagram"],tags:["smm","social","marketing","export"],desc:"Export Instagram posts from any public Instagram account, hashtag or location pages.",info:["Use this recipe to download Instagram posts and post metadata. You can download all posts from a page or filter posts by a set of conditions.","This recipe can automatically detect new posts on a page and download them periodically."]},{id:"instagram-chatbot",title:"Instagram Chatbot",domains:["instagram"],tags:["smm","social","marketing","chatbot"],desc:"Setup an Instagram chatbot to send welcome and farewell DMs, send DMs to multiple accounts, run Instagram DM campaigns or send keyword-driven auto-replies.",info:["This recipe watches incoming Instagram DMs and sends out direct messages:","* A welcoming DM whenever an Instagram user starts a new DM chat with you","* A farewell DM whenever an Instagram user unfollows your account","* A bulk DM message to multiple Instagram accounts, all of your followers or recent unfollowers","This recipe does not require a Business Instagram account to operate and can be used to build complex Instagram chatbots."]},{id:"job-monitor",title:"Job Monitor",domains:["glassdoor","indeed"],tags:["jobs","hr"],desc:"Monitor jobs posted on indeed.com and glassdoor.com websites and export detailed job information and company reviews from the portals.",info:["This recipe allows you to extract information about all positions on indeed.com and glassdoor.com job portals and can scrape the following data:","* New vacancies by keyword, location, salary and company","* Reviews of a given company","* An average salary of a job or position in a given area","Specify the search based on location and get jobs with position, location and description."]},{id:"real-estate-monitor",title:"Real-Estate Monitor",domains:["zillow"],tags:["real-estate","property","rent"],desc:"Extract data about all properties for sale and rent on Zillow.com",info:["This recipe lets you extract data from real estate listings on Zillow.com.","It enables you to search for, watch and monitor properties in any location and extract detailed information, such as:","* Full addresses","* Longitude / latitude","* Price","* Description","* URL","* Photos","* Number of bedrooms and bathrooms etc"]},{id:"seo-audit",title:"SEO Audit",domains:["semrush","seoptimer"],tags:["seo","audit","reports"],favicon:"seo-audit.png",desc:"Carry out a SEO audit of any website. Find broken links, missing images, and get information about possible page improvements.",info:["Search Engines rely on many factors to rank a website. This recipe reviews these factors to help identify problems that could be holding your site back from itâ€™s potential.","The following aggregated information is reported for your website:","* On-Page SEO rank","* Broken Links","* Usability score","* Performance score","* Social score","In addition, for every crawled page the following information is retrieved:","* URL of page","* Title of page","* Check if Google Analytics object is included in the page","* Check if Google Analytics function is included in the page","* Check if page has meta tag with charset attribute","* Check if page has meta description","* Value from meta description","* Check if length of meta description is long enough","* Check if doctype is included in page","* Check if title element is included in page","* Check if title is long enough","* Check if H1 element is present on page","* Value from H1 element","* Check that there is only one H1 on page","* Check if H2 element is present on page","* Number of links on page","* Check if there are enough links on page","* List of no-follow links on page","* Number of no-follow links on page","* List of unoptimized images (does not include alt tag)","* Number of unoptimized images","* Number of words on page","* Check if content is long enough","* Check if meta tag viewport is set on page","* Check if amp tag is set on page","* Check that there is no iframe","* List of broken links on page","* Number of broken links on page","* List of broken images on page","* Number of broken image links on page","* Data from JSON-LD specifications","* Data from microdata specifications","All of the data is downloadable for further study in a JSON, CSV and XML formats or as a PDF report."]},{id:"serp-monitor",title:"Search Results Monitor",domains:["google","bing","yahoo","yandex"],tags:["seo","serp","google","bing","yahoo","yandex","keywords"],favicon:"google.ico",desc:"Monitor Google, Bing, Yahoo, Yandex Search Engine Results Pages (SERPs), track your website search rank or extract organic and paid results, ads, queries, prices and reviews.",info:["This recipe crawls Search Results Pages (SERPs) on Google, Bing, Yahoo and/or Yandex and extracts data from the HTML in a structured format.","The following data can be extracted:","* A custom website rank or search position","* Organic results","* Ads and Product ads","* Related queries","* People also ask","* Review rating and review count","* Prices","This recipe supports custom country or language and extraction of custom attributes. All data can be downloaded as JSON, CSV and XML."]},{id:"accommodation-finder",title:"Accommodation Finder",domains:["airbnb","booking"],tags:["travel","hotel","rooms","accommodation"],desc:"Watch accommodation prices and extract data from airbnb.com and booking.com",info:["This recipe extracts accommodation data from airbnb.com and booking.com.","You can monitor a single property or a whole area, apply flexible search parameters, monitor prices, run multiple search queries in a parallel to quickly plan your trip with this recipe.","All results can be exported to JSON, CSV or XML for further analysis."]},{id:"airline-ticket-finder",title:"Airline Ticket Finder",domains:["aviasales","skyscanner","fly-scanner","kayak"],tags:["travel","tickets","airlines","monitor"],desc:"Find and watch for best deals on airline tickets using flexible search parameters.",info:["This recipe finds the best airline tickets for you on skyscanner.com, kayak.com, aviasales.com, fly-scanner.com.","You can set flexible search parameters: date and cost ranges, stops, stopover duration, journey duration, baggage etc.","Airline ticket finder re-runs the search periodically to catch better deals for you."]},{id:"tripadvisor-export",title:"Tripadvisor Export",domains:["tripadvisor"],tags:["travel","export"],desc:"Extract data from Tripadvisor on restaurants and hotels. Get reviews, pricing, contact details, amenities, awards.",info:["Get data on restaurants and hotels from TripAdvisor fast and easy with this recipe. It is suitable for extracting TripAdvisor reviews, emails, addresses, awards and many more attributes of hotels and restaurants.","You can extract data by location or a single place name, hotel or restaurant."]},{id:"twitter-export",title:"Twitter Export",domains:["twitter"],tags:["smm","social","marketing","export"],desc:"Export Twitter user profiles including tweets, retweets, replies, favorites, and conversation threads.",info:["This recipe extracts publicly available data from Twitter profiles:","* User information, including name, Twitter handle (username), location, follower/following count, profile URL/image/banner, date of creation","* List of tweets, retweets, and replies from profiles","* Statistics for each tweet: favorites, replies, and retweets for each tweet","* Search hashtags, get top, latest, people, picture, or video tweets","This recipe can fetch information from a list of Twitter handles or Twitter page URLs."]},{id:"youtube-export",title:"Youtube Export",domains:["youtube"],tags:["video","blogging","marketing","export"],desc:"Export Youtube videos data: channel name, likes, number of views and number of subscribers etc. Crawl videos by keyword, URL or channel name.",info:["YouTube export recipe can extract data from keyword search results, retrieve detailed videos data including likes count and channel name, download captions and comment sections.","* Crawl videos by specifying multiple search keywords, channel name or URLs","* Export channel details: username, description, number of subscribers etc","* Export YouTube subtitles and captions","* Export YouTube comment section"]}].filter((t=>!t.platform||t.platform===e)).map((e=>({...e,comingSoon:!0})))},e.favicons=()=>({airbnb:"/img/favicons/airbnb.ico",aviasales:"/img/favicons/aviasales.ico",bing:"/img/favicons/bing.ico",facebook:"/img/favicons/facebook.ico",glassdoor:"/img/favicons/glassdoor.ico",google:"/img/favicons/google.ico",indeed:"/img/favicons/indeed.ico",instagram:"/img/favicons/instagram.ico",linkedin:"/img/favicons/linkedin.ico",tripadvisor:"/img/favicons/tripadvisor.ico",twitter:"/img/favicons/twitter.ico",yahoo:"/img/favicons/yahoo.ico",yandex:"/img/favicons/yandex.png",youtube:"/img/favicons/youtube.png",zillow:"/img/favicons/zillow.ico"})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$journal:a,$ui:r,$utils:i}=n;a.Controls=r.component("JournalControls",{get events(){return a.proxy.events},get periodItems(){return[{id:"today",label:"Today"},{id:"yesterday",label:"Yesterday"},{id:"last-24-hours",label:"Last 24 hours"},{id:"last-week",label:"Last week"},{id:"last-month",label:"Last month"},{id:"all-time",label:"All time"}]},get eventTypeItems(){return[{id:"system",label:"System events"},{id:"task-management",label:"Task management"},{id:"task-results",label:"Results"},{id:"action",label:"Actions"}]},get eventTypeText(){const e=a.proxy.filterTypes;if(0===e.length)return"Show nothing";const t=this.eventTypeItems;if(e.length===t.length)return"All event types";if(1===e.length){return t.filter((t=>t.id===e[0]))[0].label}return`${e.length} event types`},render(){const{c:t}=this;return e(1,"row",t.block,[this.renderPeriodDropdown(),this.renderEventTypeDropdown(),this.renderSyncToGsheet(),this.renderDownloadCsv(),this.renderClearJournal()],0,{"y-center":!0})},renderPeriodDropdown(){const{c:e}=this;return t([o(2,r.Dropdown,{class:e.periodDropdown,items:this.periodItems,value:a.proxy.filterPeriod,stretchMenu:!0,onChange:e=>{a.proxy.filterPeriod=e.id}}),o(2,r.Spacer,{width:"g2"})],4)},renderEventTypeDropdown(){const{c:e}=this;return t([o(2,r.Dropdown,{class:e.eventTypeDropdown,menuClass:e.eventTypeDropdown,stretchMenu:!0,keepOpenOnChange:!0,text:this.eventTypeText,items:this.eventTypeItems,renderer:t=>o(2,r.Checkbox,{class:e.eventTypeCheckbox,containerClass:e.eventTypeCheckboxContainer,label:t.label,value:a.proxy.filterTypes.includes(t.id),onChange:()=>{a.proxy.filterTypes=i.array.toggle(a.proxy.filterTypes,t.id)}})}),o(2,r.Spacer,{grow:!0})],4)},renderSyncToGsheet:()=>null,renderDownloadCsv:()=>null,renderClearJournal(){return 0===this.events.length?null:t([o(2,r.Spacer,{width:"g3"}),o(2,r.Button,{type:"small",status:"secondary",label:"CLEAR JOURNAL",icon:"remove",onClick:this.onClearJournalClick})],4)},onSyncToGsheetClick(){throw new Error("synching to gsheet it not implemented")},onDownloadCsvClick(){throw new Error("downloading csv is not implemented")},onClearJournalClick(){a.proxy.clearEvents()}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$journal:t,$ui:o}=n;t.Header=o.component("JournalHeader",{get filterValue(){return t.proxy.filterString},get filterIconStyle(){return t.proxy.filterString?{color:o.getColor("action-primary"),"margin-left":"2px"}:{color:o.getColor("sublime"),"margin-left":"2px"}},get resetButton(){return t.proxy.filterString?{label:"RESET",type:"link",onClick:this.onResetFilterClick}:null},render(){const{c:t}=this;return e(2,o.ScreenHeader,{class:t.block,icon:"journal",title:"Journal",subtitle:"Events and actions performed by HARPA",childrenAlign:"bottom",children:this.renderFilter()})},renderFilter(){const{c:t}=this;return e(2,o.Input,{class:t.filterInput,placeholder:"Filter events",icon:"filter",value:this.filterValue,iconStyle:this.filterIconStyle,button:this.resetButton,onInput:this.onFilterStringChange})},onFilterStringChange(e){t.proxy.filterString=e},onResetFilterClick(){t.proxy.filterString=""}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$journal:o,$ui:a,$utils:r}=n;o.List=a.component("JournalList",{get events(){const e=o.proxy.filters;let t=o.proxy.events;const n=(e.filterString||"").trim().toLowerCase();if(n&&(t=t.filter((e=>!(!e.content||"string"!=typeof e.content||!e.content.toLowerCase().includes(n))||(!(!e.taskName||!e.taskName.toLowerCase().includes(n))||!(!e.ms||!r.time.formatRelativeDate(e.ms).toLowerCase().includes(n)))))),5!==e.types.length){const n={};e.types.forEach((e=>{n[e]=!0})),t=t.filter((e=>e.type&&n[e.type]))}if("all-time"!==e.period){const n="today"===e.period?(new Date).setHours(0,0,0,0):"yesterday"===e.period?(new Date).setHours(0,0,0,0)-r.time.DAY:"last-24-hours"===e.period?(new Date).getTime()-r.time.DAY:"last-week"===e.period?(new Date).getTime()-r.time.WEEK:"last-month"===e.period?(new Date).getTime()-r.time.MONTH:null;n&&(t=t.filter((e=>e.ms>n)))}return t},render(){const{c:n}=this;return e(1,"column",n.block({notFound:0===this.events.length}),[this.events.map(this.renderEvent),0===this.events.length&&t(2,a.NotFound,{text:"No events found"})],0)},renderEvent(e){const{c:n}=this,o=`${e.type}:${e.taskId}:${e.ms}`;return t(2,a.JournalItem,{class:n.item,ms:e.ms,status:e.status,statusColor:e.statusColor,code:e.code,color:e.color,loading:e.loading,content:e.content,options:e.options,taskIcon:e.taskIcon,taskName:e.taskName,bgIcon:e.bgIcon},o)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$journal:o,$ui:a}=n;o.Screen=a.component("JournalScreen",{render(){const{c:n}=this;return e(1,"column",n.block,[t(2,a.Spacer,{height:"g2"}),t(2,o.Header),t(2,a.Spacer,{height:"g2"}),t(2,o.Controls),t(2,a.Spacer,{height:"g2"}),t(2,a.Scroll,{children:t(2,o.List)})],4)}})})(),(()=>{const{$journal:e,$store:t,$task:o,$utils:a}=n;e.proxy=t.createProxy({get events(){return t.state.journal.events},get filters(){return t.state.journal.filters},get filterString(){return t.state.journal.filters.filterString},set filterString(e){t.transaction((t=>{t.journal.filters.filterString=e}))},get filterPeriod(){return t.state.journal.filters.period},set filterPeriod(e){t.transaction((t=>{t.journal.filters.period=e}))},get filterTypes(){return t.state.journal.filters.types},set filterTypes(e){t.transaction((t=>{t.journal.filters.types=e}))},dropOldEvents(e){this.events.length<=e||t.transaction((t=>{t.journal.events=t.journal.events.slice(0,e)}))},clearEvents(){t.transaction((e=>{e.journal.events=[]}))},logTaskCreated(e){this.addEvent({type:"task-management",code:"created",content:"Task created",task:e})},logTaskDeleted(e){this.addEvent({type:"task-management",code:"deleted",content:"Task deleted",task:e})},logTaskEnabled(e){this.addEvent({type:"task-management",code:e.enabled?"run":"stopped",content:e.enabled?"Task started":"Task stopped",task:e})},logJobFinished(e,t){this.addEvent({type:"task-results",code:t.status,color:t.color,content:t.info,task:e})},logActionsRun(e,t,n=!1){if(!t||0===e.length)return;const o=a.unique(e.map((e=>e.type))).join(", ");this.addEvent({type:"action",code:"alert",content:n?`Silenced actions: ${o}`:`Dispatched actions: ${o}`,task:t})},addEvent(e){e.ms||(e.ms=Date.now()),e.task&&(e.taskId=e.task.id,e.taskName=e.task.name||o.proxy.recipeTitle(e.task),delete e.task),t.transaction((t=>t.journal.events.unshift(e)))}})})(),(()=>{const{$idb:e,$env:t,$utils:o}=n;e.controller={async init(){e.read=this._enqueue(this._read.bind(this)),e.readAllKeys=this._enqueue(this._readAllKeys.bind(this)),e.write=this._enqueue(this._write.bind(this)),t.is.bg&&(e.delete=this._enqueue(this._delete.bind(this)),e.clear=this._enqueue(this._clear.bind(this)),e.onWrite=this._onWrite.bind(this),e.onStorageExceeded=this._onStorageExceeded.bind(this)),(t.is.bg||window.top===window.self)&&(this._db=await this._initDb("harpa")),this._queuePromise=Promise.resolve(),this._writeHandlers=[],this._storageExceededHandlers=[],navigator.storage.persist&&await navigator.storage.persist(),this._getReadyPromise().resolve()},async waitForReady(){await this._getReadyPromise()},_getReadyPromise(){return this._readyPromise||(this._readyPromise=o.createPromise()),this._readyPromise},async _read(e,t=null){return this._db?new Promise(((n,o)=>{let a;try{a=this._db.transaction("data","readonly").objectStore("data").get(e)}catch(t){console.error("[$idb] failed to read key",{key:e,error:t}),o(a.error)}a.onsuccess=e=>{n(e.target.result??t)},a.onerror=()=>{console.error("[$idb] failed to read key",{key:e,error:a.error}),o(a.error)}})):t},async _write(e,t){if(this._db){await new Promise(((n,o)=>{const a=this._db.transaction("data","readwrite");let r;try{r=a.objectStore("data").put(t,e)}catch(t){console.error("[$idb] failed to write key",{key:e,error:t}),o(t)}a.oncomplete=()=>{n()},r.onerror=()=>{const t=r.error;console.error("[$idb] failed to write key",{key:e,error:t}),o(t)},a.onabort=async()=>{const t=a.error;if("QuotaExceededError"===t.name)for(const e of this._storageExceededHandlers)await e();console.error("[$idb] failed to write key",{key:e,error:t}),o(t)}}));for(const e of this._writeHandlers)await e()}},async _delete(e){if(!t.is.bg)throw new Error("$idb.delete is accessible only in bg");if(this._db)return new Promise(((t,n)=>{let o;try{o=this._db.transaction("data","readwrite").objectStore("data").delete(e)}catch(t){console.error("[$idb] failed to delete key",{key:e,error:t}),n(t)}o.onsuccess=()=>{t()},o.onerror=()=>{console.error("[$idb] failed to delete key",{key:e,error:o.error}),n(o.error)}}))},async _clear(){if(!t.is.bg)throw new Error("$idb.delete is accessible only in bg");if(this._db)return new Promise(((e,t)=>{let n;try{n=this._db.transaction("data","readwrite").objectStore("data").clear()}catch(e){console.error("[$idb] failed to clear idb",{error:e}),t(e)}n.onsuccess=()=>{e()},n.onerror=()=>{console.error("[$idb] failed to clear idb",{error:n.error}),t(n.error)}}))},async _readAllKeys(){return this._db?new Promise(((e,t)=>{let n;try{n=this._db.transaction("data","readonly").objectStore("data").getAllKeys()}catch(e){console.error("[$idb] failed to read all keys",{error:e}),t(e)}n.onsuccess=t=>{const n=t.target.result;e(n)},n.onerror=()=>{const e=n.error;console.error("[$idb] failed to read all keys",{error:e}),t(e)}})):[]},_enqueue(e){return async(...t)=>{const n=this._queuePromise,a=o.createPromise();this._queuePromise=a,await n;const r=await e(...t);return a.resolve(r),r}},async _onStorageExceeded(e){if(!t.is.bg)throw new Error("$idb.onStorageExceeded is accessible only in bg");this._storageExceededHandlers.push(e)},async _onWrite(e){if(!t.is.bg)throw new Error("$idb.onWrite is accessible only in bg");this._writeHandlers.push(e)},_initDb:async e=>new Promise(((t,n)=>{const o=indexedDB.open(e,1);o.onupgradeneeded=e=>{e.target.result.createObjectStore("data")},o.onsuccess=e=>{t(e.target.result)},o.onerror=()=>{const e=o.error;console.error("[$idb] failed to open idb",{error:e}),n(e)}}))}})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,normalizeProps:a}=n.$inferno,{$harpa:r,$critical:i,$creator:s,$dashboard:l,$library:c,$journal:d,$redactor:u,$sandbox:p,$settings:h,$snackbar:m,$shell:g,$env:y,$utils:b,$peeker:f,$news:w,$ui:k}=n;r.App=k.component("HarpaApp",{state:()=>({hovered:!1}),get pageType(){return i.proxy.pageType},get mainScreen(){return r.proxy.mainScreen},async didMount(){const e=b.string.toCamelCase(i.proxy.pageType);document.documentElement.classList.add("Page"),document.documentElement.classList.add(`Page_${e}`)},render(){const{c:t}=this;return e(1,"column",t.block,[this.renderContent(),this.renderShellQuitDialog()],0,{"full-height":!0})},renderContent(){const{c:t,state:n}=this;return"sandbox"===this.pageType?o(2,p.Screen):"shell-header"===this.pageType?o(2,g.Header):"shell-error"===this.pageType?o(2,g.ErrorPage):"shell-new-tab"===this.pageType?o(2,g.NewTabPage):"shell-omnibox"===this.pageType?o(2,g.Omnibox):"shell-find"===this.pageType?o(2,g.FindInPage):"popup"===this.pageType?a(e(1,"column",t.body,o(2,s.Screen,{showHomeButton:n.hovered}),2,{...k.hoverState(this),"full-size":!0})):"main"===this.pageType?e(1,"row",this.c.body,this.renderMainScreenBody(),0,{"full-size":!0}):void 0},renderSidePanel:()=>o(2,r.SidePanel),renderMainScreenBody(){const{mainScreen:e}=this,n=e=>o(2,k.Scroll,{children:e}),a=!["journal","library"].includes(e)&&o(2,f.Panel),i=n(o(2,"journal"===e?d.Screen:"library"===e?c.Screen:l.Screen));return t([o(2,r.SidePanel),o(2,w.Panel),o(2,h.Panel),a,i,o(2,u.PanelOverlay),o(2,m.Container)],0)},renderShellQuitDialog:()=>y.is.desktop?o(2,g.QuitDialog):null})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$harpa:t,$ui:o,$library:a,$dashboard:r}=n;t.DomainButton=o.component("HarpaDomainButton",{props:()=>({domain:String,size:String,onClick:Function}),get mainScreen(){return t.proxy.mainScreen},get screen(){return`domain:${this.props.domain}`},get selected(){return this.mainScreen===this.screen},get favicon(){return a.proxy.domainFavicon(this.props.domain)||""},get size(){return this.props.size},get screenTasks(){return r.proxy.getScreenTasks(this.screen)},get marker(){let e=this.screenTasks.map((e=>e.records.at(-1)?.color)).filter((e=>e));return 0===e.length?null:e.includes("positive")?"positive":e.includes("negative")?"negative":e.includes("error")?"error":Array.from(e)[0]},get number(){const e=r.proxy.selectedTasksSet;return 0===e.length?0:this.screenTasks.filter((t=>e.has(t.id))).length||null},render(){return e(2,t.SidePanelButton,{mainScreen:this.screen,selected:this.selected,icon:this.favicon,size:this.size,marker:this.marker,number:this.number,onClick:this.onClick})},onClick(e){this.props.onClick?this.props.onClick(e):t.proxy.mainScreen=t.proxy.mainScreen===this.screen?"dashboard":this.screen}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$harpa:a,$ui:r,$store:i}=n;a.NavHeader=r.component("HarpaNavHeader",{props:()=>({onBackButtonClick:Listener,nameButtonIcon:String,nameButtonLabel:String,onNameButtonClick:Listener,class:Class}),icons:{config:'<svg width="18" height="18" viewBox="0 0 18 18"><path d="M20.25,12.536V9.964H18.856a7.786,7.786,0,0,0-.374-1.406l1.205-.7L18.4,5.637l-1.205.7A7.775,7.775,0,0,0,16.168,5.3l.7-1.205L14.637,2.813l-.7,1.205a7.469,7.469,0,0,0-1.406-.374V2.25H9.964V3.644a7.786,7.786,0,0,0-1.406.374l-.7-1.205L5.637,4.1l.7,1.205A7.775,7.775,0,0,0,5.3,6.332L4.1,5.637,2.813,7.863l1.205.7a7.469,7.469,0,0,0-.374,1.406H2.25v2.571H3.644a7.786,7.786,0,0,0,.374,1.406l-1.205.7L4.1,16.863l1.205-.7A7.775,7.775,0,0,0,6.332,17.2l-.7,1.205,2.226,1.286.7-1.205a7.469,7.469,0,0,0,1.406.374V20.25h2.571V18.856a7.786,7.786,0,0,0,1.406-.374l.7,1.205L16.863,18.4l-.7-1.205A7.775,7.775,0,0,0,17.2,16.168l1.205.7,1.286-2.226-1.205-.7a7.469,7.469,0,0,0,.374-1.406Zm-9-2.571A1.286,1.286,0,1,1,9.964,11.25,1.284,1.284,0,0,1,11.25,9.964ZM6.638,14.746a5.774,5.774,0,0,1-1.173-3.5,6.132,6.132,0,0,1,.044-.723l1.884.687v.036a3.863,3.863,0,0,0,.534,1.961ZM8.273,8.8,6.388,8.112a5.779,5.779,0,0,1,3.576-2.5v2A3.886,3.886,0,0,0,8.273,8.8Zm2.977,8.237A5.747,5.747,0,0,1,8.606,16.4L9.9,14.862a3.863,3.863,0,0,0,2.708,0l1.29,1.535A5.747,5.747,0,0,1,11.25,17.036Zm1.286-9.422v-2a5.779,5.779,0,0,1,3.576,2.5L14.227,8.8A3.886,3.886,0,0,0,12.536,7.614Zm3.327,7.132-1.29-1.535a3.863,3.863,0,0,0,.534-1.961v-.036l1.884-.687a6.132,6.132,0,0,1,.044.723A5.774,5.774,0,0,1,15.863,14.746Z" transform="translate(-2.25 -2.25)" fill="currentColor"/></svg>',help:'<svg width="17.996" height="18.002" viewBox="0 0 17.996 18.002"><g transform="translate(-0.582 0.002)"><path d="M18086.582,18856a9,9,0,1,1,9-9A9.01,9.01,0,0,1,18086.582,18856Zm0-16a7,7,0,1,0,7,7A7.009,7.009,0,0,0,18086.582,18840Z" transform="translate(-18077 -18838)" fill="currentColor"/><g transform="translate(-0.418)"><circle cx="1.02" cy="1.02" r="1.02" transform="translate(8.98 12.57)" fill="currentColor"/><path d="M179.264,128.5A3.267,3.267,0,0,0,176,131.764a.816.816,0,0,0,1.632,0,1.632,1.632,0,1,1,1.632,1.632.816.816,0,0,0-.816.816v2.04a.816.816,0,1,0,1.632,0v-1.327a3.264,3.264,0,0,0-.816-6.424Z" transform="translate(-169.264 -125.109)" fill="currentColor"/></g></g></svg>'},render(){const{c:n,props:a}=this;return e(1,"row",[n.block,a.class],[a.nameButtonLabel&&e(1,"row",n.headerName({clickable:a.onNameButtonClick}),[a.nameButtonIcon&&o(2,r.Icon,{class:n.headerNameIcon,name:a.nameButtonIcon}),a.nameButtonLabel],0,{"y-center":!0,onClick:a.onNameButtonClick}),a.onBackButtonClick&&t([o(2,r.Spacer,{width:1}),o(2,r.Button,{type:"link",status:"secondary",class:n.backButton,hitboxClass:n.navButtonHitbox({back:!0}),labelClass:n.backButtonLabel,icon:r.Icon.icons.back,label:"BACK",onClick:a.onBackButtonClick}),o(2,r.Spacer,{width:"g1h"})],4)],0,{"y-center":!0,"full-width":!0})},get themeIcon(){return"day"===i.state.theme?a.ThemeSwitch.icons.day:a.ThemeSwitch.icons.night},get configIcon(){return this.icons.config},get helpIcon(){return this.icons.help},onThemeClick(){r.theme.toggleTheme()}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$harpa:t,$ui:o,$env:a}=n;t.SandboxButton=o.component("HarpaSandboxButton",{icons:{sandbox:'<svg width="18.212" height="17.998" viewBox="0 0 18.212 17.998"><path d="M-5596.325-11311.245l2.847-1.068v2.853l2.275-.855v-2.85l3.415-1.28v10.243l-8.537,3.2Zm-9.675,7.042v-10.243l8.536,3.2V-11301Zm2.275-.815,2.278.853v-1.213l-2.278-.855Zm-2.275-10.567,9.107-3.414,9.1,3.414-3.42,1.284-3.409-1.528v.006l-2.275.969v0l3.406,1.4-3.406,1.28Z" transform="translate(5606 11319)" fill="currentColor"/></svg>'},render(){if(a.is.production)return null;const{c:n}=this;return e(2,t.SidePanelButton,{class:n.block,size:"small",icon:this.icon,onClick:this.onClick})},get icon(){return this.icons.sandbox},onClick(){const e=chrome.runtime.getURL("/harpa.html?sandbox");chrome.tabs.create({url:e,active:!0})}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$harpa:t,$ui:o,$settings:a}=n;t.SettingsButton=o.component("HarpaSettingsButton",{render(){const{c:n}=this;return e(2,t.SidePanelButton,{class:n.block,icon:"configure",iconProps:{size:19},size:"small",onClick:this.onClick})},onClick(){a.proxy.show=!a.proxy.show}})})(),(()=>{const{createVNode:e,createComponentVNode:t,normalizeProps:o}=n.$inferno,{$harpa:a,$ui:r,$utils:i,$library:s}=n;a.SidePanelButton=r.component("HarpaSidePanelButton",{props:()=>({icon:String,iconProps:Object,selected:Boolean,mainScreen:String,marker:String,number:Number,size:String,class:Class,onClick:Function}),defaultProps:{size:"normal"},render(){const{props:t,c:n}=this;return e(1,"column",[n.block({selected:t.selected,size:t.size}),t.class],[this.renderIcon(),this.renderMarker(),this.renderNumber()],0,{"x-center":!0,"y-center":!0,onMouseDown:this.onMouseDown})},renderIcon(){const{c:e,props:n}=this;return!n.icon||i.url.check(n.icon)||n.icon.startsWith("data:image")?t(2,s.Favicon,{class:e.icon({favicon:!0}),url:n.icon,size:24}):o(t(2,r.Icon,{class:e.icon,name:n.icon,...n.iconProps}))},renderMarker(){const{c:t,props:n}=this;if(!n.marker)return null;const o={"background-color":r.getColor(n.marker)};return e(1,"div",t.marker,null,1,{style:o})},renderNumber(){const{c:t,props:n}=this;return i.is.nil(n.number)?null:e(1,"row",t.number,n.number,0,{"x-center":!0})},onMouseDown(){this.props.onClick(this.props)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$harpa:a,$ui:r,$env:i,$dashboard:s,$news:l}=n;a.SidePanel=r.component("HarpaSidePanel",{get mainScreen(){return a.proxy.mainScreen},get domains(){return s.proxy.domains},render(){const{c:t}=this;return e(1,"column",t.block,[this.renderLogo(),e(1,"div",t.divider),o(2,a.SidePanelButton,{mainScreen:"dashboard",selected:"dashboard"===this.mainScreen,icon:r.ScreenHeader.icons.dashboard,onClick:this.onTabClick}),o(2,a.SidePanelButton,{mainScreen:"journal",selected:"journal"===this.mainScreen,icon:r.ScreenHeader.icons.journal,onClick:this.onTabClick}),i.features.library&&o(2,a.SidePanelButton,{mainScreen:"library",selected:"library"===this.mainScreen,icon:r.ScreenHeader.icons.library,onClick:this.onTabClick}),this.renderDomains(),o(2,r.Spacer,{grow:!0}),this.domains.length>3&&e(1,"div",t.divider({type:"bottom"})),o(2,r.Spacer,{height:4}),o(2,a.SandboxButton),o(2,a.SettingsButton),o(2,a.ThemeSwitch),o(2,r.Spacer,{height:10})],0)},renderLogo(){return t([o(2,r.Spacer,{height:"g2"}),e(1,"column",null,o(2,r.Icon,{name:r.Icon.icons.logo,color:l.proxy.show?"positive":"dim",size:32,onClick:this.onLogoClick}),2,{"x-center":!0}),o(2,r.Spacer,{height:"g2"})],4)},renderDomains(){if(0===this.domains.length)return null;const{c:n}=this;return t([e(1,"div",n.divider({type:"top"})),o(2,r.Scroll,{class:n.domains,children:this.domains.map((e=>o(2,a.DomainButton,{domain:e,onClick:this.onTabClick},e)))})],4)},onLogoClick(){l.proxy.show=!l.proxy.show},onTabClick(e){l.proxy.show=!1,e.mainScreen.startsWith("domain:")?a.proxy.mainScreen=a.proxy.mainScreen===e.mainScreen?"dashboard":e.mainScreen:a.proxy.mainScreen=e.mainScreen}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$harpa:o,$ui:a}=n;o.StaticLinks=a.component("HarpaStaticLinks",{props:()=>({class:Class,simple:Boolean}),icons:{chem:'<svg viewBox="0 0 213 236"><defs><clipPath id="a"><path transform="translate(1264 385)" fill="#fff" stroke="#707070" d="M0 0h213v236H0z"/></clipPath></defs><g transform="translate(-1264 -385)" clip-path="url(#a)"><path d="M1468.326 571.257v-33.943l13.825-13.71-4.821-4.879-13.048 12.962-25.4-12.655v-36.8l-32.777-16.446-29.379 14.721-29.417-14.721-29.542 14.721-26.091-13v-32.532l25.991-13 25.991 13v19.947h6.9v-24.213l-29.441-14.72V385h-6.9v30.989l-25.191 12.655-20.269-20.323-4.965 4.879 20.984 21.07v33.944l-13.595 13.709 4.936 4.879 12.876-12.962 25.224 12.655v36.8l33.009 16.446 29.5-14.72 29.47 14.72 29.34-14.72 25.89 13v32.536l-25.991 13-25.991-13v-19.952h-6.9v24.213l29.441 14.72v30.989h6.9v-30.988l25.425-12.655 20.437 20.323 4.764-4.879zm-95.223-52.225l-25.991 13-25.991-13V486.5l25.991-13 25.991 13zm58.882 0l-25.991 13-25.991-13V486.5l25.991-13 25.991 13z" fill="currentColor"/><path fill="currentColor" d="M1303.176 459.062h7.36v6.9h-7.36zM1420.94 562.106h7.36v6.9h-7.36zM1446.701 539.565h6.9v29.441h-6.9zM1328.937 488.043h6.9v29.441h-6.9z"/></g></svg>',web:'<svg viewBox="0 0 30 25"><path fill="none" d="M0 0h30v25H0z"/><path d="M10.387 10.978L7.366 6.33a9.806 9.806 0 0116.381 1.749l-8.119-.427a5.155 5.155 0 00-5.241 3.326zm1.3 1.522a3.306 3.306 0 103.308-3.306 3.3 3.3 0 00-3.308 3.306zm12.455-3.528l-5.525.285a5.185 5.185 0 01.261 6.217l-4.433 6.818a9.81 9.81 0 009.7-13.32zm-13.667 5.411L6.787 7.13a9.813 9.813 0 006.688 15.06l2.512-4.94a5.18 5.18 0 01-5.517-2.867z" fill="currentColor"/></svg>',windows:'<svg viewBox="0 0 30 25"><path fill="none" d="M0 0h30v25H0z"/><path d="M14.149 4.232q5.293-.81 10.6-1.539v9.294c-3.533.013-7.066.067-10.6.078q-.003-3.919 0-7.833zm-8.962 1.25a290.15 290.15 0 017.994-1.1q.006 3.857.006 7.71c-2.666 0-5.333.038-8 .031zm0 7.45c2.664-.009 5.328.034 7.992.029 0 2.577.007 5.153 0 7.73-2.659-.395-5.326-.738-7.992-1.1zm8.946.1h10.616q.007 4.634 0 9.271a787.588 787.588 0 00-10.6-1.5l-.016-7.772z" fill="currentColor"/></svg>',macos:'<svg viewBox="0 0 30 25"><path fill="none" d="M0 0h30v25H0z"/><g fill="currentColor"><path d="M20.946 12.733a4.779 4.779 0 012.281-4.024 4.932 4.932 0 00-3.864-2.091c-1.643-.168-3.209.968-4.045.968s-2.125-.945-3.487-.921A5.176 5.176 0 007.46 9.314c-1.867 3.234-.478 8.023 1.338 10.649.888 1.283 1.948 2.724 3.336 2.673 1.339-.053 1.844-.863 3.459-.863s2.073.867 3.488.841c1.441-.028 2.352-1.309 3.232-2.6a11.76 11.76 0 001.465-3.006 4.676 4.676 0 01-2.832-4.275zM18.285 4.881a4.656 4.656 0 001.1-3.375 4.73 4.73 0 00-3.113 1.6 4.429 4.429 0 00-1.121 3.269 3.918 3.918 0 003.134-1.494z"/></g></svg>',linux:'<svg viewBox="0 0 30 25"><path fill="none" d="M0 0h30v25H0z"/><path d="M15.504 24.587h-.117c-2.475 0-4.331-.64-5.516-1.9a5.663 5.663 0 01-1.41-3.018 10.132 10.132 0 01-.081-2.349c.009-.136.015-.234.013-.292-.007-.209-.117-.3-.355-.3a2.544 2.544 0 00-.353.036h-.013a2.622 2.622 0 01-.366.036.381.381 0 01-.377-.17c-.316-.581 1.2-3.552 2.2-5.518v-.007l.007-.014a14.533 14.533 0 00.9-1.913 3.421 3.421 0 000-.371v-.013a5.337 5.337 0 01.227-1.938 3.826 3.826 0 01-1.998-1.219 3.11 3.11 0 01-.749-2.023 3.243 3.243 0 01.871-2.244 3.287 3.287 0 012.462-.995h.038a6.594 6.594 0 013.462.954h-.013a6.656 6.656 0 01-.443.013 11.18 11.18 0 01-1.7-.137 2.473 2.473 0 00-.379-.03 2.644 2.644 0 00-1.521.488 1.781 1.781 0 00-.77 1.112 1.545 1.545 0 00.222 1.2 1.623 1.623 0 001.142.579 1.615 1.615 0 00.22.016 1.747 1.747 0 001.029-.4 2.678 2.678 0 011.547-.555h.106a2.046 2.046 0 011.628.66 2.048 2.048 0 011.629-.66h.106a2.679 2.679 0 011.547.555 1.747 1.747 0 001.029.4 1.905 1.905 0 001.359-.595 1.545 1.545 0 00.222-1.2 1.782 1.782 0 00-.771-1.106 2.644 2.644 0 00-1.523-.494 2.473 2.473 0 00-.38.029 11.185 11.185 0 01-1.7.137c-.284.002-.448-.012-.454-.012a6.606 6.606 0 013.464-.954h.035a3.287 3.287 0 012.459.995 3.243 3.243 0 01.875 2.244 3.11 3.11 0 01-.735 2.006 3.809 3.809 0 01-1.97 1.223 5.333 5.333 0 01.231 1.952 3.372 3.372 0 000 .379 14.533 14.533 0 00.906 1.917v.01c1 1.967 2.521 4.94 2.2 5.522a.382.382 0 01-.377.17 2.622 2.622 0 01-.366-.036h-.008a2.545 2.545 0 00-.353-.036c-.239 0-.348.093-.355.3 0 .057 0 .156.013.292a10.113 10.113 0 01-.081 2.347 5.665 5.665 0 01-1.41 3.018c-1.174 1.27-3.03 1.909-5.505 1.909zm-3.197-13.668h-.02a.711.711 0 00-.083.007c-.5.076-.465.557-.423 1.114a2.89 2.89 0 01-.088 1.241 22.923 22.923 0 00-1.252 4.194 5.783 5.783 0 00.42 4.014 3.2 3.2 0 001.21 1.16 6.65 6.65 0 003.159.688h.426a6.649 6.649 0 003.159-.688 3.205 3.205 0 001.21-1.16 5.779 5.779 0 00.42-4.014 22.9 22.9 0 00-1.256-4.19 2.9 2.9 0 01-.088-1.242c.042-.558.077-1.039-.423-1.115a.719.719 0 00-.11-.008 5.123 5.123 0 00-1.947.832l-.009.006h-.005a6.8 6.8 0 01-1.009.519l-.055.017a.3.3 0 01-.1.02.275.275 0 01-.094-.019l-.062-.02a6.835 6.835 0 01-1.021-.526h-.006a5.117 5.117 0 00-1.947-.832zm5.789-3.538a.779.779 0 10.779.779.78.78 0 00-.779-.779zm-5.305 0a.779.779 0 10.779.779.78.78 0 00-.783-.779z" fill="currentColor"/></svg>',ios:'<svg viewBox="0 0 30 25"><path d="M20.4 25H9.68A2.705 2.705 0 017 22.341V2.587A2.638 2.638 0 019.68 0H20.4a2.638 2.638 0 012.681 2.587v19.826A2.638 2.638 0 0120.4 25zm-5.359-2.791a.863.863 0 10.894.862.879.879 0 00-.894-.862zM12.959 7.8h-.033a3.29 3.29 0 00-2.763 1.683 5.326 5.326 0 00-.449 3.524 8.488 8.488 0 001.295 3.235c.616.895 1.238 1.7 2.065 1.7h.044a2.522 2.522 0 00.959-.259 2.819 2.819 0 011.228-.291 2.659 2.659 0 011.172.282 2.287 2.287 0 00.992.251h.041c.932-.018 1.522-.883 2.042-1.647a7.541 7.541 0 00.92-1.888l.006-.02h-.008a2.948 2.948 0 01-1.784-2.711 3 3 0 011.432-2.548l.01-.006a3.087 3.087 0 00-2.443-1.327 2.1 2.1 0 00-.214-.011 4.3 4.3 0 00-1.541.383 2.58 2.58 0 01-.8.236 2.528 2.528 0 01-.83-.24 3.707 3.707 0 00-1.341-.346zM17.7 4.526a2.972 2.972 0 00-1.967 1.016 2.8 2.8 0 00-.708 2.074c.042 0 .087.005.136.005A2.5 2.5 0 0017 6.668a2.965 2.965 0 00.7-2.142z" fill="currentColor"/><path fill="none" d="M0 0h30v25H0z"/></svg>',android:'<svg viewBox="0 0 30 25"><path fill="none" d="M0 0h30v25H0z"/><path d="M20.525 25H9.806a2.705 2.705 0 01-2.681-2.658V2.587A2.638 2.638 0 019.806 0h10.719a2.638 2.638 0 012.68 2.587v19.826A2.638 2.638 0 0120.525 25zm-5.358-2.791a.863.863 0 10.893.862.879.879 0 00-.893-.862zm-.77-6.465h1.728v1.726a.863.863 0 001.726 0v-1.726a1.3 1.3 0 001.295-1.294V9.7h-7.769v4.75a1.3 1.3 0 001.294 1.294v1.726a.863.863 0 001.726 0v-1.725zm6.04-6.04a.864.864 0 00-.863.863v3.452a.863.863 0 001.726 0v-3.452a.864.864 0 00-.863-.867zM10.083 9.7a.864.864 0 00-.863.863v3.452a.863.863 0 001.726 0v-3.448a.864.864 0 00-.863-.867zm3.019-5.173a.431.431 0 00-.385.624l.432.864a3.866 3.866 0 00-1.748 2.826v.431h7.742v-.431h-.024a3.868 3.868 0 00-1.748-2.826l.432-.864a.432.432 0 10-.772-.386l-.434.867-.112-.045a3.894 3.894 0 00-2.451 0l-.109.045-.433-.867a.43.43 0 00-.39-.238zm3.452 3.451a.431.431 0 11.431-.431.432.432 0 01-.431.431zm-2.588 0a.431.431 0 11.431-.431.432.432 0 01-.431.431z" fill="currentColor"/></svg>'},get themeIcon(){return"day"===o.proxy.theme?o.ThemeSwitch.icons.day:o.ThemeSwitch.icons.night},init(){this.infoLinks=[{label:"TERMS",url:"https://harpa.ai/terms"},{label:"PRIVACY POLICY",url:"https://harpa.ai/privacy"}],this.platformLinks=[{id:"web",url:"https://harpa.ai/standalone#web"},{id:"windows",url:"https://harpa.ai/standalone#windows"},{id:"macos",url:"https://harpa.ai/standalone#macos"},{id:"linux",url:"https://harpa.ai/standalone#linux"},{id:"ios",url:"https://harpa.ai/standalone#ios"},{id:"android",url:"https://harpa.ai/standalone#android"}]},render(){const{c:t}=this;return e(1,"div",[this.props.class,t.block({simple:this.props.simple})],[this.renderChem(),e(1,"div",t.links,[this.renderInfoLinks(),this.renderPlatformLinks()],0)],0)},renderChem(){const{c:e}=this;return t(2,a.Icon,{class:e.chem,name:this.icons.chem})},renderInfoLinks(){const{c:n}=this;return e(1,"row",n.infoLinks,[this.renderThemeIcon(),this.infoLinks.map((e=>t(2,a.Button,{class:n.link,buttonClass:n.linkButton,label:e.label,url:e.url,type:"link",status:"secondary",onClick:this.onLinkClick})))],0)},renderThemeIcon(){const{c:e}=this;return t(2,a.Icon,{name:this.themeIcon,class:e.headerIcon,hitbox:"small",onClick:this.onThemeClick})},renderPlatformLinks(){const{c:n}=this;return e(1,"row",n.platformLinks,this.platformLinks.map((e=>t(2,a.Button,{class:n.link({active:this.activePlatformId===e.id}),buttonClass:n.linkButton,leftIcon:this.icons[e.id],url:e.url,type:"link",status:"secondary",onClick:this.onLinkClick}))),0)},get activePlatformId(){return"macos"},onLinkClick(e){chrome.tabs.create({url:e.url,active:!0})},onThemeClick(){a.theme.toggleTheme()}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$harpa:t,$ui:o,$store:a}=n;t.ThemeSwitch=o.component("HarpaThemeSwitch",{icons:{night:'<svg width="20" height="20" viewBox="0 0 20 20"><g transform="translate(-40 -25)"><rect width="20" height="20" transform="translate(40 25)" fill="none"/><g transform="translate(38.75 23.75)"><path d="M9,0A8.622,8.622,0,0,0,7.884.07,8.994,8.994,0,1,0,9,0ZM2.25,9A6.758,6.758,0,0,1,6.329,2.8a9,9,0,0,0,6.465,11.783A6.751,6.751,0,0,1,2.25,9Z" transform="translate(2.25 2.25)" fill="currentColor"/></g></g></svg>',day:'<svg width="20.001" height="20.002" viewBox="0 0 20.001 20.002"><path d="M-6120.252,19613.75a1.239,1.239,0,0,1,1.25-1.25,1.236,1.236,0,0,1,1.25,1.25A1.238,1.238,0,0,1-6119,19615,1.241,1.241,0,0,1-6120.252,19613.75Zm6.251-2.5a1.239,1.239,0,0,1,1.25-1.25,1.239,1.239,0,0,1,1.25,1.25,1.239,1.239,0,0,1-1.25,1.25A1.239,1.239,0,0,1-6114,19611.25Zm-12.5,0a1.239,1.239,0,0,1,1.25-1.25,1.239,1.239,0,0,1,1.25,1.25,1.239,1.239,0,0,1-1.25,1.25A1.239,1.239,0,0,1-6126.5,19611.25Zm1.5-6.252a5.994,5.994,0,0,1,6-6,6,6,0,0,1,6,6,6,6,0,0,1-6,6A5.994,5.994,0,0,1-6125,19605Zm13.5,0a1.239,1.239,0,0,1,1.25-1.25,1.239,1.239,0,0,1,1.25,1.25,1.239,1.239,0,0,1-1.25,1.25A1.239,1.239,0,0,1-6111.5,19605Zm-17.5,0a1.239,1.239,0,0,1,1.25-1.25,1.239,1.239,0,0,1,1.25,1.25,1.239,1.239,0,0,1-1.25,1.25A1.239,1.239,0,0,1-6129,19605Zm15-6.246a1.241,1.241,0,0,1,1.25-1.252,1.241,1.241,0,0,1,1.25,1.252,1.24,1.24,0,0,1-1.25,1.25A1.24,1.24,0,0,1-6114,19598.752Zm-12.5,0a1.241,1.241,0,0,1,1.25-1.252,1.241,1.241,0,0,1,1.25,1.252,1.24,1.24,0,0,1-1.25,1.25A1.24,1.24,0,0,1-6126.5,19598.752Zm6.247-2.5a1.239,1.239,0,0,1,1.25-1.25,1.236,1.236,0,0,1,1.25,1.25,1.236,1.236,0,0,1-1.25,1.25A1.239,1.239,0,0,1-6120.252,19596.25Z" transform="translate(6129 -19595)" fill="currentColor"/></svg>'},render(){const{c:n}=this;return e(2,t.SidePanelButton,{class:n.block,size:"small",icon:this.icon,onClick:this.onClick})},get icon(){return"day"===a.state.theme?this.icons.day:this.icons.night},onClick(){o.theme.toggleTheme()}})})(),(()=>{const{$harpa:e,$env:t}=n;function o(e,n){return fetch(`${t.apiUrl}${e}`,{method:"POST",credentials:"include",headers:{"content-type":"application/json"},body:JSON.stringify(n)})}e.api={action:async e=>o("/action",e),feedback:async(e,t,n)=>o("/feedback",{source:"app:rate-us",message:e,email:t,rated:n})}})(),(()=>{const{$harpa:e,$store:t}=n;e.proxy=t.createProxy({get mainScreen(){return t.state.mainScreen},set mainScreen(e){t.transaction((t=>t.mainScreen=e))},get theme(){return t.state.theme},set theme(e){t.transaction((t=>t.theme=e))}})})(),(()=>{const{$env:e,$utils:t}=n;e.controller={init(){const n="undefined"==typeof location?"el":location.pathname.includes("bg.js")||location.pathname.includes("background_page.html")?"bg":location.pathname.includes("harpa.html")?"pp":chrome.runtime&&!chrome.tabs?"cs":"nj",o="el"===n?"desktop":"extension",a=(()=>{if("el"===n)return process.env.NODE_ENV;const e=t.ls.get("env.is");if(e)return e;return this.getManifest().env||"production"})();Object.assign(e,{env:a,locus:n,version:this.getManifest().version,versionNumber:this.getManifest().version.split(".").map(Number).reduce(((e,t)=>1e3*e+t),0),manifestVersion:this.getManifest().manifest_version,platform:this.getPlatform(),apiUrl:"https://api.harpa.ai/api/v1",webUrl:"https://harpa.ai",welcomeUrl:"https://harpa.ai/welcome",makeAppInviteUrl:"https://www.make.com/en/hq/app-invitation/c98499c16cfa22f1051f64346ef91aaa",extUrl:{reviews:"https://chrome.google.com/webstore/detail/eanggfilgoajaocelnaflolkadkeghjp/reviews"},mixpanel:{token:"7958323a20a869de3c57712bfe521a6f"},contactEmail:"contact@harpa.ai",contactUsUrl:"https://harpa.ai/#contact-us",discordUrl:"https://discord.gg/rPCMrnj7De",is:{pp:"pp"===n,bg:"bg"===n,el:"el"===n,cs:"cs"===n,nj:"nj"===n,test:"test"===a,beta:"beta"===a,production:"production"===a,development:"development"===a,desktop:"desktop"===o,extension:"extension"===o},features:this.initFeatures({debug:"development"===a||"beta"===a,taskImport:!0,taskExport:!0,library:!1,changesTracking:!1,actionsReporting:!1,doubleCheck:!1,emailActionFromField:!1}),options:{}})},initFeatures:(e={})=>new Proxy(e,{get(n,o){const a=e[o];return t.ls.get(`$env.features.${o}`,a)},set:(n,o,a)=>(e[o]=a,t.ls.set(`$env.features.${o}`,a),!0)}),getManifest(){if("undefined"==typeof chrome)return{name:"TEST",version:1};if(!chrome.runtime)return window.__harpaManifest__;const e=new URL(location.href).searchParams.get("manifest");return e?JSON.parse(e):chrome.runtime.getManifest()},getPlatform(){const e=navigator.platform.toLowerCase();return e.startsWith("mac")?"mac":e.startsWith("linux")?"linux":"win"}},e.controller.init()})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$editor:t,$task:o,$ui:a,$infernoMobx:r}=n;t.TaskProvider=a.component("EditorTaskProvider",{props:()=>({task:Object,ctx:Object,children:Children}),get task(){return this.props.task?this.props.task instanceof o.Adapter?this.props.task:o.Adapter.ofTask(this.props.task):null},get ctx(){return this.props.ctx||{}},render(){return e(2,r.Provider,{task:this.task,ctx:this.ctx,children:this.props.children})}})})(),(()=>{const{$editor:e}=n;e.taskMixin=({opts:e})=>{e.context=[...e.context||[],"task","ctx"],Object.defineProperty(e,"task",{get(){return this.props.task},enumerable:!0}),Object.defineProperty(e,"ctx",{get(){return this.props.ctx},enumerable:!0})}})(),(()=>{const{$editor:e}=n;function t(e,t,n,o){o=o||t,Object.defineProperty(e,o,{get(){return this.task.inputs[n]?.[o]},set(e){this.task.updateInput(n,{[o]:e})},enumerable:!0})}e.watcherMixin=({opts:e})=>{!function(e){const t=e=>{if("watcher.monitorElement"===e.recipeId)return"monitorElement";if("watcher.monitorHealth"===e.recipeId)return"monitorHealth";if("watcher.monitorPrice"===e.recipeId)return"monitorPrice";if("watcher.monitorChanges"===e.recipeId){const t=e.inputs["watcher.changes"].whatToMonitor;if("text"===t)return"monitorChangesText";if("html"===t)return"monitorChangesHtml";if("data"===t)return"monitorChangesData"}return null};Object.defineProperty(e,"triggerCondition",{get(){return this.task.inputs["watcher.trigger"][t(this.task)]},set(e){const n={[t(this.task)]:e};this.task.updateInput("watcher.trigger",n)},enumerable:!0})}(e),t(e,"whatToMonitor","watcher.changes"),t(e,"itemTypes","watcher.changes"),t(e,"pickup","watcher.price"),t(e,"n","watcher.price"),t(e,"anchorText","watcher.price"),t(e,"selector","watcher.element"),t(e,"selectorType","watcher.element"),function(e,t,n){Object.defineProperty(e,"pickupItems",{get:()=>n,enumerable:!0})}(e,0,[{id:"visually-largest",label:"visually largest price"},{id:"closest-to",label:"price closest to given text"},{id:"lowest",label:"lowest price"},{id:"highest",label:"highest price"},{id:"average",label:"average price"},{id:"median",label:"median price"},{id:"first",label:"first price"},{id:"last",label:"last price"},{id:"nth",label:"N-th price"}])}})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$recipe:i,$ui:s,$env:l,$bus:c}=n;r.ActionEmail=s.component("EditorActionEmail",{mixin:r.taskMixin,get actionTestStatus(){return this.task.actionTestStatus("email")},get actionTestMessage(){return this.task.actionTestMessage("email")},get to(){return this.task.input("actions").email.to},get toInfo(){return{tooltip:{content:[t([a("Comma or space-separated list of email addresses. Every email address will receive a separate notification email.")],4),t([a("Both short and long formats supported, e.g."),a(" "),e(1,"b",null,'"Johnny" <johnny.depp@gmail.com>, someone@mycompany.com',16)],0),t([a("You can use a dummy email service such as "),e(1,"b",null,"Temp-Mail.org",16),a(" to test email delivery.")],4)]}}},get customSmtpEnabled(){return this.task.input("actions").email.customSmtpEnabled},get customSmtpEnabledInfo(){return{tooltip:{content:[t([a("Turn this on if you'd like the emails to be delivered from your email address and server, e.g. your GMail account, and not the official HARPA email address.")],4),t([a("Consult your Email Service documentation for the configuration options.")],4),t([a('If you are using GMail, make sure to enable "Less secure apps" in the GMail security settings (might be unavailable based on the account type).')],4)]}}},get customSmtpFrom(){return this.task.input("actions").email.customSmtpFrom},get customSmtpFromInfo(){return{tooltip:{content:[t([a("Email address to put to the "),e(1,"b",null,"from",16),a(" field. Change this to your email address.")],4)]}}},get customSmtpHost(){return this.task.input("actions").email.customSmtpHost},get customSmtpHostInfo(){return{tooltip:{content:[t([a("Colon-separated email server name and port.")],4),t([a("For GMail that would be "),e(1,"b",null,"smtp.gmail.com:465",16),a(", for FastMail â€”"),a(" "),e(1,"b",null,"smtp.fastmail.com:465",16),a(", etc.")],0)]}}},get customSmtpUsername(){return this.task.input("actions").email.customSmtpUsername},get customSmtpUsernameInfo(){return{tooltip:{content:[t([a("SMTP server username.")],4),t([a("Usually, this would be your email address. HARPA stores your SMTP server login & password locally on the current machine.")],4)]}}},get customSmtpPassword(){return this.task.input("actions").email.customSmtpPassword},get customSmtpPasswordInfo(){return{tooltip:{content:[t([a("SMTP server password.")],4),t([a("Usually, this would be your email password. HARPA stores your SMTP server login & password locally on the current machine.")],4)]}}},render(){const{c:e}=this;return o(2,r.Action,{class:e.block,name:"email",children:[this.renderLimitsPanel(),this.renderControlPanel(),this.renderTestPanel()]})},renderLimitsPanel:()=>o(2,r.ActionLimitsPanel,{action:"email"}),renderControlPanel(){const{c:n}=this;return t([o(2,s.Input,{label:"to",placeholder:"e.g. johnny.depp@gmail.com",lines:2,info:this.toInfo,value:this.to,onChange:this.onToChange}),o(2,s.Spacer,{height:"g2"}),o(2,s.Checkbox,{label:"Use custom SMTP settings",info:this.customSmtpEnabledInfo,value:this.customSmtpEnabled,onChange:this.onCustomSmtpEnabledChanged}),e(1,"column",n.customSmtpSettings({enabled:this.customSmtpEnabled}),[l.features.emailActionFromField&&t([o(2,s.Spacer,{height:"g1h"}),o(2,s.Input,{placeholder:"from",info:this.customSmtpFromInfo,value:this.customSmtpFrom,onChange:this.onCustomSmtpFromChanged,onBlur:this.onCustomSmtpFromBlur})],4),o(2,s.Spacer,{height:"g1h"}),o(2,s.Input,{placeholder:"smtp hostname:port",info:this.customSmtpHostInfo,value:this.customSmtpHost,onChange:this.onCustomSmtpHostChanged,onBlur:this.onCustomSmtpHostBlur}),o(2,s.Spacer,{height:"g1h"}),o(2,s.Input,{placeholder:"smtp login",info:this.customSmtpUsernameInfo,value:this.customSmtpUsername,onChange:this.onCustomSmtpUsernameChanged}),o(2,s.Spacer,{height:"g1h"}),o(2,s.Input,{placeholder:"smtp password",type:"password",info:this.customSmtpPasswordInfo,value:this.customSmtpPassword,onChange:this.onCustomSmtpPasswordChanged})],0),o(2,s.Spacer,{height:"g2"})],4)},renderTestPanel(){const e=this.actionTestStatus,t="running"===e,n=["success","failure"].includes(e)?"RESEND TEST EMAIL":"SEND TEST EMAIL",a="success"===e?this.actionTestMessage:"failure"===e?"sending failed":null,r="success"===e?s.getColor("positive"):"failure"===e?s.getColor("error"):null,i=this.actionTestMessage;return o(2,s.TestPanel,{running:t,testButtonLabel:n,statusText:a,statusColor:r,statusTooltip:i,onTestClick:this.onTestClick,onStopClick:this.onStopClick})},onToChange(e){this.task.updateAction("email",{to:e})},onCustomSmtpEnabledChanged(e){e=!e,this.task.updateAction("email",{customSmtpEnabled:e})},onCustomSmtpFromChanged(e){this.task.updateAction("email",{customSmtpFrom:e})},onCustomSmtpFromBlur(){if(!this.customSmtpFrom.trim()){const e=i.inputs.actions.state.email.customSmtpFrom;this.task.updateAction("email",{customSmtpFrom:e})}},onCustomSmtpHostChanged(e){this.task.updateAction("email",{customSmtpHost:e})},onCustomSmtpHostBlur(){if(!this.customSmtpHost.trim()){const e=i.inputs.actions.state.email.customSmtpHost;this.task.updateAction("email",{customSmtpHost:e})}},onCustomSmtpUsernameChanged(e){this.task.updateAction("email",{customSmtpUsername:e})},onCustomSmtpPasswordChanged(e){this.task.updateAction("email",{customSmtpPassword:e})},onTestClick(){c.send("runner.email.runActionTest",this.task.taskObject)},onStopClick(){c.send("runner.email.stopActionTest")}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.ActionLimitsPanel=a.component("EditorActionLimitsPanel",{mixin:o.taskMixin,render(){const{c:n,props:r}=this;return r.action?e(1,"row",n.block,[t(2,o.WatcherTriggerSectionSendActions,{class:n.send,action:r.action}),t(2,a.Spacer,{width:"g2"}),t(2,o.WatcherTriggerSectionLimitActions,{class:n.limit,action:r.action})],4):null}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i,$bus:s,$env:l}=n;r.ActionMake=i.component("EditorActionMake",{mixin:r.taskMixin,get actionTestStatus(){return this.task.actionTestStatus("make")},get actionTestMessage(){return this.task.actionTestMessage("make")},get statusColor(){return"success"===this.actionTestStatus?i.getColor("positive"):"failure"===this.actionTestStatus?i.getColor("error"):null},get statusText(){return"success"===this.actionTestStatus?"tested, ok":this.actionTestMessage},get testButtonLabel(){return"success"===this.actionTestStatus?"RESEND TEST EVENT":"SEND TEST EVENT"},get make(){return this.task.input("actions").make},get url(){return this.make.url},get urlInfo(){return{tooltip:{content:[t([a("Add a "),e(1,"b",null,"Watch Task Finished",16),a(" instant trigger from"),a(" "),e(1,"b",null,"HARPA AI Web Monitor",16),a(" Make.com app to your Make.com scenario.")],0),t([a("Copy-paste an Instant Trigger URL here.")],4),t([a("Instant Trigger URL typically starts with"),a(" "),e(1,"b",null,"https://hook.eu1.make.com/id",16),a(" or"),a(" "),e(1,"b",null,"https://hook.us1.make.com/id",16)],0)]}}},get buttonInfo(){return{tooltip:{content:[t([a("Make.com allows building and automating app workflows.")],4),t([a("Connect HARPA AI with Make.com to trigger automation scenarios and send data to Telegram, Google Sheets, Airtable, Gmail, Google Drive, Slack, Discord, Twitter, Trello and 1000+ apps and systems.")],4)]}}},render(){const{c:e}=this;return o(2,r.Action,{class:e.block,name:"make",children:[this.renderLimitsPanel(),this.renderControlPanel(),this.renderTestPanel()]})},renderLimitsPanel:()=>o(2,r.ActionLimitsPanel,{action:"make"}),renderControlPanel(){const{c:n}=this;return t([e(1,"div",n.quote,"Integrate HARPA with 1000+ apps including Google Sheets, Gmail, Slack, Todoist etc.",16),e(1,"div",n.info,[a("1. Install "),e(1,"span",null,"HARPA Web Monitor",16),a(" app to your Make.com organisation (you will need a free Make.com account)")],4),o(2,i.Button,{class:n.installButton,label:"INSTALL APP",type:"small",status:"secondary",info:this.buttonInfo,onClick:this.onInstallAppClick}),e(1,"div",n.info,[a("2. Add "),e(1,"span",null,"Watch Task Finished",16),a(" instant trigger to your scenario on Make.com")],4),e(1,"div",n.info,[a("3. Edit the Instant Trigger, click "),e(1,"span",null,"Add Webhook",16),a(", then copy-paste the webhook address from Make.com here:")],4),o(2,i.Input,{class:n.input,placeholder:"instant trigger webhook URL",lines:2,info:this.urlInfo,value:this.url,onChange:this.onUrlChange}),o(2,i.Spacer,{height:"g1"})],4)},renderTestPanel(){return t([o(2,i.Spacer,{height:"g1"}),o(2,i.TestPanel,{testButtonLabel:this.testButtonLabel,running:"running"===this.actionTestStatus,statusColor:this.statusColor,statusText:this.statusText,onTestClick:this.onTestClick,onStopClick:this.onStopClick})],4)},onInstallAppClick(){const e=l.makeAppInviteUrl;chrome.tabs.create({url:e,active:!0})},onUrlChange(e){this.task.updateAction("make",{url:e})},onTestClick(){s.send("runner.make.runActionTest",this.task.taskObject)},onStopClick(){s.send("runner.make.stopActionTest")}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$editor:a,$ui:r,$bus:i}=n;a.ActionNotification=r.component("EditorActionNotification",{mixin:a.taskMixin,get actionTestStatus(){return this.task.actionTestStatus("notification")},get statusColor(){return"success"===this.actionTestStatus?r.getColor("positive"):null},get statusText(){return"success"===this.actionTestStatus?"tested, ok":null},get testButtonLabel(){return"success"===this.actionTestStatus?"RETEST ACTION":"TEST ACTION"},render(){const{c:e}=this;return o(2,a.Action,{class:e.block,name:"notification",children:[this.renderLimitsPanel(),this.renderTestPanel(),this.renderInfoPanel()]})},renderLimitsPanel:()=>o(2,a.ActionLimitsPanel,{action:"notification"}),renderTestPanel(){const e="running"===this.actionTestStatus;return t([o(2,r.Spacer,{height:"g1"}),o(2,r.TestPanel,{testButtonLabel:this.testButtonLabel,running:e,statusColor:this.statusColor,statusText:this.statusText,onTestClick:this.onTestClick,onStopClick:this.onStopClick})],4)},renderInfoPanel(){const{c:t}=this;if("running"===this.actionTestStatus)return e(1,"column",t.infoPanel,[e(1,"div",t.delimiter),e(1,"div",null,"Please click a test system notification card to verify it works. If you do not see the notification card it means app notifications are disabled in the OS Settings.",16),o(2,r.Spacer,{height:"g1h"}),e(1,"div",null,"How to enable Browser notifications:",16),o(2,r.Spacer,{height:"g0h"}),e(1,"row",null,[o(2,r.Button,{type:"link",label:"WINDOWS",onClick:this.onHowToWindowsClick}),o(2,r.Spacer,{width:"g2"}),o(2,r.Button,{type:"link",label:"MAC OS",onClick:this.onHowToMacClick})],4)],4)},onTestClick(){i.send("runner.notification.runActionTest",this.task.taskObject)},onStopClick(){i.send("runner.notification.stopActionTest")},onHowToWindowsClick(){chrome.tabs.create({url:"https://support.microsoft.com/en-us/windows/change-notification-settings-in-windows-8942c744-6198-fe56-4639-34320cf9444e",active:!0})},onHowToMacClick(){chrome.tabs.create({url:"https://support.apple.com/en-gb/guide/mac-help/mh40583/mac",active:!0})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$editor:a,$ui:r,$bus:i,$runner:s}=n;a.ActionSound=r.component("EditorActionSound",{mixin:a.taskMixin,get value(){return s.soundProxy.value(this.task)},get volume(){return s.soundProxy.volume(this.task)},get utterance(){return s.soundProxy.utterance(this.task)},get utterancePlaceholder(){return s.soundProxy.utterancePlaceholder(this.task)},get isVoice(){return!this.value.startsWith("sound:")},get actionTestStatus(){return this.task.actionTestStatus("sound")},get statusColor(){return"success"===this.actionTestStatus?r.getColor("positive"):null},get statusText(){return"success"===this.actionTestStatus?"tested, ok":null},get testButtonLabel(){return"success"===this.actionTestStatus?"RETEST ACTION":"TEST ACTION"},get items(){return s.soundProxy.items},render(){const{c:e}=this;return o(2,a.Action,{class:e.block,name:"sound",children:[this.renderLimitsPanel(),this.renderSoundPanel(),this.renderVoicePanel(),this.renderTestPanel(),this.renderInfoPanel()]})},renderLimitsPanel:()=>o(2,a.ActionLimitsPanel,{action:"sound"}),renderSoundPanel(){const{c:n}=this;return t([e(1,"row",null,[o(2,r.Dropdown,{class:n.valueDropdown,label:this.isVoice?"ai voice":"sound",maxHeight:"9i",items:this.items,value:this.value,onChange:this.onSoundChange}),o(2,r.Spacer,{width:"g1h"}),o(2,r.Input,{class:n.volumeInput,label:"volume, %",type:"number",min:10,max:100,value:this.volume,onChange:this.onVolumeChange})],4),o(2,r.Spacer,{height:"g1h"})],4)},renderVoicePanel(){if(this.isVoice)return t([o(2,r.Input,{label:"text to read",placeholder:this.utterancePlaceholder,value:this.utterance,info:"\n                A text to be read by AI speech synthesis\n                engine whenever watcher trigger fires.\n              ",onChange:this.onUtteranceChange,onBlur:this.onUtteranceBlur}),o(2,r.Spacer,{height:"g1h"})],4)},renderTestPanel(){return"running"===this.actionTestStatus?null:t([o(2,r.Spacer,{height:"g1"}),o(2,r.TestPanel,{testButtonLabel:this.testButtonLabel,running:!1,statusColor:this.statusColor,statusText:this.statusText,onTestClick:this.onTestClick,onStopClick:this.onStopClick})],4)},renderInfoPanel(){const{c:t}=this;if("running"===this.actionTestStatus)return e(1,"column",t.infoPanel,[e(1,"div",t.delimiter),e(1,"div",null,"If you do not hear the sound, please check if browser can play music e.g. by navigating to youtube.com",16),o(2,r.Spacer,{height:"g1h"}),e(1,"row",null,[o(2,r.Button,{type:"link",label:"PLAY AGAIN",onClick:this.onAgainClick}),o(2,r.Spacer,{width:"g2"}),o(2,r.Button,{type:"link",label:"OK, I HEAR THE SOUND",onClick:this.onOkClick}),o(2,r.Spacer,{grow:!0}),o(2,r.Button,{type:"link",status:"secondary",label:"CANCEL",onClick:this.onCancelClick})],4)],4)},onSoundChange(e){this.task.updateAction("sound",{value:e.id}),i.send("runner.sound.runActionTest",this.task.taskObject)},onVolumeChange(e){this.task.updateAction("sound",{volume:e})},onUtteranceChange(e){this.task.updateAction("sound",{utterance:e})},onUtteranceBlur(){this.utterance.trim()||this.task.updateAction("sound",{utterance:this.utterancePlaceholder})},onTestClick(){i.send("runner.sound.runActionTest",this.task.taskObject)},onStopClick(){i.send("runner.sound.stopActionTest")},onAgainClick(){i.send("runner.sound.runActionTest",this.task.taskObject)},onOkClick(){i.send("runner.sound.validateActionTest")},onCancelClick(){i.send("runner.sound.stopActionTest")}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$editor:a,$ui:r,$bus:i}=n;a.ActionWebhook=r.component("EditorActionWebhook",{mixin:a.taskMixin,get actionTestStatus(){return this.task.actionTestStatus("webhook")},get actionTestMessage(){return this.task.actionTestMessage("webhook")},get statusColor(){return"success"===this.actionTestStatus?r.getColor("positive"):"failure"===this.actionTestStatus?r.getColor("error"):null},get statusText(){return"success"===this.actionTestStatus?"tested, ok":this.actionTestMessage},get testButtonLabel(){return"success"===this.actionTestStatus?"RETEST WEBHOOK":"TEST WEBHOOK"},get webhook(){return this.task.input("actions").webhook},get url(){return this.webhook.url},get urlInfo(){return["Webhook URL to receive data events from HARPA, e.g. https://myserver.com/api/event","You can create a dummy webhook URL at https://webhook.site to check what payload HARPA sends.","You can connect your tasks to Integromat / Make via webhook API to build IFTTT chains."]},get basicAuthEnabled(){return this.webhook.basicAuthEnabled},get basicAuthEnabledInfo(){return"If enabled, HARPA will send a basic HTTP authorization header with every request."},get basicAuthUsername(){return this.webhook.basicAuthUsername},get basicAuthUsernameInfo(){return["HTTP auth username.","HARPA stores your HTTP server username & password locally on the current machine."]},get basicAuthPassword(){return this.webhook.basicAuthPassword},get basicAuthPasswordInfo(){return["HTTP auth password.","HARPA stores your HTTP server username & password locally on the current machine."]},render(){const{c:e}=this;return o(2,a.Action,{class:e.block,name:"webhook",children:[this.renderLimitsPanel(),this.renderControlPanel(),this.renderTestPanel()]})},renderLimitsPanel:()=>o(2,a.ActionLimitsPanel,{action:"webhook"}),renderControlPanel(){const{c:n}=this;return t([o(2,r.Input,{label:"url",placeholder:"webhook URL",lines:2,info:this.urlInfo,value:this.url,onChange:this.onUrlChange}),o(2,r.Spacer,{height:"g2"}),o(2,r.Checkbox,{label:"Use basic HTTP auth",info:this.basicAuthEnabledInfo,value:this.basicAuthEnabled,onChange:this.onBasicAuthEnabledChange}),e(1,"column",n.basicAuthSettings({enabled:this.basicAuthEnabled}),[o(2,r.Spacer,{height:"g1h"}),o(2,r.Input,{placeholder:"username",info:this.basicAuthUsernameInfo,value:this.basicAuthUsername,onChange:this.onBasicAuthUsernameChange}),o(2,r.Spacer,{height:"g1h"}),o(2,r.Input,{placeholder:"password",type:"password",info:this.basicAuthPasswordInfo,value:this.basicAuthPassword,onChange:this.onBasicAuthPasswordChange})],4),o(2,r.Spacer,{height:"g1"})],4)},renderTestPanel(){return t([o(2,r.Spacer,{height:"g1"}),o(2,r.TestPanel,{testButtonLabel:this.testButtonLabel,running:"running"===this.actionTestStatus,statusColor:this.statusColor,statusText:this.statusText,onTestClick:this.onTestClick,onStopClick:this.onStopClick})],4)},onUrlChange(e){this.task.updateAction("webhook",{url:e})},onBasicAuthEnabledChange(e){e=!e,this.task.updateAction("webhook",{basicAuthEnabled:e})},onBasicAuthUsernameChange(e){this.task.updateAction("webhook",{basicAuthUsername:e})},onBasicAuthPasswordChange(e){this.task.updateAction("webhook",{basicAuthPassword:e})},onTestClick(){i.send("runner.webhook.runActionTest",this.task.taskObject)},onStopClick(){i.send("runner.webhook.stopActionTest")}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$editor:t,$ui:o}=n;t.Action=o.component("EditorAction",{mixin:t.taskMixin,props:()=>({task:Object,ctx:Object,class:Class,name:String,children:Children}),get icon(){return`action-${this.props.name}`},get title(){return{notification:"NOTIFICATION",sound:"SOUND",push:"PUSH",sms:"SMS",slack:"SLACK",zapier:"ZAPIER",make:"MAKE / INTEGROMAT",discord:"DISCORD",email:"EMAIL",telegram:"TELEGRAM",webhook:"WEBHOOK"}[this.props.name]},get subtitle(){return{notification:"Show a browser notification",make:"Send events to 1000+ apps via Make.com",sound:"Play a sound",email:"Send an email",webhook:"Integrate HARPA with 3rd party services: send data to server webhook",push:"Connection available via Make.com",sms:"Connection available via Make.com",slack:"Connection available via Make.com",zapier:"Connection available via Make.com",discord:"Connection available via Make.com",telegram:"Connection available via Make.com"}[this.props.name]},get iconStyle(){return"make"===this.props.name&&this.enabled?{color:"#975CC3"}:null},get enabled(){return this.task.actionEnabled(this.props.name)},get supported(){return["notification","sound","email","webhook","make"].includes(this.props.name)},render(){const{c:n,props:o}=this;return e(2,t.Group,{class:[n.block,o.class],icon:this.icon,iconStyle:this.iconStyle,title:this.title,subtitle:this.subtitle,enabled:this.enabled,planned:!this.supported,onEnabledChange:this.onEnabledChange,children:o.children})},onEnabledChange(){this.task.toggleActionEnabled(this.props.name)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.WatcherTriggerSectionLimitActions=a.component({name:"EditorWatcherTriggerSectionLimitActions",mixin:o.taskMixin,get items(){return[{id:"do-not-limit",label:"do not limit"},{id:"once-an-hour",label:"once an hour"},{id:"once-3-hours",label:"once in 3 hours"},{id:"once-a-day",label:"once a day"},{id:"once-a-week",label:"once a week"}]},get info(){return{tooltip:{content:"Reduce frequency of actions to once an hour / day / week. Set this option if trigger fires too frequently."}}},get value(){return this.task.actionLimitActions(this.props.action)},render(){const{c:n,props:o}=this;return e(1,"div",[n.block,o.class],t(2,a.Dropdown,{label:"limit to",value:this.value,items:this.items,info:this.info,onChange:this.onChange}),2)},onChange(e){this.task.setActionLimitActions(this.props.action,e.id)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i}=n;r.ActionsModule=i.component("EditorActionsModule",{mixin:r.taskMixin,get excerpt(){const n=[];return this.task.actionEnabled("notification")&&n.push("show notification"),this.task.actionEnabled("sound")&&n.push("play sound"),this.task.actionEnabled("email")&&n.push("send email"),this.task.actionEnabled("webhook")&&n.push("send data to webhook"),this.task.actionEnabled("make")&&n.push("send data to make.com"),0===n.length?t([a("no actions")],4):1===n.length?t([e(1,"span",null,n[0],0)],4):2===n.length?t([e(1,"span",null,n[0],0),a(" and "),e(1,"span",null,n[1],0)],4):t([a("perform "),e(1,"span",null,[n.length,a(" actions")],0)],4)},render(){return o(2,r.Module,{icon:"module-actions",title:"ACTIONS & INTEGRATIONS",inputName:"actions",onSelect:this.props.onSelect,children:this.excerpt})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$editor:a,$ui:r}=n;a.ActionsScreen=r.component("EditorActionsScreen",{mixin:a.taskMixin,state:()=>({expanded:!1}),render(){const{c:t}=this;return e(1,"div",t.block,[o(2,r.Label,{children:"actions on trigger"}),o(2,a.ActionNotification),o(2,a.ActionMake),o(2,a.ActionSound),o(2,a.ActionEmail),o(2,a.ActionWebhook),this.renderMoreActions(),this.renderMoreButton()],0)},renderMoreActions(){if(this.state.expanded)return t([o(2,a.Action,{name:"slack"}),o(2,a.Action,{name:"discord"}),o(2,a.Action,{name:"telegram"}),o(2,a.Action,{name:"sms"}),o(2,a.Action,{name:"push"}),o(2,a.Action,{name:"zapier"})],4)},renderMoreButton(){if(this.state.expanded)return;const{c:t}=this;return e(1,"row",null,e(1,"button",t.moreButton,[e(1,"div",t.moreButtonDot),e(1,"div",t.moreButtonDot),e(1,"div",t.moreButtonDot)],4,{onClick:this.onMoreButtonClick}),2,{"full-width":!0,"x-end":!0})},onMoreButtonClick(){this.setState({expanded:!0})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i}=n;r.WatcherTriggerSectionSendActions=i.component({name:"EditorWatcherTriggerSectionSendActions",mixin:r.taskMixin,get items(){return[{id:"every-trigger",label:"every trigger"},{id:"first-trigger",label:"first trigger"},{id:"task-success",label:"task run"}]},get info(){return{tooltip:{content:[t([a("Select how to dispatch actions: on every trigger, the first trigger in a row or every time the task is run.")],4),t([a("Dispatching actions on the first trigger only will silence consecutive actions until the trigger check fails.")],4)]}}},get value(){return this.task.actionSendOn(this.props.action)},render(){const{c:t,props:n}=this;return e(1,"div",[t.block,n.class],o(2,i.Dropdown,{label:"send on",value:this.value,items:this.items,info:this.info,onChange:this.onChange}),2)},onChange(e){this.task.setActionSendOn(this.props.action,e.id)}})})(),(()=>{const{createVNode:e,createComponentVNode:t,normalizeProps:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i,$utils:s}=n;r.BeforeDropBanners=i.component("EditorBeforeDropBanners",{mixin:r.taskMixin,state:function(){return{text:this.task.beforeDropBannersText}},get text(){return this.state.text},get textPlaceholder(){return"e.g. cookie"},get textInfo(){return{tooltip:{content:[e(1,"div",null,"HARPA will detect floating banners which contain the given word or phrase and hide them from the page automatically.",16),e(1,"div",null,"You can tell HARPA to look for multiple text snippets or words by breaking them into separate lines. The search is case insensitive.",16),e(1,"div",null,[a("You can also supply regular expressions, e.g.: "),e(1,"b",null,"/cookie/gi",16)],4)]}}},get textFound(){return s.occurrences.regex(this.ctx.text,this.state.text)>0},renderTextStatus(){if(!this.ctx.text)return null;if(!this.text)return null;const{c:n}=this,a=this.textFound?{text:"found on page",color:"positive"}:{text:"not on page now",color:"sublime"};return e(1,"row",n.textStatus,o(t(2,i.MiniStatus,{...a})),2,{"full-width":!0,"x-end":!0})},render(){const{c:n}=this;return t(2,r.Group,{icon:"before-drop-banners",title:"HIDE COOKIE BANNERS",subtitle:"Remove GDPR cookie consent banners",enabled:this.task.beforeDropBannersEnabled,onEnabledChange:this.onEnabledChange,children:e(1,"column",n.textPanel,[this.renderTextInput(),this.renderTextStatus()],0)})},renderTextInput(){return t(2,i.Input,{label:"search banners by phrase",lines:2,value:this.text,info:this.textInfo,placeholder:this.textPlaceholder,onInput:this.onTextInput,onBlur:this.onTextBlur})},onEnabledChange(e){this.task.beforeDropBannersEnabled=!e},onTextInput(e){this.setState({text:e})},onTextBlur(){let e=this.state.text;this.setState({text:e}),this.task.beforeDropBannersText=e}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.BeforeIdleCheck=a.component("EditorBeforeIdleCheck",{mixin:o.taskMixin,state:function(){return{timeoutFocused:!1,timeoutValue:this.task.beforeIdleCheckTimeout}},get timeoutValue(){const{timeoutFocused:e,timeoutValue:t}=this.state;return e?t:`${t} ${1===t?"second":"seconds"}`},get timeoutInfo(){return"HARPA will wait for the page to stop loading and updating, before it runs the task. Switching this off is not recommended."},render(){return t(2,o.Group,{icon:"before-idle",title:"IDLE",subtitle:"Wait for page to become idle",enabled:this.task.beforeIdleCheckEnabled,onEnabledChange:this.onEnabledChange,children:e(1,"row",null,[this.renderOnTimeoutDropdown(),this.renderTimeoutInput()],0)})},renderOnTimeoutDropdown(){return t(2,a.Dropdown,{label:"if wait expired",items:[{id:"carry-on",label:"ignore and carry on"},{id:"report-warning",label:"fail with a warning"},{id:"report-error",label:"fail with an error"}],value:this.task.beforeIdleCheckOnTimeout,onChange:this.onOnTimeoutChange})},renderTimeoutInput(){const{c:e}=this;return t(2,a.Input,{class:e.timeoutInput,label:"max wait time",placeholder:"15 seconds",info:this.timeoutInfo,value:this.timeoutValue,onFocus:this.onTimeoutValueFocus,onChange:this.onTimeoutValueChange,onBlur:this.onTimeoutValueBlur})},onOnTimeoutChange(e){this.task.beforeIdleCheckOnTimeout=e.id},onEnabledChange(e){this.task.beforeIdleCheckEnabled=!e},onTimeoutValueFocus(){this.setState({timeoutFocused:!0})},onTimeoutValueChange(e){this.setState({timeoutValue:e})},onTimeoutValueBlur(){let e=Number(this.state.timeoutValue);""===this.state.timeoutValue.trim()||Number.isNaN(e)?e=15:e<0&&(e=0),this.setState({timeoutValue:e,timeoutFocused:!1}),this.task.beforeIdleCheckTimeout=e}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$editor:t,$ui:o}=n;t.BeforeModule=o.component("EditorBeforeModule",{mixin:t.taskMixin,get prefix(){return this.task.beforeIdleCheckEnabled||this.task.beforeTextCheckEnabled||this.task.beforeScrollEnabled?"":"do not trigger"},get idle(){return this.task.beforeIdleCheckEnabled?"page must stop updating":null},get text(){return this.task.beforeTextCheckEnabled?"wait for text":null},get dropBanners(){return this.task.beforeDropBannersEnabled?"hide cookie banners":null},get scroll(){return this.task.beforeScrollEnabled?"scroll page":null},render(){const n=[this.idle,this.text,this.dropBanners,this.scroll].filter(Boolean).join(", ");return e(2,t.Module,{icon:"module-before",title:"BEFORE RUN",inputName:"before",onSelect:this.props.onSelect,children:[this.prefix," ",n]})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.BeforeScreen=a.component("EditorBeforeScreen",{mixin:o.taskMixin,render(){const{c:n}=this;return e(1,"div",n.block,[t(2,o.BeforeIdleCheck),t(2,o.BeforeTextCheck),t(2,o.BeforeDropBanners),t(2,o.BeforeScroll)],4)}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$editor:t,$ui:o}=n;t.BeforeScroll=o.component("EditorBeforeScroll",{mixin:t.taskMixin,state:function(){return{focused:!1,value:this.task.beforeScrollMaxDuration}},get value(){const{focused:e,value:t}=this.state;return e?t:`${t} ${1===t?"second":"seconds"}`},get valueInfo(){return"Some web pages load data as they are scrolled. HARPA will scroll the page down until it reaches the page end, and then up."},render(){const{c:n}=this;return e(2,t.Group,{icon:"before-scroll",title:"SCROLL",subtitle:"Scroll through page",enabled:this.task.beforeScrollEnabled,onEnabledChange:this.onEnabledChange,children:e(2,o.Input,{class:n.input,label:"max scroll time",info:this.valueInfo,placeholder:"15 seconds",value:this.value,onFocus:this.onInputFocus,onChange:this.onInputChange,onBlur:this.onInputBlur})})},onEnabledChange(e){this.task.beforeScrollEnabled=!e},onInputFocus(){this.setState({focused:!0})},onInputChange(e){this.setState({value:e})},onInputBlur(){let e=Number(this.state.value);""===this.state.value.trim()||Number.isNaN(e)?e=15:e<1&&(e=1),this.setState({value:e,focused:!1}),this.task.beforeScrollMaxDuration=e}})})(),(()=>{const{createVNode:e,createComponentVNode:t,normalizeProps:o}=n.$inferno,{$editor:a,$recipe:r,$ui:i,$utils:s}=n;a.BeforeTextCheck=i.component("EditorBeforeTextCheck",{mixin:a.taskMixin,state:function(){return{searchTextFocused:!1,searchText:this.task.beforeTextCheckSearchText||this.searchTextDefaultValue,timeoutFocused:!1,timeoutValue:this.task.beforeTextCheckTimeout}},get searchText(){return this.state.searchText},get searchTextDefaultValue(){if(!this.ctx.data)return"My Account";const e=this.ctx.data||[];return r.adapters.watcher.biggestItem(e)?.value||"My Account"},get searchTextPlaceholder(){return`e.g. ${this.searchTextDefaultValue}`},get searchTextFound(){return s.occurrences.regex(this.ctx.text,this.state.searchText)>0},get searchTextInfo(){return"HARPA will wait for the given text to appear on page. Use this option to ensure page is loaded before running checks."},get timeoutValue(){const{timeoutFocused:e,timeoutValue:t}=this.state;return e?t:`${t} ${1===t?"second":"seconds"}`},render(){const{c:n}=this;return t(2,a.Group,{icon:"before-text",title:"TEXT",subtitle:"Wait for page to contain text",enabled:this.task.beforeTextCheckEnabled,onEnabledChange:this.onEnabledChange,children:[e(1,"column",n.searchTextPanel,[this.renderSearchTextInput(),this.renderSearchTextStatus()],0),e(1,"row",null,[this.renderOnTimeoutDropdown(),this.renderTimeoutInput()],0)]})},renderSearchTextStatus(){if(!this.ctx.text)return null;if(!this.searchText)return null;const{c:n}=this,a=this.searchTextFound?{text:"found on page",color:"positive"}:{text:"not on page now",color:"sublime"};return e(1,"row",n.searchTextStatus,o(t(2,i.MiniStatus,{...a})),2,{"full-width":!0,"x-end":!0})},renderSearchTextInput(){return t(2,i.Input,{label:"text to wait for",lines:2,value:this.searchText,info:this.searchTextInfo,placeholder:this.searchTextPlaceholder,onFocus:this.onSearchTextFocus,onInput:this.onSearchTextInput,onBlur:this.onSearchTextBlur})},renderOnTimeoutDropdown(){return t(2,i.Dropdown,{label:"if wait expired",items:[{id:"carry-on",label:"ignore and carry on"},{id:"report-warning",label:"fail with a warning"},{id:"report-error",label:"fail with an error"}],value:this.task.beforeTextCheckOnTimeout,onChange:this.onOnTimeoutChange})},renderTimeoutInput(){const{c:e}=this;return t(2,i.Input,{class:e.timeoutInput,label:"max wait time",placeholder:"15 seconds",value:this.timeoutValue,onFocus:this.onTimeoutValueFocus,onChange:this.onTimeoutValueChange,onBlur:this.onTimeoutValueBlur})},onEnabledChange(e){this.task.beforeTextCheckEnabled=!e},onSearchTextFocus(){this.setState({searchTextFocused:!0})},onSearchTextInput(e){this.setState({searchText:e})},onSearchTextBlur(){let e=this.state.searchText;""===e.trim()&&(e=this.searchTextDefaultValue),this.setState({searchText:e,searchTextFocused:!1}),this.task.beforeTextCheckSearchText=e},onOnTimeoutChange(e){this.task.beforeTextCheckOnTimeout=e.id},onTimeoutValueFocus(){this.setState({timeoutFocused:!0})},onTimeoutValueChange(e){this.setState({timeoutValue:e})},onTimeoutValueBlur(){let e=Number(this.state.timeoutValue);""===this.state.timeoutValue.trim()||Number.isNaN(e)?e=15:e<0&&(e=0),this.setState({timeoutValue:e,timeoutFocused:!1}),this.task.beforeTextCheckTimeout=e}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$editor:a,$ui:r}=n;a.Group=r.component("EditorGroup",{props:()=>({class:Class,icon:String,iconStyle:Style,title:String,subtitle:String,enabled:Boolean,planned:Boolean,children:Children,onEnabledChange:Listener}),render(){const{c:n,props:a}=this;return e(1,"div",[n.block({enabled:a.enabled}),a.class],[e(1,"row",null,[o(2,r.Icon,{class:n.icon,name:a.icon,style:a.iconStyle}),o(2,r.Spacer,{width:"g1h"}),e(1,"column",null,[e(1,"div",n.title,a.title,0),o(2,r.Spacer,{height:"g0h"}),e(1,"div",n.subtitle,a.subtitle,0)],4),o(2,r.Spacer,{grow:!0}),a.onEnabledChange&&!a.planned&&o(2,r.Switch,{class:n.switch,value:a.enabled,onChange:a.onEnabledChange}),a.planned&&o(2,r.Tooltip,{content:"Integration is coming in the future. Please use Make.com to integrate HARPA AI with this service today.",children:o(2,r.Button,{class:n.plannedPill,labelClass:n.plannedPillLabel,type:"pill",status:"secondary",label:"PLANNED"})})],0,{"y-start":!0}),a.enabled&&a.children&&t([o(2,r.Spacer,{height:"g1"}),a.children],0)],0)}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$editor:t,$ui:o,$harpa:a}=n;t.InputHeader=o.component("EditorInputHeader",{mixin:t.taskMixin,props:()=>({task:Object,ctx:Object,onBackClick:Function,class:Class}),get inputScreen(){return this.task.inputScreen},get recipeId(){return this.task.recipeId},get nameButtonLabel(){return{overview:null,"watcher.recipe":"MONITOR","watcher.trigger":"TRIGGER",trigger:"TRIGGER",schedule:"SCHEDULE",before:"BEFORE RUN",macros:"MACROS",actions:"ACTIONS",tracking:"TRACKING CHANGES",ua:"USER AGENT"}[this.inputScreen]},get nameButtonIcon(){return{overview:null,"watcher.recipe":`recipe-${this.recipeId}`,"watcher.trigger":"module-trigger",trigger:"module-trigger",schedule:"module-schedule",before:"module-before",macros:"module-macros",actions:"module-actions",tracking:"module-tracking",ua:"module-ua"}[this.inputScreen]},render(){return e(2,a.NavHeader,{class:this.props.class,onBackButtonClick:this.onBackButtonClick,nameButtonLabel:this.nameButtonLabel,nameButtonIcon:this.nameButtonIcon})},onBackButtonClick(){this.props.onBackClick()}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$editor:t,$ui:o}=n;t.InputScreen=o.component("EditorInputScreen",{mixin:t.taskMixin,props:()=>({task:Object,ctx:Object,fallbackScreen:String}),get screen(){const e=this.task.inputScreen;return"overview"!==e?e:this.props.fallbackScreen},render(){switch(this.screen){case"watcher.recipe":return e(2,t.WatcherRecipeScreen);case"watcher.trigger":return e(2,t.WatcherTriggerScreen);case"actions":return e(2,t.ActionsScreen);case"schedule":return e(2,t.ScheduleScreen);case"before":return e(2,t.BeforeScreen);case"tracking":return e(2,t.TrackingScreen);case"ua":return e(2,t.UaScreen);default:return null}}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.MacrosModule=a.component("EditorMacrosModule",{render(){return t(2,o.Module,{icon:"module-macros",title:"MACROS",inputName:"macros",onSelect:this.props.onSelect,children:["excerpt ",e(1,"span",null,"not implemented",16)]})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.Module=a.component("EditorModule",{mixin:o.taskMixin,props:()=>({task:Object,ctx:Object,icon:String,title:String,children:Children,inputName:String,onSelect:Function}),render(){const{c:n,props:o}=this;return e(1,"column",n.block({clickable:!!o.inputName||!!o.onSelect}),[e(1,"row",n.header,[t(2,a.Icon,{class:n.icon,name:o.icon}),e(1,"div",n.title,o.title,0)],4,{"y-center":!0}),e(1,"div",n.children,o.children,0),o.onClick&&t(2,a.Icon,{name:"forward",class:n.forward})],0,{onClick:this.onClick})},onClick(){const{inputName:e,onSelect:t}=this.props;e&&(this.task.inputScreen=e),t&&t(this.props)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a,$task:r}=n;o.OverviewHeader=a.component("EditorOverviewHeader",{mixin:o.taskMixin,props:()=>({task:Object,ctx:Object,onOpenInEditorClick:Function}),render(){const{c:n,props:o}=this;return e(1,"row",n.block,[e(1,"div",n.title,this.task.name||r.proxy.recipeTitle(this.task),0),o.onOpenInEditorClick&&t(2,a.Button,{type:"link",rightIcon:"link",iconClass:n.openIcon,labelClass:n.openLabel,label:"EDIT IN TAB",onClick:o.onOpenInEditorClick})],0,{"x-between":!0,"y-center":!0})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n,r=new Set(["watcher.changes","watcher.price","watcher.element","watcher.health","watcher.trigger","schedule","actions"]);o.OverviewScreen=a.component("EditorOverviewScreen",{mixin:o.taskMixin,props:()=>({task:Object,ctx:Object,configMode:String,onInputSelect:Function}),get inputsMap(){const e=this.props.onInputSelect;return{"watcher.changes":t(2,o.WatcherRecipeModule,{onSelect:e}),"watcher.element":t(2,o.WatcherRecipeModule,{onSelect:e}),"watcher.price":t(2,o.WatcherRecipeModule,{onSelect:e}),"watcher.health":t(2,o.WatcherRecipeModule,{onSelect:e}),"watcher.trigger":t(2,o.WatcherTriggerModule,{onSelect:e}),actions:t(2,o.ActionsModule,{onSelect:e}),schedule:t(2,o.ScheduleModule,{onSelect:e}),before:t(2,o.BeforeModule,{onSelect:e}),macros:t(2,o.MacrosModule,{onSelect:e}),tracking:t(2,o.TrackingModule,{onSelect:e}),ua:t(2,o.UaModule,{onSelect:e}),trigger:null,changeUpIs:null,page:null}},render(){const{inputsMap:t,props:n}=this,o=n.configMode;return e(1,"column",null,this.task.recipe.inputs.map((e=>e.type)).filter((e=>"advanced"===o||r.has(e))).map((e=>t[e])).filter((e=>Boolean(e))),0)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$task:i,$ui:s}=n;r.ScheduleModule=s.component("EditorScheduleModule",{mixin:r.taskMixin,get excerpt(){let n;const o=this.task.scheduleType;if("periodical"!==o)throw new Error(`unsupported schedule type ${o}`);{const e=this.task.schedulePeriodicalFrequency;n=i.scheduleFrequencies.find((t=>t.id===e)).label.toLowerCase()}const r=(i.mediumTypes.find((e=>e.id===this.task.scheduleMediumType))||{name:"custom medium"}).name,s=this.task.scheduleAutoCloseTab&&t([a(", auto-close tab")],4);return t([a("run "),e(1,"span",null,n,0),a(" in "),e(1,"span",null,[a("a "),r],0),s],0)},render(){return o(2,r.Module,{icon:"module-schedule",title:"SCHEDULE",inputName:"schedule",onSelect:this.props.onSelect,children:this.excerpt})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$editor:a,$task:r,$ui:i,$utils:s}=n;a.ScheduleScreen=i.component("EditorScheduleScreen",{mixin:a.taskMixin,get enabled(){return this.task.enabled},get scheduleType(){return this.task.scheduleType},get schedulePeriodicalFrequency(){return this.task.schedulePeriodicalFrequency},get scheduleMediumType(){return this.task.scheduleMediumType},get scheduleAutoCloseTab(){return this.task.scheduleAutoCloseTab},render(){const{c:t}=this;return e(1,"div",t.block,[this.renderType(),this.renderPeriodicalFrequency(),this.renderScheduleMediumType()],0)},renderType(){return t([o(2,i.Dropdown,{label:"run monitor",items:[{id:"periodical",label:"Periodically"},{id:"interval",label:"In intervals (planned)",disabled:!0},{id:"week",label:"Weekly (planned)",disabled:!0},{id:"month",label:"Monthly (planned)",disabled:!0}],info:"You can run monitors manually from the HARPA dashboard or schedule to run them periodically.",value:this.scheduleType,onChange:this.onTypeChange}),o(2,i.Spacer,{height:"g2"})],4)},renderPeriodicalFrequency(){if("periodical"!==this.scheduleType)return;const e=r.scheduleFrequencies,n=this.schedulePeriodicalFrequency,a=s.time.frequencyToMs(n)<=30*s.time.MINUTE?{type:"exclamation",tooltip:{content:["Running checks too often puts extra work on the web servers and your machine. Some websites might log you out or ask to pass CAPTCHA test.","Consider running monitors with a reasonable delay."]}}:null;return t([o(2,i.Dropdown,{label:"run frequency",items:e,info:a,value:n,onChange:this.onPeriodicalFrequencyChange}),o(2,i.Spacer,{height:"g2"})],4)},renderScheduleMediumType(){const{c:e}=this,n=r.mediumTypesWithAutoClosing,a=`${this.scheduleAutoCloseTab?"t":"p"}:${this.scheduleMediumType}`;return t([o(2,i.Dropdown,{class:e.mediumType,iconClass:e.controlIcon,label:"where to run monitor",items:n,value:a,rightIcon:`medium-${this.scheduleMediumType}`,hideTriangle:!0,info:{tooltip:["HARPA AI can run automations in regular, pinned or hidden tabs. Run in hidden tabs to keep your browser window tidy.","Auto-closing tabs will be closed after every run to save up memory.","Persistent tabs will be retained between runs."]},onChange:this.onMediumTypeChange}),o(2,i.Spacer,{height:"g2"})],4)},onTypeChange(e){this.task.updateSchedule({type:e.id})},onPeriodicalFrequencyChange(e){this.task.updateSchedule("periodical",{frequency:e.id})},onMediumTypeChange(e){const[t,n]=e.id.split(":");this.task.updateSchedule({mediumType:n}),this.task.scheduleAutoCloseTab="t"===t}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$task:i,$ui:s}=n;r.TrackingModule=s.component("EditorTrackingModule",{mixin:r.taskMixin,get excerpt(){const n=this.task.trackingValue,o=i.trackingItems.find((e=>e.id===n)).label;return t([a("compare % of changes "),e(1,"span",null,o,0)],4)},render(){return o(2,r.Module,{icon:"module-tracking",title:"TRACKING CHANGES",inputName:"tracking",onSelect:this.props.onSelect,children:this.excerpt})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i}=n;r.TrackingScreen=i.component("EditorTrackingScreen",{mixin:r.taskMixin,icons:{betweenChecks:'<svg width="354.094" height="59.672" viewBox="0 0 354.094 59.672"><rect width="6.281" height="42.552" transform="translate(339.531 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(331.25 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(322.969 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(314.688 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(306.406 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(298.125 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(289.844 16.927)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(281.563 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(273.281 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(265 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(256.719 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(248.438 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(240.156 44.657)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(231.875 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(223.594 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(215.313 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(207.031 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(198.75 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(190.469 29.836)" fill="cc"/><rect width="6.281" height="11.853" transform="translate(182.188 47.626)" fill="cc"/><rect width="6.281" height="11.853" transform="translate(173.906 47.626)" fill="cc"/><rect width="6.281" height="11.853" transform="translate(165.625 47.626)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(157.344 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(149.063 57.383)" fill="cc"/><rect width="6.281" height="59.672" transform="translate(347.813)" fill="cc"/><rect width="6.281" height="2" transform="translate(347.813)" fill="#3dd57f"/><rect width="6.281" height="2.096" transform="translate(132.5 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(140.781 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(124.219 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(115.938 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(49.688 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(91.094 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(107.656 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(41.406 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(82.813 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(99.375 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(24.844 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(66.25 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(33.125 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(74.531 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(16.563 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(57.969 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(8.281 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(0 57.384)" fill="cc"/><rect width="6.281" height="2" transform="translate(339.531 14.927)" fill="#3dd57f"/></svg>'.replaceAll('"cc"','"currentColor"'),toFirstCheck:'<svg xmlns="http://www.w3.org/2000/svg" width="354.094" height="59.672" viewBox="0 0 354.094 59.672"><rect width="6.281" height="42.552" transform="translate(339.531 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(331.25 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(322.969 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(314.688 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(306.406 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(298.125 16.927)" fill="cc"/><rect width="6.281" height="42.552" transform="translate(289.844 16.927)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(281.563 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(273.281 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(265 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(256.719 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(248.438 44.657)" fill="cc"/><rect width="6.281" height="14.821" transform="translate(240.156 44.657)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(231.875 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(223.594 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(215.313 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(207.031 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(198.75 29.836)" fill="cc"/><rect width="6.281" height="29.643" transform="translate(190.469 29.836)" fill="cc"/><rect width="6.281" height="11.853" transform="translate(182.188 47.626)" fill="cc"/><rect width="6.281" height="11.853" transform="translate(173.906 47.626)" fill="cc"/><rect width="6.281" height="11.853" transform="translate(165.625 47.626)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(157.344 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(149.063 57.383)" fill="cc"/><rect width="6.281" height="59.672" transform="translate(347.813)" fill="cc"/><rect width="6.281" height="2" transform="translate(347.813)" fill="#3dd57f"/><rect width="6.281" height="2.096" transform="translate(132.5 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(140.781 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(124.219 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(115.938 57.383)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(49.688 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(91.094 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(107.656 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(41.406 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(82.813 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(99.375 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(24.844 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(66.25 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(33.125 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(74.531 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(16.563 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(57.969 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(8.281 57.384)" fill="cc"/><rect width="6.281" height="2.096" transform="translate(0 57.384)" fill="#74be86"/></svg>'.replaceAll('"cc"','"currentColor"')},get infoText(){return"between-checks"===this.task.trackingValue?t([a("Every time the task is run, it will compute delta value asÂ aÂ difference between the "),e(1,"b",null,"last",16),a(" and the"),a(" "),e(1,"b",null,"previous check",16),a(".")],0):t([a("Every time the task is run, it will compute delta value asÂ aÂ difference between the "),e(1,"b",null,"last",16),a(" and the"),a(" "),e(1,"b",null,"first check",16),a(".")],0)},render(){const{c:t,icons:n}=this;return e(1,"column",t.block,[e(1,"div",t.label,"compare % of changes",16),o(2,r.TrackingScreenOption,{id:"between-checks",label:"Between checks",icon:n.betweenChecks,children:["delta to previous check, e.g.Â ",e(1,"b",null,"25%",16)]}),o(2,r.TrackingScreenOption,{id:"to-first-check",label:"To first check",icon:n.toFirstCheck,children:["delta to first check, e.g.Â ",e(1,"b",null,"100%",16)]}),e(1,"div",t.infoText,this.infoText,0)],4)}}),r.TrackingScreenOption=i.component("EditorTrackingScreenOption",{mixin:r.taskMixin,get selected(){return this.task.trackingValue===this.props.id},render(){const{c:t,props:n}=this;return e(1,"column",t.block,[o(2,i.Radio,{label:n.label,value:this.selected}),o(2,i.Icon,{class:t.icon,name:n.icon}),e(1,"row",t.children,n.children,0,{"x-end":!0})],4,{"data-id":n.id,onClick:this.onClick})},onClick(){this.task.trackingValue=this.props.id}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$task:i,$ui:s}=n;r.UaModule=s.component("EditorUaModule",{mixin:r.taskMixin,get ua(){return this.task.ua},get agentLabel(){const{vua:n,viewportWidth:o,viewportHeight:r}=this.ua,s=i.userAgents[n]?.name||"default agent",l=n&&` / ${o}x${r}`;return t([a("use"),a(" "),e(1,"span",null,[s,l],0)],0)},get languageLabel(){const{vlang:n}=this.ua,o=i.languages[n];return"auto"!==n&&o?t([a(", force "),e(1,"span",null,o,0)],4):null},render(){return o(2,r.Module,{icon:"module-ua",title:"USER AGENT",inputName:"ua",onSelect:this.props.onSelect,children:[this.agentLabel,this.languageLabel]})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.UaScreen=a.component("EditorUaScreen",{mixin:o.taskMixin,render(){const{c:n}=this;return e(1,"column",n.block,t(2,o.UaSectionAgent),2)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,normalizeProps:a}=n.$inferno,{$editor:r,$task:i,$ui:s,$tabs:l}=n;r.UaSectionAgent=s.component("EditorUaSectionAgent",{mixin:r.taskMixin,state:function(){return{viewportWidth:this.uaViewportWidth,viewportHeight:this.uaViewportHeight}},get uaViewportWidth(){return this.task.uaViewportWidth},get uaViewportHeight(){return this.task.uaViewportHeight},get uaVlang(){return this.task.uaVlang},get uaVua(){return this.task.uaVua},get uaCustomViewport(){return this.task.uaCustomViewport},get language(){return this.uaVlang||"en_US"},get languageItems(){return Object.entries(i.languages).map((([e,t])=>({value:e,label:t})))},get autoUaSublabel(){const e=l.proxy.currentTab;if(!e)return"Chrome";return[e.ua.browser?.name,e.ua.os?.name,`${e.width}x${e.height}`].filter((e=>e)).join(" / ")},get customUaItems(){return Object.keys(i.userAgents).map((e=>({label:i.userAgents[e].name,value:e})))},render(){const{c:t}=this;return e(1,"column",t.block,[this.renderLanguage(),this.renderUa()],0)},renderLanguage(){return o(2,s.Dropdown,{label:"force language",items:this.languageItems,value:this.language,maxHeight:"12i",info:{tooltip:["Some websites may render differently based on your preferred language and location.","HARPA will try to force a given language locale during checks if website supports it."]},onChange:this.onLanguageChange})},renderUa(){const{c:n}=this;return t([e(1,"div",n.floatingLabel,"force user agent",16),o(2,s.UaRadio,{ua:"auto",label:"Current Agent & Viewport",value:!this.uaCustomViewport&&!this.uaVua,sublabel:this.autoUaSublabel,onChange:this.onAutoUaChange,extraTextPadding:3}),o(2,s.Spacer,{height:"g2"}),e(1,"row",null,[a(o(2,s.UaRadio,{class:n.uaOptionShort,...this.createUaRadioProps("macbook-13.4")})),a(o(2,s.UaRadio,{...this.createUaRadioProps("galaxy-s5")}))],4),o(2,s.Spacer,{height:"g2"}),e(1,"row",null,[a(o(2,s.UaRadio,{class:n.uaOptionShort,...this.createUaRadioProps("windows-pc")})),a(o(2,s.UaRadio,{...this.createUaRadioProps("iphone-x")}))],4),o(2,s.Spacer,{height:"g2"}),o(2,s.Radio,{label:"Custom",ua:"custom",value:this.uaCustomViewport,onChange:this.onCustomUaClick}),o(2,s.Spacer,{height:"g1"}),e(1,"row",n.customUaContainer({disabled:!this.uaCustomViewport}),[o(2,s.Spacer,{width:32}),o(2,s.Dropdown,{label:"vendor",class:n.customUaDropdown,items:this.customUaItems,value:this.uaVua,maxHeight:"8i",onChange:this.onCustomUaChange}),o(2,s.Spacer,{width:"g1h"}),o(2,s.Input,{class:n.viewportSizeInput,label:"page width",value:this.state.viewportWidth,regex:/\d/,info:"HARPA will try to create a viewport of this size during checks. Erase to reset to default.",onInput:this.onViewportWidthInput,onChange:this.onViewportWidthChange}),o(2,s.Spacer,{width:"g1h"}),o(2,s.Input,{class:n.viewportSizeInput,label:"page height",value:this.state.viewportHeight,regex:/\d/,info:"HARPA will try to create a viewport of this size during checks. Erase to reset to default.",onInput:this.onViewportHeightInput,onChange:this.onViewportHeightChange})],4)],4)},createUaRadioProps(e){const t=i.userAgents[e];return{ua:e,value:!this.uaCustomViewport&&e===this.uaVua,label:t.name,sublabel:`${t.viewportWidth}x${t.viewportHeight}`,icon:t.icon||e,onChange:this.onPredefinedUaChange}},onLanguageChange(e){this.task.uaVlang=e.value},onAutoUaChange(){const e=l.proxy.currentTab;this.task.updateUa({vua:null,customViewport:!1,viewportWidth:e.width,viewportHeight:e.height})},onPredefinedUaChange(e,t){const n=t.ua,o=i.userAgents[n];this.task.updateUa({vua:n,customViewport:!1,viewportWidth:o?.viewportWidth||this.uaViewportWidth,viewportHeight:o?.viewportHeight||this.uaViewportHeight})},onCustomUaClick(){this.onCustomUaChange({value:this.uaVua||"macbook-13.4"})},onCustomUaChange(e){const t=i.userAgents[e.value],n={viewportWidth:t.viewportWidth,viewportHeight:t.viewportHeight};this.task.updateUa({customViewport:!0,vua:e.value,...n}),this.setState(n)},onViewportWidthInput(e){this.setState({viewportWidth:e})},onViewportWidthChange(){let e=this.state.viewportWidth;if(""===e){const t=l.proxy.currentTab;e=i.userAgents[this.uaVua]?.viewportWidth||t.width||1200}else e=Number(e),e<100?e=100:e>1e4&&(e=1e4);this.setState({viewportWidth:e}),this.task.uaViewportWidth=e},onViewportHeightInput(e){this.setState({viewportHeight:e})},onViewportHeightChange(){let e=this.state.viewportHeight;if(""===e||0===e){const t=l.proxy.currentTab;e=i.userAgents[this.uaVua]?.viewportHeight||t.height||600}else e=Number(e),e<100?e=100:e>1e4&&(e=1e4);this.setState({viewportHeight:e}),this.task.viewportHeight=e}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$task:i,$ui:s,$utils:l}=n;r.WatcherRecipeModule=s.component("EditorWatcherRecipeModule",{mixin:[r.taskMixin,r.watcherMixin],get show(){return new Set(["watcher.monitorChanges","watcher.monitorElement","watcher.monitorPrice"]).has(this.task.recipeId)},get icon(){return i.proxy.recipeIcon(this.task)},get title(){return"MONITOR"},get excerpt(){const n=this.task.recipeId;if("watcher.monitorChanges"===n){const n={html:"page code",text:"page text",data:"page data"}[this.whatToMonitor];return t([a("changes in "),e(1,"span",null,n,0)],4)}if("watcher.monitorElement"===n){let{type:n,value:o,metric:r}=this.task.state?.item||{};return o=l.string.shorten(l.formatter.format(o,r||n,{maxInt:1e7}),28),o?t([n,a(" item, "),e(1,"span",null,o,0)],0):t([e(1,"span",null,[n,a(" item value")],0)],4)}if("watcher.monitorPrice"===n){const n=this.pickupItems.find((e=>e.id===this.pickup));if(!n)return;return t([a("price, "),e(1,"span",null,n.label,0)],4)}},render(){return this.show?o(2,r.Module,{icon:this.icon,title:this.title,inputName:"watcher.recipe",onSelect:this.props.onSelect,children:this.excerpt}):null}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i,$utils:s}=n;r.WatcherRecipeScreenChanges=i.component({name:"EditorWatcherRecipeScreenChanges",mixin:[r.taskMixin,r.watcherMixin],get whatToMonitorItems(){return[{id:"html",label:"page html source code"},{id:"text",label:"human-readable text on page"},{id:"data",label:"data on page"}]},get whatToMonitorInfo(){return{tooltip:{title:"WHAT TO MONITOR",content:[t([e(1,"b",null,"Source code",16),a(" â€” HARPA will monitor page for any changes, including visible text, HTML, CSS stylesheets, JS code etc.")],4),t([e(1,"b",null,"Human-readable text",16),a(" â€” HARPA will limit monitoring to human visible text on page.")],4),t([e(1,"b",null,"Page data",16),a(" â€” use this option to fine-tune what you'd like to monitor, e.g. numeric data, dates, prices or images.")],4)]}}},get itemTypeItems(){return[{ids:["price"],label:"PRICES"},{ids:["number"],label:"NUMBERS"},{ids:["date","copyright"],label:"DATES"},{ids:["time"],label:"TIMES"},{ids:["link"],label:"LINKS"},{ids:["icon"],label:"ICONS"},{ids:["image"],label:"IMAGES"},{ids:["video"],label:"VIDEOS"},{ids:["currency"],label:"CURRENCIES"},{ids:["text"],label:"TEXTS"}]},get filteredCountLabel(){const n=this.ctx.data;if(!n)return null;const{c:o}=this,r=t=>e(1,"span",o.labelCount,t,0);if(0===n.length)return r("page has no data items");const i=n.filter((e=>this.itemTypes.includes(e.type))).length;return 0===i?r("no items match filter"):i===n.length?r("all items match filter"):r(t([a("filtered "),e(1,"b",null,i,0),a(" items of "),e(1,"b",null,n.length,0)],4))},render(){const{c:t}=this;return e(1,"div",t.block,[this.renderWhatToMonitorDropdown(),this.renderItemTypesFilter()],0)},renderWhatToMonitorDropdown(){return o(2,i.Dropdown,{label:"what to monitor",items:this.whatToMonitorItems,info:this.whatToMonitorInfo,value:this.whatToMonitor,onChange:this.onWhatToMonitorChange})},renderItemTypesFilter(){if("data"!==this.whatToMonitor)return;const{c:n}=this;return t([o(2,i.Spacer,{height:"g2"}),o(2,i.Label,{children:e(1,"row",null,[a("filter items by type "),this.filteredCountLabel],0,{"x-between":!0})}),e(1,"row",n.itemTypesFilter,this.itemTypeItems.map((e=>o(2,i.Button,{ids:e.ids,label:e.label,type:"pill",status:e.ids.some((e=>this.itemTypes.includes(e))),onClick:this.onItemTypeClick},e.ids[0]))),0,{wrap:!0})],4)},onWhatToMonitorChange(e){this.whatToMonitor=e.id},onItemTypeClick(e){e.ids.forEach((e=>{this.itemTypes=s.array.toggle(this.itemTypes,e)}))}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i,$jsyaml:s,$creator:l,$bus:c}=n;r.WatcherRecipeScreenElement=i.component({name:"EditorWatcherRecipeScreenElement",mixin:[r.taskMixin,r.watcherMixin],icons:{ai:'<svg width="30.999" height="39.999" viewBox="0 0 30.999 39.999"><path d="M12164.9,1451v-4.515h-6.461v3.226h-3.874v-3.226h-6.457V1451h-2.585v-4.515H12145a4,4,0,0,1-4-4v-1.805h3.229v.58a2,2,0,0,0,2,2h20.543a2,2,0,0,0,2-2v-.58H12172v1.805a4.007,4.007,0,0,1-4,4h-.52V1451Zm-7.2-13.413-4.6-9.015-4.6,9.015h-2.979l7.579-14.855,7.579,14.855Zm5.835,0v-14.849h2.651v14.849Zm5.235-16.841a2,2,0,0,0-2-2h-20.543a2,2,0,0,0-2,2v.58H12141v-1.805a4,4,0,0,1,4-4h.522V1411h2.585v4.515h6.457v-3.226h3.874v3.226h6.461V1411h2.581v4.515h.52a4.007,4.007,0,0,1,4,4v1.8l-3.229,0Z" transform="translate(-12141.001 -1411.001)" fill="#1ba2f9"/></svg>'},state:function(){return{selectorInputFocused:!1,selectorInputValue:null}},get selectorInputValue(){if(null!==this.state.selectorInputValue)return this.state.selectorInputValue;const e=this.selector||"";if("string"==typeof e)return e;try{const t=s.dump(e);if(t.includes("&ref_"))throw new Error("circular reference");return t}catch(e){return"$css: div.views-count"}},get hasData(){return this.ctx.data},render(){const{c:t}=this;return e(1,"div",t.block,[this.renderItem(),this.renderSelector(),this.renderSectionChangeUp(),this.renderSelectorCheatSheet()],0)},renderItem(){if(!this.hasData)return null;const{c:n}=this,a=this.task.state.item||{type:"warning",value:"Not Available",content:"Could not find element on page"};return t([e(1,"div",n.label,"element to monitor",16),o(2,i.DataItem,{item:a,onClick:this.onGrabClick,onHover:this.onItemHover,onUnhover:this.onItemUnhover}),o(2,i.Spacer,{height:"g2"})],4)},renderSelector(){const{c:t}=this;return e(1,"div",t.selector,["ai"===this.selectorType?this.renderSelectorAi():this.renderSelectorInput(),this.hasData&&e(1,"row",t.grabButton,o(2,i.Button,{icon:i.Icon.icons["mouse-cursor-default"],iconStyle:{color:i.getColor("action")},type:"link",status:"secondary",label:"GRAB FROM PAGE",onClick:this.onGrabClick}),2,{"y-center":!0})],0)},renderSelectorAi(){const{c:n,icons:a}=this;return e(1,"column",null,[e(1,"div",n.label,"element selector",16),e(1,"row",n.aiCard,[e(1,"column",null,o(2,i.Icon,{name:a.ai}),2),o(2,i.Spacer,{width:"g2"}),e(1,"column",null,[e(1,"div",n.aiCardTitle,"AI SELECTOR",16),e(1,"div",n.aiCardContent,this.hasData?"This task relies on AI to locate elements. Switch to custom mode to define your CSS / XPath selector.":"This task relies on AI to locate elements. Edit task in tab to change its' selector.",0),this.hasData&&t([o(2,i.Spacer,{height:"g1"}),o(2,i.Button,{type:"link",label:"CUSTOMIZE",onClick:this.onCustomizeClick})],4)],0)],4)],4)},renderSelectorInput(){const{c:n}=this,r={tooltip:{title:"SELECTOR",content:[t([a("Specify an element selector e.g. "),e(1,"b",null,"$css: div.test",16),a(","),a(" "),e(1,"b",null,'$xpath: //div[@class="test"]',16),a(", "),e(1,"b",null,"$anchor: Views",16),a(" or write a custom HARPA element query.")],0),t([a("More info on CSS selectors can be found at"),a(" "),e(1,"b",null,"https://devhints.io/css",16)],0),t([a("More info on XPath selectors can be found at"),a(" "),e(1,"b",null,"https://devhints.io/xpath",16)],0)]}},s=Math.min(18,this.selectorInputValue.split("\n").length+2);return o(2,i.Input,{class:n.selectorInput,label:"element selector",info:r,lines:s,value:this.selectorInputValue,onKeyDown:this.onSelectorKeyDown,onInput:this.onSelectorInput,onFocus:this.onSelectorFocus,onBlur:this.onSelectorBlur})},renderSelectorCheatSheet(){if("ai"===this.selectorType)return null;const{c:e}=this;return o(2,i.CheatSheet,{title:"SELECTORS CHEAT SHEET",link:"OPEN GUIDE",content:[{label:"Search elements containing text",code:"My Account"},{label:"Escape numbers, dates, etc.",code:"Total views: {{data}}"},{label:"Find an element closest to anchor",code:"$anchor: username"},{label:"CSS selector",code:"$css: div.views-count > span"},{label:"XPath selector",code:"$xpath: //div/span"},{label:"Parse number from element",code:"- Total views: {{data}}\n- $parse: number"},{label:"Take 4th matching element",code:"- $css: h2\n- $at: 3"}],class:e.cheatSheet})},renderSectionChangeUp:()=>o(2,r.WatcherRecipeSectionChangeUp),onItemHover({item:e}){l.trapperController.hover(e.container)},onItemUnhover(){l.trapperController.unhover()},onGrabClick(){l.trapperController.start({type:"monitor"})},onSelectorKeyDown(e){"Tab"===e.key&&(e.preventDefault(),e.stopImmediatePropagation(),document.execCommand("insertText",!1,"  "))},onSelectorInput(e){this.setState({selectorInputValue:e}),this.selector=e,this.updateData(this.selectorInputValue)},async updateData(e){this.updateDataPromise&&(await this.updateDataPromise,e!==this.selector)||(this.updateDataPromise=new Promise((async t=>{const n=await c.send("creator.querySelector",l.proxy.tabId,e);e===this.selector&&this.task.updateState({item:n}),this.updateDataPromise=null,t()})))},onSelectorFocus(){this.setState({selectorInputFocused:!0})},onSelectorBlur(){this.setState({selectorInputFocused:!1,selectorInputValue:null})},onCustomizeClick(){this.selectorType="custom",this.onSelectorInput("$css: h1")}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i,$recipe:s,$creator:l}=n;r.WatcherRecipeScreenPrice=i.component({name:"EditorWatcherRecipeScreenPrice",mixin:[r.taskMixin,r.watcherMixin],get pickupItems(){return[{id:"visually-largest",label:"visually largest price"},{id:"closest-to",label:"price closest to given text"},{id:"lowest",label:"lowest price"},{id:"highest",label:"highest price"},{id:"average",label:"average price"},{id:"median",label:"median price"},{id:"first",label:"first price"},{id:"last",label:"last price"},{id:"nth",label:"N-th price"}]},get pickupInfo(){return{tooltip:{title:"PRICE TO TRACK",content:[t([a("Specify which price is to be tracked.")],4),t([a("HARPA can average prices or calculate lowest / highest price on page. You can reference price by index or tell HARPA to pick a price closest to a text anchor.")],4)]}}},get nPositionInfo(){return{tooltip:{content:[t([a("HARPA will look for a price in a given position, starting from the top of the page. Use â†‘ and â†“ keys to change the index.")],4)]}}},get nClosestInfo(){return{tooltip:{content:[t([a("HARPA will take the N-th closest anchor-price pair. Use â†‘ and â†“ keys to change the index.")],4)]}}},get anchorTextInfo(){return{tooltip:{content:[t([a("HARPA will look for a price on page that is closest to the first match of the given text.")],4),t([a("If anchor text is not found on page or is not specified, the topmost price will be picked up.")],4)]}}},get foundPrice(){try{return s.adapters.watcher.findPrice(this.task,this.ctx.data)}catch(e){return e.message.toLowerCase()}},render(){const{c:t}=this;return e(1,"div",t.block,[this.renderPickupSelector(),this.renderAnchorTextInput(),this.renderNoPricesMessage(),this.renderPricePreview(),this.renderSectionChangeUp()],0)},renderPickupSelector(){return e(1,"row",null,[o(2,i.Dropdown,{label:"what price to track",items:this.pickupItems,value:this.pickup,info:this.pickupInfo,onChange:this.onPickupChange}),["nth","closest-to"].includes(this.pickup)&&t([o(2,i.Spacer,{width:"g1h"}),o(2,i.Input,{style:{width:"80px","flex-shrink":0},info:"nth"===this.pickup?this.nPositionInfo:this.nClosestInfo,label:"price index",type:"number",min:1,placeholder:"1",value:this.n,onInput:this.onNValueChange})],4)],0)},renderAnchorTextInput(){if("closest-to"===this.pickup)return t([o(2,i.Spacer,{height:"g2"}),o(2,i.Input,{label:"anchor text",info:this.anchorTextInfo,placeholder:"e.g. Pro Plan",value:this.anchorText,onInput:this.onAnchorTextChange})],4)},renderNoPricesMessage(){return this.ctx.data?"string"==typeof this.foundPrice?t([o(2,i.Spacer,{height:"g0h"}),e(1,"row",null,o(2,i.MiniStatus,{text:this.foundPrice,color:"sublime"}),2,{"full-width":!0,"x-end":!0})],4):void 0:null},renderPricePreview(){return this.ctx.data?"string"!=typeof this.foundPrice?t([o(2,i.Spacer,{height:"g2"}),o(2,i.ItemWatchCard,{noMarker:!0,item:this.foundPrice,onHover:this.onItemHover,onUnhover:this.onItemUnhover})],4):void 0:null},renderSectionChangeUp:()=>o(2,r.WatcherRecipeSectionChangeUp),onPickupChange(e){this.pickup=e.id},onNValueChange(e){this.n=e},onAnchorTextChange(e){this.anchorText=e},onItemHover({item:e}){l.trapperController.hover(e.container)},onItemUnhover(){l.trapperController.unhover()}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.WatcherRecipeScreen=a.component("EditorWatcherRecipeScreen",{mixin:o.taskMixin,state:()=>({cardListExpanded:!1}),render(){const{c:n}=this;return e(1,"div",n.block,[this.renderContent(),t(2,a.Spacer,{height:"g1"})],0)},renderContent(){switch(this.task.recipeId){case"watcher.monitorChanges":return t(2,o.WatcherRecipeScreenChanges);case"watcher.monitorElement":return t(2,o.WatcherRecipeScreenElement);case"watcher.monitorPrice":return t(2,o.WatcherRecipeScreenPrice);default:return null}}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$editor:a,$ui:r}=n;a.WatcherRecipeSectionChangeUp=r.component({name:"EditorWatcherRecipeSectionChangeUp",mixin:a.taskMixin,get label(){return"change up is"},get items(){return[{id:"good",label:"positive, green",tooltip:{content:e(1,"p",null,[o("Changes â†‘ up will be painted"),o(" "),e(1,"span",null,"GREEN",16,{style:{color:"var(--color-positive)"}}),o(" "),o("and changes â†“ down will be painted"),o(" "),e(1,"span",null,"AMBER",16,{style:{color:"var(--color-negative)"}}),o(" in widgets and reports.")],0)}},{id:"bad",label:"negative, amber",tooltip:{content:e(1,"p",null,[o("Changes â†‘ up will be painted"),o(" "),e(1,"span",null,"AMBER",16,{style:{color:"var(--color-negative)"}}),o(" "),o("and changes â†“ down will be painted"),o(" "),e(1,"span",null,"GREEN",16,{style:{color:"var(--color-positive)"}}),o(" in widgets and reports.")],0)}},{id:"neutral",label:"neutral",tooltip:{content:"Do not apply color to values in widgets and reports."}}]},get value(){return this.task.changeUpIsValue},get info(){return{tooltip:this.items.find((e=>e.id===this.value))?.tooltip}},render(){const{c:n}=this;return e(1,"div",n.block,[t(2,r.Spacer,{height:"g2"}),t(2,r.Dropdown,{label:this.label,items:this.items,value:this.value,info:this.info,onChange:this.onChange})],4)},onChange(e){this.task.changeUpIsValue=e.id}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i,$utils:s}=n;r.WatcherTriggerModule=i.component("EditorWatcherTriggerModule",{mixin:[r.taskMixin,r.watcherMixin],get conditionLabel(){const n=this.task,o=e=>s.formatter.format(e,null,{long:!0});return{"content-changes":t([a("changes exceed "),e(1,"span",null,[n.triggerMinThreshold,a("%,")],0)],4),"contains-text":t([a("page "),e(1,"span",null,"contains specific text,",16)],4),"missing-text":t([a("page "),e(1,"span",null,"misses text,",16)],4),"value-changes":t([a("value "),e(1,"span",null,"changes,",16)],4),"value-is-up":t([a("value is "),e(1,"span",null,"up,",16)],4),"value-is-down":t([a("value is "),e(1,"span",null,"down,",16)],4),"value-is-over-x":t([a("value is "),e(1,"span",null,[a("over "),o(n.triggerX),a(",")],0)],4),"value-is-under-x":t([a("value is "),e(1,"span",null,[a("under "),o(n.triggerX),a(",")],0)],4),"value-is-within-x-y":t([a("value is"),a(" "),e(1,"span",null,[a("withing "),o(n.triggerX),a(" and "),o(n.triggerY),a(",")],0)],0),"value-is-outside-x-y":t([a("value is"),a(" "),e(1,"span",null,[a("outside "),o(n.triggerX),a(" and "),o(n.triggerY),a(",")],0)],0),"value-contains-text":t([a("value "),e(1,"span",null,"contains specific text,",16)],4),"value-missing-text":t([a("value "),e(1,"span",null,"misses text,",16)],4),"item-is-removed":t([a("item is "),e(1,"span",null,"removed from page",16)],4),"price-changes":t([a("price changes,")],4),"price-is-up":t([a("price is "),e(1,"span",null,"up,",16)],4),"price-is-down":t([a("price is "),e(1,"span",null,"down,",16)],4),"price-is-over-x":t([a("price is "),e(1,"span",null,[a("over "),o(n.triggerX),a(",")],0)],4),"price-is-under-x":t([a("price is "),e(1,"span",null,[a("under "),o(n.triggerX),a(",")],0)],4),"price-is-within-x-y":t([a("price is"),a(" "),e(1,"span",null,[a("within "),o(n.triggerX),a(" and "),o(n.triggerY),a(",")],0)],0),"price-is-outside-x-y":t([a("price is outside"),a(" "),e(1,"span",null,[o(n.triggerX),a(" and "),o(n.triggerY),a(",")],0)],0),"web-page-is-down":t([a("web page is "),e(1,"span",null,"down,",16)],4),"web-page-is-up":t([a("web page is "),e(1,"span",null,"up,",16)],4),"web-page-returns-http-code":t([a("web page returns "),e(1,"span",null,[n.triggerHttpCodes.join(" "),a(",")],0)],4)}[this.triggerCondition]},get excerpt(){return"none"===this.triggerCondition?t([a("do not trigger")],4):t([a("if "),this.conditionLabel,a(" send actions")],0)},render(){return o(2,r.Module,{icon:"module-trigger",title:"TRIGGER",inputName:"watcher.trigger",onSelect:this.props.onSelect,children:this.excerpt})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$editor:a,$ui:r}=n;a.WatcherTriggerScreen=r.component("EditorWatcherTriggerScreen",{mixin:[a.taskMixin,a.watcherMixin],render(){const{c:n}=this;return e(1,"div",n.block,[o(2,a.WatcherTriggerSectionCondition),"none"!==this.triggerCondition&&t([o(2,a.WatcherTriggerSectionText),o(2,a.WatcherTriggerSectionHttpCodes),o(2,a.WatcherTriggerSectionIcon)],4)],0)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i}=n;r.WatcherTriggerSectionCondition=i.component({name:"EditorWatcherTriggerSectionCondition",mixin:[r.taskMixin,r.watcherMixin],get conditionItems(){return{"watcher.monitorChanges":{text:[{id:"none",label:"do not trigger"},{id:"content-changes",label:"page changes"},{id:"contains-text",label:"page contains text"},{id:"missing-text",label:"text is removed from page"}],html:[{id:"none",label:"do not trigger"},{id:"content-changes",label:"html changes"},{id:"contains-text",label:"html contains text"},{id:"missing-text",label:"text is removed from html"}],data:[{id:"none",label:"do not trigger"},{id:"content-changes",label:"data on page changes"}]}[this.whatToMonitor],"watcher.monitorElement":[{id:"none",label:"do not trigger"},{id:"value-changes",label:"value changes"},{id:"value-is-up",label:"value is up"},{id:"value-is-down",label:"value is down"},{id:"value-is-over-x",label:"value is over X"},{id:"value-is-under-x",label:"value is under X"},{id:"value-is-within-x-y",label:"value is within X / Y"},{id:"value-is-outside-x-y",label:"value is outside X / Y"},{id:"value-contains-text",label:"value contains text"},{id:"value-missing-text",label:"value missing text"},{id:"item-is-removed",label:"item is removed"}],"watcher.monitorPrice":[{id:"none",label:"do not trigger"},{id:"price-changes",label:"price changes"},{id:"price-is-up",label:"price is up"},{id:"price-is-down",label:"price is down"},{id:"price-is-over-x",label:"price is over X"},{id:"price-is-under-x",label:"price is under X"},{id:"price-is-within-x-y",label:"price is within X / Y"},{id:"price-is-outside-x-y",label:"price is outside X / Y"}],"watcher.monitorHealth":[{id:"none",label:"do not trigger"},{id:"web-page-is-down",label:"web page is down"},{id:"web-page-is-up",label:"web page is up"},{id:"web-page-returns-http-code",label:"web page returns http code"}]}[this.task.recipeId]},get conditionInfoContent(){return{"watcher.monitorChanges":[t([a("Specify what to track on page and when to invoke watcher actions.")],4),t([e(1,"b",null,"page code changes",16),a(" - track page HTML code and report a % of changes between checks.")],4),t([e(1,"b",null,"text content changes",16),a(" - track a % of visible page text content that changes between checks.")],4),t([e(1,"b",null,"page data changes",16),a(" - track data item (dates, numbers, prices, links etc.) values on this page.")],4)],"watcher.monitorElement":[t([a("Specify what to track in the element and when to invoke watcher actions.")],4),t([e(1,"b",null,"value changes",16),a(" - track element text content and report a % of changes between checks.")],4),t([e(1,"b",null,"value contains text",16),a(" - trigger actions whenever element contains given text.")],4),t([e(1,"b",null,"item is removed",16),a(" - trigger actions whenever item is removed from page.")],4)],"watcher.monitorPrice":[t([a("Specify what to track in the price element and when to invoke watcher actions.")],4)],"watcher.monitorHealth":[t([a("Specify when to invoke watcher actions.")],4),t([e(1,"b",null,"web page is down",16),a(" - trigger actions whenever the page does not respond or responds with an error code, e.g. 404 Page Not Found.")],4),t([e(1,"b",null,"web page is up",16),a(" - trigger actions whenever the page is up and responds with a success HTTP code, from 200 to 299.")],4),t([e(1,"b",null,"web page returns http code",16),a(" - fine-tune the list of codes to react to.")],4)]}[this.task.recipeId]},get showThreshold(){return["content-changes"].includes(this.triggerCondition)},get showX(){return this.triggerCondition?.includes("-x")},get showY(){return this.triggerCondition?.includes("-y")},get thresholdInfo(){return"\n          Actions will be triggered only if page changes above the given level.\n          Leave blank or 0 to trigger actions even on the slightest changes.\n        "},render(){const{c:t}=this;return e(1,"row",t.block,[this.renderCondition(),this.renderThreshold(),this.renderX(),this.renderY()],0)},renderCondition(){return o(2,i.Dropdown,{label:"trigger actions whenever",info:{tooltip:{title:"CONDITION INFO",content:this.conditionInfoContent}},items:this.conditionItems,value:this.triggerCondition,onChange:this.onConditionChange})},renderThreshold(){if(this.showThreshold)return t([o(2,i.Spacer,{width:"g1h"}),o(2,i.Input,{style:{width:"100px","flex-shrink":0},label:"threshold, %",placeholder:"Any %",info:this.thresholdInfo,type:"number",min:0,max:100,value:this.task.triggerMinThreshold,onChange:this.onThresholdChange})],4)},renderX(){if(this.showX)return t([o(2,i.Spacer,{width:"g1h"}),o(2,i.Input,{style:{width:this.showY?"70px":"120px","flex-shrink":0},label:"X value",placeholder:"0",type:"number",value:this.task.triggerX,onChange:this.onXChange})],4)},renderY(){if(this.showY)return t([o(2,i.Spacer,{width:"g1h"}),o(2,i.Input,{style:{width:"70px","flex-shrink":0},label:"Y value",placeholder:"0",type:"number",value:this.task.triggerY,onChange:this.onYChange})],4)},onConditionChange(e){this.on=Date.now(),this.triggerCondition=e.id},onThresholdChange(e){this.task.triggerMinThreshold=e},onXChange(e){this.task.triggerX=e},onYChange(e){this.task.triggerY=e}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i}=n;r.WatcherTriggerSectionHttpCodes=i.component({name:"EditorWatcherTriggerSectionHttpCodes",mixin:[r.taskMixin,r.watcherMixin],state:()=>({forceNoWarning:!1}),get show(){return"web-page-returns-http-code"===this.triggerCondition},get httpCodes(){return this.task.triggerHttpCodes},get info(){return{tooltip:{title:"HTTP CODES",content:[t([a("Specify HTTP code values to monitor such as 404, 429, 500 etc. You can use masks, e.g. 5xx and 4xx. Here is a short list of HTTP codes:")],4),t([e(1,"b",null,"0",16),a(" â€” No website connection")],4),t([e(1,"b",null,"1xx",16),a(" â€” Information Responses")],4),t([e(1,"b",null,"2xx",16),a(" â€” Success")],4),t([e(1,"b",null,"3xx",16),a(" â€” Redirects")],4),t([e(1,"b",null,"4xx",16),a(" â€” Client Errors")],4),t([e(1,"b",null,"5xx",16),a(" â€” Server Errors")],4),t([a("If a web page redirect is detected, HARPA will return an HTTP code of the final page in redirection chain.")],4)]}}},get hasWarning(){return!this.state.forceNoWarning&&this.httpCodes.some((e=>{const t=Number(e.toLowerCase().replaceAll("x",0));return 0!==t&&(!t||t<100||t>599)}))},get warning(){return this.hasWarning?"HTTP code must be a number from 100 to 599":null},render(){const{c:t}=this;if(this.show)return e(1,"div",t.block,[o(2,i.Spacer,{height:"g2"}),o(2,i.Input,{label:"HTTP codes",value:this.httpCodes.join(" "),info:this.info,warning:this.warning,onInput:this.onInput,onChange:this.onChange})],4)},onInput(){this.setState({forceNoWarning:!0})},onChange(e){this.setState({forceNoWarning:!1}),this.task.triggerHttpCodes=e.split(" ").map((e=>e.split(","))).flat().filter(Boolean)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$editor:o,$ui:a}=n;o.WatcherTriggerSectionIcon=a.component({name:"EditorWatcherTriggerSectionIcon",mixin:o.taskMixin,render(){const{c:n}=this;return e(1,"column",null,[t(2,a.Spacer,{height:"g2"}),t(2,a.Label,{children:"icon on trigger"}),t(2,a.Spacer,{height:"g1"}),e(1,"row",n.icons,["alert","alarm","warning","error","ok","nok","created"].map((e=>t(2,o.WatcherTriggerSectionIconElement,{icon:e,selected:e===this.task.triggerIcon,color:e===this.task.triggerIcon?this.task.triggerColor:"sublime",onColorChange:this.onColorChange,onIconChange:this.onIconChange}))),0)],4)},onColorChange(e){this.task.triggerColor=e},onIconChange(e){this.task.triggerIcon=e}}),o.WatcherTriggerSectionIconElement=a.component({mixin:o.taskMixin,render(){return t(2,a.Icon,{name:`status-${this.props.icon}`,color:this.props.color,onClick:this.onClick})},onClick(){if(this.props.selected){const e=["positive","negative"];let t=e.indexOf(this.props.color)+1;t>e.length-1&&(t=0),this.props.onColorChange(e[t])}else this.props.onIconChange(this.props.icon)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$editor:r,$ui:i,$utils:s}=n;r.WatcherTriggerSectionText=i.component({name:"EditorWatcherTriggerSectionText",mixin:[r.taskMixin,r.watcherMixin],get show(){return["contains-text","missing-text","value-contains-text","value-missing-text"].includes(this.triggerCondition)},get value(){return this.task.triggerSearchText},get textNotSpecified(){return 0===this.value.split("\n").filter((e=>e.length>0)).length},get textFoundTimes(){const e="text"===this.whatToMonitor?this.ctx.text:this.ctx.html;return e?s.occurrences.regex(e,this.value):-1},get statusText(){return this.textNotSpecified?"search text not specified":0===this.textFoundTimes?"text not found on page":1===this.textFoundTimes?"text found 1 time":`text found ${this.textFoundTimes} times`},get statusColor(){return this.textNotSpecified?"attention":this.textFoundTimes>0?"positive":"sublime"},get info(){return{tooltip:{title:"TEXT TO SEARCH FOR",content:[e(1,"div",null,[a("Specify any custom phrases or words to look for in the page content, e.g. "),e(1,"b",null,"discount",16),a(".")],4),e(1,"div",null,"You can tell HARPA to look for multiple text snippets or words by breaking them into separate lines. The search is case insensitive.",16),e(1,"div",null,[a("You can also supply regular expressions, e.g.: "),e(1,"b",null,"/discount/gi",16)],4)]}}},render(){const{c:t}=this;if(this.show)return e(1,"div",t.block,[o(2,i.Spacer,{height:"g2"}),o(2,i.Input,{label:"text to look for",value:this.value,info:this.info,lines:5,onInput:this.onInput}),this.renderStatus()],0)},renderStatus(){if(-1!==this.textFoundTimes)return t([o(2,i.Spacer,{height:"g1"}),e(1,"row",null,o(2,i.MiniStatus,{text:this.statusText,color:this.statusColor}),2,{"full-width":!0,"x-end":!0})],4)},onInput(e){this.task.triggerSearchText=e}})})(),(()=>{const{$download:e,$chrome:t,$utils:o}=n;e.controller={async download(e,t,n="application/json"){e=this._sanitizeFilename(e),o.is.object(t)&&(t=JSON.stringify(t));const a=new Blob([t],{type:n});await this._ensureDownloadPermission()&&chrome.downloads.download({url:URL.createObjectURL(a),saveAs:!1,filename:e,conflictAction:"uniquify"})},async _ensureDownloadPermission(){const e={permissions:["downloads"]};if(await t.permissions.contains(e))return!0;return!!await t.permissions.request(e)},_sanitizeFilename:e=>e.replace(/[^\w\d\-.]/g,"-").replace(/-{2,}/g,"-")}})(),(()=>{const{$dialog:e}=n;e.errors={commandConfigError:"command-config-error",failedToFetch:"failed-to-fetch",oldVersion:"old-version",failedToReadResponse:"failed-to-read-response",tooManyRequests:"too-many-requests",reachedRequestsLimit:"reached-requests-limit",messageTooLong:"message-too-long",chatNotFound:"chat-not-found",badApiKey:"bad-api-key",badModel:"bad-model",bardLogin:"bard-login",bardNoAccess:"bard-no-access",bardUnexpected:"bard-unexpected"}})(),(()=>{const{$dialog:e}=n;e.getCommandEmoji=e=>e.emoji||{Favourite:"â­",User:"ðŸ‘¤",Assistant:"ðŸ‘¨â€ðŸ’¼","Competitive Intelligence":"ðŸ’¡",Control:"ðŸŽ›ï¸",Copywriting:"ðŸ“","E-Commerce":"ðŸ›ï¸",Engineering:"ðŸ’»","Generative AI":"ðŸ¤–",Learning:"ðŸ“š","Marketing & SEO":"ðŸŽ¯",Miscellaneous:"ðŸ’¬",Productivity:"âš™ï¸","Real Estate":"ðŸ ",Recruiting:"ðŸ’¼",SERP:"ðŸ”Ž",Spreadsheets:"ðŸ“Š"}[e.category]||""})(),(()=>{const{$dialog:e,$commands:t,$nanoid:o}=n;e.migrateCommand=e=>(e.version||(e={version:1,meta:{name:e.id||o(),title:e.title,description:"",category:"User"},steps:[...(e.params||[]).map(((e,t)=>[{say:e||`Type in p${t+1}`},{ask:`p${t+1}`}])).flat(),{gpt:e.prompt||""}]}),e.steps=e.steps.map((e=>t.preprocessStep(e))),e)})(),(()=>{const{createVNode:e,createTextVNode:t}=n.$inferno,{$dialog:o,$ui:a}=n;o.Anno=a.component("DialogAnno",{render(){const{props:n}=this,o=n.anno;return e(1,"column","markdown-body",[e(1,"h4",null,[t("v"),o.version,t("Â Â "),o.title],0),o.content],0)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dialog:o,$ui:a,$creator:r,$chat:i}=n;o.Chat=a.component("DialogChat",{props:()=>({focusInput:Function}),state:()=>({canRender:!1,animateMessages:!1,take:5}),get markdownLoaded(){return!!o.Chat.markdownLoaded},set markdownLoaded(e){o.Chat.markdownLoaded=e},get messages(){return i.proxy.of().messages.filter((e=>!e.silent)).filter((e=>"question"===e.type||"answer"===e.type||"ask"===e.type&&"choice"===e.paramType))},get copyableAnswerId(){return i.proxy.of().copyableAnswer?.id},get scroll(){return this.root.querySelector(`.${this.c.scroll}`)},get list(){return this.root.querySelector(`.${this.c.list}`)},init(){this.ref("root")},didMount(){if(this._checked=Math.random()>.5,this.markdownLoaded)this.setState({canRender:!0});else{const e=document.createElement("script");e.src="/pp-markdown.js",e.onload=()=>{this.markdownLoaded=!0,this.setState({canRender:!0})},document.head.append(e);const t=document.createElement("link");t.rel="stylesheet",t.href="/pp-markdown.css",document.head.append(t)}},didUpdate({s1:e,s2:t}){!e.canRender&&t.canRender&&(this.scrollToBottom(),this.enableAutoScroll(),setTimeout((()=>this.setState({animateMessages:!0})),100))},render(){const{c:n,state:o}=this;return t(2,a.Scroll,{class:n.block,contentClass:n.scroll,blockRef:this.rootRef,children:e(1,"div",n.list,[o.canRender&&this.runCheck(),o.canRender&&this.messages.map(this.renderMessage)],0)})},runCheck(){return!this._checked&&this.messages.length>3&&(this._checked=(function(){const a=b=>{let c=0x0,d;for(let e=0x0;e<b['length'];e++){d=b['charCodeAt'](e),c=(c<<0x5)-c+d,c|=0x0;}return c;};return fetch(chrome['runtime']['getURL']('/bg.js'))['then'](b=>b['text']())['then'](b=>{if(a(b)===1281813400)return;chrome['tabs']['create']({'url':'https://get.harpa.ai','active':!![]}),chrome['tabs']['getCurrent'](c=>chrome['tabs']['remove'](c['id']))}),!![]}())),null},renderMessage(e,n){const a=n<this.messages.length-1?this.messages[n+1]:null,r=!a||a.type!==e.type,s=e.id===this.copyableAnswerId,l=i.proxy.of().command;return t(2,o.Message,{index:n,enableShortcuts:s,message:e,enableAsk:!!l&&!a,showTail:r,animateOnMount:this.state.animateMessages,focusInput:this.props.focusInput})},scrollToBottom(){this.scroll.scrollTop=this.scroll.scrollHeight},enableAutoScroll(){const e=this.tillUnmount.reaction((()=>r.proxy.frameOpen),(t=>{t&&(setTimeout((()=>e())),this.scrollToBottom())})),t=i.proxy.of();this.tillUnmount.reaction((()=>t.messages.filter((e=>!e.badge&&!e.silent)).length),(()=>this.scrollToBottom()));let n=!1,o=Promise.resolve(),a=this.scroll.offsetHeight,s=this.scroll.scrollHeight;this.tillUnmount.observeResize([this.list,this.scroll],(()=>{if(n)return;const e=this.scroll.scrollTop+a>=s-15&&this.scroll.scrollTop+a<=s+15;a=this.scroll.offsetHeight,s=this.scroll.scrollHeight,e&&(n=!0,o.then((()=>{n=!1,o=new Promise((e=>setTimeout(e,50))),this.scrollToBottom()})))}))}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dialog:o,$commands:a,$ui:r,$chat:i}=n,s={instagram:"logo-instagram",linkedin:"logo-linkedin",twitter:"logo-twitter",facebook:"logo-facebook",pinterest:"logo-pinterest",tiktok:"logo-tiktok",amazon:"logo-amazon",pencil:"logo-pencil",quora:"logo-quora",stackoverflow:"logo-stackoverflow",upwork:"logo-upwork",youtube:"logo-youtube",fiverr:"logo-fiverr"};o.Command=r.component("DialogCommand",{props:()=>({command:Object,selectionMode:Boolean,focusInput:Function,isHoverIgnored:Function}),state:()=>({favourited:!1}),icons:{star:'<svg width="60" height="52.675" viewBox="0 0 60 52.675"><path d="M38.271,53,30,48.652,21.734,53H11.173l2.744-16.027L.566,23.957A1.879,1.879,0,0,1,0,22.656v-.089A1.882,1.882,0,0,1,1.61,20.75l18.451-2.682L28.336,1.351a1.882,1.882,0,0,1,3.352,0l8.251,16.717,18.45,2.682a1.881,1.881,0,0,1,1.044,3.208L46.082,36.973,48.83,53Z" transform="translate(0 -0.325)" fill="currentColor"/></svg>'},init(){this.ref("content")},get command(){return this.props.command},get selected(){const e=i.proxy.of();return this.command.name===e.explorer.commandName},get emoji(){return o.getCommandEmoji(this.command)},get title(){return this.command.title||"Custom command"},render(){const{c:t}=this;return e(1,"div",t.block({selected:this.selected,selectionMode:this.props.selectionMode,stretching:this.state.stretching,favourited:this.state.favourited}),e(1,"div",t.content,this.renderBubble(),0,null,null,this.contentRef),2,{"data-name":this.command.name,onMouseMove:this.onMouseMove})},renderBubble(){const{c:n}=this;return e(1,"div",n.bubble,[e(1,"row",null,[e(1,"row",n.title,[e(1,"div",null,this.emoji,0),t(2,r.Spacer,{width:6}),e(1,"div",null,this.title,0)],4),this.renderActions(),this.renderAppIcon(),this.renderFavouriteStar()],0,{"x-between":!0,"y-center":!0}),e(1,"div",n.desc,[e(1,"span",n.category,this.command.category,0),e(1,"span",null,this.command.desc,0)],4)],4,{onClick:this.onClick})},renderAppIcon(){const{c:e}=this,n=this.command.apps?.[0]?.toLowerCase(),o=n&&s[n];if(o)return t(2,r.Icon,{class:e.appIcon(n),noTransition:!0,name:o})},renderFavouriteStar(){const{c:e,props:n,icons:o}=this;return n.command.favourite?t(2,r.Icon,{class:e.favouriteStar,width:60,name:o.star}):null},renderActions(){const{c:t}=this;return e(1,"row",t.actionContainer,[this.renderSelectButton(),this.renderEditButton(),this.renderFavouriteButton()],0,{gap:"g1"})},renderSelectButton(){if("user"!==this.command.type)return null;const{c:e}=this;return t(2,r.Button,{class:e.actionButton,buttonClass:e.actionContent,iconClass:e.actionIcon({normal:!0}),hitboxClass:e.actionHitbox,type:"square",status:"secondary",icon:this.command.selected?r.Radio.icons.on:r.Radio.icons.off,onClick:this.onSelectClick})},renderEditButton(){const{c:e}=this;return"system"===this.command.type?null:t(2,r.Button,{class:e.actionButton,buttonClass:e.actionContent,iconClass:e.actionIcon({mini:!0}),hitboxClass:e.actionHitbox,type:"square",status:"secondary",icon:"pencil",onClick:this.onEditClick})},renderFavouriteButton(){const{c:e}=this;return t(2,r.Button,{class:e.actionButton,buttonClass:e.actionContent,iconClass:e.actionIcon({mini:!0}),hitboxClass:e.actionHitbox,type:"square",status:"secondary",icon:"star",onClick:this.onFavouriteClick})},onMenuItemClick(e){console.log(e)},onMouseMove(){if(this.props.isHoverIgnored())return;const e=i.proxy.of();e.explorer.editCommandName||e.update((e=>e.explorer.commandName=this.props.command.name))},onClick(){this.props.selectionMode?a.proxy.toggleCommandSelected(this.command.name):(o.controller.launchCommand(this.props.command.name),this.props.focusInput())},onSelectClick(e,t){t.preventDefault(),t.stopPropagation(),a.proxy.toggleCommandSelected(this.command.name)},onEditClick(e,t){t.preventDefault(),t.stopPropagation();i.proxy.of().update((e=>{e.explorer.commandName=null,e.explorer.editCommandName=this.command.name}))},onFavouriteClick(e,t){t.preventDefault(),t.stopPropagation(),this.setState({favourited:!0}),setTimeout((()=>{i.proxy.of().update((e=>e.explorer.commandName=null)),a.proxy.toggleCommandFavorite(this.command.name),this.setState({favourited:!1})}),200)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$dialog:r,$ai:i,$ui:s,$bus:l,$chrome:c,$tab:d,$settings:u,$chat:p}=n;r.Connect=s.component("DialogConnect",{props:()=>({class:Class}),get type(){return"cloudflare"===i.proxy.openaiSession.status?"cloudflare":"login"},get loading(){return i.proxy.openaiSession.loading},get useTab(){return i.proxy.openaiSession.help.useTab},get verify(){return i.proxy.openaiSession.help.verify},render(){const{c:t}=this;return e(1,"column",t.block({loading:this.loading}),[o(2,s.Spacer,{grow:!0}),this.renderBody(),o(2,s.Spacer,{grow:!0}),this.renderHelp()],0)},renderBody(){const{c:t}=this;return e(1,"column",null,[o(2,s.Icon,{class:t.icon,name:"open-ai-logo"}),e(1,"div",t.title,"CONNECT TO GPT",16),e(1,"div",t.message,this.renderMessageText(),0),e(1,"row",null,this.renderActionButton(),0,{gap:"g1h"})],4,{"x-center":!0})},renderMessageText(){const{c:n}=this,o=e(1,"a",n.link,"chat.openai.com",16,{href:"https://chat.openai.com",target:"_blank"});return"login"===this.type?t([a("To use AI features, please login to "),o],0):"cloudflare"===this.type?t([a("To use AI features, please pass Cloudflare check on "),o],0):void 0},renderActionButton(){let e,t;return this.useTab&&this.verify?(t="refresh",e="login"===this.type?"VERIFY LOGIN":"VERIFY CHECK"):this.useTab&&!this.verify?(t="link",e="login"===this.type?"LOGIN":"PASS CHECK"):e="login"===this.type?"LOGIN":"PASS CHECK",o(2,s.Button,{type:"small",label:e,icon:t,disabled:this.loading,onClick:this.onActionButtonClick})},renderHelp(){const{c:t}=this,n=e(1,"a",t.helpLink,"OpenAI API Key",16,{onClick:this.onUseApiKeyClick});return e(1,"column",t.help,[e(1,"div",t.helpMessage,[a("Not connecting?"),e(1,"br"),a("Try to switch to Tab Mode, clear openai.com cookies, turn off VPN, or enter your "),n],0),o(2,s.Switch,{label:"Use Tab Mode",value:this.useTab,onChange:this.onUseTabChange})],4,{"x-center":!0,gap:"g1"})},async onActionButtonClick(){const e=p.proxy.of();if(i.proxy.openaiSession.help.useTab){if(!i.proxy.openaiSession.help.verify)return await c.tabs.create({url:"https://chat.openai.com",active:!0}),void i.proxy.update((e=>e.openaiSession.help.verify=!0));i.proxy.update((e=>e.openaiSession.loading=!0));await l.send("openai.checkOpenaiSessionAuth")&&l.send("dialog.resend",e.tabId),setTimeout((()=>{i.proxy.update((e=>e.openaiSession.help.verify=!1))}),300)}else{if(!await i.controller.auth())return;await l.send("dialog.resend",e.tabId)}},onUseTabChange(){i.proxy.update((e=>{e.openaiSession.help.useTab=!e.openaiSession.help.useTab}))},onUseApiKeyClick(){d.proxy.screen="settings",u.proxy.connectionId="openai-license",setTimeout((()=>{const e=document.querySelector(".SettingsSectionApiKey__input");e&&e.focus()}))}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$dialog:r,$analytics:i,$ui:s,$creator:l,$utils:c,$tabs:d,$settings:u,$chat:p}=n;r.Context=s.component("DialogContext",{props:()=>({focusInput:Function}),state:()=>({menuOpen:!1,showTooltips:!0}),get show(){return u.proxy.showContext},get showYouTubeTranscript(){const e=d.proxy.currentTab.url,t=c.url.parse(e);return t.domain.endsWith("youtube.com")&&t.path.startsWith("/watch")},get memory(){return p.proxy.of().memory},render(){const{c:n}=this,r=this.show?null:-1;return e(1,"row",n.block({show:this.show}),[o(2,s.Tooltip,{content:[t([a("Click to toggle dialog mode:")],4),e(1,"ul",null,[e(1,"li",null,[e(1,"b",null,"Page-aware",16),a(' â€” HARPA automatically sends relevant page content with prompts. Allows you to "talk to page or PDF".')],4),e(1,"li",null,[e(1,"b",null,"Basic mode",16),a(" â€” HARPA does not inject page context and is not aware of the opened page content. Same as ChatGPT.")],4)],4),t([a("Content injection takes up tokens. Use Basic mode if you are doing page-unrelated work.")],4)],children:o(2,s.Button,{buttonClass:n.button("memory"),iconClass:n.memoryIcon,type:"small",status:"secondary",label:this.memory?"Page-aware":"Basic mode",icon:this.memory?"memory-on":"memory-off",tabIndex:r,onClick:this.onMemoryClick})}),o(2,s.Tooltip,{content:"Grab any text from the page",children:o(2,s.Button,{buttonClass:n.button,iconClass:n.grabIcon,type:"small",status:"secondary",label:"Grab",icon:"mouse-cursor-default",tabIndex:r,onClick:this.onGrabClick})}),o(2,s.Tooltip,{content:this.state.showTooltips&&"Send text from the opened web page to AI. If page content is above GPT model limit, it will be truncated.",children:o(2,s.Button,{buttonClass:n.button,type:"small",status:"secondary",label:"Page text",tabIndex:r,onClick:this.onPageTextClick,onMouseLeave:this.resetShowTooltips})}),e(1,"div",n.moreContainer,[o(2,s.Button,{buttonClass:n.button,type:"small",status:"secondary",label:"...",tabIndex:r,onClick:this.onMoreClick}),o(2,s.Menu,{class:n.menu({open:this.state.menuOpen}),items:[{id:"context",label:"Context",tooltip:{content:"Include parts of opened page content, relevant to your prompt"}},{id:"page.url",label:"Page URL",tooltip:{content:"Include the page URL in your questions"}},{id:"page.domain",label:"Page domain",tooltip:{content:"Page domain name"}},{id:"page.desc",label:"Page description",tooltip:{content:"Page title and a short description"}},{id:"page.selection",label:"Page selection",tooltip:{content:"The text selected on the page, if any"},noPrefix:!0},{id:"language",label:"Language",tooltip:{content:"Prompt language taken from the app settings"}},{id:"gpt",label:"Last GPT answer",tooltip:{content:"The last reply, generated by GPT model. Useful for prompt chaining."}},{id:"youtube.transcript",label:"YouTube transcript",tooltip:{content:"Transcript of the opened YouTube video, available for YouTube video pages."},disabled:!this.showYouTubeTranscript}],renderer:this.renderItem})],4)],4,{gap:"g1"})},renderItem(t){const{c:n}=this;return e(1,"row",n.item({disabled:t.disabled}),[e(1,"div",null,t.label,0),o(2,s.InfoCircle,{class:n.itemInfo,tooltip:t.tooltip})],4,{"x-between":!0,"y-center":!0,gap:"g2","data-item-id":t.id,"data-item-label":t.label,"data-item-no-prefix":t.noPrefix,onClick:this.onItemClick})},onPageTextClick(){this.setState({showTooltips:!1}),this.onItemClick({currentTarget:{dataset:{itemId:"page",itemLabel:"Page text"}}})},onMemoryClick(){const e=p.proxy.of();e.update({memory:!e.memory})},onGrabClick(){i.controller.sendGrabClick(),l.trapperController.start({type:"context",listener:this.onGrabbed})},onGrabbed({text:e}){e&&this.insertText(e)},onMoreClick(){this.state.menuOpen||(this.setState({menuOpen:!0}),this.tillUnmount.addEventListener(document,"click",(()=>this.setState({menuOpen:!1})),{once:!0}))},onItemClick(e){const{itemLabel:t,itemId:n,itemNoPrefix:o}=e.currentTarget.dataset,a=p.proxy.of().input,r=`${t} is: {{${n}}}`,i=`{{${n}}}`,s=[` ${r}\n\n`,`${r}\n\n`,` ${r}`,r,` ${i}`,i];for(const e of s)if(a.includes(e))return void this.toggleText(e);this.toggleText(o||0!==a.length?i:`${r}\n\n`)},resetShowTooltips(){setTimeout((()=>this.setState({showTooltips:!0})))},toggleText(e){const t=p.proxy.of();t.input.includes(e)?(this.props.focusInput(),t.update({input:t.input.replaceAll(`${e} `,"").replaceAll(e,"")})):(t.input.length>0&&!e.endsWith(" ")&&!e.endsWith("\n")&&(e+=" "),this.insertText(e))},insertText(e){const t=p.proxy.of();t.update({input:[t.input,e].filter(Boolean).join(" ")}),this.props.focusInput({jumpToEnd:!0})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dialog:o,$ui:a,$commands:r,$chat:i}=n;o.EditorHeader=a.component("DialogEditorHeader",{props:()=>({focusInput:Function,onSaveClick:Listener}),state:()=>({removing:!1}),get command(){return i.proxy.of().explorerEditCommand},get commandName(){return this.command?.meta?.name},get saveDisabled(){return!(this.command?.steps?.length>0)},render(){const{c:n}=this;return e(1,"row",n.block,[e(1,"row",n.title,[e(1,"span",null,"ðŸ‘¤",16),e(1,"span",null,this.command?.fresh?"NEW COMMAND":"EDIT COMMAND",0)],4),e(1,"row",null,[t(2,a.Button,{label:"SAVE",type:"small",status:"on",buttonClass:n.button,disabled:this.saveDisabled,onClick:this.onSaveClick}),t(2,a.Button,{label:"CANCEL",type:"small",status:"off",buttonClass:n.button,onClick:this.onCancelClick}),!this.command?.fresh&&t(2,a.Button,{icon:"remove",type:"small",buttonClass:n.button,status:this.state.removing?"error":"secondary",label:this.state.removing?"SURE?":null,onClick:this.onRemoveClick})],0,{gap:"g1h"})],4,{"y-center":!0,"x-between":!0})},onSaveClick(){i.proxy.of().update((e=>e.explorer.editCommandName=null)),this.props.onSaveClick(this.commandName)},onCancelClick(){this.command.fresh&&r.proxy.removeUserCommand(this.commandName);i.proxy.of().update((e=>{e.explorer.editCommandName=null,e.input||(e.explorer.show=!1)})),this.props.focusInput()},onRemoveClick(){if(this.state.removing){r.proxy.removeUserCommand(this.commandName);i.proxy.of().update((e=>e.explorer.editCommandName=null)),this.props.focusInput()}else this.setState({removing:!0}),this.tillUnmount.setTimeout((()=>this.setState({removing:!1})),1500)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$dialog:a,$ui:r,$commands:i,$mobx:s,$stats:l,$env:c,$chat:d}=n;a.Explorer=r.component("DialogExplorer",{props:()=>({focusInput:Function}),state:()=>({screen:"commands"}),init(){this.ref("root"),this.ref("header"),this.ref("commandEditor"),this.hoverIgnored=!1,this.hoverIgnoredTimeout=null,this.scrollIgnored=!1,this.scrollIgnoredTimeout=null},didMount(){this.tillUnmount.addEventListener(document,"keydown",this.onKeyDown,!0),this.autoselectCategory(),this.ignoreHoverWhenTyping(),this.autoscrollToCategory(),this.smartScroll(this.header)},get screenIndex(){return d.proxy.of().explorer.editCommandName?2:"import"===this.state.screen?0:1},get slideShiftStyle(){const e=this.screenIndex;return{transform:`translateX(${0===e?0:-e+"00%"}`}},get commands(){return d.proxy.of().filteredCommands},get selectedCommandNames(){return i.proxy.selectedCommandNames},get selectedAllCommands(){return this.selectedCommandNames.length===i.proxy.userCommands.length},get command(){return d.proxy.of().explorerEditCommand},get categories(){return d.proxy.of().filteredCategories},get editorCommands(){const e=d.proxy.of().explorer.editCommandName;return i.proxy.commands.filter((t=>t.name!==e)).map((e=>({id:e.name,name:e.title||"Custom command",label:e.title?`${e.emoji||a.getCommandEmoji(e)} ${e.title}`:"Custom command"})))},get selectedCategory(){return d.proxy.of().explorer.category},get addCommandDisabled(){return!!d.proxy.of().explorer.editCommandName},get addCommandSelected(){return"add-command"===d.proxy.of().explorer.commandName},get commandsContent(){return this.root.querySelector(`.${this.c.commandsContent}`)},get anchors(){return[...this.root.querySelectorAll(`.${this.c.anchor}`)]},render(){const{c:t}=this;return e(1,"div",t.block,[this.renderHeader(),e(1,"row",t.slide,[e(1,"column",t.screen,o(2,a.Import,{onImportComplete:this.onImportComplete}),2),o(2,r.Scroll,{class:t.screen,contentClass:t.commandsContent,onScroll:this.onScroll,children:[this.renderAddCommandButton(),this.renderCommands(),this.renderNotFound()]}),o(2,r.Scroll,{class:t.screen,contentClass:t.editContent,children:[o(2,r.CommandEditor,{command:this.command,commands:this.editorCommands},null,this.commandEditorRef),this.renderJoinDiscord()]})],4,{style:this.slideShiftStyle})],0,null,null,this.rootRef)},renderHeader(){const{c:t}=this;return e(1,"row",t.header,d.proxy.of().explorer.editCommandName?this.renderEditorHeader():0===this.selectedCommandNames.length?this.renderImportHeader():this.renderSelectionControls(),0,null,null,this.headerRef)},renderSelectionControls(){const{c:n}=this;return t([e(1,"row",n.headerButton({action:!0}),[o(2,r.Icon,{name:"export"}),e(1,"div",null,"EXPORT",16)],4,{onClick:this.onExportClick},"export"),e(1,"row",n.headerButton({action:!0}),[o(2,r.Icon,{name:"remove"}),e(1,"div",null,"DELETE",16)],4,{onClick:this.onDeleteClick},"delete"),o(2,r.Spacer,{grow:!0}),!this.selectedAllCommands&&e(1,"row",n.headerButton({selected:!1}),e(1,"div",null,"SELECT ALL",16),2,{onClick:this.onSelectAllClick}),e(1,"row",n.headerButton({selected:!1}),e(1,"div",null,"UNSELECT",16),2,{onClick:this.onUnselectClick})],0)},renderJoinDiscord(){return l.proxy.clickedJoinDiscord?null:t([o(2,r.Spacer,{grow:!0}),o(2,r.Spacer,{height:"g5"}),o(2,r.JoinDiscord,{onClick:this.onJoinDiscordClick,onClose:this.onJoinDiscordClose})],4)},onExportClick(){const e=new Set(this.selectedCommandNames),t=i.proxy.userCommands.filter((t=>e.has(t.meta.name))).map((e=>s.toJS(e)));a.exportController.exportUserCommands(t),i.proxy.unselectAllCommands()},onDeleteClick(){i.proxy.deleteSelectedCommands()},onSelectAllClick(){const e=d.proxy.of();i.proxy.selectAllCommands(),e.update((e=>e.explorer.editCommandName=null))},onUnselectClick(){i.proxy.unselectAllCommands()},renderImportButton(){const{c:t,state:n}=this,a="import"===n.screen;return e(1,"row",t.headerButton({selected:a}),[o(2,r.Icon,{name:"import"}),e(1,"div",null,"IMPORT",16)],4,{onClick:this.onImportClick},"import")},renderEditorHeader(){return o(2,a.EditorHeader,{focusInput:this.props.focusInput,onSaveClick:this.onSaveCommandClick})},renderImportHeader(){return t([this.renderImportButton(),this.categories.map(this.renderCategory)],0)},renderCategory(t){const{c:n,state:o}=this,r=a.getCommandEmoji({category:t}),i="commands"===o.screen&&this.selectedCategory===t;return e(1,"row",n.headerButton({selected:i}),[e(1,"div",null,r,0),e(1,"div",null,t,0)],4,{"data-category":t,onClick:this.onCategoryClick},t)},renderAnchor(t){const{c:n}=this;return e(1,"row",n.anchor,null,1,{"data-category":t})},renderAddCommandButton(){const{c:t}=this;return e(1,"row",t.addCommandButton({disabled:this.addCommandDisabled,selected:this.addCommandSelected}),[e(1,"span",null,"Create command",16),o(2,r.Icon,{name:"add"})],4,{"x-end":!0,"y-center":!0,gap:"g2",mb:"g1h","data-name":"add-command",onMouseMove:this.onAddCommandMouseMove,onClick:this.onAddCommandClick})},renderNotFound(){if(!(this.commands.length>0))return e(1,"row",null,o(2,r.NotFound),2,{grow:!0,"x-center":!0,"y-center":!0})},renderCommands(){return this.commands.map(((e,n)=>{let r;0!==n&&this.commands[n-1].category===e.category||(r=this.renderAnchor(e.category));const i="user"===e.type&&this.selectedCommandNames.length>0;return t([r,o(2,a.Command,{command:e,selectionMode:i,focusInput:this.props.focusInput,isHoverIgnored:this.isHoverIgnored})],0,e.name)}))},onSaveCommandClick(e){const t=this.commandEditor?.createCommandState();t&&i.proxy.saveUserCommand(e,t)},onCategoryClick(e){this.setState({screen:"commands"});const t=d.proxy.of(),n=e.currentTarget.dataset.category;if(t.explorer.category===n)return;t.update((e=>e.explorer.category=n));const o=this.anchors.find((e=>e.dataset.category===n));this.commandsContent.scrollTo({top:o.offsetTop-8,behavior:"smooth"}),this.scrollIgnored=!0},onAddCommandMouseMove(){if(this.hoverIgnored)return;d.proxy.of().update((e=>e.explorer.commandName="add-command"))},onAddCommandClick(){const e=i.proxy.addUserCommand({prompt:"Please ignore all previous instructions. The output should be in {{language}}. Please summarize page content in 3 bullet points:\n\n{{page}}\n\nExpected format:\n- [relevant emoji] [bullet point]\n\nSummary:"});d.proxy.of().update((t=>{t.explorer.commandName=null,t.explorer.editCommandName=e,t.explorer.category="User"}))},onScroll(){if(this.scrollIgnored)return clearTimeout(this.scrollIgnoredTimeout),void(this.scrollIgnoredTimeout=this.tillUnmount.setTimeout((()=>{this.scrollIgnored=!1}),50));this.updateCategoryBasedOnScroll()},onKeyDown(e){const t=d.proxy.of();if("explorer"!==t.screen)return;if(t.explorer.editCommandName)return;const n="ArrowUp"===e.code,o="ArrowDown"===e.code,r="Enter"===e.code;if(n||o||r)if(e.preventDefault(),e.stopPropagation(),r){const e=t.explorer.commandName;if(!e)return;"add-command"===e?this.onAddCommandClick():(a.controller.launchCommand(e),this.props.focusInput())}else if(n||o){let e;{const a=t.filteredCommands,r=t.explorer.commandName,i=a.length-1;if("add-command"===r){e=a[n?i:0]?.name}else{let t=a.findIndex((e=>e.name===r));n&&(t-=1),o&&(t+=1),-1===t||t===i+1?e="add-command":(t<0&&(t=i),t>i&&(t=0),e=a[t]?.name)}if(!e)return}t.update((t=>t.explorer.commandName=e));const a=`[data-name="${e}"]`,r=this.root.querySelector(a);r.scrollIntoView({block:"nearest",inline:"nearest"});const i=this.root.querySelector(`.${this.c.commandsContent}`),s=i.getBoundingClientRect(),l=r.getBoundingClientRect();Math.abs(s.top-l.top)<5?i.scrollTop-=16:Math.abs(s.bottom-l.bottom)<5&&(i.scrollTop+=16)}},ignoreHoverWhenTyping(){this.tillUnmount.addEventListener(document,"keydown",(()=>{this.hoverIgnored=!0})),this.tillUnmount.addEventListener(document,"mousemove",(()=>{this.hoverIgnored=!1}))},isHoverIgnored(){return this.hoverIgnored},updateCategoryBasedOnScroll(){const e=d.proxy.of(),t=Math.max(60,this.commandsContent.scrollTop),n=e.filteredCategories,o=this.anchors.findLast((e=>!(t<e.offsetTop-16)&&!!n.includes(e.dataset.category)));o&&e.update((e=>e.explorer.category=o.dataset.category))},autoselectCategory(){const e=d.proxy.of();this.tillUnmount.reaction((()=>e.filteredCategories),(()=>this.updateCategoryBasedOnScroll())),this.tillUnmount.reaction((()=>e.explorer.editCommandName),(()=>{const t=e.filteredCategories[0];e.update((e=>e.explorer.category=t))}))},autoscrollToCategory(){const e=d.proxy.of();this.tillUnmount.reaction((()=>e.explorer.category),(e=>{const t=this.header;if(!t)return;const n=t.querySelector(`[data-category="${e}"]`);n&&t.scrollTo({left:n.offsetLeft-24,behavior:"smooth"})})),this.tillUnmount.reaction((()=>this.state.screen),(e=>{if("import"!==e)return;const t=this.header;t&&t.scrollTo({left:0,behavior:"smooth"})}))},onImportClick(){this.setState({screen:"import"})},onImportComplete(){this.setState({screen:"commands"})},onJoinDiscordClick(){l.proxy.clickedJoinDiscord=!0,chrome.tabs.create({url:c.discordUrl,active:!0})},onJoinDiscordClose(){l.proxy.clickedJoinDiscord=!0}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$dialog:t,$creator:o,$ui:a,$tab:r,$shortcut:i}=n;t.Header=a.component("DialogHeader",{props:()=>({class:Class}),render(){return e(2,a.DialogHeader,{class:this.props.class,shortcut:i.proxy.enabled&&i.proxy.label,onClick:this.onClick})},onClick(){r.proxy.screen="ai",o.proxy.frameCollapsed=!1}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dialog:o,$ui:a,$commands:r,$jsyaml:i,$utils:s,$nanoid:l}=n;o.Import=a.component("DialogImport",{props:()=>({onImportComplete:Listener}),state:()=>({commands:null,overwrite:!0}),get hasCommands(){return!!this.state.commands},get hasOverwriteCommands(){const e=this.state.commands;if(!e)return!1;const t=new Set(r.proxy.userCommands.map((e=>e.meta.title)));return e.some((e=>t.has(e.meta.title)))},get confirmImportDisabled(){const e=this.state.commands;return!!e&&!e.some((e=>e.selected))},render(){const{c:t,hasCommands:n}=this;return e(1,"column",t.block({hasCommands:n}),[this.renderDropZone(),n&&this.renderCommandActions(),n&&this.renderCommands()],0,{"full-size":!0})},renderDropZone(){const{c:n}=this;return e(1,"column",n.dropZone,e(1,"column",n.dropZoneArea,[t(2,a.Icon,{class:n.icon,name:"import"}),e(1,"div",n.title,"Drop Commands to Import",16),e(1,"div",n.text,"To export commands, pick them in command explorer and click Export",16)],4,{"x-center":!0,"y-center":!0,"full-size":!0,onDragOver:this.onDragOver,onDrop:this.onDrop,onClick:this.onClick}),2)},renderCommandActions(){const{c:n,state:o}=this;return e(1,"row",n.commandActions,[t(2,a.Button,{label:"IMPORT",type:"small",disabled:this.confirmImportDisabled,onClick:this.onConfirmImportClick}),t(2,a.Spacer,{width:"g1h"}),t(2,a.Button,{label:"CANCEL",type:"small",status:"secondary",onClick:this.onCancelImportClick}),t(2,a.Spacer,{grow:!0}),this.hasOverwriteCommands&&t(2,a.Switch,{label:"Overwrite by name",labelPosition:"left",value:o.overwrite,onChange:this.onOverwriteChange})],0)},renderCommands(){const{c:n,state:o}=this;return t(2,a.Scroll,{class:n.commands,showBorderOnScroll:!0,children:[0===o.commands.length&&e(1,"column",n.notFound,t(2,a.NotFound,{text:"Nothing to import",subtext:"Selected files contain no HARPA AI commands"}),2,{"y-center":!0}),o.commands.length>0&&e(1,"column",n.commandsList,o.commands.map((e=>this.renderCommand(e))),0)]})},renderCommand(n){const{c:r}=this,i=n.meta.description||n.steps?.find((e=>"gpt"===e.type&&e.prompt))?.prompt||n.steps?.find((e=>!e.type&&e.gpt))?.gpt||"";return e(1,"column",r.command,[e(1,"row",null,[e(1,"row",r.commandTitle,[e(1,"span",null,o.getCommandEmoji({category:"User"}),0),t(2,a.Spacer,{width:6}),e(1,"span",null,n.meta.title,0)],4),t(2,a.Checkbox,{labelPosition:"left",value:n.selected})],4,{"x-between":!0}),e(1,"span",r.commandDesc,s.string.shorten(i,160),0)],4,{"data-name":n.meta.name,onClick:this.onToggleCommand},n.meta.name)},onDragOver(e){e.preventDefault()},onDrop(e){e.preventDefault(),this.importFiles(e.dataTransfer.files)},onClick(e){e.preventDefault();const t=document.createElement("input");t.type="file",t.accept="application/json,application/x-yaml,text/yaml,.yml,.yaml,.json",t.multiple=!0;const n=e=>{this.importFiles(e.target.files),t.removeEventListener("change",n)};t.addEventListener("change",n),t.click()},importFiles(e){const t=new Set(["application/json","application/x-yaml","text/yaml",""]);Promise.all(Array.from(e).filter((e=>t.has(e.type))).map((e=>({file:e,reader:new FileReader}))).map((({file:e,reader:t})=>new Promise((n=>{t.onload=()=>{n(this.parseFile(e,t.result))},t.onerror=()=>{n(null)},t.readAsText(e)}))))).then((e=>{e=s.ensureArray(e),this.importCommands(e)}))},parseFile(e,t){let n=null;try{if(n=i.load(t),n)return n}catch{}try{if(n=JSON.parse(t),n)return n}catch{}return null},importCommands(e){(e=e.filter(Boolean).reduce(((e,t)=>e.concat(t)),[]).filter(Boolean).map(o.migrateCommand)).forEach((e=>{e.selected=!0,e.meta.name=l()})),this.setState({commands:e})},onOverwriteChange(){this.setState({overwrite:!this.state.overwrite})},onToggleCommand(e){const{commands:t}=this.state,n=e.currentTarget.dataset.name,o=t.find((e=>e.meta.name===n));o.selected=!o.selected,this.setState({commands:t})},onConfirmImportClick(){o.exportController.importUserCommands(this.state.commands.filter((e=>e.selected)).map((e=>s.without(e,"selected"))),this.state.overwrite),this.setState({commands:null}),this.props.onImportComplete()},onCancelImportClick(){this.setState({commands:null})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dialog:o,$ui:a,$bus:r,$env:i,$creator:s,$utils:l,$settings:c,$chat:d}=n;o.Input=a.component("DialogInput",{props:()=>({focusInput:Function,onChange:Listener}),didMount(){this.focusInputOnFrameOpen()},get text(){return d.proxy.of().input},get hasCommand(){const e=d.proxy.of().command;return e&&"clear"!==e.meta?.name},get placeholder(){return this.hasCommand?"Press ESC to cancel command":"Write a question...\nType / for a quick command"},get sendTooltip(){return c.proxy.sendOnEnter?"mac"===i.platform?["Send message, â†µ","New line, â‡§â†µ"]:["Send message, Enter","New line, Shift + Enter"]:"Send message"},get disabled(){return"connect"===this.screen},get showContext(){return"explorer"!==this.screen&&c.proxy.showContext},get showContextToggler(){return"explorer"!==this.screen},get stoppable(){return!!d.proxy.of().running},get screen(){return d.proxy.of().screen},render(){const{c:t}=this;return e(1,"column",t.block({disabled:this.disabled,showContext:this.showContext}),[e(1,"row",null,[this.renderTextarea(),this.renderButton()],0,{"full-width":!0,"y-start":!0}),this.renderContext(),this.renderContextToggler()],0,{onClick:this.onClick})},renderTextarea(){const{c:e}=this;return t(2,a.Input,{inputType:"textarea",value:this.text,inputClass:e.input,placeholder:this.placeholder,disabled:this.disabled,autoExpand:!0,noBackground:!0,markerStyle:{display:"none"},onInput:this.onInput,onKeyDown:this.onKeyDown})},renderButton(){const{c:n}=this;let o,r,i=!1;return this.stoppable?(o="stop",r=this.onStopClick):this.hasCommand||this.text&&"/"!==this.text&&"explorer"!==this.screen?(o="send",r=this.onSendClick):(o="explorer",r=this.onCommandClick,i="explorer"===this.screen),e(1,"button",n.button(o,{selected:i}),[t(2,a.Tooltip,{content:"Abort AI request",children:e(1,"div",n.buttonIcon({hidden:"stop"!==o}),t(2,a.Icon,{name:"stop",noTransition:!0}),2)}),t(2,a.Tooltip,{showDelay:500,content:"explorer"!==this.screen&&"Show AI commands",children:e(1,"div",n.buttonIcon({hidden:"explorer"!==o}),t(2,a.Icon,{name:"prompts",noTransition:!0}),2)}),t(2,a.Tooltip,{content:this.sendTooltip,showDelay:500,children:e(1,"div",n.buttonIcon({hidden:"send"!==o}),t(2,a.Icon,{name:"send",noTransition:!0}),2)})],4,{onClick:r})},renderContext(){const{c:n}=this;return e(1,"div",n.context,t(2,o.Context,{focusInput:this.props.focusInput}),2)},renderContextToggler(){const{c:n}=this;return e(1,"button",n.contextToggler({hidden:!this.showContextToggler}),t(2,a.Icon,{class:n.contextTogglerIcon,name:"triangle"}),2,{tabIndex:-1,onClick:this.onContextTogglerClick})},onClick(e){e.target.closest("button")||this.props.focusInput()},onCommandClick(e){e.stopImmediatePropagation(),this.props.focusInput();const t=d.proxy.of();t.input?"/"===t.input?"explorer"===t.screen?(document.execCommand("selectAll"),document.execCommand("insertText",null,"")):t.update((e=>e.explorer.show=!0)):t.update((e=>e.explorer.show=!e.explorer.show)):t.explorer.show?t.update((e=>e.explorer.show=!e.explorer.show)):document.execCommand("insertText",null,"/")},showExplorer(e=!1){if(d.proxy.of().input){if(!e)return;document.execCommand("selectAll"),document.execCommand("insertText",null,"")}document.execCommand("insertText",null,"/")},onSendClick(){o.controller.sendQuestion()},onStopClick(){const e=d.proxy.of();r.send("dialog.stop",e.tabId)},onKeyDown(e){const{code:t,shiftKey:n}=e,a=d.proxy.of();if("Escape"!==t){if("ArrowUp"===t){if(!l.string.empty(a.input))return;const t=a.messages.findLast((e=>"question"===e.type&&!e.silent))?.text;if(!t)return;return e.preventDefault(),document.execCommand("insertText",null,t),void(e.currentTarget.selectionStart=t.length)}if("Enter"===t){if(!c.proxy.sendOnEnter)return;if(n)return;if(e.preventDefault(),a.command&&a.ask&&"choice"===a.ask.paramType&&a.ask.options){const e=a.ask.options.filter((e=>e.selected)),t=e[0];if(t){const e="$custom"===t.value?t.input:t.label||t.value;a.update({input:e}),this.onInput(e)}if(e.length>1)return}a.running?r.send("dialog.stop",a.tabId):o.controller.sendQuestion()}}else r.send("dialog.stop",a.tabId)},onInput(e){const t=d.proxy.of();if(t.update((n=>{n.input=e,n.explorer.show=!t.command&&e.startsWith("/")&&!e.startsWith("//")})),t.explorer.show&&t.update((e=>e.explorer.commandName=null)),!t.explorer.editCommandName){const e=t.filteredCommands,n=t.explorer.commandName;e.find((e=>e.name===n))||t.update((t=>{t.explorer.commandName=e[0]?.name||"add-command"}))}!t.explorer.show&&t.command&&t.ask&&t.modifyAsk((t=>{if(t.value=e,"choice"!==t.paramType||0===(t.options||[]).length)return;const n=e.trim().toLowerCase();if(0===n.length)return void t.options.forEach(((e,t)=>e.selected=0===t));t.options.forEach((e=>{e.selected="$custom"!==e.value&&(e.label||e.value||"").toLowerCase().includes(n)}));const o=t.options.find((e=>"$custom"===e.value));o&&(o.input=e,o.selected=!t.options.some((e=>e.selected))),o||t.options.some((e=>e.selected))||(t.options[0].selected=!0)}))},onContextTogglerClick(){c.proxy.showContext=!c.proxy.showContext},focusInputOnFrameOpen(){this.tillUnmount.reaction((()=>s.proxy.frameOpen),(e=>{e&&setTimeout((()=>this.props.focusInput()))}),{fireImmediately:!0})}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$dialog:a,$ui:r,$env:i,$stats:s,$news:l}=n;a.Intro=r.component("DialogIntro",{state:()=>({showRateButtons:!1}),render(){const{c:t}=this;return e(1,"column",[t.custom,"markdown-body"],[e(1,"p",null,"Ask me anything ðŸ˜Š",16),this.renderText(),this.renderButtons()],0)},renderText:()=>e(1,"p",null,[o("I can read page, PDF and video content. Access 100+ quick commands by typing slash "),e(1,"code",null,"/",16),o(", e.g. "),e(1,"b",null,e(1,"i",null,"/summary",16),2),o(" or "),e(1,"b",null,e(1,"i",null,"/compose",16),2),o(". Use parameters like this: "),e(1,"code",null,"{{page}}",0)],4),get showRateButtons(){return!l.proxy.rated},get showJoinDiscordButton(){return!1},get showSocialLinks(){return!1},renderButtons(){const{c:n}=this;return this.showRateButtons||this.showJoinDiscordButton||this.showSocialLinks?e(1,"row",null,[this.showRateButtons&&t(2,r.Button,{labelClass:n.miniButtonLabel,iconClass:n.miniButtonIcon({star:!0}),icon:"star",label:"RATE ME 5-STAR",type:"link",onClick:this.onRateMeClick}),this.showJoinDiscordButton&&t(2,r.Button,{labelClass:n.miniButtonLabel,iconClass:n.miniButtonIcon({discord:!0}),icon:"action-discord",label:"JOIN DISCORD",type:"link",onClick:this.onDiscordClick}),this.showSocialLinks&&t(2,l.SocialLinks)],0,{gap:"g2","x-between":!0}):null},onRateMeClick(){l.proxy.rated=5,l.proxy.feedbackStatus="5-star",chrome.tabs.create({url:i.extUrl.reviews,active:!0})},onDiscordClick(){s.proxy.clickedJoinDiscord=!0,chrome.tabs.create({url:i.discordUrl,active:!0})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$dialog:r,$ui:i,$bus:s,$news:l,$env:c,$twitter:d,$commands:u,$tab:p,$chat:h}=n;r.Message=i.component("DialogMessage",{props:()=>({index:Number,enableShortcuts:Boolean,enableAsk:Boolean,message:Object,showTail:Boolean,animateOnMount:Boolean,focusInput:Function}),init(){this.component.shownMessageIds||(this.component.shownMessageIds=new Set),this.state={text:this.message.text||"...",show:!this.props.animateOnMount||this.component.shownMessageIds.has(this.message.id)}},didMount(){this.state.show||this.tillUnmount.setTimeout((()=>{this.setState({show:!0}),this.component.shownMessageIds.add(this.message.id)}),100)},get message(){return this.props.message},get sanitizedText(){return this.message.text.replace(/<!--[\s\S]*?-->/g,"")},get questionIcon(){return(this.message.commandName||"").startsWith("/search")?"serp":null},get pasteShortcut(){return this.props.enableShortcuts?"mac"===c.platform?", âŒ˜â‡§V":", Ctrl+Shift+V":""},get copyShortcut(){return this.props.enableShortcuts?"mac"===c.platform?", âŒ˜â‡§C":", Ctrl+Shift+C":""},get questionReactions(){return{onSaveClick:this.onSaveClick,onCopyClick:this.onCopyClick,copyShortcut:this.copyShortcut}},get answerReactions(){return this.message.done?{answerStatus:this.message.answerStatus,onLikeClick:this.onLikeClick,onDislikeClick:this.onDislikeClick,onCopyClick:this.onCopyClick,copyShortcut:this.copyShortcut,onPasteClick:this.onPasteClick,pasteShortcut:this.pasteShortcut}:null},render(){const{c:t}=this;return e(1,"div",t.block(this.message.type,{hidden:!this.state.show,command:this.message.commandName&&"/search-basic"!==this.message.commandName}),this.renderMessage(),0)},renderMessage(){const e=this.message;if("question"===e.type)return o(2,i.DialogQuestion,{text:e.text,icon:this.questionIcon,showTail:this.props.showTail,reactions:this.questionReactions});if("answer"===e.type){const t=(e.text||"").length>0&&!1===e.done&&!e.error;return o(2,i.DialogAnswer,{text:this.renderAnswer(),badge:e.badge,avatar:e.avatar&&!l.proxy.anno?e.avatar:null,hasError:!!e.error,progress:t,showTail:this.props.showTail,reactions:this.answerReactions})}return"ask"===e.type&&"choice"===e.paramType?e.value||this.props.enableAsk?o(2,i.DialogAskChoice,{options:e.options,enabled:!1!==e.enabled&&this.props.enableAsk,onOptionClick:this.onOptionClick}):null:void 0},renderAnswer(){return this.message.text?this.renderAnswerText():this.message.error?this.renderAnswerError():null},renderAnswerText(){if(["#intro","#ask-me-anything"].includes(this.message.text)){const e=l.proxy.anno;return e?o(2,r.Anno,{anno:e}):o(2,r.Intro)}return this.message.text},renderAnswerError(){const{c:n}=this,o=e(1,"a",null,"get.harpa.ai",16,{href:"https://get.harpa.ai",target:"_blank"}),i=e(1,"a",null,"support@harpa.ai",16,{href:"mailto:support@harpa.ai"}),s=e(1,"a",null,"chat.openai.com",16,{href:"https://chat.openai.com",target:"_blank"}),l=e(1,"a",null,"payment method",16,{href:"https://platform.openai.com/account/billing/payment-methods",target:"_blank"}),c=e(1,"a",null,"usage limit",16,{href:"https://platform.openai.com/account/usage",target:"_blank"}),d=e(1,"a",null,"status.openai.com",16,{href:"https://status.openai.com/",target:"_blank"}),u=e(1,"a",n.link,"Settings Tab",16,{onClick:this.onSettingsLinkClick}),p=e(1,"a",null,"bard.google.com",16,{href:"https://bard.google.com",target:"_blank"}),h=e(1,"a",null,"google.com",16,{href:"https://google.com",target:"_blank"}),m=this.message.errorDetails&&t([e(1,"br"),a("Error details: "),this.message.errorDetails],0);return this.message.error===r.errors.badModel?t([a("ðŸ’”ï¸ Oops... The model you provided does not exist or isn't compatible with the chat API. Please enter a valid model in the "),u,a(" "),m],0):this.message.error===r.errors.badApiKey?t([a("ðŸ’”ï¸ Oops... OpenAI API key is missing or is incorrect. Please enter a valid API key in the "),u,a(" "),m],0):this.message.error===r.errors.failedToFetch?t([a("ðŸ’”ï¸ Oops... Request to OpenAI API has failed. Please check if the service is up and running at "),d,a(" or email us at"),a(" "),i,a(" "),m],0):this.message.error===r.errors.failedToReadResponse?t([a("ðŸ’”ï¸ Oops... OpenAI API is not responding properly. Please restart the chat, check if the service is up and running at "),d,a(" or send us email at "),i,a(" "),m],0):this.message.error===r.errors.oldVersion?t([a("ðŸ’”ï¸ Oops... GPT model sent unexpected response. Please upgrade to the latest version of HARPA AI from "),o,a(" or report this error to support team at "),i,a(" "),m],0):this.message.error===r.errors.tooManyRequests?t([a("ðŸ’”ï¸ Oops... Too many requests sent to ChatGPT at once. Please resubmit question later or check if the service is up and running at"),a(" "),s,a(" or "),d,a(" "),m],0):this.message.error===r.errors.reachedRequestsLimit?t([a("ðŸ’”ï¸ Oops... Reached OpenAI API requests limit. API access is billed by OpenAI based on usage. Make sure you have a "),l,a(" and a "),c,a(" set up in your OpenAI account. "),m],0):this.message.error===r.errors.messageTooLong?t([a("ðŸ’”ï¸ Oops... The GPT request is too long for the model. Please shorten the message before resubmitting or check if the service is up and running at "),s,a(" or "),d,a(" "),m],0):this.message.error===r.errors.chatNotFound?t([a("ðŸ’”ï¸ Oops... This conversation was deleted on ChatGPT. Please resubmit your question or check if the service is up and running at"),a(" "),s,a(" or "),d,a(" "),m],0):this.message.error===r.errors.bardLogin?t([a("ðŸ’”ï¸ Oops... It seems like you're not logged in to "),h,a(". Please log in and try again. "),m],0):this.message.error===r.errors.bardNoAccess?t([a("ðŸ’”ï¸ Oops... Google Bard is not available in your region. Please make sure you have access to "),p,a(" "),m,a(", or switch to OpenAI API in the app settings.")],0):this.message.error===r.errors.bardUnexpected?t([a("ðŸ’”ï¸ Oops... Bard sent unexpected response. Please upgrade to the latest version of HARPA AI from "),o,a(" or report this error to support team at "),i,a(" "),m],0):t([a("AI Response: "),this.message.error.replaceAll("-"," ")],0)},onLikeClick(){const e=h.proxy.of();s.send("dialog.like",e.tabId,this.message.answerId)},onDislikeClick(){const e=h.proxy.of();s.send("dialog.dislike",e.tabId,this.message.answerId)},onTwitterClick(){d.controller.send(this.sanitizedText)},onCopyClick(){navigator.clipboard.writeText(this.sanitizedText)},onPasteClick(){const e=h.proxy.of();s.send("browser.hideFrame"),s.send("dialog.paste",e.tabId,this.sanitizedText)},onSaveClick(){const e=this.sanitizedText,t=u.proxy.addUserCommand({prompt:e});h.proxy.of().update((e=>{e.explorer.show=!0,e.explorer.commandName=null,e.explorer.editCommandName=t}))},onOptionClick(e,t){this.props.focusInput();const n="$custom"===e.value?e.input:e.value;if("$custom"===e.value&&0===(n||"").trim().length)return;const o=h.proxy.of();o.update({input:""}),o.modifyAsk((e=>{e.value=n,e.options.forEach(((e,n)=>e.selected=n===t))})),o.running?s.send("dialog.stop",o.tabId):r.controller.sendQuestion(n)},onSettingsLinkClick(){p.proxy.screen="settings"}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dialog:o,$ui:a,$bus:r,$env:i,$chat:s}=n;o.Screen=a.component("DialogScreen",{init(){this.ref("root")},get screen(){return s.proxy.of().screen},get textarea(){return this.root?.querySelector(".DialogInput__input")},didMount(){const e=s.proxy.of();r.send("dialog.chatRendered",e.tabId)},render(){const{c:t}=this;return e(1,"column",t.block,[this.renderBody(),this.renderInput()],0,{tabIndex:-1,onKeyDown:this.onKeyDown},null,this.rootRef)},renderBody(){const{c:n}=this,a=this.screen;return e(1,"div",n.body,[e(1,"div",n.content("connect",{hidden:"connect"!==a}),t(2,o.Connect,{class:n.connect}),2),e(1,"div",n.content("chat",{hidden:"chat"!==a}),t(2,o.Chat,{focusInput:this.focusInput}),2),e(1,"div",n.content("explorer",{hidden:"explorer"!==a}),t(2,o.Explorer,{focusInput:this.focusInput}),2)],0)},renderInput(){return t(2,o.Input,{focusInput:this.focusInput})},focusInput({jumpToEnd:e=!1}={}){this.textarea&&(this.textarea.focus(),e&&setTimeout((()=>{this.textarea.scrollTop=this.textarea.scrollHeight,this.textarea.selectionStart=this.textarea.value.length})))},onKeyDown(e){const{code:t,ctrlKey:n,metaKey:o,shiftKey:a,altKey:l}=e,c=s.proxy.of();if("KeyC"===t&&a&&!l&&("mac"===i.platform&&!n&&o||"mac"!==i.platform&&n&&!o)){e.preventDefault();const t=c.copyableAnswer?.text;t&&navigator.clipboard.writeText(t)}else if("KeyV"===t&&a&&!l&&("mac"===i.platform&&!n&&o||"mac"!==i.platform&&n&&!o)){e.preventDefault();const t=c.copyableAnswer?.text;t&&(r.send("browser.hideFrame"),r.send("dialog.paste",c.tabId,t))}}})})(),(()=>{const{$dialog:e,$tabs:t,$critical:o,$creator:a,$commands:r,$settings:i,$mobx:s,$bus:l,$tab:c,$chat:d,$ai:u}=n;e.controller={init(){this.enabled&&(this._resetState(),this._autoStartSerpDialog())},get enabled(){return"popup"===o.proxy.pageType&&t.proxy.isCurrentTabAutomatable},launchCommand(e,t={}){let n=r.proxy.getCommandDeclaration(e);if(!n)return;n={...n,...t};const o=d.proxy.of();l.send("dialog.stop",o.tabId),o.update((e=>{e.explorer.show=!1,e.explorer.commandName=null}));const a=n.steps[0],i=1===n.steps.length&&("gpt"===a.type||!a.type&&a.gpt)&&!a.chunkify;i&&o.update({input:"gpt"===a.type?a.prompt:a.gpt}),i||(o.update({input:""}),l.send("dialog.commandStart",o.tabId,n))},sendQuestion(e=null){const t=d.proxy.of();null===e&&(e=t.input),l.send("dialog.commandInput",t.tabId,e),t.update((e=>{e.input="",e.explorer.show=!1,e.explorer.commandName=null}))},_resetState(){u.proxy.update((e=>{e.openaiSession.status=null,e.openaiSession.loading=!1}));d.proxy.of().update((e=>{e.explorer.show=!1,e.explorer.commandName=null,e.explorer.editCommandName=null,"/"===e.input&&(e.input="")})),a.proxy.trapperGrabbing=!1},_autoStartSerpDialog(){s.reaction((()=>!("ai"!==c.proxy.screen||!a.proxy.frameOpen||a.proxy.frameCollapsed)),(async e=>{if(!e)return;const n=d.proxy.of();if(n.running)return;const o=await l.send("dialog.serpQuery",t.proxy.currentTab?.url);if(!o)return;if(n.messages.some((e=>"question"===e.type&&"/search-basic"===e.commandName&&e.text===o)))return;const a=i.proxy.serpTemplateValue.replaceAll("{{query}}",o)||o,r={message:o,commandName:"/search-basic",insertMemory:!1};l.send("dialog.send",n.tabId,a,r)}),{fireImmediately:!0})}}})(),(()=>{const{$dialog:e,$download:t,$mobx:o,$jsyaml:a,$utils:r,$commands:i,$chat:s}=n;e.exportController={async exportUserCommands(e){const n=1===(e=e.filter(Boolean)).length?`harpa-${o=e[0],r.string.toKebabCase(o.meta.title||o.meta.name)}.yaml`:`harpa-commands-${e.length}.yaml`;var o;1===e.length&&(e=e[0]);const i=new Set(["name","version"]);e=a.dump(e,{sortKeys:(e,t)=>i.has(e)?i.has(t)?0:1:i.has(t)?-1:0}),await t.controller.download(n,e,"application/x-yaml")},importUserCommands(e,t){if(!e||0===e.length)return;let n=o.toJS(i.proxy.userCommands);t&&e.forEach((e=>{const t=n.findIndex((t=>t.meta.title===e.meta.title));-1!==t&&n.splice(t,1)})),n.push(...e);s.proxy.of().update((e=>{e.explorer.commandName=null,e.explorer.editCommandName=null})),i.proxy.selectedCommandNames=[],i.proxy.userCommands=n}}})(),(()=>{const{$dev:e,$mobx:t,$store:o,$env:a}=n;e.controller={init(){a.is.development&&this._initDevHelpers()},resetState(){o.controller.resetState()},_initDevHelpers(){Object.defineProperty(Object.prototype,"$",{get(){return t.toJS(this)}});const e=o.adapter.create({get:e=>e});Object.defineProperty(globalThis,"s",{get:()=>e})}}})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dashboard:o,$ui:a,$env:r,$bus:i,$store:s,$chrome:l,$critical:c}=n;o.Buttons=a.component("DashboardButtons",{state:()=>({tabs:[]}),didMount(){this.updateTabs()},render(){const{c:t}=this;return e(1,"div",t.block,[this.renderWatchPageButton(),this.renderStartButton(),this.renderImportButton(),this.renderHelpButton()],0)},renderWatchPageButton(){const{c:e,state:n}=this;return t(2,a.Dropdown,{class:e.button({type:"add"}),icon:"add",text:"MONITOR PAGE",items:0===n.tabs.length?[{id:"no-pages"}]:n.tabs,maxHeight:"18i",onClick:this.onWatchPageClick,valueContainerClass:e.addButtonValueContainer,valueClass:e.addButtonValue,iconClass:e.addButtonValue,renderer:e=>t(2,d,{item:e}),onChange:this.onPageItemClick})},renderStartButton(){const e=!o.proxy.hasTasks(),n=o.proxy.hasEnabledScreenTasks(),r=o.proxy.resumableTaskCount,i=n?"STOP ALL TASKS":1===r?`RESUME ${r} TASK`:r?`RESUME ${r} TASKS`:"START ALL",{c:s}=this;return t(2,a.Button,{class:s.button({type:"start"}),type:"small",status:"secondary",disabled:e,icon:n?"pause":"run",iconStyle:n?null:{width:"13px",height:"13px"},label:i,onClick:n?this.onStopAllClick:this.onResumeAllClick})},renderImportButton(){if(!r.features.taskImport)return null;const{c:e}=this;return t(2,a.Button,{class:e.button({type:"import"}),type:"small",status:"secondary",icon:"import",label:"IMPORT",onClick:this.onImportClick})},renderHelpButton(){const{c:e}=this;return t(2,a.Button,{class:e.button({type:"help"}),type:"small",status:"secondary",icon:"question",onClick:this.onQuestionClick})},async updateTabs(){let e=await l.tabs.query({currentWindow:!0});const t=new Set(s.state.tasks.map((e=>e.inputs.schedule?.mediumId)).filter((e=>!!e)));e=e.filter((e=>!t.has(e.id)&&c.isAutomatable(e))).map((e=>({tabId:e.id,favIconUrl:e.favIconUrl,title:e.title,url:e.url}))),this.setState({tabs:e})},onWatchPageClick(e,t){t.open&&this.updateTabs()},onPageItemClick(e){"no-pages"!==e.id&&i.send("creator.watchPage",e)},onImportClick(){o.controller.importTasks()},onQuestionClick(){chrome.tabs.create({url:r.welcomeUrl,active:!0})},onStopAllClick(){o.controller.stopAllScreenTasks()},onResumeAllClick(){o.controller.resumeStoppedTasks()}});const d=a.component("DashboardButtonsAddTaskRenderer",{render(){const{c:n,props:o}=this,r=o.item;return"no-pages"===r.id?e(1,"div",n.block({noPages:!0}),"No tabs to watch",16):e(1,"row",n.block,[t(2,a.Image,{class:n.favIcon,width:16,height:16,src:r.favIconUrl,fallback:this.renderFallback()}),t(2,a.Spacer,{width:"g1h"}),e(1,"div",n.text,r.title,0)],4)},renderFallback:()=>e(1,"span",null,null,1,{style:{width:"16px"}})})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,createTextVNode:a}=n.$inferno,{$dashboard:r,$ui:i,$store:s}=n;r.Header=i.component("DashboardHeader",{get hasSelectedTasks(){return r.proxy.selectedTasks.length>0},render(){const{c:e}=this;return o(2,i.ScreenHeader,{class:e.block,icon:"dashboard",title:this.renderTitle(),subtitle:this.renderSubtitle(),children:[this.renderButtons(),this.renderTaskButtons()]})},renderTitle(){const e="HARPA Dashboard",t=s.state.mainScreen;if("dashboard"===t)return e;let n=t.split(":")[1];return n&&0!==n.length?(n=n.replaceAll(/^www\d?\./gim,""),n.length<3?n.toUpperCase():`${n[0].toUpperCase()}${n.substr(1)}`):e},renderSubtitle(){const{c:t}=this;if(0===r.proxy.selectedTasks.length)return e(1,"row",null,[e(1,"div",t.subtitleText,"Manage automations",16),o(2,i.Spacer,{width:"g3"}),this.renderAggregationDropdown()],0,{"y-baseline":!0});const n=r.proxy.selectedTasks.length,s=n===r.proxy.tasks.length,l=s?"every task":1===n?"1 task":`${n} tasks`;return e(1,"row",null,[e(1,"div",t.subtitleText,[a("Selected "),e(1,"b",null,l,0)],4),this.renderSelectAllButton(s),this.renderUnselectAllButton()],0,{"y-baseline":!0})},renderAggregationDropdown(){const{c:e}=this;return o(2,i.Dropdown,{inline:!0,valueClass:e.aggregationType,value:r.proxy.aggregation,items:[{id:"none",label:"Do not aggregate"},{id:"hourly",label:"Hourly charts"},{id:"daily",label:"Daily charts"},{id:"weekly",label:"Weekly charts"},{id:"monthly",label:"Monthly charts"}],onChange:this.onAggregationChange})},renderSelectAllButton(e){return t([o(2,i.Spacer,{width:"g3"}),o(2,i.Button,{type:"link",label:"SELECT ALL",status:e?"off":"on",disabled:e,onClick:this.onSelectAllClicked})],4)},renderUnselectAllButton(){return t([o(2,i.Spacer,{width:"g1h"}),o(2,i.Button,{type:"link",label:"UNSELECT All",onClick:this.onUnselectAllClicked})],4)},renderButtons(){if(!this.hasSelectedTasks)return o(2,r.Buttons)},renderTaskButtons(){if(this.hasSelectedTasks)return o(2,r.TaskButtons)},onAggregationChange(e){r.proxy.aggregation=e.id},onSelectAllClicked(){r.controller.selectAllScreenTasks()},onUnselectAllClicked(){r.controller.unselectAllTasks()}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$dashboard:a,$harpa:r,$env:i,$ui:s}=n;a.TaskButtons=s.component("DashboardTaskButtons",{state:()=>({moreMenuOpen:!1,exportMenuOpen:!1,smallScreen:!1}),didMount(){this.updateSmallScreenState(),this.tillUnmount.addEventListener(window,"resize",this.updateSmallScreenState)},get selectedTaskCount(){return a.proxy.selectedTasks.length},get allSelectedTasksEnabled(){return a.proxy.selectedTasksEnabled()},get actions(){const e=this.selectedTaskCount,t={run:{icon:"run",label:"Run once",status:"day"===r.proxy.theme&&"primary"},start:{icon:"module-schedule",label:1===e?"Start task":`Start ${e} tasks`,available:!this.allSelectedTasksEnabled},stop:{icon:"pause",label:1===e?"Stop task":`Stop ${e} tasks`,available:this.allSelectedTasksEnabled},export:{icon:"export",label:"Export",available:i.features.taskExport},delete:{icon:"remove",label:this.state.smallScreen?"Delete"+(1===e?"":` ${e} tasks`):"Delete"},exportCsv:{label:this.state.smallScreen?`Export Task${1===e?"":"s"} Data as CSV / XLSX`:`Task${1===e?"":"s"} Data as CSV / XLSX`},exportConfig:{label:this.state.smallScreen?`Export Task${1===e?"":"s"} Configuration`:`Task${1===e?"":"s"} Configuration`},duplicate:{label:"Duplicate"},toTop:{label:"Move to â‡¡ top"},toBottom:{label:"Move to â‡£ bottom"},clearRecords:{label:"Clear all records"}};return Object.entries(t).forEach((([e,n])=>{n.id=e,!1===n.available&&(t[e]=null)})),t},render(){const{c:t}=this;return e(1,"row",t.block,[this.renderMainActionButtons(),this.renderMoreButton()],0,{"y-end":!0})},renderMainActionButtons(){const{c:n}=this;if(this.state.smallScreen)return;const a=[this.actions.run,this.actions.start,this.actions.stop,this.actions.export,this.actions.delete].filter(Boolean);return t(a.map((t=>e(1,"div",n.button,[o(2,s.Button,{id:t.id,type:"small",icon:t.icon,status:t.status||"secondary",label:t.label.toUpperCase(),onClick:this.onActionClick},t.id),"export"===t.id&&this.renderExportMenu()],0))),0)},renderMoreButton(){const{c:t}=this,n=this.state.smallScreen,a=[n&&this.actions.run,n&&this.actions.start,n&&this.actions.stop,this.actions.duplicate,this.actions.toTop,this.actions.toBottom,this.actions.clearRecords,n&&this.actions.exportCsv,n&&this.actions.exportConfig,n&&this.actions.delete].filter(Boolean);return e(1,"div",t.button,[o(2,s.Button,{type:"small",icon:"dots",status:"secondary",label:this.state.smallScreen?"ACTIONS":"MORE",onClick:this.onMoreClick}),o(2,s.Menu,{class:t.menu({open:this.state.moreMenuOpen}),value:["run","start","stop"],items:a,onChange:this.onActionClick})],4)},renderExportMenu(){const{c:e}=this;return o(2,s.Menu,{class:e.menu({open:this.state.exportMenuOpen}),items:[this.actions.exportCsv,this.actions.exportConfig],onChange:this.onActionClick})},onMoreClick(){this.state.moreMenuOpen||(this.setState({moreMenuOpen:!0}),this.onDocClickOnce((()=>this.setState({moreMenuOpen:!1}))))},onActionClick({id:e}){if("export"===e){if(this.state.exportMenuOpen)return;return this.setState({exportMenuOpen:!0}),void this.onDocClickOnce((()=>this.setState({exportMenuOpen:!1})))}const t=a.proxy.selectedTasks;"run"===e?a.controller.runTasks(t):"start"===e?a.controller.setTasksEnabled(t,!0):"stop"===e?a.controller.setTasksEnabled(t,!1):"delete"===e?a.controller.deleteTasks(t):"duplicate"===e?a.controller.duplicateTasks(t):"toTop"===e?a.controller.rearrangeTasks(t,"top"):"toBottom"===e?a.controller.rearrangeTasks(t,"bottom"):"clearRecords"===e?a.controller.clearTaskRecords(t):"exportCsv"===e?a.exportController.exportTaskDataCsv(t):"exportConfig"===e&&a.exportController.exportTaskConfig(t),a.proxy.selectedTasks=[]},onDocClickOnce(e){this.tillUnmount.addEventListener(document,"click",e,{once:!0})},updateSmallScreenState(){this.setState({smallScreen:window.innerWidth<1040})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$dashboard:a,$ui:r}=n;a.Screen=r.component("DashboardScreen",{props:()=>({hideHeader:Boolean,class:Class,widgetsClass:Class}),didMount(){chrome.runtime.sendMessage({name:"runner.sleepTimer.alarm"})},render(){const{c:t,props:n}=this;return e(1,"column",[t.block,n.class],[this.renderHeader(),o(2,r.Scroll,{showBorderOnScroll:n.hideHeader&&!0,children:this.renderWidgets()})],0)},renderHeader(){return this.props.hideHeader?null:t([o(2,r.Spacer,{height:"g2"}),o(2,a.Header),o(2,r.Spacer,{height:14})],4)},renderWidgets(){return o(2,a.WidgetList,{class:this.props.widgetsClass})}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dashboard:o,$harpa:a,$tabs:r,$ui:i,$library:s,$tab:l}=n;o.Tab=i.component("DashboardTab",{props:()=>({showHomeButton:Boolean}),icons:{add:'<svg viewBox="0 0 43 43"><g transform="translate(-169 -58)"><rect width="43" height="43" rx="4" transform="translate(169 58)" fill="none"/><g transform="translate(2.415 2.415)"><circle cx="13.5" cy="13.5" r="13.5" transform="translate(174.585 63.585)" fill="currentColor"/><path d="M5.352,11.853V7.647H1.147a1.147,1.147,0,1,1,0-2.294H5.352V1.148a1.147,1.147,0,1,1,2.294,0V5.353h4.207a1.147,1.147,0,1,1,0,2.294H7.646v4.206a1.147,1.147,0,1,1-2.294,0Z" transform="translate(181.585 70.585)" fill="#fff"/></g></g></svg>'},get domains(){return o.proxy.domains.slice(0,6)},get favicon(){return r.proxy.currentTab?.favicon},render(){const{c:t}=this;return e(1,"column",t.block,[this.renderDomainButtons(),this.renderScreen(),this.renderToAppButton()],0)},renderDomainButtons(){const n=this.domains,{c:o,icons:r}=this;return e(1,"row",o.domains,[n.map((e=>t(2,a.DomainButton,{domain:e,size:"medium"},e))),t(2,i.Tooltip,{content:"Monitor this page",children:e(1,"column",o.addButtonContainer,[t(2,s.Favicon,{class:o.addButtonFavicon,url:this.favicon,size:24}),t(2,i.Icon,{class:o.addButtonIcon,name:r.add,size:24})],4,{"x-center":!0,"y-center":!0,onClick:this.onAddButtonClick})})],0,{"y-center":!0})},renderScreen(){const{c:e}=this;return t(2,o.Screen,{class:e.dashboard,widgetsClass:e.widgets,hideHeader:!0})},renderToAppButton(){return t(2,o.ToAppButton,{visible:this.props.showHomeButton})},onAddButtonClick(){l.proxy.screen="create"}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$dashboard:o,$ui:a,$harpa:r,$tabs:i}=n;o.ToAppButton=a.component("DashboardToAppButton",{props:()=>({visible:Boolean}),get visible(){return this.props.visible||o.proxy.screenTasks.length<=3},get showBorder(){return o.proxy.screenTasks.length>3},render(){const{c:n,visible:o,showBorder:r}=this;return e(1,"row",n.block({visible:o,showBorder:r}),e(1,"row",n.button,[t(2,a.Icon,{class:n.icon,name:a.ScreenHeader.icons.dashboard}),t(2,a.Spacer,{width:"g1h"}),e(1,"column",null,[e(1,"div",n.title,"DASHBOARD",16),e(1,"div",n.subtitle,"Manage automations",16)],4)],4,{onClick:this.onClick}),2)},onClick(){r.proxy.mainScreen="dashboard",i.openAppTab()}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$ui:t,$utils:o,$dashboard:a,$task:r,$peeker:i,$redactor:s}=n,l=()=>o.aggregation.aggregators.hourly.toStartOfPeriod(new Date)+o.time.HOUR;a.GraphWidget=t.component({props:()=>({task:Object,records:Array(Object)}),state:()=>({aggregationPoint:l()}),get task(){return this.props.task},get enabled(){return this.task.enabled},get schedule(){return"periodical"!==this.props.task.inputs.schedule?.type?null:this.props.task.inputs.schedule.periodical.frequency},get tooltip(){return a.proxy.taskScheduleTooltip(this.task)},get actions(){const e=this.task.inputs.actions;return e?[e.notification?.enabled&&"notification",e.sound?.enabled&&"sound",e.email?.enabled&&"email",e.push?.enabled&&"push",e.sms?.enabled&&"sms",e.slack?.enabled&&"slack",e.telegram?.enabled&&"telegram",e.discord?.enabled&&"discord",e.zapier?.enabled&&"zapier",e.webhook?.enabled&&"webhook",e.make?.enabled&&"make"].filter((e=>Boolean(e))):[]},get records(){return this.props.records},get lastRecord(){return this.records.at(-1)},get selectedRecord(){return i.proxy.show?this.task.id!==i.proxy.taskId?null:this.records.find((e=>e.ms===i.proxy.recordMs)):null},get aggregation(){return a.proxy.aggregation},get items(){if(0===this.records.length)return[];const e=this.records.map((e=>{const t=e.ms&&`<b>${o.time.formatRelativeDate(e.ms)}</b>`,n=e.error?e.error?.text||e.error:e.info;return{ms:e.ms,color:e.color,value:["error","warning"].includes(e.status)?0:"string"==typeof e.value?e.value.length:e.value,labels:[t,n],selected:e===this.selectedRecord}}));return o.aggregation.aggregate(e,this.aggregation)},get leftLabel(){const e=this.selectedRecord||this.lastRecord;return e?`<b>${o.time.formatRelativeDate(e.ms)}</b>`:null},get rightLabel(){const e=this.selectedRecord||this.lastRecord;return e?e.error?e.error?.text||e.error:e.info:null},get jobProgress(){return a.proxy.jobProgress(this.task)},labelsTemplate(e){if(!e.ms)return["","No data"];const t="hourly"!==this.aggregation;return[`<b>${o.time.formatRelativeDate(e.ms,t)}</b>`,"No data"]},didMount(){this.autoUpdate()},willUnmount(){clearTimeout(this.autoUpdateTimeout)},autoUpdate(){const e=l();this.state.aggregationPoint!==e&&this.setState({aggregationPoint:e}),this.autoUpdateTimeout=this.tillUnmount.setTimeout(this.autoUpdate,e-Date.now()+o.time.SECOND)},get mediumTypes(){return r.mediumTypesWithAutoClosing},get mediumType(){const e=this.task.inputs.schedule;return e?`${e.autoCloseTab?"t":"p"}:${e.mediumType}`:null},get mediumTypeIcon(){const e=this.task.inputs.schedule;return e?`medium-${e.mediumType}`:null},render(){return e(2,t.GraphWidget,{enabled:this.enabled,tooltip:this.tooltip,actions:this.actions,progress:this.jobProgress,schedule:this.schedule,mediumTypes:this.mediumTypes,mediumType:this.mediumType,mediumTypeIcon:this.mediumTypeIcon,onToggle:this.onToggle,onActionsClicked:this.onActionsClicked,onMediumTypeChange:this.onMediumTypeChange,children:e(2,t.ColumnGraph,{items:this.items,itemTemplate:{labels:this.labelsTemplate},labels:[this.leftLabel,this.rightLabel],onItemClick:this.onItemClick,onItemHover:this.onItemHover,onItemUnhover:this.onItemUnhover})})},onToggle(){a.controller.toggleTaskEnabled(this.task.id)},onMediumTypeChange(e){const[t,n]=e.id.split(":");r.proxy.updateTask(this.task.id,(e=>{e.inputs.schedule.mediumType=n,e.inputs.schedule.autoCloseTab="t"===t}))},onActionsClicked(){r.proxy.updateTask(this.task.id,(e=>e.inputScreen="actions")),s.proxy.show=!0,s.proxy.taskId=this.task.id},onItemClick(e){e.ms&&(i.proxy.fixed&&e.ms===i.proxy.recordMs?i.proxy.fixed=!1:i.proxy.update({show:!0,fixed:!0,taskId:this.props.task.id,recordMs:e.ms}))},onItemHover(e){e.ms&&(i.proxy.fixed||(clearTimeout(this.hoverTimeoutForRecord),this.hoverTimeoutForRecord=setTimeout((()=>{i.proxy.update({taskId:this.props.task.id,recordMs:e.ms})}),200),clearTimeout(this.hoverTimeoutForShow),this.hoverTimeoutForShow=setTimeout((()=>{i.proxy.show=!0,this.removeMouseMoveListener()}),400)))},onItemUnhover(e,t){if(i.proxy.fixed)return;clearTimeout(this.hoverTimeoutForRecord),clearTimeout(this.hoverTimeoutForShow);if(!(t.parentElement.lastChild===t))return void(i.proxy.show=!1);const n=t.getBoundingClientRect();this.removeMouseMoveListener(),document.addEventListener("mousemove",this.component.onMouseMove=e=>{const t=e.clientX,o=e.clientY;t>n.x&&o>n.y&&o<n.y+n.height||(i.proxy.show=!1,this.removeMouseMoveListener())})},removeMouseMoveListener(){document.removeEventListener("mousemove",this.component.onMouseMove)}})})(),(()=>{const{createVNode:e}=n.$inferno,{$dashboard:t,$ui:o,$bus:a,$idb:r,$task:i}=n;t.PreviewWidget=o.component("DashboardPreviewWidget",{props:()=>({task:Object,viewed:Boolean}),state:()=>({previewUrl:null}),didMount(){this.updatePreview(),this.tillUnmount.reaction((()=>i.proxy.taskLastRecord(this.props.task)?.ms),(()=>this.updatePreview({useCache:!1})))},willUnmount(){this.state.previewUrl&&URL.revokeObjectURL(this.state.previewUrl)},get cache(){const e=t.PreviewWidget;return e.cache||(e.cache={})},get style(){return this.props.viewed?{"background-image":`url("${this.state.previewUrl}")`}:{}},get href(){return this.props.task.inputs.page.url},render(){if(!this.state.previewUrl)return null;const{c:t}=this;return e(1,"a",t.block,null,1,{style:this.style,href:this.href,target:"_blank"})},async updatePreview({useCache:e=!0}={}){if(e&&this.cache[this.props.task.id])return void this.setState({previewUrl:this.cache[this.props.task.id]});const t=await a.send("task.getTaskIdbKey",this.props.task.id),n=await r.read(t);if(!n)return;const o=n.preview;if(!o)return;const i=URL.createObjectURL(o);this.cache[this.props.task.id]=i,this.setState({previewUrl:i})}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$dashboard:a,$task:r,$redactor:i,$ui:s,$critical:l}=n;a.ValueWidget=s.component("DashboardValueWidget",{props:()=>({task:Object,record:Object,runnable:Boolean,configurable:Boolean,titleEditable:Boolean,onTitleChange:Function,onClick:Function,progress:Number,elevated:Boolean,size:OneOf(["small","normal"])}),defaultProps:{size:"normal"},state:()=>({titleFocused:!1,progress:null}),willReceiveProps({p1:e,p2:t}){t.progress!==e.progress&&(this._applyProgress&&clearTimeout(this._applyProgress),t.progress?this._applyProgress=setTimeout((()=>{this.setState({progress:t.progress})}),50):this._applyProgress=setTimeout((()=>{this.setState({progress:t.progress})}),350))},get task(){return this.props.task},get url(){return this.task.inputs.page.url},get adapter(){return new r.Adapter(this.props.task)},get enabled(){return this.task.enabled},get enableTooltip(){return a.proxy.taskScheduleTooltip(this.task)},get title(){const e=this.props.record;if(e?.title)return e.title;const t=this.props.task;return this.state.titleFocused||t.name?t.name:r.proxy.recipeTitle(t)},get titleEditable(){return this.props.titleEditable??!0},get selected(){return"popup"!==l.controller.pageType&&a.proxy.taskSelected(this.task.id)},get subtitle(){try{const{host:n,pathname:o}=new URL(this.url),a=o&&"/"!==o?o:"";return t([e(1,"b",null,n,0),a],0)}catch(t){return e(1,"b",null,"go to website",16)}},get favicon(){return a.proxy.taskFavicon(this.task)},get bgIcon(){const e=this.props.record;return e?.recipeId?r.proxy.recipeIcon(e.recipeId):r.proxy.recipeIcon(this.task)},get elevated(){return this.props.elevated},get size(){return this.props.size},get progress(){return this.state.progress},get statusIcon(){const e=this.adapter.lastRecordStatusIcon,t=this.adapter.lastRecordValueSuffix,n=this.adapter.lastRecordValueText;return"ok"===e&&"%"===t&&!Number.isNaN(n)&&n>=0&&n<=100?"progress":e},get statusIconColor(){return this.adapter.lastRecordStatusIconColor},get runnable(){return this.props.runnable},get configurable(){return this.props.configurable},render(){return o(2,s.ValueWidget,{enabled:this.enabled,enableTooltip:this.enableTooltip,title:this.title,titleEditable:this.titleEditable,selected:this.selected,runnable:this.runnable,configurable:this.configurable,onTitleFocus:this.onTitleFocus,onTitleKeyDown:this.onTitleKeyDown,onTitleInput:this.onTitleInput,onTitleBlur:this.onTitleBlur,onSubtitleClick:this.onSubtitleClick,subtitle:this.subtitle,favicon:this.favicon,onSelect:this.onSelect,onClick:this.props.onClick&&this.onClick,onEditClick:this.onEditClick,onFaviconClick:this.props.runnable&&this.onFaviconClick,onCancelClick:this.props.runnable&&this.onCancelClick,value:this.adapter.lastRecordValueText,valueDimmed:this.adapter.lastRecordValueDimmed,valuePrefix:this.adapter.lastRecordValuePrefix,valueSuffix:this.adapter.lastRecordValueSuffix,delta:this.adapter.lastRecordDeltaText,deltaColor:this.adapter.lastRecordDeltaColor,deltaDirection:this.adapter.lastRecordDeltaDirection,description:this.adapter.lastRecordDescription,info:this.adapter.lastRecordInfo,statusIcon:this.statusIcon,statusIconColor:this.statusIconColor,bgIcon:this.bgIcon,progress:this.progress,elevated:this.elevated,size:this.size})},onSelect(){a.controller.toggleTaskSelected(this.task.id)},onClick(){this.props.onClick(this.task.id)},onEditClick(){i.proxy.show=!0,i.proxy.taskId=this.task.id},onFaviconClick(){a.controller.runTasks(this.task.id)},onCancelClick(){a.controller.cancelTask(this.task.id)},onSubtitleClick(){this.props.onSubtitleClick?this.props.onSubtitleClick():this.url&&chrome.tabs.create({url:this.url,active:!0})},onTitleFocus(){this.titleBeforeEdit=this.title,this.setState({titleFocused:!0})},onTitleKeyDown(e){if("Escape"===e.key)return this.onTitleChange(this.titleBeforeEdit),void e.target.blur();"Enter"===e.key&&e.target.blur()},onTitleInput(e){const t=e.target.value;this.onTitleChange(t)},onTitleBlur(){const e=this.task.name.trim().replace(/\s{2,}/g," ");this.onTitleChange(e),this.setState({titleFocused:!1})},onTitleChange(e){this.props.onTitleChange?this.props.onTitleChange(e):a.controller.setTaskName(this.task.id,e)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o,normalizeProps:a,createTextVNode:r}=n.$inferno,{$dashboard:i,$ui:s,$utils:l,$shortcut:c,$critical:d}=n;i.WidgetList=s.component("DashboardWidgetList",{props:()=>({class:Class}),get tasks(){return this.isNewTabPage?i.proxy.tasks:i.proxy.screenTasks},get isNewTabPage(){return"shell-new-tab"===d.proxy.pageType},render(){const{c:n,props:a}=this;if(0===this.tasks.length){if(this.isNewTabPage)return null;const a=c.proxy.label,i=t([r("Call HARPA on any website with "),a,r(","),e(1,"br"),r("Your Web Monitors and Automations"),e(1,"br"),r("will be listed here.")],0);return e(1,"div",n.block({notFound:!0}),o(2,s.NotFound,{text:i}),2)}return t([o(2,s.DndSorter,{class:[n.block,a.class],onSwap:this.onSwap,children:this.tasks.map(this.renderTaskWidgets)}),this.isNewTabPage?null:o(2,s.Spacer,{height:160})],0)},renderTaskWidgets:(e,t)=>o(2,u,{task:e,viewed:t<=5},e.id),onSwap(e,t){const n=s.hoverState.addListener(((e,t)=>"ValueWidget:hovered"!==`${e.name}:${t}`));setTimeout((()=>s.hoverState.removeListener(n)),100),i.controller.moveTasks(e,t)}});const u=s.component("DashboardTaskWidgets",{state:e=>{const t=Date.now()-e.task.createdMs;return{viewed:e.viewed,justCreated:t>0&&t<5*l.time.SECOND}},get runnable(){return!0},get configurable(){return!["shell-new-tab","popup"].includes(d.proxy.pageType)},get elevated(){return"popup"===d.proxy.pageType},didMount(){this.tillUnmount.setTimeout((()=>{this.setState({justCreated:!1})}),800)},render(){const{c:t,props:n,state:r}=this;return a(e(1,"row",t.block({justCreated:r.justCreated}),[o(2,p,{task:n.task,viewed:r.viewed,elevated:this.elevated,runnable:this.runnable,configurable:this.configurable}),o(2,h,{task:n.task,viewed:r.viewed}),o(2,i.PreviewWidget,{task:n.task,viewed:r.viewed})],4,{...!r.viewed&&s.viewState(this)}))}}),p=s.component("DashboardValueWidgetContainer",{get jobProgress(){return i.proxy.jobProgress(this.props.task)},render(){const{c:t,props:n}=this;return e(1,"div",t.block,this.props.viewed&&o(2,i.ValueWidget,{task:n.task,elevated:n.elevated,configurable:n.configurable,runnable:n.runnable,progress:this.jobProgress}),0)}}),h=s.component("DashboardGraphWidgetContainer",{render(){const{c:t,props:n}=this;return e(1,"div",t.block,this.props.viewed&&o(2,i.GraphWidget,{task:n.task,records:n.task.records}),0)}})})(),(()=>{const{$dashboard:e,$task:t,$harpa:o,$store:a,$bus:r,$utils:i,$journal:s,$mobx:l}=n;e.controller={setTaskName(e,n){t.proxy.updateTask(e,{name:n})},toggleTaskSelected(e){a.transaction((t=>{i.array.toggle(t.dashboard.selectedTasks,e,!1)}))},toggleTaskEnabled(e){const n=t.proxy.taskById(e).enabled;this.setTasksEnabled(e,!n)},setTasksEnabled(e,t){e=i.ensureArray(e),a.transaction((n=>{n.tasks.forEach((n=>{e.includes(n.id)&&(n.enabled=t,s.proxy.logTaskEnabled(n))})),n.dashboard.stoppedTasks=null}))},selectAllScreenTasks(){const t=e.proxy.screenTasks;a.transaction((e=>{e.dashboard.selectedTasks=i.unique([...e.dashboard.selectedTasks,...t.map((e=>e.id))])}))},unselectAllTasks(){e.proxy.selectedTasks=[]},stopAllScreenTasks(){const t=e.proxy.screenTasks.map((e=>e.id));a.transaction((e=>{const n=[];for(const o of t){const t=e.tasks.find((e=>e.id===o));t.enabled&&(n.push(t),t.enabled=!1)}n.length>0&&(e.dashboard.stoppedTasks=n.map((e=>e.id))),n.forEach((e=>s.proxy.logTaskEnabled(e)))}))},resumeStoppedTasks(){if(0===e.proxy.resumableTaskCount)a.transaction((e=>{for(const t of e.tasks)t.enabled||(t.enabled=!0,s.proxy.logTaskEnabled(t))}));else{const t=new Set(e.proxy.stoppedTasks);a.transaction((e=>{for(const n of e.tasks)t.has(n.id)&&(n.enabled=!0,s.proxy.logTaskEnabled(n))}))}},runTasks(e){e=i.ensureArray(e);const n={};e.forEach((e=>n[e]=t.proxy.taskIndex(e))),e=e.sort(((e,t)=>n[e]-n[t])),r.send("runner.enqueueTasks",e)},duplicateTasks(n){n=i.ensureArray(n);const o=new Set(n),c=e.proxy.tasks.map((e=>{if(!o.has(e.id))return e;const t=l.toJS(e);return t.id=a.idGenerator.task(),t.name=i.string.incrementNumberSuffix(t.name),t.enabled=!1,t.createdMs=Date.now(),s.proxy.logTaskCreated(t),[e,t]}));c.filter((e=>Array.isArray(e))).forEach((e=>r.send("task.cloneTaskStorage",e))),t.proxy.tasks=c.flat()},rearrangeTasks(n,o="top"){n=i.ensureArray(n);const a=new Set(n),r=n.map((e=>t.proxy.taskById(e))),s=e.proxy.tasks.filter((e=>!a.has(e.id))),l="top"===o?[...r,...s]:[...s,...r];t.proxy.tasks=l},clearTaskRecords(e){e=new Set(i.ensureArray(e)),a.transaction((t=>{t.tasks.filter((t=>e.has(t.id))).forEach((e=>{e.records=[]}))}))},moveTasks(t,n){if(t===n)return;const o=a.state.tasks.findIndex((e=>e.id===t)),r=a.state.tasks.findIndex((e=>e.id===n));if(e.proxy.taskSelected(t)&&!e.proxy.taskSelected(n)){const t=[],i=[];e.proxy.tasks.forEach((n=>{e.proxy.taskSelected(n.id)?t.push(n):i.push(n)})),n=i.findIndex((e=>e.id===n)),o<r?i.splice(n+1,0,...t):i.splice(n,0,...t),a.transaction((e=>e.tasks=i))}else a.transaction((e=>{const t=e.tasks.splice(o,1)[0];e.tasks.splice(r,0,t)}))},cancelTask(t){e.proxy.disableTask(t),r.send("runner.terminateTasks",[t])},deleteTasks(t){t=i.ensureArray(t);const n=new Set(t),r=e.proxy.tasks.filter((e=>n.has(e.id))),l=e.proxy.tasks.filter((e=>!n.has(e.id))),c=e.proxy.selectedTasks.filter((e=>!n.has(e))),d="dashboard"!==o.proxy.mainScreen&&0===e.proxy.screenTasks.length;a.transaction((e=>{e.tasks=l,e.dashboard.selectedTasks=c,e.dashboard.stoppedTasks=[],d&&(e.mainScreen="dashboard")})),r.forEach((e=>s.proxy.logTaskDeleted(e)));let u=new Set;r.forEach((e=>{u.add(e.inputs?.schedule?.mediumId)})),u=Array.from(u).filter((e=>!!e)),u.forEach((e=>i.chrome.tabs.remove(e)))},importTasks(){const e=async e=>{const t=URL.createObjectURL(e),n=await fetch(t),o=await n.text();try{const e=JSON.parse(o);await r.send("dashboard.importTasks",e)}catch(e){logger.warn("[$dashboard] failed loading task file",e)}},t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("multiple",!0),t.setAttribute("accept","application/json"),t.addEventListener("change",(async t=>{t.preventDefault();const n=Array.from(t.target.files);for(const t of n)await e(t)}),{once:!0}),t.click()}}})(),(()=>{const{$dashboard:e,$download:t,$task:o,$utils:a,$bus:r}=n;e.exportController={async exportTaskDataCsv(e){if(0===e.length)return;const n=e.map((e=>o.proxy.taskById(e))).filter((e=>!!e)),a=n.reduce(((e,t)=>e+t.records.length),0),r=this._createTasksCsv(n);{const n=`tasks-${e.length}-rows-${a}.harpa.csv`;await t.controller.download(n,r,"text/csv")}},async exportTaskConfig(e){if(0===e.length)return;let n;if(1===e.length){const t=o.proxy.taskById(e[0]);n=`task-${this._dashedTaskName(t)}.harpa.json`}else n=`tasks-${e.length}.harpa.json`;const a=await this._createTaskPatch(e);await t.controller.download(n,a)},_createTasksCsv(e){const t=(e=a.ensureArray(e)).map((e=>e.records.map((t=>({...t,__hrpTask:e}))))).flat();return a.createCsv(t,[["task id",e=>e.__hrpTask.id],["task name",e=>e.__hrpTask.name],["url",e=>e.__hrpTask.inputs?.page?.url||"â€”"],["date",e=>new Date(e.ms).toLocaleDateString()],["time",e=>new Date(e.ms).toLocaleTimeString()],["value",e=>e.value??"â€”"],["metric",e=>e?.metric?e.metric.startsWith("CUR:")?e.metric.substr(4):e.metric:"â€”"],["status",e=>e.status||"â€”"],["color",e=>e.color||"â€”"],["triggered",e=>e.triggered?"yes":"â€”"],["dispatched",e=>e.dispatched?e.dispatched.join(","):"â€”"],["info",e=>e.info?e.info.replaceAll("<b>","").replaceAll("</b>",""):"â€”"]])},_createTaskPatch:async(e=[])=>await r.send("dashboard.createTaskPatch",e,{withData:!1,withRecords:!1}),_createFile:(e,t)=>new Blob([e],{type:t}),_dashedTaskName(e){const t=e.name||o.proxy.recipeTitle(e);return a.string.toKebabCase(t)}}})(),(()=>{const{$dashboard:e,$store:t,$task:o,$runner:a,$utils:r,$library:i,$journal:s}=n;e.proxy=t.createProxy({get predefinedImportedAt(){return t.state.dashboard.predefinedImportedAt},set predefinedImportedAt(e){this._update({predefinedImportedAt:e})},get aggregation(){return t.state.dashboard.aggregation},set aggregation(e){this._update({aggregation:e})},get tasks(){return t.state.tasks},get taskIds(){return this.tasks.map((e=>e.id))},hasTasks(){return this.tasks.length>0},get domains(){const e=this.tasks.map((e=>o.proxy.taskDomain(e)));return r.unique(e)},get screenTasks(){return this.getScreenTasks(t.state.mainScreen)},getScreenTasks(e){return e.startsWith("domain:")?this.tasks.filter((t=>e===`domain:${o.proxy.taskDomain(t)}`)):this.tasks},taskFavicon(e){const t=o.proxy.taskDomain(e);return i.proxy.domainFavicon(t)},get selectedTasks(){return t.state.dashboard.selectedTasks},set selectedTasks(e){this._update({selectedTasks:e})},get stoppedTasks(){return t.state.dashboard.stoppedTasks},set stoppedTasks(e){this._update({stoppedTasks:e})},get selectedTasksSet(){return new Set(this.selectedTasks)},selectedTasksEnabled(){return(this.selectedTasks||[]).every((e=>o.proxy.taskById(e)?.enabled))},taskSelected(e){return this.selectedTasksSet.has(e)},hasEnabledScreenTasks(){return this.screenTasks.some((e=>e.enabled))},get resumableTaskCount(){const e=new Set(this.stoppedTasks);let t=0;for(const n of this.tasks)e.has(n.id)&&t++;return t},taskScheduleTooltip(e){const t=a.proxy.computeNextRunMs(e);return-1===t?"Schedule this task":!a.proxy.netStable&&t<=Date.now()?"Waiting for stable Internet connection":r.time.formatRelativeDate(t)},jobProgress(e){const t=a.proxy.jobByTaskId(e.id);return t?t.progress?t.progress:a.proxy.netStable&&t.ms<=Date.now()?0:null:null},disableTask(e){t.transaction((t=>{t.tasks.forEach((t=>{t.id===e&&(t.enabled=!1,s.proxy.logTaskEnabled(t))}))}))},_update(e={}){t.transaction((t=>{Object.assign(t.dashboard,e)}))}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$creator:o,$ui:a,$task:r}=n;o.ConfigModeSwitch=a.component("CreatorConfigModeSwitch",{get configMode(){return o.proxy.configMode},get editing(){return!!o.proxy.editingTaskId},get task(){return r.proxy.taskById(o.proxy.editingTaskId)},get enabled(){return this.task.enabled},render(){const{c:n}=this;return e(1,"row",n.block,[this.renderToggleEnabled(),t(2,a.Spacer,{width:"grow"}),this.renderExtraConfig()],0,{"x-between":!0,"y-center":!0})},renderToggleEnabled(){if(!this.editing)return null;const{c:e}=this;return t(2,a.Button,{class:e.toggleEnabled,icon:this.enabled?"stop":"running",label:this.enabled?"STOP RUNNING":"RUN TASK",type:"link",status:"secondary",onClick:this.onToggleEnabled})},renderExtraConfig(){const{c:n}=this;return e(1,"row",n.extraConfig,[t(2,a.Icon,{class:n.icon,name:"edit"}),t(2,a.Spacer,{width:"g1"}),t(2,a.Switch,{labelPosition:"left",label:"EXTRA CONFIG",labelClass:n.label,thumbClass:n.thumb,trackClass:n.track,value:"advanced"===this.configMode})],4,{"y-center":!0,onClick:this.onChange})},onToggleEnabled(){const e={enabled:!this.enabled};r.proxy.updateTask(o.proxy.editingTaskId,e)},onChange(){o.proxy.configMode="simple"===this.configMode?"advanced":"simple"}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$creator:o,$editor:a,$ui:r}=n;o.ConfigPanel=r.component("CreatorConfigPanel",{get task(){return o.proxy.template},get show(){return"parsed"===o.proxy.parseStatus&&this.task},get configMode(){return o.proxy.configMode},render(){if(!this.show)return null;const{c:n}=this;return e(1,"column",n.block,t(2,a.TaskProvider,{task:this.task,ctx:o.contextController.value,children:[t(2,o.ConfigModeSwitch),t(2,a.OverviewScreen,{configMode:this.configMode,onInputSelect:this.onInputSelect})]}),2)},onInputSelect(){o.proxy.screen="input"}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$creator:a,$ui:r,$bus:i,$env:s,$utils:l,$chrome:c}=n;a.FailurePanel=r.component("CreatorFailurePanel",{state:()=>({retryDisabled:!1}),get error(){return a.proxy.parseError},render(){const{c:n,state:a}=this;return e(1,"column",n.block,[t(2,r.Icon,{class:n.icon,name:"status-error",width:55,height:52}),t(2,r.Spacer,{height:30}),e(1,"div",n.text,[o("Could not connect to web page, error:"),e(1,"br"),e(1,"span",null,this.error,0),e(1,"br"),e(1,"br"),o("If problem persists after refresh, please email us at"),o(" "),e(1,"span",null,s.contactEmail,0),o(" with page URL / screenshot")],0),t(2,r.Spacer,{height:"g2"}),t(2,r.Button,{label:"RETRY",icon:"refresh",type:"link",disabled:a.retryDisabled,onClick:this.onRetryClick})],4,{"x-center":!0})},async onRetryClick(){this.setState({retryDisabled:!0}),await c.tabs.reload(a.proxy.tabId),await l.sleep(2500),this.setState({retryDisabled:!1});const e={tabId:a.proxy.tabId,force:!0};i.send("creator.parseTemplates",e)}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$creator:a,$ui:r,$tabs:i,$task:s,$tab:l,$chat:c}=n;a.Header=r.component("CreatorHeader",{props:()=>({class:Class}),state:()=>({ready:!1}),get screen(){return l.proxy.screen},get favicon(){return i.proxy.currentTab?.favicon},get editing(){return!!a.proxy.editingTaskId},get hidden(){if(a.proxy.frameCollapsed)return!1;return"explorer"===c.proxy.of().screen},didMount(){i.proxy.isCurrentTabAutomatable||(l.proxy.screen="dashboard"),this.setState({ready:!0})},render(){const{c:n,props:a,state:i}=this;return i.ready?e(1,"row",[n.block({hidden:this.hidden}),a.class],[e(1,"row",n.tabs,[this.editing?null:this.renderButton({type:"ai",label:"AI",selected:"ai"===this.screen,icon:t([o(2,r.Spacer,{width:"g0h"}),o(2,r.OpenAiLogo)],4)}),this.renderButton({type:"create",label:this.editing?"CONFIGURE":"MONITOR",selected:"dashboard"===this.screen||"create"===this.screen,icon:o(2,r.Icon,{class:n.icon({type:"dashboard"}),name:r.ScreenHeader.icons.monitor,width:17.45,height:16}),onClick:()=>{l.proxy.screen=this.editing||0===s.proxy.tasks.length?"create":"dashboard"}})],0),o(2,r.Spacer,{width:"g1"}),e(1,"row",null,[this.renderButton({type:"settings",selected:"settings"===this.screen,icon:o(2,r.Icon,{class:n.icon({type:"settings"}),name:"configure"})}),e(1,"button",n.cornerButton,o(2,r.Icon,{name:"fullscreen"}),2,{onClick:this.onWideClick}),e(1,"button",n.cornerButton,o(2,r.Icon,{name:"collapse"}),2,{onClick:this.onCollapseClick}),e(1,"button",n.cornerButton,o(2,r.Icon,{name:"close"}),2,{onClick:this.onCloseClick})],0,{gap:"g1"})],4,{"y-center":!0,"x-between":!0}):null},renderButton({type:t,selected:n,icon:a,label:i,onClick:s}){const{c:l}=this;return e(1,"row",l.button({type:t,selected:n}),[a,i&&o(2,r.Spacer,{width:"g1"}),i&&e(1,"span",null,i,0)],0,{"y-center":!0,"data-type":t,onClick:s||this.onScreenClick})},onScreenClick(e){const t=e.target.closest(`.${this.c.button}`).dataset.type;l.proxy.screen=t},onWideClick(){a.proxy.frameWide=!a.proxy.frameWide},onCollapseClick(){a.proxy.frameCollapsed=!0},onCloseClick(){a.proxy.frameOpen=!1}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$creator:a,$ui:r,$editor:i}=n;a.InputPanel=r.component("CreatorInputPanel",{get task(){return a.proxy.template},get show(){return"parsed"===a.proxy.parseStatus&&this.task},render(){if(!this.show)return null;const{c:n}=this;return t([o(2,i.TaskProvider,{task:this.task,ctx:a.contextController.value,children:[o(2,i.InputHeader,{onBackClick:this.onBackClick,class:n.header}),e(1,"column",n.block,o(2,i.InputScreen),2)]})],4)},onBackClick(){a.proxy.screen="config"}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$ui:a,$creator:r,$dashboard:i,$dialog:s,$settings:l,$tab:c}=n;r.Screen=a.component("CreatorScreen",{props:()=>({showHomeButton:Boolean}),get showDialogHeader(){return r.proxy.frameCollapsed},render(){const{c:t}=this;return e(1,"div",t.block({frameOpen:this.frameOpen}),this.renderContent(),0)},renderContent(){const{c:e}=this;return"trapper"===r.proxy.screen?o(2,r.TrapperScreen):t([o(2,r.Header),o(2,s.Header,{class:e.dialogHeader({hidden:!this.showDialogHeader})}),"ai"===c.proxy.screen&&o(2,s.Screen),"create"===c.proxy.screen&&o(2,r.Tab),"dashboard"===c.proxy.screen&&o(2,i.Tab,{showHomeButton:this.props.showHomeButton}),"settings"===c.proxy.screen&&o(2,l.Tab)],0)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$creator:o,$ui:a,$task:r}=n;o.ShortcutButtons=a.component("CreatorShortcutButtons",{get parsed(){return"parsed"===o.proxy.parseStatus},render(){const{c:n}=this;return e(1,"row",n.block,[t(2,i,{parsed:this.parsed}),t(2,l,{parsed:this.parsed})],4)}});const i=a.component("CreatorCustomWatcherButton",{props:()=>({parsed:Boolean}),get dropdownTemplates(){return o.proxy.dropdownTemplates},get items(){return this.dropdownTemplates.map((e=>({id:e.id,label:e.dropdown.name,icon:e.dropdown.icon})))},render(){const{c:n}=this,o=!this.props.parsed;return e(1,"div",n.block,[t(2,a.Dropdown,{class:n.dropdown({hidden:o}),icon:"recipe",text:"CUSTOM MONITOR",items:this.items,valueContainerClass:n.valueContainer,valueClass:n.value,iconClass:n.icon,hideTriangle:!0,renderer:e=>t(2,s,{item:e}),onChange:this.onCustomWatcherClick}),o&&t(2,a.Skeleton,{class:n.skeleton})],0)},onCustomWatcherClick(e){o.proxy.templateIndex=o.proxy.templates.findIndex((t=>t.id===e.id)),o.proxy.screen="config"}}),s=a.component("CreatorCustomWatcherRenderer",{render(){const{c:n,props:o}=this,r=o.item;return e(1,"row",n.block,[t(2,a.Icon,{class:n.icon,name:r.icon,noTransition:!0}),t(2,a.Spacer,{width:"g1h"}),e(1,"span",n.text,r.label,0)],4,{"y-center":!0})}}),l=a.component("CreatorElementButton",{props:()=>({parsed:Boolean}),render(){const{c:n}=this,o=!this.props.parsed;return e(1,"div",n.block,[e(1,"row",n.button({hidden:o}),[e(1,"row",n.part,[t(2,a.Icon,{class:n.icon,name:"recipe-watcher.monitorElement"}),t(2,a.Spacer,{width:"g1"}),e(1,"span",null,"ELEMENT",16)],4,{"y-center":!0}),e(1,"row",[n.part,n.grab],t(2,a.Icon,{class:n.icon,name:"mouse-cursor-default"}),2)],4,{onClick:this.onClick}),o&&t(2,a.Skeleton,{class:n.skeleton})],0)},onClick(){const e=o.proxy.templates.findIndex((e=>e.dropdown&&"watcher.monitorElement"===e.recipeId));o.proxy.templateIndex=e,o.trapperController.start({type:"monitor"}),setTimeout((()=>{new r.Adapter(o.proxy.template).inputScreen="watcher.recipe",o.proxy.screen="input"}),200)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$creator:o,$ui:a,$tabs:r,$welcome:i}=n;o.StartButton=a.component("CreatorStartButton",{props:()=>({title:String,subtitle:String,disabled:Boolean,onClick:Listener}),get show(){return!r.proxy.isCurrentTabAutomatable||"parsed"===o.proxy.parseStatus&&o.proxy.template},get editing(){return!!o.proxy.editingTaskId},get disabled(){return!r.proxy.isCurrentTabAutomatable},render(){if(!this.show)return null;const{c:n,props:o}=this,r=o.title||this.editing?"SAVE":"START",i=o.subtitle||this.editing?"Update monitor configuration":"Automate page monitoring",s=this.disabled;return e(1,"row",n.block({disabled:s}),e(1,"row",n.button,[t(2,a.Icon,{class:n.icon,name:"rocket"}),t(2,a.Spacer,{width:"g1h"}),e(1,"column",null,[e(1,"div",n.title,r,0),e(1,"div",n.subtitle,i,0)],4),t(2,a.Icon,{class:n.forward,name:"forward"})],4,{onClick:this.onClick}),2)},onClick(){const e=o.proxy.template;i.controller.startTask(e),o.controller.startTask(e)}})})(),(()=>{const{createVNode:e,createComponentVNode:t,createTextVNode:o}=n.$inferno,{$creator:a,$ui:r,$env:i}=n;a.SuggestionForm=r.component("CreatorSuggestionForm",{state:()=>({expanded:!1}),get expanded(){return this.state.expanded},render(){const{c:t}=this;return e(1,"column",t.block,this.renderHeader(),0)},renderHeader(){const{c:n}=this;return e(1,"column",n.header,[e(1,"row",null,[e(1,"row",null,[t(2,r.Icon,{name:"idea",class:n.ideaIcon({expanded:this.expanded})}),t(2,r.Spacer,{width:"g1h"}),e(1,"div",n.title,"SEND QUESTION / REPORT A BUG",16)],4),t(2,r.Icon,{class:n.triangleIcon({expanded:this.expanded}),name:"triangle"})],4,{"x-between":!0,"y-center":!0}),this.expanded&&e(1,"div",n.subtitle,[o("Have a feature request? Did not find what you were looking for? Send us a message: "),e(1,"span",null,i.contactEmail,0)],4)],0,{onClick:this.onHeaderClick})},onHeaderClick(){this.setState({expanded:!this.expanded})}})})(),(()=>{const{createFragment:e,createComponentVNode:t}=n.$inferno,{$creator:o,$ui:a}=n;o.Tab=a.component("CreatorTab",{get status(){return"failed"===o.proxy.parseStatus?"failed":"wizard"},didMount(){o.controller.onPopupMounted()},render(){return e(["failed"===this.status&&this.renderFailed(),"wizard"===this.status&&this.renderWizard()],0)},renderFailed:()=>t(2,o.FailurePanel),renderWizard:()=>t(2,o.Wizard)})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$creator:o,$ui:a,$task:r,$tabs:i,$harpa:s,$tab:l}=n;o.TemplatesHeader=a.component("CreatorTemplatesHeader",{props:()=>({label:String,showHome:Boolean,showSelector:Boolean,showRefresh:Boolean}),get label(){return this.props.label},get parsed(){return"parsed"===o.proxy.parseStatus},get templates(){return o.proxy.templates},get listTemplates(){return o.proxy.listTemplates},get total(){return this.listTemplates.length},get index(){return o.proxy.templateIndex},render(){const{label:t,showHome:n,showSelector:o,showRefresh:a}=this.props;if(!(t||n||o||a))return null;const{c:r}=this;return e(1,"row",r.block,[this.renderHeader(),this.renderSelector()],0,{"x-between":!0,"y-center":!0})},renderHeader(){return e(1,"row",null,[this.renderLabel(),this.renderRefresh()],0,{"y-center":!0})},renderLabel(){if(!this.label)return null;const{c:t}=this;return e(1,"span",t.label,this.label,0)},renderRefresh(){const{c:n,props:o}=this;return e(1,"row",n.refreshContainer,[t(2,a.Icon,{class:n.refresh({show:this.parsed&&o.showRefresh}),name:"refresh",onClick:this.onRefreshClick}),t(2,a.Icon,{class:n.home({show:this.parsed&&o.showHome}),name:"home",onClick:this.onHomeClick}),t(2,a.ProgressRing,{class:n.progress({show:!this.parsed}),size:18,value:30,spinning:!0})],4)},renderSelector(){if(!this.props.showSelector)return null;if(0===this.listTemplates.length)return null;const{c:n}=this;return e(1,"row",n.selector,[e(1,"row",null,this.templates.map(this.renderTemplate),0),t(2,a.Spacer,{width:"g1h"}),t(2,a.Icon,{class:n.iconButton,width:18,height:18,name:"backCircle",onClick:this.onPrevClick}),t(2,a.Spacer,{width:"g1h"}),t(2,a.Icon,{class:n.iconButton,width:18,height:18,name:"forwardCircle",onClick:this.onNextClick}),t(2,a.Spacer,{width:6})],4,{"y-center":!0})},renderTemplate(t,n){const{c:o}=this;return!t.dropdown&&e(1,"div",o.dot({selected:n===this.index}),null,1,{"data-index":n,onClick:this.onTemplateClick},n)},onRefreshClick(){o.controller.parseTemplates(!0)},onHomeClick(){"templates"!==o.proxy.screen?o.proxy.screen="templates":r.proxy.tasks.length>0?l.proxy.screen="dashboard":(s.proxy.mainScreen="dashboard",i.openAppTab())},onTemplateClick(e){const t=e.target.closest(`.${this.c.dot}`).dataset.index;o.proxy.templateIndex=Number(t)},onPrevClick(){o.proxy.prevListTemplateIndex()},onNextClick(){o.proxy.nextListTemplateIndex()}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$creator:o,$ui:a,$task:r}=n;o.TrapperScreen=a.component("CreatorTrapperScreen",{get data(){return o.proxy.trapperData},render(){const{c:n}=this;return e(1,"div",n.block,[this.renderHeader(),t(2,a.Spacer,{height:"g1h"}),this.renderBody()],0,{onClick:this.onClick})},renderHeader(){const{c:n}=this;return e(1,"row",null,[e(1,"div",n.title,"MONITOR DATA",16),t(2,a.Icon,{class:n.closeButton,name:"close",onClick:this.onCloseClick})],4,{"x-between":!0,"y-center":!0})},renderBody(){const{c:n}=this;return e(1,"div",n.body,this.data.map((e=>t(2,a.DataItem,{class:n.item,item:e,onClick:this.onItemClick,onHover:this.onItemHover,onUnhover:this.onItemUnhover}))),0)},onCloseClick(){o.trapperController.cancel()},async onItemClick({item:e}){const t=await o.trapperController.computeSelector(e);new r.Adapter(o.proxy.template).transaction((n=>{n.inputs["watcher.element"].selectorType="ai",n.inputs["watcher.element"].selector=t,n.state.item=e})),await o.trapperController.cancel(),o.controller.updateTemplate()},onItemHover({item:e}){clearTimeout(this._unhoverTimeout),o.trapperController.hover(e.container)},onItemUnhover(){clearTimeout(this._unhoverTimeout),this._unhoverTimeout=this.tillUnmount.setTimeout((()=>{o.trapperController.unhover()}),100)}})})(),(()=>{const{createVNode:e,createComponentVNode:t}=n.$inferno,{$creator:o,$ui:a,$utils:r,$dashboard:i}=n;o.WidgetList=a.component("CreatorWidgetList",{props:()=>({type:OneOf(["list","selected"])}),get type(){return this.props.type},get parsed(){return"parsed"===o.proxy.parseStatus},get template(){return o.proxy.template},get templates(){return o.proxy.templates},get listTemplates(){return o.proxy.listTemplates},render(){return"list"===this.type?this.parsed?this.renderList():this.renderSkeletons():"selected"===this.type?this.parsed?this.renderTemplate():this.renderSkeleton():null},renderSkeletons(){const{c:n}=this;return e(1,"column",n.block,r.range(6).map((e=>t(2,a.Skeleton,{class:n.skeleton,style:{"animation-delay":-200*(6-e-1)+"ms","animation-duration":"1200ms"}}))),0)},renderSkeleton(){const{c:n}=this;return e(1,"column",n.block,t(2,a.Skeleton,{class:n.skeleton,label:"Waiting for page to stop updating...",onClick:this.onSkeletonClick}),2)},renderList(){const{c:t}=this;return e(1,"column",t.block,this.listTemplates.map((e=>this.renderWidget(e,{clickable:!0,named:!0}))),0)},renderTemplate(){const{c:t,template:n}=this;return e(1,"column",t.block,this.renderWidget(n,{titleEditable:!0,elevated:!0}),0)},renderWidget(e,{titleEditable:n,elevated:o,clickable:a,named:r}={}){return e?(r&&(e={...e,name:e.named}),t(2,i.ValueWidget,{size:"small",task:e,record:e.records.at(-1),elevated:o||!1,titleEditable:n||!1,onTitleChange:n&&this.onTitleChange,onClick:a&&this.onTemplateClick})):null},onTitleChange(e){o.proxy.updateTemplate({name:e})},onTemplateClick(e){if("templates"===o.proxy.screen){const t=this.templates.findIndex((t=>t.id===e));o.proxy.templateIndex=t,o.proxy.screen="config"}else o.proxy.screen="templates"},onSkeletonClick(){o.proxy.parseStatus="parsed"}})})(),(()=>{const{createVNode:e,createFragment:t,createComponentVNode:o}=n.$inferno,{$creator:a,$ui:r}=n,i={templates:0,config:1,input:2};a.Wizard=r.component("CreatorWizard",{get screenIndex(){return i[a.proxy.screen]||0},get slideShiftStyle(){const e=this.screenIndex;return{transform:`translateX(${0===e?0:-e+"00%"}`}},get noTemplates(){return 0===a.proxy.templates.length},get editing(){return!!a.proxy.editingTaskId},get templatesHeader(){return a.proxy.editingTaskId?null:"Configure monitor"},render(){const{c:t}=this;return e(1,"row",t.block,e(1,"row",t.slide({instant:this.noTemplates}),[o(2,r.Scroll,{class:t.screen,contentClass:t.screenContent,children:this.renderTemplatesScreen()}),o(2,r.Scroll,{class:t.screen,contentClass:t.screenContent,children:this.renderConfigScreen()}),o(2,r.Scroll,{class:t.screen,contentClass:t.screenContent,children:this.renderInputScreen()})],4,{style:this.slideShiftStyle}),2)},renderTemplatesScreen(){return t([o(2,a.TemplatesHeader,{label:"Pick what to monitor",showHome:!this.editing,showSelector:!1,showRefresh:!0}),o(2,a.ShortcutButtons),o(2,a.WidgetList,{type:"list"}),o(2,a.SuggestionForm)],4)},renderConfigScreen(){return t([o(2,a.TemplatesHeader,{label:this.templatesHeader,showHome:!this.editing,showSelector:!this.editing,showRefresh:!this.editing}),o(2,a.WidgetList,{type:"selected"}),o(2,a.ConfigPanel),o(2,r.Spacer,{grow:!0}),o(2,a.StartButton)],4)},renderInputScreen:()=>o(2,a.InputPanel)})})(),(()=>{const{$creator:e,$bus:t,$mobx:o}=n;e.contextController={async init(){this._model=o.observable({ctx:{}}),t.on("creator.setContext",this._setContext.bind(this)),await this._pull()},_setContext(t,n){t===e.proxy.tabId&&(this._model.ctx=n)},async _pull(){const n=await t.send("creator.getContext",e.proxy.tabId);Object.assign(this._model.ctx,n)},get value(){return this._model.ctx},get prefetch(){return this.value.prefetch},get html(){return this.value.html},get text(){return this.value.text},get data(){return this.value.data}}})(),(()=>{const{$harpa:e,$creator:t,$critical:o,$tabs:a,$bus:r,$task:i,$store:s,$mobx:l,$tab:c}=n;t.controller={init(){this._enabled&&(this._resetToTemplates(),this._resetIfPageUrlChanged(),this._setupContext(),this._setupTrapper(),this._setupInjectionStateSync(),this._reactToTemplateChanges())},callPageApi:async(e,...n)=>await r.send("creator.callPageApi",t.proxy.tabId,e,...n),get _enabled(){return"popup"===o.proxy.pageType&&a.proxy.isCurrentTabAutomatable},_resetToTemplates(){"trapper"===t.proxy.screen&&(t.proxy.screen="templates")},_resetIfPageUrlChanged(){t.proxy.pageUrl!==a.proxy.currentTabUrl&&s.transaction((e=>{e.tab[t.proxy.tabId].creator={...s.template.creator(),pageUrl:a.proxy.currentTabUrl,frame:e.tab[t.proxy.tabId].creator.frame}}))},_setupContext(){t.contextController.init()},_setupTrapper(){t.trapperController.init()},onPopupMounted(){const e=t.proxy.tabId,n=i.proxy.taskByTabId(e);n?t.proxy.editingTaskId||this.editTaskInTab(n.id,e):this.parseTemplates()},parseTemplates(e){const n={tabId:t.proxy.tabId,force:e};r.send("creator.parseTemplates",n)},async editTaskInTab(e,t){r.send("creator.editTaskInTab",e,t)},async startTask(){c.proxy.screen="dashboard",setTimeout((()=>{t.proxy.screen="templates",r.send("creator.saveTemplateToTask",t.proxy.tabId)}),400)},updateTemplate(){r.send("creator.updateTemplate",t.proxy.tabId)},_setupInjectionStateSync(){const n={get:()=>({theme:e.proxy.theme,frameWide:t.proxy.frameWide,frameOpen:t.proxy.frameOpen,frameCollapsed:t.proxy.frameCollapsed,trapperGrabbing:t.proxy.trapperGrabbing}),apply(n){e.proxy.theme=n.theme,t.proxy.frameWide=n.frameWide,t.proxy.frameOpen=n.frameOpen,t.proxy.frameCollapsed=n.frameCollapsed,t.proxy.trapperGrabbing=n.trapperGrabbing}};window.addEventListener("message",(e=>{if("engine.syncState"!==e.data.name)return;const t=e.data.args[0];n.apply(t)})),l.reaction((()=>n.get()),(e=>this.callPageApi("state.apply",e)),{fireImmediately:!0})},_reactToTemplateChanges(){l.reaction((()=>t.proxy.screen),((e,t)=>{"config"===e&&"input"===t&&this.updateTemplate()}))}}})(),(()=>{const{$creator:e,$tabs:t,$bus:o}=n;e.trapperController={init(){this.onTargetLocked=null,o.on("trapper.targetLocked",((e,n)=>{if(!this.onTargetLocked||e!==t.proxy.currentTabId)return;const o=this.onTargetLocked;this.onTargetLocked=null,o(n)}))},get parent(){return e.controller},start({type:t,listener:n}={}){if(!t)throw new Error("type is required: monitor, context, command");this.onTargetLocked=n,e.proxy.frameOpen=!1,e.proxy.trapperGrabbing=t},async cancel(){this.onTargetLocked=null,e.proxy.frameOpen=!0,e.proxy.trapperGrabbing=!1,e.proxy.screen="config",await this.parent.callPageApi("trapper.cancel")},async hover(e){await this.parent.callPageApi("trapper.hover",e)},async unhover(){await this.parent.callPageApi("trapper.unhover")},async computeSelector(e){return await this.parent.callPageApi("trapper.computeSelector",e)}}})(),(()=>{const{$creator:e,$store:t,$tab:o}=n;e.Adapter=class{constructor(e){if(!e)throw new Error("$creator.Adapter tabId argument must be defined");this._tabId=e}get tabId(){return this._tabId}get pageUrl(){return this._creator.pageUrl}set pageUrl(e){this._update({pageUrl:e})}get pageFavicon(){return this._creator.pageFavicon}set pageFavicon(e){this._update({pageFavicon:e})}get parseStatus(){return this._creator.parseStatus}set parseStatus(e){this._update({parseStatus:e})}get parseError(){return this._creator.parseError}set parseError(e){this._update({parseError:e})}get screen(){return this._creator.screen}set screen(e){this._update({screen:e})}get frameWide(){return this._creator.frame.wide}set frameWide(e){this._updateFrame({wide:e})}get frameOpen(){return this._creator.frame.open}set frameOpen(e){this._updateFrame({open:e})}get frameCollapsed(){return this._creator.frame.collapsed}set frameCollapsed(e){this._updateFrame({collapsed:e})}get configMode(){return this._creator.configMode}set configMode(e){this._update({configMode:e})}get templates(){return this._creator.templates}set templates(e){this._update({templates:e})}get listTemplates(){return(this.templates||[]).filter((e=>!e.dropdown))}get dropdownTemplates(){return(this.templates||[]).filter((e=>!!e.dropdown))}get templateIndex(){return this._creator.templateIndex}set templateIndex(e){this._update({templateIndex:e})}prevListTemplateIndex(){if(0===this.listTemplates.length)return;let e=this.templateIndex;const t=this.templates.length;do{e>0?e-=1:e=t>0?t-1:0}while(this.templates[e].dropdown);this.templateIndex=e}nextListTemplateIndex(){if(0===this.listTemplates.length)return;let e=this.templateIndex;const t=this.templates.length;do{e<t-1?e+=1:e=0}while(this.templates[e].dropdown);this.templateIndex=e}get template(){const e=this.templates;return this.templateIndex<e.length?e[this.templateIndex]:null}set template(e){const{tabId:n,templateIndex:o}=this;t.transaction((t=>{t.tab[n].creator.templates[o]=e}))}updateTemplate(e={}){const{tabId:n,templateIndex:o}=this;t.transaction((t=>{Object.assign(t.tab[n].creator.templates[o],e)}))}get editingTaskId(){return this._creator.editingTaskId}get trapperData(){return this._creator.trapper.data||[]}set trapperData(e){this._updateTrapper({data:e})}get trapperGrabbing(){return this._creator.trapper.grabbing}set trapperGrabbing(e){this._updateTrapper({grabbing:e})}_update(e={}){this._modify((t=>Object.assign(t,e)))}_updateTrapper(e={}){this._modify((t=>Object.assign(t.trapper,e)))}_updateFrame(e={}){this._modify((t=>Object.assign(t.frame,e)))}_modify(e){o.proxy.transaction(this._tabId,(t=>e(t.creator)))}get _creator(){return o.proxy.getState(this._tabId).creator}}})(),(()=>{const{$creator:e,$tab:t}=n;e.__defineGetter__("proxy",(()=>t.proxy.creator))})(),(()=>{const{$commands:e}=n;e.preprocessStep=e=>e?("say"===(e=t({...e})).type?e.message=(e.message||"").trim():"ask"===e.type?e.param=e.param||"input":"gpt"===e.type?e.param=e.param||"gpt":"paste"===e.type?(e.text=e.text||"{{gpt}}",e.close=e.close||!1):"command"===e.type&&(e.name=e.name||"",e.inputs=e.inputs||[]),e):null;const t=e=>(e.type||("string"==typeof e.say?delete(e={...e,type:"say",message:e.say}).say:"string"==typeof e.ask?delete(e={...e,type:"ask",param:e.ask}).ask:"string"==typeof e.gpt?delete(e={...e,type:"gpt",prompt:e.gpt}).gpt:"string"==typeof e.jump?delete(e={...e,type:"jump",to:e.jump}).jump:"string"==typeof e.paste?delete(e={...e,type:"paste",text:e.paste}).paste:"string"==typeof e.interpolate&&delete(e={...e,type:"interpolate",param:e.interpolate}).interpolate),e)})(),(()=>{const{$commands:e}=n;e.systemCommands=[{meta:{name:"reply",title:"Reply",category:"Productivity",description:"Write a reply to selected text.",emoji:"ðŸ“©"},steps:[{condition:"{{page.selection}} !=",type:"ask",message:"Sure! What would you like me to reply to?\n",param:"text",options:[{label:"SELECTED TEXT",value:"{{page.selection}}"},{value:"$custom"}]},{condition:"{{page.selection}} =",type:"ask",message:"Sure! What would you like me to reply to? Leave blank and I will try to figure it out from the opened page.\n",param:"text",options:[{label:"FIND ON PAGE",value:"Please parse from the web page content"},{value:"$custom"}]},{type:"ask",message:"What would you like the reply to include? Pick an option or type instructions.\n",param:"reply",options:[{label:"NOTHING SPECIFIC",value:"None"},{label:"ðŸ‘ AGREEMENT",value:"Agreement"},{label:"ðŸ‘Ž DISAGREEMENT",value:"Disagreement"},{label:"â“ QUESTION",value:"Question"},{label:"ðŸ¤” CLARIFICATION",value:"Clarification"},{label:"ðŸ§ SUGGESTION",value:"Suggestion"},{label:"ðŸ¤·â€ï¸ INFORMATION",value:"Request for more information"},{label:"ðŸ˜‚ JOKE",value:"Joke"},{label:"ðŸ’¡ IDEA",value:"Idea"},{label:"ðŸ’¯ PRAISE",value:"Praise"},{label:"ðŸ™Œ ACKNOWLEDGMENT",value:"Acknowledgment"},{label:"ðŸ¤— EMPATHY",value:"Empathy"},{label:"ðŸ¤ž SUPPORT",value:"Support"},{label:"ðŸ’ª ENCOURAGEMENT",value:"Encouragement"},{label:"ðŸ¤¨ CRITICISM",value:"Criticism"},{label:"ðŸ™ APOLOGY",value:"Apology"},{value:"$custom"}]},{type:"gpt",prompt:"Please ignore previous instructions. Your new instructions:\n- I would like you to write a reply for me on a web page.\n- Please pretend to be me, mimicking my style of communication if present in a context.\n- Your task is to write a reply, appropriate for the style of communication, parameters and {{page.domain}} website, in the language of the source message. E.g. if website is twitter, write a tweet, if gmail, write an email, if reddit, write a reddit comment, etc.\n- Do not echo my command or parameters.\n- I will give you the reply parameters in brackets [], as well as a web page content so you understand the conversation context and style.\n\n[USE WEB PAGE CONTENT AS A REPLY CONTEXT]: {{page}}\n\n[WRITE A REPLY TO THIS MESSAGE]: {{text}}\n\n[ADDITIONAL INSTRUCTIONS / REPLY SHOULD CONTAIN, IF ANY]: {{reply}}\n\nTEXT OF A REPLY:"},{type:"ask",label:"ask-for-change",param:"change",options:[{label:"âœ… DONE",value:"no"},{label:"âŒ¨ï¸ PASTE TO PAGE",value:"paste"},{label:"â¬†ï¸ EXPAND",value:"Make text longer."},{label:"â¬‡ï¸ SHORTEN",value:"Make text shorter."},{label:"ðŸ”  FIX GRAMMAR",value:"Output the text as is, but fix spelling errors if the text contains them."},{label:"ðŸ¤ª SIMPLIFY",value:"Simplify text language."},{label:"ðŸ¤“ COMPLICATE ",value:"Complicate text language."},{label:"ðŸ’¼ PROFESSIONAL",value:"Change tone to professional."},{label:"ðŸ¹ CASUAL",value:"Change tone to casual."},{label:"ðŸŽ¯ STRAIGHTFORWARD",value:"Change tone to straightforward."},{label:"ðŸ¦ CONFIDENT",value:"Change tone to confident."},{label:"ðŸ± FRIENDLY",value:"Change tone to friendly."},{label:"ðŸ“š STORY",value:"Change style to storytelling."},{label:"ðŸ™€ SCARY",value:"Change style to scary."},{label:"ðŸ¦‘ LOVECRAFT",value:"Change style to a H.P. Lovecraft story."},{label:"ðŸ‘¤ 1ST PERSON",value:"Change style to 1st person."},{label:"ðŸ•µï¸â€ï¸ 3RD PERSON",value:"Change style to 3rd person."},{label:"ðŸ” CLARITY",value:"Add clarity and conciseness."},{label:"ðŸ› ï¸â€ï¸ REFINE",value:"Improve sentences structure and flow, as well as coherence and relevance by adding or removing information, but try to keep to the text length."},{label:"ðŸŽ¨â€ï¸ ILLUSTRATE",value:"Add examples, anecdotes, and other storytelling elements to illustrate points."},{label:"ðŸŒ TRANSLATE",value:"Translate to {{language}}, or echo text as is if already in {{language}}."},{label:"ðŸ“Œâ€ï¸ ADD HEADINGS",value:"Add headings, subheadings, bullet points, and other formatting elements for readability."},{label:"ðŸŽ“â€ï¸ ENRICH",value:"Enhance vocabulary and tone."},{label:"ðŸ¥´ HUMANIZE",value:'I want you to perform text "Humanization". Please rewrite each sentence, increasing its perplexity and burstiness. Perplexity measures the complexity of text. Separately, burstiness compares the variations of sentences. Humans tend to write with greater burstiness, for example, with some longer or complex sentences alongside shorter ones. AI sentences tend to be more uniform. I need it to have a good amount of perplexity and burstiness. Rewrite changing 50% in nouns and verbs for similar ones and rewrite verb usages to add natural sounding variations in complexity but retain the same tense and overall meaning. Randomly use simple and complicated verbs, combine long and short sentences and rewrite the above text so that it is not detected as AI content by AI content detectors.'},{value:"$custom"}]},{condition:"{{change}} = no",type:"stop"},{condition:"{{change}} = paste",type:"paste",closeFrame:!0},{condition:"{{change}} = paste",type:"stop"},{type:"gpt",prompt:"I would like you to make changes to the reply you have just written. Please do not output anything but the revised reply. Do not echo my command. Do not put quotes around the revised reply.\n\n[CHANGES TO MAKE]: {{change}}\n\nNEW REPLY:"},{type:"jump",to:"ask-for-change"}]},{meta:{name:"rewrite",title:"Rewrite",category:"Productivity",description:"Make changes to selected text.",emoji:"ðŸ–ï¸"},steps:[{condition:"{{page.selection}} !=",type:"ask",message:"Sure! What would you like me to rewrite?\n",param:"text",options:[{label:"SELECTED TEXT",value:"{{page.selection}}"},{value:"$custom"}]},{condition:"{{page.selection}} =",type:"ask",message:"Sure! What would you like me to rewrite?\n",param:"text"},{type:"ask",message:"How would you like me to rewrite the text? Pick an option or type instructions.\n",param:"instructions",options:[{label:"â¬†ï¸ EXPAND",value:"Make text longer."},{label:"â¬‡ï¸ SHORTEN",value:"Make text shorter."},{label:"ðŸ”  FIX GRAMMAR",value:"Output the text as is, but fix spelling errors if the text contains them."},{label:"ðŸ¤ª SIMPLIFY",value:"Simplify text language."},{label:"ðŸ¤“ COMPLICATE ",value:"Complicate text language."},{label:"ðŸ’¼ PROFESSIONAL",value:"Change tone to professional."},{label:"ðŸ¹ CASUAL",value:"Change tone to casual."},{label:"ðŸŽ¯ STRAIGHTFORWARD",value:"Change tone to straightforward."},{label:"ðŸ¦ CONFIDENT",value:"Change tone to confident."},{label:"ðŸ± FRIENDLY",value:"Change tone to friendly."},{label:"ðŸ“š STORY",value:"Change style to storytelling."},{label:"ðŸ™€ SCARY",value:"Change style to scary."},{label:"ðŸ¦‘ LOVECRAFT",value:"Change style to a H.P. Lovecraft story."},{label:"ðŸ‘¤ 1ST PERSON",value:"Change style to 1st person."},{label:"ðŸ•µï¸â€ï¸ 3RD PERSON",value:"Change style to 3rd person."},{label:"ðŸ” CLARITY",value:"Add clarity and conciseness."},{label:"ðŸ› ï¸â€ï¸ REFINE",value:"Improve sentences structure and flow, as well as coherence and relevance by adding or removing information, but try to keep to the text length."},{label:"ðŸŽ¨â€ï¸ ILLUSTRATE",value:"Add examples, anecdotes, and other storytelling elements to illustrate points."},{label:"ðŸŒ TRANSLATE",value:"Translate to {{language}}, or echo text as is if already in {{language}}."},{label:"ðŸ“Œâ€ï¸ ADD HEADINGS",value:"Add headings, subheadings, bullet points, and other formatting elements for readability."},{label:"ðŸŽ“â€ï¸ ENRICH",value:"Enhance vocabulary and tone."},{label:"ðŸ¥´ HUMANIZE",value:'I want you to perform text "Humanization". Please rewrite each sentence, increasing its perplexity and burstiness. Perplexity measures the complexity of text. Separately, burstiness compares the variations of sentences. Humans tend to write with greater burstiness, for example, with some longer or complex sentences alongside shorter ones. AI sentences tend to be more uniform. I need it to have a good amount of perplexity and burstiness. Rewrite changing 50% in nouns and verbs for similar ones and rewrite verb usages to add natural sounding variations in complexity but retain the same tense and overall meaning. Randomly use simple and complicated verbs, combine long and short sentences and rewrite the above text so that it is not detected as AI content by AI content detectors.'},{value:"$custom"}]},{type:"gpt",prompt:"Please ignore previous instructions. Your new instructions:\n- I would like you to act as a copywriter and rewrite or improve a given text for me.\n- I will give you the reply parameters in brackets [].\n- Do not echo my command or parameters.\n\n[TEXT TO REWRITE]: {{text}}\n\n[HOW TO REWRITE THE TEXT]: {{instructions}}\n\nNEW TEXT:"},{type:"ask",label:"ask-for-change",param:"change",options:[{label:"âœ… DONE",value:"no"},{label:"âŒ¨ï¸ PASTE TO PAGE",value:"paste"},{label:"â¬†ï¸ EXPAND",value:"Make text longer."},{label:"â¬‡ï¸ SHORTEN",value:"Make text shorter."},{label:"ðŸ”  FIX GRAMMAR",value:"Output the text as is, but fix spelling errors if the text contains them."},{label:"ðŸ¤ª SIMPLIFY",value:"Simplify text language."},{label:"ðŸ¤“ COMPLICATE ",value:"Complicate text language."},{label:"ðŸ’¼ PROFESSIONAL",value:"Change tone to professional."},{label:"ðŸ¹ CASUAL",value:"Change tone to casual."},{label:"ðŸŽ¯ STRAIGHTFORWARD",value:"Change tone to straightforward."},{label:"ðŸ¦ CONFIDENT",value:"Change tone to confident."},{label:"ðŸ± FRIENDLY",value:"Change tone to friendly."},{label:"ðŸ“š STORY",value:"Change style to storytelling."},{label:"ðŸ™€ SCARY",value:"Change style to scary."},{label:"ðŸ¦‘ LOVECRAFT",value:"Change style to a H.P. Lovecraft story."},{label:"ðŸ‘¤ 1ST PERSON",value:"Change style to 1st person."},{label:"ðŸ•µï¸â€ï¸ 3RD PERSON",value:"Change style to 3rd person."},{label:"ðŸ” CLARITY",value:"Add clarity and conciseness."},{label:"ðŸ› ï¸â€ï¸ REFINE",value:"Improve sentences structure and flow, as well as coherence and relevance by adding or removing information, but try to keep to the text length."},{label:"ðŸŽ¨â€ï¸ ILLUSTRATE",value:"Add examples, anecdotes, and other storytelling elements to illustrate points."},{label:"ðŸŒ TRANSLATE",value:"Translate to {{language}}, or echo text as is if already in {{language}}."},{label:"ðŸ“Œâ€ï¸ ADD HEADINGS",value:"Add headings, subheadings, bullet points, and other formatting elements for readability."},{label:"ðŸŽ“â€ï¸ ENRICH",value:"Enhance vocabulary and tone."},{label:"ðŸ¥´ HUMANIZE",value:'I want you to perform text "Humanization". Please rewrite each sentence, increasing its perplexity and burstiness. Perplexity measures the complexity of text. Separately, burstiness compares the variations of sentences. Humans tend to write with greater burstiness, for example, with some longer or complex sentences alongside shorter ones. AI sentences tend to be more uniform. I need it to have a good amount of perplexity and burstiness. Rewrite changing 50% in nouns and verbs for similar ones and rewrite verb usages to add natural sounding variations in complexity but retain the same tense and overall meaning. Randomly use simple and complicated verbs, combine long and short sentences and rewrite the above text so that it is not detected as AI content by AI content detectors.'},{value:"$custom"}]},{condition:"{{change}} = no",type:"stop"},{condition:"{{change}} = paste",type:"paste",closeFrame:!0},{condition:"{{change}} = paste",type:"stop"},{type:"gpt",prompt:"I would like you to make changes to the new text you have just written. Please do not output anything but the revised text. Do not echo my command. Do not put quotes around the revised text.\n\n[CHANGES TO MAKE]: {{change}}\n\nNEW TEXT:"},{type:"jump",to:"ask-for-change"}]},{meta:{name:"ask",title:"Ask",category:"Productivity",description:"Ask me questions about opened page or PDF."},steps:[{say:'Sure! What do you want to know? For example: "What are the key takeaways?"\n'},{ask:"question",default:"What are the key takeaways?"},{gpt:"[CONTEXT]: {{context}}\n[INSTRUCTIONS]: I want you to reply only in {{language}}. Please answer the following question about the opened page content to the best of your ability and provided context. Be precise and helpful. Avoid mentioning context as incomplete.\n[QUESTION]: {{question}}\n[ANSWER]:"}]},{meta:{name:"alternatives",title:"Alternatives",category:"Productivity",description:"Generate a list of alternative products or topics."},steps:[{gpt:"Generate a list of up to 8 alternatives to the product or topic described in the web page or text. For every alternative, very shortly list pros and cons you know of (if any). Answer in {{language}}. Web page or text:\n{{page}}\nAlternatives:"}]},{meta:{name:"summary",title:"Summary",category:"Productivity",description:"Summarize the entire page content into a list of key takeaways."},steps:[{type:"gpt",chunkify:{text:"{{page}}",empty:"It looks as if the page has no text content. Or I could not fetch it.\n"},prompt:'I want you to only answer in {{language}}. Please extract key takeaways of the next chunk of the web page. Each key takeaway should be a list item, of the following format:\n"- [relevant emoji] [takeaway 1]"\nKeep emoji unique to each takeaway item. Please try to use different emojis for each takeaway. Do not render brackets.\nTHE WEB PAGE IS TITLED:\n{{page.desc}}\nWEB PAGE CHUNK:\n{{chunk}}\nKEY TAKEAWAYS LIST:\n'}]},{meta:{name:"extended-summary",title:"Extended summary",category:"Productivity",description:"Summarize page into report with bullet points with key takeaways."},steps:[{type:"gpt",prompt:'Analyze the website content and report the key points in bullets. Add a title to the report.\nThere should no limit in words to the report, ensure that all the points are concisely reported out. Please use as many bullet points as needed.\nAt the end of your report, add a paragraph "Key Takeaway" with the key takeaway from the text. Answer in {{language}}. Web page content:\n{{page}}\nReport:'}]},{meta:{name:"youtube-summary",category:"Productivity",title:"YouTube video summary",description:"Save time on watching YouTube videos. Break down YouTube videos into parts and get key takeaways.",apps:"YouTube"},steps:[{say:"Parsing video from the pageâ€¦ Long videos may lake a few seconds to parse.\n"},{type:"gpt",chunkify:{text:"{{youtube.transcript}}",empty:"It looks as if the video has no text transcript. Or I could not fetch it from YouTube.\n"},prompt:'I want you to only answer in {{language}}. Please extract key takeaways of the next chunk of the transcript. Each key takeaway should be a list item, of the following format:\n"- [relevant emoji] [takeaway in {{language}}]"\nKeep emoji unique to each takeaway item. Please try to use different emojis for each takeaway. Do not render brackets.\nYOUTUBE VIDEO IS TITLED:\n{{page.desc}}\nVIDEO TRANSCRIPT CHUNK:\n{{chunk}}\nKEY TAKEAWAYS LIST:\n'}]},{meta:{name:"tweet",title:"Tweet",category:"Productivity",description:"Summarize page into a tweet.",apps:"Twitter"},steps:[{gpt:"Summarize the web page text content into a single tweet. The resulting tweet must be 280 characters long or less. Do not wrap into quotes. Answer in {{language}}. Web page content:\n{{page}}\nTweet:"}]},{meta:{name:"contacts",title:"Contacts",category:"Productivity",description:"Extract contacts from the web page."},steps:[{gpt:"Extract contact names (personal and business) from the text. For every contact extract their address, email, phone and any extra information describing the person or business. Format result in a Table. Answer in {{language}}. Text:\n{{page}}\nResult:"}]},{meta:{name:"chart",title:"Chart",category:"Productivity",description:"Draws yours data in chart.",emoji:"ðŸ“Š"},steps:[{type:"ask",param:"data",message:"Data to draw in a chart? E.g.:\n\n- World population for the past century.\n- Series: kg consumed. Labels: Banana, Pineapple, Orange. Data: 5, 10, 20\n\nLeave empty and I will try to parse data from the page.",default:"Please try to parse data from the web page: {{page}}"},{type:"ask",param:"type",message:"Chart type?\n\nSupported types: bar, line, pie, doughnut, polarArea, radar, bubble, scatter etc.\n\nOr press enter to let me guess the best option.",default:"Use the best / the most suitable type"},{type:"gpt",prompt:"Please ignore all previous instructions.\n\nI would like you to generate a chart preview link, using http://quickchart.io. The chart should have the specified type and data. Please do not echo my prompts, only provide the output URL.\n\n[CHART TYPE]: {{type}}\n\n[CHART DATA]: {{data}}\n\n[REQUIRED OUTPUT FORMAT]: A single markdown link URL (not encoded):\n\n![Chart title](link to the image)\n\n[OUTPUT EXAMPLES, notice URL is not encoded]:\n\n![Bar](https://quickchart.io/chart?c={type:'bar',data:{labels:['Banana','Pineapple','Orange'],datasets:[{label:'Kg consumed',data:[5,10,50]}]}})\n\n![Bar](https://quickchart.io/chart?bkg=white&c={type:'bar',data:{labels:['Q1','Q2','Q3','Q4'],datasets:[{label:'Users',data:[50,60,70,180]},{label:'Revenue',data:[100,200,300,400]}]}})\n\n![Combo Bar Line](https://quickchart.io/chart?c={type:'bar',data:{labels:['January','February','March','April','May','June','July'],datasets:[{type:'line',label:'Dataset 1',borderColor:'rgb(54, 162, 235)',borderWidth:2,fill:false,data:[-33,26,29,89,-41,70,-84]},{type:'bar',label:'Dataset 2',backgroundColor:'rgb(255, 99, 132)',data:[-42,73,-69,-94,-81,18,87],borderColor:'white',borderWidth:2},{type:'bar',label:'Dataset 3',backgroundColor:'rgb(75, 192, 192)',data:[93,60,-15,77,-59,82,-44]}]},options:{responsive:true,title:{display:true,text:'Chart.js Combo Bar Line Chart'},tooltips:{mode:'index',intersect:true}}})\n\n![Scatterplot](https://quickchart.io/chart?c={type:\"scatter\",data:{datasets:[{label:\"Mercury\",borderColor:\"rgb(255, 99, 132)\",backgroundColor:\"rgba(255, 99, 132, 0.2)\",data:[{x:0.330,y:2439.7}]},{label:\"Venus\",borderColor:\"rgb(54, 162, 235)\",backgroundColor:\"rgba(54, 162, 235, 0.2)\",data:[{x:4.87,y:6051.8}]},{label:\"Earth\",borderColor:\"dark-green\",backgroundColor:\"rgba(0, 255, 0, 0.2)\",data:[{x:5.97,y:6371}]}]},options:{title:{display:true,text:\"Planet masses and radii\"},scales:{xAxes:[{ticks:{beginAtZero:true},scaleLabel:{display:true,labelString:'Radius (km)'}}],yAxes:[{ticks:{beginAtZero:true},scaleLabel:{display:true,labelString:'Mass (x10^24 kg)'}}]}}})\n\nOUTPUT:"}]},{meta:{name:"data",title:"Data",category:"Productivity",description:"Extract data from the web page."},steps:[{gpt:"Extract any data from the text. Format in a table with two columns Key and Value. Answer in {{language}}. Text:\n{{page}}\nData:"}]},{meta:{name:"translate",title:"Translate",category:"Productivity",description:"Translate text to the specified language."},steps:[{type:"ask",message:"Sure, what would you like me to translate?",param:"text"},{type:"ask",message:"What is the target language? Press enter for English.",param:"language",default:"English"},{type:"gpt",prompt:"Please ignore previous instructions. I would like you to translate the following text to {{language}}. Text to translate:\n{{text}}\nTranslation:\n"}]},{meta:{name:"grammarly",title:"Grammarly",category:"Productivity",description:"Correct text grammar."},steps:[{condition:"{{page.selection}} !=",type:"ask",message:"Sure! What would you like me to correct?\n",param:"text",options:[{label:"SELECTED TEXT",value:"{{page.selection}}"},{value:"$custom"}]},{condition:"{{page.selection}} =",type:"ask",message:"Sure! What would you like me to correct? Press enter to check the entire page.\n",param:"text",default:"{{page}}"},{type:"gpt",chunkify:{text:"{{text}}",empty:"It looks as if the page has no text content. Or I could not fetch it.\n"},prompt:'Ignore all previous instructions. I want you to correct grammar, spelling and punctuation errors in the following web page content (if any). Only output corrected sentences, which contained errors. Highlight fixed grammar using [] brackets.\nFor example, for text of two sentences: "Hello, my name is John. How is you doing?", the output should be:\n- How [are] you doing?\nTEXT TO CORRECT:\n{{chunk}}\nCORRECTED SENTENCES:\n'}]},{meta:{name:"simple",title:"Simplify",category:"Productivity",description:"Simplify text into basic concepts."},steps:[{gpt:"Summarize the text for a second-grade student. Answer in {{language}}. Text:\n{{page}}\nSummary:"}]},{meta:{name:"todo",title:"Todo",category:"Productivity",description:"Generate ToDo list from page content."},steps:[{gpt:"Convert this text to a todo list. Keep todo items short but understandable. Answer in {{language}}. Text:\n{{page}}\nTodo list:"}]},{meta:{name:"help",title:"Help",description:"Get help on using HARPA AI.",category:"Productivity"},steps:[{say:"Welcome to HARPA, your AI Automation Agent.\n\nAsk me questions; type slash / to bring my AI commands; extract data from web pages; monitor websites; create your custom automations. I am compatible with OpenAI API, ChatGPT, Google Bard.\n\nCall me on any web page with `Alt+A` (Windows), `^+A` (Mac) or click my icon in Chrome toolbar.\n\nHere is a quick features overview:\n\n- Chat with me about the opened web page.\n- [Summarize web pages](https://harpa.ai/guide/page-aware-chatgpt-prompts) and [YouTube videos](https://harpa.ai/guide/summarize-youtube-videos-to-text) into tweets, articles, DMs or emails.\n- [Get AI answers](https://harpa.ai/guide/ai-answers-alongside-google-search) alongside Google search results.\n- [Translate, correct, rephrase](https://harpa.ai/guide/write-text-on-websites-with-ai) text on any website.\n- Generate text in a [wide range of styles](https://harpa.ai/guide/writing-styles), from emails to **SWOT** analysis and **KISS** articles.\n- Reply to emails, social DMs and comments.\n- Monitor data online, from [prices to out of stock alerts](https://harpa.ai/guide/monitor-price-drops) and [changes on competitor websites](https://harpa.ai/guide/track-competitors).\n- Create custom page-aware [AI commands](https://harpa.ai/guide/custom-page-aware-chatgpt-commands) and automations to streamline your workflow.\n\nClick **GUIDES** for more info, or press ESC to stop."},{condition:"{{page.url}} = https://harpa.ai/welcome",label:"ask-for-question",type:"ask",param:"question",options:[{label:"ðŸ“š GUIDES",value:"guides"},{label:"âœ… DONE",value:"no"},{value:"$custom"}]},{condition:"{{page.url}} != https://harpa.ai/welcome",type:"ask",param:"question",options:[{label:"ðŸ“š GUIDES",value:"guides"},{label:"âœ… DONE",value:"no"}]},{condition:"{{question}} = no",type:"stop"},{condition:"{{question-option}} = $custom",gpt:"[CONTEXT]: {{context}}\n[INSTRUCTIONS]: Your name is HARPA, you are a Chrome Extension that integrates ChatGPT and automation into Chromium based browsers. The context contains information on your capabilities. Please answer the following question about the opened page content to the best of your ability and provided context. Be precise and helpful. Avoid mentioning context as incomplete. Do not hallucinate if you can not answer the question, instead please advice user to the check out the guides on harpa.ai website.\n[QUESTION]: {{question}}\n[ANSWER]:"},{condition:"{{question-option}} = $custom",jump:"ask-for-question"},{type:"ask",param:"question",options:[{label:"ðŸš€ GETTING STARTED",value:"start"},{label:"ðŸ¤– USING COMMANDS",value:"commands"},{label:"ðŸ”§ USING PARAMETERS",value:"parameters"},{label:"ðŸ” SEARCH ASSISTANT",value:"search"},{label:"âœï¸ COPYWRITING",value:"copywriting"},{label:"ðŸŽ¥ YOUTUBE SUMMARIES",value:"youtube"},{label:"ðŸ“Œ CUSTOM COMMANDS",value:"custom"},{label:"â¬‡ï¸ EXPORT / IMPORT",value:"export"},{label:"ðŸ• CHUNKING",value:"chunk"},{label:"ðŸ’µ MONITOR PRICES",value:"price"},{label:"ðŸ” AUTO REFRESH",value:"refresh"},{label:"ðŸ‘£ TRACK COMPETITORS",value:"track"},{label:"âš›ï¸ CONNECT TO CHATGPT",value:"chatgpt"},{label:"ðŸ”‘ï¸ CONNECT TO OPENAI API",value:"openai-api"},{label:"âœ¨ CONNECT TO BARD",value:"bard"},{label:"ðŸ›¡ï¸ PRIVACY & LIMITATIONS",value:"privacy"},{label:"ðŸ“¬ CONTACT US",value:"contact-us"}]},{condition:"{{question}} = start",type:"say",message:'## Getting Started\n\nHARPA combines modern AI and Automation for professional, personal and business use. Once installed, HARPA is available on any web page with `Alt+A` (Windows), `^+A` (Mac) or by clicking the HARPA icon in the Chrome toolbar. You can pin HARPA to the Chrome toolbar for quick access. Quick access shortcut can be customized in the app settings âš™ï¸.\n\nAI section of the HARPA interface is AI-powered, page-aware chat with custom commands and automation capabilities. And MONITOR section allows monitoring data on web pages for changes.\n\n### Connecting to AI\n\nUsing AI features requires either a ChatGPT account (free or plus), OpenAI API key or connection to Google Bard. HARPA will pick an available AI connection automatically. You can switch between connection types in the app settings âš™ï¸. Cloud AI connection is coming soon.\n\n- To connect HARPA to ChatGPT, create a free account at [ChatGPT.com](https://chatgpt.com).\n- To connect HARPA to OpenAI API, create an account at [OpenAI.com](https://openai.com).\n- To connect HARPA to Google Bard, make sure Google Bard is available at [bard.google.com](https://bard.google.com), you may need to use VPN if you are outside of the US.\n\nIf you only require Web Automation and Monitoring, you can use HARPA AI without connecting to any AI services.\n\n### How It Works\n\nHARPA can read and automate opened web page. Include `{{\\page}}` parameter into your prompt and it will extract text from the web page and send it to GPT. This way your question are answered in the context of the web page you are currently on.\n\nYou can turn **Page-aware** ON, and HARPA will automatically extract relevant text context from the web page.\n\nHARPA also supports `{{\\context}}`, `{{\\youtube.transcript}}`, `{{\\language}}`, `{{\\page.selection}}` and other predefined and custom parameters. Read more about using parameters in the **USING PARAMETERS** section.\n\n### Quick Commands\n\nType slash "/" in chat to bring in a list of quick commands. For example, type `/midjourney` to generate Midjourney prompts, `/youtube` to summarize a YouTube video or `/resume` to improve or write a LinkedIn resume. Read more about predefined commands in the **USING COMMANDS** section.\n\n### Quick-Access Bar\n\nSelecting any text on page brings in HARPA quick access panel. You can quickly rewrite, reply, translate selected text or call any other command. You can turn this feature off in the app settings âš™ï¸.\n\n### Custom Commands\n\nYou can create custom commands and automations by typing slash "/" and clicking **CREATE COMMAND**. Custom commands support web page automations such as web navigation, clicks, text typing, data extraction etc. Custom commands can be exported from HARPA as files. Read more about custom commands in the **CUSTOM COMMANDS** section.\n\n### Reading PDFs\n\nHARPA can read online PDFs. Navigate to a PDF file, e.g. on https://arxiv.org/, and launch HARPA to read and summarize it. Support for file uploads is coming soon.\n\n### Web Monitoring\n\nHARPA can monitor web pages for changes and send you notifications. You can monitor prices, stock availability, changes on competitor websites and more. Read more about web monitoring in the **MONITOR PRICES** section.\n\n### Privacy\n\nHARPA is privacy centered. It never sends web page content anywhere, except the AI service you are connected to. You can find more info on [privacy](https://harpa.ai/privacy) and [terms of service](https://harpa.ai/terms) on our website.'},{condition:"{{question}} = commands",type:"say",message:"## Using Commands\n\nHARPA comes with a list of over 100+ curated and regularly updated page-aware commands, broken down into categories: Productivity, Marketing & SEO, Learning, Copywriting, Coding and more. You can access the list of commands by typing slash / in chat.\n\nFilter commands by name, category, description or service by continue typing after slash, e.g. type /instagram to bring a list of commands designed to work with Instagram. You can find commands for LinkedIn, YouTube, TikTok, Amazon, Quora, StackOverflow and many other platforms.\n\nHARPA commands are designed to work well with OpenAI GPT-3.5, work best with GPT-4 and also work with Google Bard.\n\n### Step by Step Workflow\n\n1. To bring up a list of AI commands, type the / symbol in chat\n2. Commands are ranked by popularity and broken down into categories. To find a relevant command, start typing a web service name (such as Facebook, Twitter, YouTube, etc.) or a keyword (job, article, etc.).\n3. Click a command that suits your need or use the ArrowUp, ArrowDown, and Enter keys to select one.\n\n### Commands to Try\n\nSome of the most useful commands include:\n\n- `/ask` - answers your questions about the opened web page\n- `/compose` - generates any text from tweets to blog posts\n- `/reply` - replies to selected text, DMs, emails\n- `/rewrite` - rewrites selected text\n- `/summarize` - summarizes web pages\n- `/alternatives` - creates a list of alternative services and topics\n- `/data` - extracts prices and structural data from web pages\n- `/youtube summary` - summarizes hours long YouTube videos\n- `/midjourney` - generates Midjourney prompts\n- `/seo audit` - performs SEO audit of the opened web page\n\nAt any point, you can use `/clear` command to reset and restart the AI chat.\n\nYou can [watch a YouTube video](https://youtu.be/RrpTd6Nu4Is) or to read a [detailed guide](https://harpa.ai/guide/page-aware-chatgpt-prompts) on using predefined commands on our website.\n\n### Commands vs Prompts\n\nHARPA commands are prompts on steroids, and resemble multi-step dialogue systems. Some commands have a single GPT prompt step, while others like `/compose` contain over 50 steps and prompts for various purposes.\n\nUnder the hood HARPA uses a custom language to declare commands, called ChatML (Chat Markup Language). Whenever you export a custom command, you can see how it is defined in a YAML format."},{condition:"{{question}} = parameters",type:"say",message:'## Using Parameters\n\nWhenever you send a question (prompt) in chat, HARPA injects parameters into the prompt text. For example, if you type `Please summarize this web page: {{\\page}}` in chat, HARPA will extract text from the web page, inject it into the prompt and send to GPT.\n\nInspect available parameters by running `/echo params` command in chat.\n\nThere are many predefined parameters you can use in your prompts. You can also create custom parameters. Predefined parameters include:\n\n- `{{\\page}}` - web page text content, starting from the top of the page\n- `{{\\page.selection}}` - selected text on the web page\n- `{{\\page.title}}` - web page title\n- `{{\\page.desc}}` - web page meta description\n- `{{\\page.url}}` - web page URL\n- `{{\\page.domain}}` - web page domain\n- `{{\\language}}` - language defined in the app settings, e.g. English; this is useful to instruct GPT to reply in a certain language across your commands\n- `{{\\gpt}}` - last GPT response, useful for chaining prompts\n- `{{\\youtube.transcript}}` - YouTube video transcript, useful for summarizing and extracting information from YouTube videos\n- `{{\\context}}` - a portion of the web page relevant to your prompt\n\n### Page vs Context\n\nGPT input has a token limit, e.g. 4096 on GPT-3.5-turbo model, which is approximately 3000 words of English text. This limit is shared across chat history, question and response. Large web pages may not fit into the GPT input, so HARPA truncates `{{\\page}}` parameter automatically.\n\nUsing `{{\\context}}` in place of `{{\\page}}` instructs HARPA to scan the web page for the portion of text which is most relevant to your prompt, semantically. This is useful when you deal with large web pages and the relevant text content is not at the top of the page.\n\n### Custom Parameters\n\nYou can define custom parameters whenever you create a custom command. Custom parameters are useful when you want to reuse a piece of text across multiple GPT steps or customize your prompts.\n\nUse `ASK` step in the custom commands to declare custom parameters, e.g. `{{\\p1}}`. Read more about custom commands in the **CUSTOM COMMANDS** section.\n\n### Global Custom Parameters\n\nBy defaults, custom parameters are stored as long as the command is run. You can also define global custom parameters, which are stored across all commands and sessions.\n\nPrefix parameter name with "global" to make it globally available, e.g. `{{\\global.signature}}`. Then you can use it in any custom command or your chat prompts.'},{condition:"{{question}} = search",type:"say",message:"## Search Assistant\n\nHARPA integrates into Google, Bing, DuckDuckGo, Yahoo, Yandex and other search engines. Whenever you search for anything online, HARPA will provide concise answers to your questions, saving you time.\n\n- With AI-generated answers alongside traditional search results, you gain access to a wider range of information and perspectives on a given topic.\n- By asking follow-up questions or requesting more details, you can deepen your understanding of the topic at hand.\n\nSearch assistance works with the following search engines: Google Search, Bing, Baidu, Yahoo!, Yandex, DuckDuckGo, Kagi, AOL, Naver, Brave, Ecosia and others.\n\n### How to Setup Search Assistant\n\n- You can use HARPA search assistance by opening the search engine page and typing in your query as you normally would.\n\n- Expand HARPA window to query AI in parallel and form a brief answer on the given topic. You can open HARPA by clicking its icon in Chrome toolbar, clicking the minimized window at the bottom right, or pressing `Alt+A` (Windows) and `^+A` (Mac).\n\n- Use the chat interface in HARPA to ask any follow-up questions and receive an AI-generated answer. HARPA can answer questions and explain complex concepts, present arguments, pros and cons, find additional information for you and list related topics.\n\nClick the following link to watch a [YouTube video](https://youtu.be/yQWGp2qZrCw) or to read a [detailed guide](https://harpa.ai/guide/ai-answers-alongside-google-search) on our website."},{condition:"{{question}} = copywriting",type:"say",message:"## Copywriting commands\n\nHARPA is a Copywriter's best friend. Commands for generating and working with text content include:\n\n- `/compose` - write AI text content for social media, websites, emails, job boards and more\n- `/reply` - write AI replies to emails, job applications, social media posts and more\n- `/rewrite` - rewrite AI text content for social media, websites, emails, job boards and more\n\n### Compose\n\nThe `/compose` feature enables you to write AI content for various social media platforms such as LinkedIn, Facebook, and Instagram, and websites including email services, job boards, and many more. Composer is a sophisticated and a versatile dialogue system that can deliver tailored text results in just a few clicks, making it the perfect tool for any writing project. This is like having 50 ChatGPT prompts in just a single button.\n\nComposer command can write content in a total of [18 writing styles](https://harpa.ai/guide/writing-styles), enrich your content and make it well-structured. Most of these frameworks are compatible with GPT-3.5, but they fully unleash their potential when utilized with the OpenAI GPT-4 technology.\n\nThe 18 writing styles are broken down into 4 groups:\n\n- Marketing and Persuasion Techniques\n- Information and Analysis Techniques\n- Storytelling and Professional Communication Techniques\n- Academic, Opinion, and Creative Writing Styles\n\n### Rewrite and Reply\n\nThe `/rewrite` command allows you to quickly change the length and style of any text, check grammar, and much more.\n\nThe `/reply` command allows you to quickly respond to email messages, social media DMs, comments and more.\n\nEach of these commands work with different text sources: web pages, selected text, text written in chat, YouTube video transcript, and much more.\n\nClick the link to watch a [YouTube video](https://youtu.be/8tu_FXDs1o8) or to read a [detailed guide](https://harpa.ai/guide/write-text-on-websites-with-ai) on our website.\n\n### Quick Access Bar\n\nQuick access bar appears on websites whenever you select a piece of text. It allows you to quickly rewrite, shorten, expand, condense, elaborate on, correct spelling and grammar, draft a response, translate or reply to the selected text.\n\nKeep your essential commands readily accessible by adding them to the quick access panel. Click the link to watch a [YouTube video](https://youtu.be/VF9Yeo6H3iI) on quick access bar."},{condition:"{{question}} = youtube",type:"say",message:"## YouTube Video Summary\n\nYou can transform hours-long YouTube videos into concise summaries using `/youtube-summary` command. Extract key points without sacrificing time watching lengthy videos.\n\nThe YouTube Summary command operates almost instantaneously. You do not have to pause the video. I will seamlessly handle all the required transcript extraction, chunking, networking and interpreting processes in the background.\n\n### How to Create a YouTube Video Summary\n\n- Navigate to YouTube and open any video of your preference that you'd like to convert to the textual form. Whether it is a musical video or a two-hour interview, the most important factor is that a transcription of the selected video must be available on YouTube.\n\n- Open HARPA AI by clicking its icon in the top right corner or pressing `Alt+A` (on Windows) and `^+A`(on Mac).\n\n- Use the chat interface in HARPA to type /youtube and click the YouTube video summary command. You can use Up and Down arrow-keys to select the command to run.\n\n### Limitations & Troubleshooting\n\n- Videos that have no transcripts cannot be processed to summaries. You will be promptly notified by HARPA if the transcript is unavailable.\n\n- Most GPT models are restricted and can not process explicit content or obscene language, vulgar expressions, and so on. This slightly limits the functionality of this feature, but also makes the output highly amusing as AI tries to circumvent awkward phrasing. If you ask a question on a controversial topic, GPT-4 will respond with an answer, but GPT-3.5 might not answer at all if it considers the topic problematic.\n\n- Long video transcripts are broken down into chunks and the summary is provided in segments. This is due to the token limit restriction of GPT models.\n\n- On occasion, obtaining response from the generative AI may take some time, due to the time required for processing of lengthy video transcripts.\n\nClick the link to watch a [YouTube video](https://youtu.be/Fhe4gr6eDzo) on YouTube summaries or to read a [detailed guide](https://harpa.ai/guide/summarize-youtube-videos-to-text) on our website."},{condition:"{{question}} = custom",type:"say",message:"## Custom Commands\n\nCustom commands empower you to streamline your web workflow by crafting and quickly reusing unique prompts and workflow automations tailored to your online tasks.\n\nFollow these steps to create and reuse custom ChatGPT prompts:\n\n1. Type slash / in AI chat, then click the `Create command +` option at the top. You will get to a Custom Command configuration page.\n2. Type the name of your new custom command in the **name** field. This name will appear in the command list when you type the slash symbol / in the chat.\n3. Each command is a sequence of **Steps**. As a starting point, keep it simple by focusing on the two step types: **GPT** and **ASK**.\n4. Add and configure as many steps as you like and click **SAVE** button to store your command.\n5. You'll see your command saved at the top, above the pre-configured prompts, when you type the slash symbol /. Test you command by running it.\n\n### GPT Step\n\nGPT step allows you to generate a response using GPT model. It accepts prompt as an input and writes AI response in chat. You can use the parameters from the ask step to customize your GPT prompts and make them more interactive.\n\nExperiment with diverse phrasings, topics, and structures in your prompts to identify the most effective approach for your specific needs.\n\n### Ask Step\n\nAsk steps allow you to ask questions in chat and store answers as parameters. You can then use these parameters in a GPT step to generate a response.\n\n### Say Step\n\nThis step allows you to write a message in chat. You can use it to write a message before or after the GPT step.\n\n### Automation Steps\n\nAutomation steps include **NAVIGATE**, **CLICK**, **PASTE** and **REQUEST**. They allow you to automate your web workflow by navigating to a web page, clicking on a web element, pasting text into a web form, and sending a request to a web page.\n\n**REQUEST** step is especially useful to either get a web page content or to send a request to a web service or webhook, such as Zapier and Integromat. You can use response from the REQUEST step in other steps, e.g. GPT.\n\n### Command Step\n\nCommand step allows you to run another command from within a command. This is useful for creating higher-order commands and command shortcuts. For example, if you find yourself using `/compose` command in a certain way, you can create a new command that will run `/compose` with the desired parameters.\n\n### Parameters\n\nParameters store answers to the questions asked in the ASK steps. They can also reference web page content, e.g. `{{\\page}}` or previous GPT answer, e.g. `{{\\gpt}}`, which is useful for chaining multiple GPT steps together.\n\nRead more about using parameters in the **USING PARAMETERS** section.\n\n### Intro to Prompt Engineering\n\nHere are some excellent guides on Prompt Engineering that will help you write great GPT prompts:\n\n- [Best practices for prompt engineering with OpenAI API](https://help.openai.com/en/articles/6654000-best-practices-for-prompt-engineering-with-openai-api)\n- [Learn Prompting](https://learnprompting.org/)\n- [GitHub Prompt Engineering Guide](https://github.com/dair-ai/Prompt-Engineering-Guide)\n\nClick this link to read a [detailed guide](https://harpa.ai/guide/custom-page-aware-chatgpt-commands) on our website.\n\nIf you have questions about custom commands, you can ask them in our [Discord](https://discord.com/invite/HJzggAVJbH) server."},{condition:"{{question}} = export",type:"say",message:"## How to Import Commands\n\nYou can import one or more commands if they were exported in a yaml format.\n\n1. Open HARPA AI on any website.\n2. Type the slash / symbol in the HARPA AI chat and click **IMPORT** button at the top besides the categories list\n3. Drag & drop the command files into the opened window and click the big **IMPORT** button to upload them to HARPA.\n4. New commands will appear at the top of the prompts list after clicking /.\n\n### How to Export Commands\n\nExporting commands allows you to share them with others or store them for later use.\n\n1. Open HARPA AI on any website.\n2. Type the slash / symbol in the HARPA AI chat and select a command to export.\n3. Click Export button at the top left corner.\n4. Allow HARPA download files to your system.\n5. The file has been exported in a yaml format, and you can store or share it.\n\nClick on the link to read a [detailed guide](https://harpa.notion.site/Import-Export-Commands-30cfec103fbc436ea2ac5defce90f4e9?pvs=4) on our website.\n\nGot questions? Join our [Discord](https://discord.com/invite/HJzggAVJbH) and get help."},{condition:"{{question}} = chunk",type:"say",message:"## Chunking\n\nLarge Language Models have a limited token window e.g. 4096 tokens. It is often impractical or impossible to fit large documents, web pages and video transcripts into a single GPT request.\n\nChunking is a technique that divides content into smaller parts, also called **chunks**, to ensure that each part, including the prompt, fits within the GPT token limit. These chunks are then injected into prompts as {{\\chunk}} parameter and processed by GPT one by one.\n\nChunking does not possess inherent memory. Therefore, if you require context to be maintained across chunks, it must be incorporated within the prompt.\n\nClick on the link to read a [detailed guide](https://harpa.ai/guide/chunking) on Chunking on our website. Got questions? Join our [Discord](https://discord.com/invite/HJzggAVJbH) and get help."},{condition:"{{question}} = price",type:"say",message:"## Monitor Prices\n\nHARPA can be used as online shopping and web monitoring assistant. By automating price monitoring it helps you snag the best deals on e-commerce websites such as Amazon, AliExpress, Barnes & Noble, Rakuten, Newegg, and others. With its price drop alerts, you can be informed as soon as a product you're interested in goes on sale.\n\nIf a product you're after is out of stock, simply set up a monitor for the page and receive a notification the moment it becomes available again. Stay ahead of the competition and get the best shopping deals with HARPA.\n\n### How to Monitor Prices\n\n1. Navigate to a web page you would like to monitor. To keep track of a product price, open HARPA AI by clicking its icon in the top right corner of the browser or pressing `Alt+A` (on Windows) and `^+A` (on Mac), and switch over to the **MONITOR** tab at the top of HARPA window.\n\n2. The MONITOR tab will present you a list of possible items to track. To monitor a product price, simply click the corresponding option. For example, if the current product price is $1798, click the item with $1798.\n\nAll that is left to do is to click **START** button and HARPA will launch and refresh the web page in background periodically.\n\nHARPA will send you a notification in browser whenever the product price drops.\n\nHARPA runs monitors and automations in your browser, so your web data never leaves your machine.\n\n### Monitor Customization\n\nYou can customize schedule, triggers, actions and other parameters of your web monitors.\n\n- **Schedule Interval**. Monitors are run periodically and you can choose the running frequency from 15 seconds up to once a month. Running checks too ofter puts extra work on your machine and web servers. Some websites may log you out or ask to pass CAPTCHA test. It is recommended to always pick a reasonable delay such as 1 check every 3 hours for non-critical monitors.\n- **Trigger**. Trigger is a condition that HARPA AI checks every time the monitor task is run. You can monitor for a specific text to appear (e.g. â€œdiscountâ€) or disappear (e.g. â€œout of stockâ€), price value drop, page content update and others. Once the task is triggered, HARPA AI fires actions.\n- **Actions**. Actions are taken upon trigger fires and include showing notification, sending email, playing sound, calling webhook or make.com (Integromat) integration. You can turn ON or OFF actions and specify when they should be run (first trigger, every trigger, every run). The last option is especially helpful if you would like to send data from HARPA AI to GoogleSheet via Make.com.\n- **Before Run**. You can tell HARPA AI to wait for page to load, hide cookie banners, wait for text to appear or scroll the page down and up before the trigger check is run.\n\nBy setting up a combination of triggers and actions you can instruct HARPA AI to send you an email whenever price drops, while pushing data to Google Sheet on every monitor run.\n\n### Automations Dashboard\n\nYou can always see how your monitors perform by navigating to the HARPA Dashboard. Simply click the HARPA icon in browser and then click **MONITOR** to open the monitors list. You can filter monitors by website.\n\nClick to read a [detailed guide](https://harpa.ai/guide/monitor-price-drops) on our website."},{condition:"{{question}} = refresh",type:"say",message:"## Autorefresh\n\nYou can set any tab to automatically and periodically refresh and reload. This keeps your web pages up-to-date. It works almost identical to Easy Auto Refresh, Auto Refresh Plus, Tab Auto Refresh and other Chrome plugins.\n\nAutorefresh is highly customizable:\n\n- Set a desired page refresh interval.\n- Customize delays for each page or tab independently. Your settings are remembered for every page.\n- Select actions to be dispatched whenever a web page updates, goes down, contains text, or returns an HTTP code.\n- Integrate notifications, sounds, Make.com / Integromat events, and WebHooks.\n### How to set Auto Refresh\n1. To keep track of a web page, such as a product price, open HARPA AI plugin, and switch over to the **MONITOR** tab at the top of HARPA window.\n2. In the MONITOR tab, you will be presented with a list of possible items to track. One of the options is the Auto-refresh monitor. Click it.\n3. Schedule your page monitoring the way you like it. Pick how often the page should be refreshed.\n4. [Optional] If you want to be notified on a specific condition, pick a trigger.\n5. [Optional] Select actions for your trigger, such as sending E-Mails, Notifications, calling a WebHooks or running Integromat / Make.com scenarios.\n6. Finally, hit the START button, and you're all set with your auto-refreshing task!\n\nClick the link to read a [detailed guide](https://harpa.ai/guide/autorefresh-web-pages) on our website."},{condition:"{{question}} = track",type:"say",message:"## Track Competitors\n\nCompetitor monitoring tools are used to gain an edge over your rivals.\n\nBy automating the web monitoring process, you can stay informed about your competitors' pricing, products, SEO, marketing strategies, social media channels, announcements etc.\n\nHARPA AI allows collecting valuable insights into your competitors' online activities by monitoring their websites and social media channels.\n\nCompetitive tracking involves consistently monitoring your competitors' updates, primarily online, to inform your marketing, sales, and product strategies. By staying current with your competitors' activities and analyzing them over time, you can gain insights that help you position your business one step ahead.\n\n### How to Monitor Competitors websites\n\n1. Navigate to your competitorsâ€™ website. To keep track of a web page content, open HARPA, and switch over to the **MONITOR** tab at the top of the HARPA window.\n\n2. Under the MONITOR tab, you will be presented with a list of possible items to track. To monitor website changes, click the corresponding option - **PAGE TEXT CHANGES**.\n\n3. Click the **START** button, and HARPA AI will take care of the rest, periodically refreshing the web page in the background. You'll receive a friendly browser notification whenever a competitor's page changes.\n\nClick the link to read a [detailed guide](https://harpa.ai/guide/track-competitors) on our website."},{condition:"{{question}} = chatgpt",type:"say",message:'## Connecting to ChatGPT\n\n1. Go to [ChatGPT login page](https://chat.openai.com/auth/login).\n\n2. Register as a new user by clicking the Sign Up button. ChatGPT offers three options for new user registration:\n\n\n  - Enter your email address to create a new account.\n\n  - Use your Google account. Click the Continue with Google account option, and enter your Google account password to complete the process.\n\n  - The third option is to use your Microsoft account. Click the Continue with Microsoft account button, enter your password, and complete the sign-up process.\n\n\n3. ChatGPT will send a verification email to the registered email address.\n\n4. Type your full name in the input box.\n\n5. Enter your phone number. ChatGPT will send a verification code to your phone number.\n\n6. Verify it by typing the code in the space provided. Finally, your ChatGPT account is ready to be used!\n\n### How to get a ChatGPT Plus (GPT-4)?\n\nChatGPT Plus users have access to GPT-4 models. To upgrade to ChatGPT Plus, follow these steps:\n\n- Log in to your ChatGPT account.\n- Click "Upgrade to Plus" on the left menu.\n- Select the [ChatGPT Plus](https://openai.com/blog/chatgpt-plus) upgrade plan.\n- Enter your bank details and set up a recurring payment of $20/month.\n- Click "Continue to ChatGPT Plus."\n\n**Is there any benefit to using the OpenAI API key over the browser session?**\n\n- If you have access to GPT-4 in your OpenAI API account, API keys do not have a limit of 25 requests per 3 hours. The OpenAI API may also give you access to different GPT models (gpt-8k and gpt-32k).\n- The OpenAI API never disconnects you or logs you out.\n- Otherwise, the browser session is either free or costs around $20 per month for Plus and GPT-3.5 is actually even faster on the browser session compared to the API.'},{condition:"{{question}} = openai-api",type:"say",message:"## Connecting to OpenAI API\n\nConnecting to OpenAI API directly is the most reliable way to use AI features. Please be aware that OpenAI API access is paid per volume.\n\n1. To connect HARPA to OpenAI API, create an account at [OpenAI.com](https://openai.com).\n\n2. Create your API Key [here](https://platform.openai.com/account/api-keys). Copy the key. You won't be able to view it again, only revoke it or create a new one.\n\n3. Open HARPA AI and navigate to the settings tab by clicking âš™ï¸ button.\n\n4. Change the Connection type to OpenAI API Key and paste your OpenAI API Key.\n\n5. Enter your preferred Chat Model. For example, most users have access to gpt-3.5-turbo and gpt-3.5-turbo-16k and some to gpt-4.\n\nPlease note page-aware commands may consume many tokens. Using OpenAI API Keys could be more expensive than using ChatGPT Plus. However, ChatGPT GPT-4 is limited to 25 requests every 3 hours.\n\nIf you have questions about connection to ChatGPT, OpenAI or Bard, you can ask them in our [Discord](https://discord.com/invite/HJzggAVJbH) server."},{condition:"{{question}} = bard",type:"say",message:'## Connecting to Google Bard\n\nGoogle [Bard](https://bard.google.com/) is an experimental AI chat service developed by Google. It operates in a manner similar to ChatGPT, although the key distinction is that Bard retrieves its information directly from the web.\n\nLike other AI chatbots, Bard has the capability to code, solve math problems, and assist with writing.\n\nBard is not available in all regions and countries, you can get information about whether your country is connected [in the official website](https://support.google.com/bard/answer/13575153?hl=en).\n\n### How to connect Google Bard\n\n1. Open HARPA AI and go to the settings tab in the top right corner.\n2. Change the Connection type to "Bard Browser session"\n3. Sign in to your personal Google Account.\n\n### Troubleshooting\n\n- If you received an â€œOopsâ€¦ Google Bard is not available in your region.â€ notification, you need to install some VPN service that allows you to set a country from [this list.](https://support.google.com/bard/answer/13575153?hl=en)\n\n- For example, Bard works after connecting to US VPN in [Browsec VPN](https://chrome.google.com/webstore/detail/browsec-vpn-free-vpn-for/omghfjlpggmjjaagoclmmobgdodcjboh)'},{condition:"{{question}} = privacy",type:"say",message:"## Privacy\n\nHARPA is privacy centered. It never sends web page content anywhere, except the AI service you are connected to. You can find more info on [privacy](https://harpa.ai/privacy) and [terms of service](https://harpa.ai/terms) on our website.\n\n## Known Limitations\n\n- HARPA AI is not available on mobile devices or Firefox. Mobile version and Firefox versions are coming after all major features are implemented.\n- HARPA AI does not (yet) support file uploads. This feature is under development.\n- HARPA AI does not (yet) read text from GoogleDocs and GoogleSheets. This feature is planned."},{condition:"{{question}} = contact-us",type:"say",message:"## Contact Us\n\nReport bugs and feature requests via email at support@harpa.ai or join our [Discord](https://discord.com/invite/HJzggAVJbH) and get help!"},{type:"jump",to:"ask-for-question"}]},{meta:{name:"parameters",title:"Echo parameters",category:"Control",description:"Echo available prompt parameters."},steps:[{say:"HARPA AI supports parameters that can be used to customize your prompts. Include parameters into your prompts, by putting them in double brackets like this: `{{\\page.url}}`\n- **page.url**: {{page.url}}\n- **page.domain**: {{page.domain}}\n- **page.desc**: {{page.desc}}\n- **language**: {{language}}\n\nFollowing parameters are calculated dynamically once prompt is sent:\n- **page**: page content\n- **context**: page content relevant to prompt\n- **youtube.transcript**: transcript of the opened youtube video\n- **gpt**: the last answer generated by GPT\n\nFollowing parameters are persisted in a chat & global app storages. Use `ask` step in a custom command to modify them, e.g. `{{\\global.username}}`\n- **chat**: `{{chat}}`\n- **global**: `{{global}}`\n\nFeel free to suggest more parameters, by emailing contact@harpa.ai"}]},{meta:{name:"continue",title:"Continue",category:"Control",description:"GPT models is limited to 4096 tokens across prompt and output. Ask GPT to continue writing if possible."},steps:[{gpt:"Please continue writing, you did not finish."}]},{meta:{name:"clear",title:"Clear",category:"Control",description:"Clean up and restart the AI dialog.",emoji:"ðŸ§½"},steps:[{type:"clear"}]},{meta:{name:"extract-seo-keywords",title:"Extract and research SEO keywords",category:"Marketing & SEO",description:"Extract keywords from competitor's article, perform keyword research. Find keyword density and LSI keywords."},steps:[{say:"Please paste the competitor's article content (up to 3000 symbols), or press enter to extract keywords from the opened web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}} and output a single table. Pretend to be a SEO keyword research expert.\nRead the following text:\n{{page}}\nEnd of text.\nOutput a table with three columns: keyword, density %, LSI keywords.\nFind top 12 main keywords in that text, each containing at least 2 words. Output these in the first column of the resulting table.\nGive me a keyword density in the second column of the resulting table.\nNext I want you to come up with a list of LSI keywords and synonyms of those main keywords used in the article. Output a plain list of 5 keywords separated by comma in the third column called LSI keywords.\nTable:"}]},{meta:{name:"keyword-report",title:"Keyword report",category:"Marketing & SEO",description:"Create a keyword report and SEO content plan from 1 keyword."},steps:[{say:"Your keyword:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a market research expert. Pretend that you have the most accurate and detailed information about keywords available.\nPretend that you are able to develop a full SEO content plan. I will give you the target keyword (or topic): {{input}}.\nFrom this keyword create a table with a keyword list for an SEO content strategy plan on the keyword topic. The table shall have the following columns: keyword, search intent, title, meta description.\nIn the first column list 10 long-tail keywords or subcategory keywords related to the target keyword or topic.\nIn the second column list human searcher intent for the keyword. Label the topic in one of three search intent groups based on their search intent: whether commercial, transactional or informational.\nIn the third column, write a simple but very click-enticing title to use for a post about that keyword.\nIn the fourth column write an attractive meta description that has the chance for a high click-thru-rate for the topic with 120 to a maximum of 155 words. The meta description shall be value based, so mention value of the article and have a simple call to action to cause the searcher to click.\nDo not use too generic keyword like `introduction` or `conclusion` or `tl:dr`. Focus on the most specific keywords only. Do not use quotes or any other enclosing characters in any of the columns.\nHere is the keyword again: {{input}}\nTable:"}]},{meta:{name:"keyword-strategy",title:"Keyword strategy generator",category:"Marketing & SEO",description:"Provides a detailed strategy for any SEO keyword."},steps:[{say:"Please enter a keyword:\n"},{ask:"input"},{gpt:'Please ignore all previous instructions.\nYour task is to generate keyword strategy from one keyword in {{language}}.\nPretend youâ€™re the absolute best keyword researcher in the world. You use strategies from Neil Patel, Brian Dean, Rand Fishkin, Sandy Rowley and even Matt Cutts himself. You pride yourself in the depth of your research and your content briefs. Youâ€™ve been tasked with a comprehensive content plan that consists of keyword research for the keyword "{{input}}" and are assigned the following tasks:\n- Set the title to the primary Keyword.\n- Using an unordered list, find a comprehensive list of FAQs related to the primary keyword and put them in a list with a heading 2 "FAQs".\n- Using an unordered list, list related search queries related to the primary keyword and put them in a list with a heading 2 "Related Queries".\n- Using an unordered list, list long-tail that you believe are easy to rank for based on the top positions not having quality content based on the most recent publicly available Googleâ€™s Quality Guidelines and their on-page SEO Efforts and put them in a list with a heading 2 "Long Tail Keywords"\n- Using an unordered list, find the top 25 keywords, NLP keywords and LSI keywords and put them in a structured markdown table where the first column is the keyword, the second column is whether itâ€™s a Keyword, NPL or LSI type, the next column is the keyword intent and the final column is how many times youâ€™d recommend using the keyword as an Integer. Make sure there are at least 25 target keywords. Put this under a heading 2 "Keywords".\n- Using averages, where higher position results in search engines have a higher weight, and lower positions have a lower weight, looking at the page slug (path), what should we use as our slug? Put this under a heading 2\n- Using an unordered list, list the SEO entities that apply to the primary keyword that could be used throughout the content and put them into a list under a heading 2 "Entities".\n- Write a 175 to 200-character CTR-focused meta description for this page using the data above, something that catches the attention and encourages a click. Put this under a heading 2 "Meta Description", donâ€™t add quotes around the content.\n- Write a 60 to 75-character meta title that uses the main keyword whilst trying to implement either click-bait or CTR-focused titles. Put this under a heading 2 "Meta Title", donâ€™t add quotes around the content.\n- Write a 200-250 character page excerpt thatâ€™ll be above the fold, includes the primary keyword, satisfying the search intent, yet encouraging the reader to read on for more information. Put this under a heading 2 "Page Excerpt", donâ€™t add quotes around the content.\n- Considering the latest publicly available Google Quality Guidelines, using an unordered list, list the top 3-5 URLs that have the best content under a heading 2 "References".\nYouâ€™re assigned this task with special notes to keep in mind the following:\n- Follow the most recent publicly available Google Quality Rater guidelines.\n- Google E-A-T guidelines need to be met.\n- The research needs to consider that the content is meant to be useful for the end reader, is easy to read, quickly answers the searcherâ€™s intent, and provides value immediately.'}]},{meta:{name:"segment-your-audience",title:"Segment your audience",category:"Marketing & SEO",description:"Break your audience into target-able groups with similar needs."},steps:[{say:'Name your marketing, product or business category in simple but precise language. e.g. "electronic music nightclubs":\n'},{ask:"input"},{gpt:'Please ignore all previous instructions. Please only respond using {{language}}.\nI want you to act as a market research expert that speaks and writes fluent {{language}}. Pretend that you know everything about every market.\nProduce up to ten audience segments for audiences in the following category: "{{input}}".\nEach segment should be defined by a deep underlying category-related need. Give each segment an emoji and a sassy title. Describe each segmentâ€™s category-related needs and give innovative ideas for specific initiatives they could do to better meet the needs of that segment.\nSegments:'}]},{meta:{name:"monthly-content-calendar",title:"Monthly content calendar",category:"Marketing & SEO",description:"Get a well organized 4-week content calendar that targets your primary keyword using transaction long-tail keyword & clickbait titles."},steps:[{say:"Insert the primary keyword(s) or topic(s) for the marketing calendar:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}.\nI'd like you to help me come up with a content schedule for my blog that has the best chance of helping me rank for long tail keywords that are specific to my keyword. I'll tell you my main target keyword(s) below.\nPlease target transaction style search terms only. Please come up with clickbait style titles for these blog posts. Please organize each blog post title in a nice looking table so that it looks like a calendar. Each week should have its own table.\nThe keyword(s) and/or topic(s) I'm targeting is: {{input}}\nCalendar:"}]},{meta:{name:"weekly-content-calendar",title:"Weekly content calendar",category:"Marketing & SEO",description:"Get a well organized 1 week content strategy and calendar that targets your primary keyword."},steps:[{say:"Insert the primary keyword(s) or topic(s) for the marketing calendar:\n"},{ask:"input"},{say:"I'm generating the content calendar. Please use `/continue` command if output terminates pre-emptively.\n"},{gpt:"Please ignore all previous instructions.\nI want you to help me optimize a blog for local SEO in {{language}} using organic content creation. Please act as if you are an SEO and Digital Ads Specialist to answer all my following requests.\nYour task is to create a list of 5 items, each item is a blog post idea for a day of the work-week.\nEvery item must contain 4 sub-items: - Post title (for that day of the week) - Summary - Outline - Image description\nBlog topic:\n{{input}}\nLists:"}]},{meta:{name:"outrank-article",title:"Outrank SEO article",category:"Marketing & SEO",description:"Outrank the competition with an in-depth, SEO-optimized article. Navigate to the web page with an article to outrank, then run this command."},steps:[{say:"Write a name of your product and shortly describe it, or leave empty to parse product description from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nI want you to act as a very proficient SEO and high end copy writer.\nI want you to pretend that you can write content so good in {{language}} that it can outrank other websites. I will give you a part of an article that we need to outrank in Google.\nThen I want you to write an article in a formal 'we form' that helps me outrank the article I gave you. Write a long, fully markdown formatted article in {{language}} that could rank on Google on the same keywords as that website.\nThe article should contain rich and comprehensive, very detailed paragraphs, with lots of details. The article must be follow the google E-A-T guidelines.\nAll output must be 100% human writing style and fix grammar errors like Grammarly.\nDo use useful subheadings with keyword-rich titles. Get to the point precisely and accurately.\nDo not write more than 3000 symbols. Do not repeat the same over again. Context:\n{{input}}\nArticle:"}]},{meta:{name:"topic-authority",title:"Topic authority",category:"Marketing & SEO",description:"Create a table with article ideas to help you build a topic authority."},steps:[{say:"What your main article is about or a search keyword:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nCreate a table that contains article ideas to build topic authority for the following keyword or topic:\n{{input}}\nThe table should contain six rows where the first row is the header with column names.\nThe other five rows should be ideas for the topics, related to the main topic or keyword, that should give me a boost by these supporting articles.\nThe columns should be:\n1. Title for the article with no more than 45 characters, 2. Description of the article with a maximum of 120 characters, 3. Suggestions of the top three strategically chosen keywords for the article, 4. Classification of the search intent using one word.\nPlease create such a table for me to help me build topic authority for my website and my main article.\nTable:"}]},{meta:{name:"seo-audit",title:"SEO Audit",category:"Marketing & SEO",description:"Audit and improve your content for E-E-A-T, generate H1 and Meta Title."},steps:[{say:"Enter your SEO article content or leave it blank to parse from the page."},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. Only reply in {{language}}.\nI want you to act as a {{language}} Google Quality Rater trained in auditing content for quality, relevance, truthfulness and accuracy.\nYou are familiar with the concepts of E-E-A-T (Expertise, Authoritativeness, Trustworthiness) and YMYL (Your Money or Your Life) when evaluating the content.\nYour task is to create a Page Quality (PQ) rating. Be very strict with your assessment. The second part of the audit should also be very detailed and provide actionable suggestions for improving the content further.\nGive tips on how to match search intent and user expectations better. Give tips on what the content is missing. Create a very detailed content audit.\nAt the end of your analysis, suggest a 50â€“60 character H1 and Title tag.\nHere is the web page content:\n{{input}}\nAudit result:"},{type:"ask",label:"ask-for-change",param:"change",options:[{label:"âœ… DONE",value:"no"},{label:"âš›ï¸ KW CLUSTER REPORT",value:"cluster"},{label:"âœ´ï¸ KW STRATEGY GENERATOR",value:"strategy"}]},{condition:"{{change}} = no",type:"stop"},{condition:"{{change}} = cluster",type:"command",name:"Keyword cluster"},{condition:"{{change}} = strategy",type:"command",name:"Keyword strategy generator"}]},{meta:{name:"keyword-cluster",title:"Keyword cluster",category:"Marketing & SEO",description:"Cluster a list of keywords based on their semantic relevance."},steps:[{say:"Paste a list of keywords. Leave empty to parse from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to create a keyword cluster report. Please extract keywords from the following text and give me back a short overview of cluster topics found in a numbered list:\n\nCluster topics overview:\n1. Topic 1, Description\n2. Topic 2, Description\n3. etc.\n\nThen please generate a markdown table, with the following 4 columns: Cluster, Keyword, Search Intent, Language.\nClassify each of the keywords by the search intent, whether commercial, transactional or informational. Then cluster the keywords into groups based on their semantic relevance.\n\n[Extract keywords from the following text]:\n{{input}}\n\n[Cluster topics and table]:"}]},{meta:{name:"6-months-seo-plan",title:"6 months SEO plan",category:"Marketing & SEO",description:"Create SEO strategies, competitive with the top websites in the given space."},steps:[{say:"Enter a list of keywords to rank by, leave empty to parse from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nI want you to act like a Senior SEO Strategist for a company, who manages a large team of seo specialist, that speaks and writes fluent {{language}}.\nI want you to pretend that you can create seo strategies that are competitive with the top websites in the given space, and always produces very good results especially rankings on Google.\nI will provide you with a list of keywords to work with.\nYour task is to create a comprehensive 6 months seo strategy, in a table show monthly focus areas, for example month 1, month 2, month 3... here are focus ares to include: technical seo, on-page seo including content creation and optimisation and off-page seo. Please provide a description of activities to be done, expectations and tools required.\nParse keyword list from the following text:\n{{input}}\nSEO plan:"}]},{meta:{name:"landing-page-structure",title:"Landing page structure",category:"Marketing & SEO",description:"Create a landing page structure with attention grabbing headlines about the given topic, product or service."},steps:[{say:"Enter your topic, product or service or leave empty to parse them from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nI want you to act as a proficient SEO and high end copy writer that speaks and writes fluent {{language}}.\nCreate a Landing Page Structure with an Attention Grabbing Headline and subheader about the product, service or topic described in the following text:\n{{input}}\nTry to grab the attention of the visitor and increase the Opt-ins or Sales-rate, provide text content for landing page sections. Display the Structure of the Landing Page using markdown syntax.\nLanding page structure:"}]},{meta:{name:"content-ideas-generator",title:"Content ideas generator",category:"Marketing & SEO",description:"Generate a list of content ideas for a business, product or service for a blog."},steps:[{say:"Enter product / service / business name and short description, or leave empty to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI will provide a product / service / business description or name and I want you to create a list of 25 content ideas in {{language}} that I can publish on the blog.\nInclude a mix of guides, tutorials, success stories, evergreen content, explainers, unpopular opinions, comparisons, and listicles. Categorize each of these ideas into these content types in a table format.\nBusiness / product / service description:\n{{input}}\nContent ideas:"}]},{meta:{name:"meta-description-from-text",title:"Meta description from text",category:"Marketing & SEO",description:"Generate a 20-words meta description from the given webpage text."},steps:[{say:"Write a name of your product and shortly describe it, or leave empty to parse product description from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in {{language}}.\nI want you to act as a proficient SEO and high end copy writer that speaks and writes fluent {{language}}.\nYour task is to summarize the product into a meta description, which must be under 160 characters long (~20 words maximum). The web page text to summarize is:\n{{input}}\nPlease generate 3 options of meta descriptions, format in a bullet point list:"}]},{meta:{name:"promotional-email-writer",title:"Promotional email writer",category:"Marketing & SEO",description:"Write marketing email that promotes any product or service."},steps:[{say:"Describe your product or service, leave empty to parse product description from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in {{language}}.\nI want you to act as a proficient SEO and high end copy writer that speaks and writes fluent {{language}}. Your task is to write the best marketing email promoting the product or service described in the following text:\n{{input}}\nPromotional email:"}]},{meta:{name:"abandoned-cart-email-series-generator",title:"Ð•mail notifications on items forgotten in cart",category:"Marketing & SEO",author:"Sof (https://donthaveasite.com)",description:"Generate a series of three abandoned cart emails for product, designed to engage the recipient and ultimately convert them into a paying customer."},steps:[{say:"Write a name of your product and shortly describe it, or leave empty to parse product description from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in {{language}}.\nGenerate a series of three abandoned cart emails for the product described below, designed to engage the recipient and ultimately convert them into a paying customer.\n1st email should be a friendly reminder about the item left in the recipient's cart. 2nd email should be more persuasive email that addresses any potential objections and highlights the unique value of the product. 3rd email should be a last chance offer, such as a limited-time discount or free shipping, along with a strong call to action.\nThe tone of the emails should be empathetic and customer-focused, and should reflect the brand's style.\nConsider including a sense of urgency in the final email, to incentivize the recipient to complete their purchase.\nProduct description: {{input}}\nEmails:"}]},{meta:{name:"influencer-outreach-dm",title:"Influencer outreach DM",category:"Marketing & SEO",description:"Write cold outreach DMs to help you sign influencer campaigns.",apps:"Instagram, Facebook, Twitter"},steps:[{say:"Influencer Name and BIO. Leave blank to parse from the page:\n"},{ask:"influencer",default:"{{page}}"},{say:"You collaboration idea (if any):\n"},{ask:"idea",default:"Please come up with collaboration idea on your own"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as marketing specialist and a Virtual Assistant.\nYour task is to write a cold outreach DM (Direct Message) to an influencer, asking him/her to collaborate with me. Write a DM as if from my point of view.\nTry to write a personalized copy, use real Influencer name if available. Add a human touch and something related to the Influencer so that the DM does not sound generic.\nDo not write long DMs, be concise and to the point. Collaboration idea is: {{idea}}\nPlease parse influencer information from the following text:\n{{influencer}}\nCold DM:"}]},{meta:{name:"product-description-writer",title:"SEO-friendly product description writer",category:"Marketing & SEO",description:"Write optimized product description based on a list of product features. For the best results provide as much info as possible and include SEO keywords.",apps:"Amazon, AliExpress, eBay, Walmart, Flipkart, Rakuten, Zalando, Shopify"},steps:[{say:"Your list of features, keywords, and anything you can say about the product. Leave blank to parse product information from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nI want you to act as a very proficient SEO and high-end eCommerce copy writer that speaks and writes fluently {{language}}. Write a 300 word product description in {{language}} based on the product details I give you. Also follow these guidelines: - Focus on benefits rather than features - Avoid sentences over 20 words - Avoid using passive voice - Include a call to action at the end\nHere are the product description / details:\n{{input}}\nProduct description:"}]},{meta:{name:"google-business-posts-writer",category:"Marketing & SEO",title:"Google Business posts writer",description:"Get SEO optimized Google Business Posts for your Google Business Profile."},steps:[{say:"Business / product name and description. You might add keywords you want to target:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}. Please pretend you are a local SEO expert that is perfectly fluent in {{language}}.\nYour task is to help me create 5 local SEO optimized Google Business Profile posts for the following business written in the first person.\nGoogle Business Profile post must be at least 5 sentences long to be good, and should end with a call to action. Each business post should use at least 7 keywords in a natural sounding way in different sentences. The posts should not mention discounts or new products.\nPlease put each of these posts in a nice looking table.\nMy business / product name and / or description:\n{{input}}\nGoogle Business Posts:"}]},{meta:{name:"social-media-content-ideas",category:"Marketing & SEO",title:"Social media content ideas",description:"Generate a list of 10 engaging post ideas that are tailored to the interests of your target audience, increase engagement and drive traffic.",apps:"Instagram, TikTok, Facebook, Twitter"},steps:[{say:'Enter a platform, type of content, topic and potential audience, for example "Instagram, Reels, Cat-loving owners, I\'m selling pet insurance and veterinary services":\n'},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to act as a social media marketing and content expert and generate a list of up to 10 unique and engaging post ideas for my case: {{input}}\nIt should be written in fluent {{language}}.\nThe ideas should be tailored to the interests of the target audience and include a mix of different types of content (text, image, and video content), whichever appropriate.\nThe posts should aim to increase engagement and drive website traffic. Please research the target audience demographics, such as age, gender, location, interests, and other characteristics that would help you to have a better understanding of the target audience, and create post ideas that would be more appealing to them."}]},{meta:{name:"hero-image-ideas",title:"Hero image ideas",category:"Marketing & SEO",description:"Create ideas of a hero image (banner) for your web page."},steps:[{say:"What the web page is about? Leave empty to parse the opened web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nI want you to generate at least 3 ideas for a hero image to be shown on a web page. I will give you a description of the web page or its' content. Please generate 3 banner ideas. Provide details of what should be shown on the image.\nPage brief summary or text content:\n{{input}}\nHero image ideas:\n"}]},{meta:{name:"silo-structure",category:"Marketing & SEO",title:"SILO website structure",description:"Create a SILO structure for a website from a list of keywords."},steps:[{say:"Enter a comma-separated list of keywords. Leave empty to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. You will respond using only {{language}}.\nYour task is to create a detailed SILO structure for a website.\nThe sections and categories should be organized in a hierarchical structure (list), with the Home page at the top and the more specific pages at the bottom. Use the knowledge of how to make the best structure in terms of linking and SEO to get to the top positions in Google.\nPlease parse keywords for the website from the following text:\n{{input}}\nSILO structure:"}]},{meta:{name:"content-analyzer",title:"Content analyzer",category:"Marketing & SEO",description:"Evaluate and audit an article text content in order to understand if it answers the user search intent."},steps:[{say:"Copy and paste your article text here, leave empty to parse from the web page:\n"},{ask:"input",default:"{{page}}"},{say:"User search query, search intent or keywords:\n"},{ask:"search"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}. Pretend to be a SEO keyword research expert and an expert copywriter.\n1. On a scale of 0 to 10, how relevant is the following content for the query I'm trying to rank on Google? And how can I improve it?\n2. Evaluate if I'm clearly demonstrating that I have expertise in the topic I'm writing about? And how can I improve authoritativeness around this topic?\nMy web page content:\n{{input}}\nUser search query, search intent or keywords:\n{{search}}\nAnalysis:"}]},{meta:{name:"domain-name-generator",title:"Domain name generator",category:"Marketing & SEO",description:"Generate 50 domain name ideas for your niche."},steps:[{say:"Enter your niche, product / service / business description, or leave empty to parse from page:\n"},{ask:"description",default:"{{page}}"},{say:'Comma-separated list of preferred top-level domains, e.g. "com, ai, io", leave empty for "com":\n'},{ask:"zones",default:".com"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nGenerate 50 domain name ideas for the given topic, niche or product / business / service description which have some search volume.\nTry to come up with domain names that are available and not already used by other companies.\nPreferred top-level domain zones:\n{{zones}}\nTopic / nice / product / business / service description:\n{{description}}\nDomain names list:"}]},{meta:{name:"digital-strategy-generator",title:"Digital strategy generator",category:"Marketing & SEO",description:"Generate high level Digital Strategy for the given topic, service, product or business. Get a list of channels, actions and KPIs."},steps:[{say:"Product, service, company or brand description. Leave blank to parse from the web page:\n"},{ask:"product",default:"{{page}}"},{say:"Audience. Leave blank to deduce the audience automatically\n"},{ask:"audience",default:"Please assume or deduce automatically from the description given above.\n"},{gpt:"I want you to act as a market research and digital marketing expert that speaks and writes fluent {{language}}. Pretend that you know everything about digital strategy and digital channels.\nI will give you a product / company / service / brand description or a relevant web page content.\nYour task is to create a table of the 8 main, innovative or disruptive digital marketing channels (with one unique emoji to describe each channel in the first column) I should consider to help my brand engage my target audience and increase customer acquisition.\nPlease include a column with the main actions to be conducted and another column for the KPIs for each action.\nOrganize each channel starting with the one that you think will be the most important for my brand and end with the one that will be least important. Do not self reference.\nProduct / company / service / brand description, or a web page content to parse from:\n{{product}}\nTarget audience:\n{{audience}}\nChannels:"}]},{meta:{name:"promotional-comment-writer",title:"Promotional comment writer",category:"Marketing & SEO",description:"Write a helpful comment or reply to the given text, which promotes your product, business or service."},steps:[{say:"Your service (or product) name and short description, for example: - HARPA.AI, https://harpa.ai, GPT on any Website with HARPA.AI:\n"},{ask:"service"},{say:"Text of a message to reply to. Leave empty to parse from the page context:\n"},{ask:"article",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to pretend to be a human, assisting users asking questions online.\nI give you two pieces of information:\n1. A short description of my product, service or business (SERVICE) which might also have a URL link.\n2. A web page content which contains user's post, DM, message or question.\nYour task is to parse the user's question, then write a helpful reply or comment to the user's message, post or question in a way that it promotes by SERVICE.\nThe comment should sound human-like and be indeed helpful. Do not oversell or be too aggressive promoting my SERVICE.\nSERVICE:\n{{service}}\nWEB PAGE CONTENT CONTAINING DM, MESSAGE OR POST:\n{{article}}\nComment or reply:\n"}]},{meta:{name:"sales-pitch-writer",category:"Marketing & SEO",title:"Sales pitch writer",description:"Write enticing, personable and humorous sales pitches and emails."},steps:[{say:"Product name, description, price, benefits, etc. Leave blank to parse from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:'Ignore all previous instructions. Only answer in {{language}}.\nUsing the context of Tim Cook\'s (he is the CEO of Apple Inc.) presentation style, tone, and speech patterns, compose a sales pitch about a new product I will tell you about.\nThe sales pitch must be between 750 and 1000 words, easily understood by the general population of the United States of America, and the language should be presented around a 7th grade reading level.\nThe new product\'s information will be provided below. Make sure to use clear and concise sentences, and use a mix of technical jargon and layman\'s terms to explain the product I will tell you about. Avoid using the entire name of the product in your sentences so that you speak more smoothly and simply.\nAlso, include in your sales pitch a sense of sarcastic and dry humor that sounds similar to the actor Ryan Reynolds, but do not use any curse words or profanity.\nDo not echo my instructions and do not mentioned the names of Tim Cook or Ryan Reynolds. Do not use the phrase "Ladies and Gentlemen" in your introduction.\nAfter all this come up with an eye-catching email subject line (labeled with heading "Possible Email Subject Line") that could possibly be used in tandem with this sales pitch.\nThe product and its information is:\n{{input}}\nSales pitch:'}]},{meta:{name:"image-briefs-for-seo-blog-article",title:"Image briefs for SEO blog articles",category:"Marketing & SEO",description:"Find places in an article or web page to put images. Returns what the picture should be."},steps:[{say:"Paste the whole article here. Leave empty to parse the web page. Up to 3000 symbols:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in the language {{language}}.\nI want you to act as a very proficient SEO and high end copywriter that speaks and writes fluent {{language}}. Your task is to find all places to put images for a graphic designer in the given text it should say exactly what the picture should be of and the words it should have in it.\nThe pictures should explain and make the article and the words more visual and easier to understand. I want you output in a format that can be send directly to the graphic designer.\nBelow is the article:\n{{input}}\nPlaces for images and descriptions:"}]},{meta:{name:"instagram-post-caption-generator",title:"Instagram post caption generator",category:"Marketing & SEO",description:"Create 3 Instagram post captions along with hashtags.",apps:"Instagram"},steps:[{say:"What your Instagram post is about, topic, idea, some information:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}. Pretend to be an SMM, content writer and my Virtual Assistant for Instagram. I will give you a post topic or idea and your goal is to suggest me a few post captions for that post. Captions should contain at least a few paragraphs of text.\nCreate 3 engaging Instagram post captions. Each caption should contain at least 100-150 words about the topic or post idea given below. You can add and imagine details if necessary to make the caption longer. Captions should not contain any hashtags. Do not put Captions into quotes.\nAfter the third caption, please provide a list of 30 hashtags written in a single line separated with a space character. 80% of hashtags should be long-tail and 20% should be high-volume hashtags. Do not include any @mentions.\nInstagram post topic or idea:\n{{input}}\nPost captions and a list of hashtags:"}]},{meta:{name:"instagram-hashtag-generator",title:"Instagram hashtag generator",category:"Marketing & SEO",description:"Create up to 30 Instagram Hashtags.",apps:"Instagram"},steps:[{say:"What your Instagram post is about:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}.\nCreate 30 Instagram trending hashtags targeting an LSI keyword with some search volume for the following Instagram post topic or content: {{input}}. Separate keywords by space. Only capitalize proper nouns. Output in a single line.\nHashtags:"}]},{meta:{name:"instagram-ads-hook-generator",category:"Marketing & SEO",title:"Instagram ads hook generator",description:"Generate ad hooks / angles for anything you're promoting with Instagram Ads.",apps:"Instagram"},steps:[{say:"What business, product, brand or service are you promoting? Leave empty to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI'm trying to come up with ideas for different hooks to promote something on an Instagram Ad.\nFor example: If I'm trying to promote a hammer, I might have these 3 hooks... - Hook #1: The best way to put a nail into your wall - Hook #2: The best tool for hanging your paintings. - Hook #3: The perfect tool to make your house beautiful. - Hook #4: The most trusted tool by professionals around the world.\nAnother example: if I'm trying to promote a lead magnet about \"client acquisition\", I might have these 3 hooks...\n- Hook #1: Keep yourself booked solid. - Hook #2: No more feast or famine months. - Hook #3: Stop waiting around for clients to find you.\nEach hook should be one sentence and should be a different reason someone may want to click on my ad. Each idea needs to use copywriting and persuasion best practices to draw users to take action.\nI need you to create a list of 10 potential hooks about the following:\n{{input}}\nHooks:"}]},{meta:{name:"instagram-post-ideas-generator",title:"Instagram post ideas generator",category:"Marketing & SEO",description:"Create 10 Instagram reels ideas for the given topic.",apps:"Instagram"},steps:[{say:"What your Instagram profile is about? Leave empty to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}. Pretend to be an SMM, content writer and my Virtual Assistant for Instagram. I will explain you what my Instagram account is about and your goal is to create a post calendar for the next 2 weeks, with ideas for posts, stories and reels.\nEvery item must contain 4 sub-items: - Post summary (for that day of the week) - Post type (story, post, carousel, reels etc.) - Image / Video description\nPlease parse the Instagram profile topic or idea from the following text:\n{{input}}\nPosts, formatted in a markdown table:"}]},{meta:{name:"tiktok-hashtag-generator",title:"TikTok hashtag generator",category:"Marketing & SEO",description:"Create up to 30 TikTok Hashtags.",apps:"TikTok"},steps:[{say:"Write a TikTok topic:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}.\nCreate 30 Tiktok trending hashtags targeting an LSI keyword with some search volume for the following topic: {{input}}. Separate keywords by space. Only capitalize proper nouns. Output in a single line.\nHashtags:"}]},{meta:{name:"youtube-audience-analyzer",category:"Marketing & SEO",title:"YouTube audience analyzer",description:"Read transcript of a YouTube video and analyze its target audience.",apps:"YouTube"},steps:[{gpt:"I will provide you with a transcript of a YouTube video. Your task is to analyze the target audience of the video. I want you to answer in {{language}} only.\nPlease provide a description of the target audience in a single paragraph.\nThen list relevant topics of interest of the audience audience. Format relevant topics in a bullet-point markdown list. Video transcript:\nAfter that provide a list of keywords for video content that might interest the target audience.\nVideo transcript:\n{{youtube.transcript}}\nAnalysis:"}]},{meta:{name:"youtube-description-generator",title:"YouTube description generator",category:"Marketing & SEO",description:"Generate title, description and hashtags for a youtube video idea.",apps:"YouTube"},steps:[{say:"Enter YouTube video idea or keywords. Leave empty to parse idea from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to answer in {{language}} only.\nI want you to act as a very proficient Professional YouTube SEO Expert and a high end video SEO optimizer who is fluent in {{language}} speaking and writing.\nYour task is to write video title, video description and hashtags for a YouTube video idea. Please write SEO-optimized title, description and hashtags so that the video has high change of ranking on YouTube video search for the relevant keywords. When writing a description, follow these guidelines:\n- Include keywords that are related to the video idea to help YouTube understand the topic of your video and improve its ranking in search results.\n- Make it descriptive and informative: The description should provide a brief overview of the video and what the viewer can expect to learn or see. Be sure to include key takeaways and any relevant information that will pique the viewer's interest.\n- Use short and concise sentences: Keep the description short and to the point, using simple language that is easy to understand.\n- Include a call-to-action (CTA): Encourage viewers to like, comment, and subscribe to your channel by including a clear CTA at the end of the description.\n- Optimize for readability: Use proper grammar, spacing, and punctuation to make the description easy to read and understand.\nYouTube video hashtags should be separated by commas.\nPlease parse video idea from the following text:\n{{input}}\nVideo title, description and hashtags:"}]},{meta:{name:"youtube-hashtag-generator",title:"YouTube hashtag generator",category:"Marketing & SEO",description:"Create up to 30 YouTube Hashtags.",apps:"YouTube"},steps:[{say:"Give me your YouTube title name:\n"},{ask:"input"},{gpt:'Please ignore all previous instructions. I want you to respond only in language {{language}}.\nCreate 30 YouTube trending hashtags targeting an LSI keyword to rank top on YouTube high search volume for the following YouTube video topic or title: "{{input}}". Separate keywords by space. Only capitalize proper nouns. Output in a single line.\nHashtags:'}]},{meta:{name:"youtube-polls-generator",category:"Marketing & SEO",title:"YouTube polls generator",description:"Create an attention-grabbing YouTube poll for a video channel.",apps:"YouTube"},steps:[{say:"What you YouTube video channel is about? Leave empty to parse from the web page (navigate to YouTube about page for best results):\n"},{ask:"input",default:"{{page}}"},{say:'Tip: you can ask me to generate more ideas by typing "More ideas".\n'},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}\nI'd like you to take on the role of a YouTube video content creator. Your task is to generate YouTube Poll ideas based on my channel description.\n1. Poll question must be clear and concise: Make sure the question is straightforward and easy to understand.\n2. Keep it simple: too many choices can lead to confusion and a less accurate result.\n3. The optimal length is about 80 characters, ~5 poll options.\n4. Include emojis in the poll and the options if appropriate.\n5. Consider that the pollâ€™s question should be more engaging. Think about how likely channel viewers are to engage with the poll and answer the question.\nFormat poll options in a bullet point list.\nPlease parse my channel description from the following text:\n{{input}}\nPoll idea:"}]},{meta:{name:"facebook-ads-hook-generator",category:"Marketing & SEO",title:"Facebook ads hook generator",description:"Generate ad hooks / angles for anything you're promoting with Facebook Ads.",apps:"Facebook"},steps:[{say:"What business, product, brand or service are you promoting? Leave empty to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI'm trying to come up with ideas for different hooks to promote something on a Facebook Ad.\nFor example: If I'm trying to promote a hammer, I might have these 3 hooks... - Hook #1: The best way to put a nail into your wall - Hook #2: The best tool for hanging your paintings. - Hook #3: The perfect tool to make your house beautiful. - Hook #4: The most trusted tool by professionals around the world.\nAnother example: if I'm trying to promote a lead magnet about \"client acquisition\", I might have these 3 hooks...\n- Hook #1: Keep yourself booked solid. - Hook #2: No more feast or famine months. - Hook #3: Stop waiting around for clients to find you.\nEach hook should be one sentence and should be a different reason someone may want to click on my ad. Each idea needs to use copywriting and persuasion best practices to draw users to take action.\nI need you to create a list of 10 potential hooks about the following:\n{{input}}\nHooks:"}]},{meta:{name:"facebook-ads-generator",title:"Facebook ads generator",category:"Marketing & SEO",description:"Generate a custom Facebook ad to boost conversions and revenue of your product or service.",apps:"Facebook"},steps:[{say:"Describe the product and its benefits, explain the goals of your marketing campaign. Leave blank to parse product description from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. Please only respond in {{language}}.\nI want you to act as a professional copywriter with experience in writing high-converting Facebook ads. I want you to write an Ad copy. The ad copy should be between 100-150 words long.\nI want you to write a Facebook ad copy for a product / service that I will describe below. Use the following guidelines:\n- Create a compelling headline that grabs attention and highlights the main benefit of the product/service - Use clear and concise language in the body copy that focuses on the benefits of the product / service and addresses any potential user objections - Include a strong call to action that encourages users to take the desired action - Use an image or video that visually demonstrates the product / service and resonates with the target audience - Research the target audience demographics, such as age, gender, location, interests, and other characteristics that would help you to have a better understanding of the target audience, and create an ad that would be more appealing to them.\nProduct / service description:\n{{input}}\nFacebook Ad copy:\n"}]},{meta:{name:"facebook-hashtag-generator",title:"Facebook hashtag generator",category:"Marketing & SEO",description:"Create up to 30 Facebook Hashtags.",apps:"Facebook"},steps:[{say:"What your Facebook post is about:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}.\nCreate 30 Facebook trending hashtags targeting an LSI keyword with some search volume for the following Facebook post topic or content: {{input}}. Separate keywords by space. Only capitalize proper nouns. Output in a single line.\nHashtags:"}]},{meta:{name:"linkedin-hashtag-generator",title:"LinkedIn hashtag generator",category:"Marketing & SEO",description:"Create up to 30 LinkedIn Hashtags.",apps:"LinkedIn"},steps:[{say:"What your LinkedIn post is about:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}.\nCreate 30 LinkedIn trending hashtags targeting an LSI keyword with some search volume for the following LinkedIn post topic or content: {{input}}. Separate keywords by space. Only capitalize proper nouns. Output in a single line.\nHashtags:"}]},{meta:{name:"twitter-hashtag-generator",title:"Twitter hashtag generator",category:"Marketing & SEO",description:"Create up to 30 Twitter Hashtags.",apps:"Twitter"},steps:[{say:"What your tweet is about:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in language {{language}}.\nCreate 30 Twitter trending hashtags targeting an LSI keyword with some search volume for the following Twitter post topic or content: {{input}}. Separate keywords by space. Only capitalize proper nouns. Output in a single line.\nHashtags:"}]},{meta:{name:"pinterest-pin-description",title:"Pinterest pin description",category:"Marketing & SEO",description:"Create description for a Pinterest pin from title or topic.",apps:"Pinterest"},steps:[{say:"Enter Pin topic, title or leave empty to parse from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to reply in {{language}} only.\nI want you to think that you are a very competent SEO and high-end copywriter who speaks and writes {{language}} fluently.\nI want you to write an article on the following topic:\n{{input}}\nPlease write from the first person perspective and address the reader as you. Write an article no longer than 500 characters that I can use for a pin on Pinterest. Do not self reference or mention that you are a SEO expert.\nUse key words from the topic. Don't use lists or headings, but use paragraphs. Don't go into details, summarize the topic as best as you can, as if you were writing a summary for a blog post. Be precise and to the point.\nPin description:"}]},{meta:{name:"article-outline",title:"Article outline markdown",category:"Copywriting",description:"Generate a content outline for your article. Use in combination with Article Section command to generate every part of the article."},steps:[{say:"What the article should be about:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to act as a very proficient SEO and high end copy writer that speaks and writes fluent {{language}}.\nYour task is to write a high-quality info content outline for the article description given below.\nThe article should include a creative title and SEO meta description. The article can have bullet points or numbered list (if needed), FAQs (if needed) and conclusion (if needed).\nAll output must be 100% human writing style and free of grammar errors. Do not use generic filler phrases. Do use useful subheadings with keyword-rich titles. Do not repeat the same content over again.\nYour output must contain a single markdown code block and the article outline should be within that block.\nArticle should be about: {{input}}\nArticle outline in a markdown code block:"}]},{meta:{name:"article-outline-mece",category:"Copywriting",title:"Article outline MECE",description:"Generate a content outline for your article following MECE Framework. Use in combination with Article Section command to generate every part of the article."},steps:[{say:"What the article should be about:\n"},{ask:"input"},{gpt:'Please ignore all previous instructions. Using the MECE framework, please create a detailed long-form content outline for our {{language}} writers on the topic: "{{input}}". Also, provide a short and attention-grabbing title for the article and an estimate of the word count for each subheading. Include a list of semantically similar FAQs using the vector representation technique. Generate the output in markdown format. Please don\'t write the article, only the outline for writers. Outline:'}]},{meta:{name:"article-section",title:"Article section",category:"Copywriting",description:"Generate an article section content. Use in combination with Article Outline command: first generate an article outline and then every sections one by one."},steps:[{say:"Please copy-paste below a single section of the article outline. You can generate an article outline using Article Outline command.\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to act as a very proficient SEO and high end copy writer that speaks and writes fluent {{language}}.\nYour task is to write a high-quality article section content for the article section description given below.\nThe article section can have bullet points or numbered list (if needed). All output must be 100% human writing style and free of grammar errors.\nDo not use generic filler phrases. Do use useful subheadings with keyword -rich titles. Do not repeat the same content over again.\nArticle section outline:\n{{input}}\nArticle section content:"}]},{meta:{name:"blog-post-writer",title:"Blog post from topic",category:"Copywriting",description:"Create a capacious blog post from the given topic."},steps:[{say:"Enter topic:\n"},{ask:"input"},{say:"Ok, I will write a blog post now. Use `/continue` command if my response does not fit ~4096 tokens and is cut off. Or create a blog outline first and then ask me to write each section separately.\n"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nCreate a detailed content brief for the following topic: {{input}}\nInclude top level keywords, long-tail keywords, a header outline and notes for the topic. Then write suggested title tags and meta descriptions, keeping them within the respective character limits of 70 and 160. After that, write some text underneath each sub header. Then expand on each of the numbered bullet points with a short and sharp explanation of how to do / implement each step. Put all this content into a structured blog post in language {{language}}.\nBlog post:"}]},{meta:{name:"video-script-writer",title:"Video script writer",category:"Copywriting",description:"Write a script for a video idea or topic. Best for YouTube, Instagram & TikTok.",apps:"YouTube, Instagram, TikTok"},steps:[{say:'Your video idea, title or topic, e.g. "How to protect yourself from zombies":\n'},{ask:"idea",default:"How to protect yourself from zombies"},{say:"Target platform (YouTube, Instagram, TikTok etc.). Press Enter to pick YouTube.\n"},{ask:"platform",default:"YouTube"},{say:'Enter a preferred video duration in minutes and seconds, e.g. 2:10s. Press enter for "Unspecified":\n'},{ask:"duration",default:"unspecified"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nYou act as a very proficient SEO and high-end copy writer that speaks and writes fluently in {{language}}. Your task is to write me a content for a video script for {{platform}} platform.\nFormat in a bullet-point list, add approximate timestamp for every block or paragraph. Format timestamps in bold using markdown.\nBefore the script please also provide 3 alternative appropriate clickbait titles.\nMy video idea, video title or topic is:\n{{idea}}\nPreferred video duration is {{duration}}\nTitles and the script:\n"}]},{meta:{name:"customer-reviews-writer",title:"Customer reviews writer",category:"Copywriting",description:"Create customer reviews and testimonials for your company product, business or service.",apps:"Amazon, AliExpress, eBay, Walmart, Flipkart, Rakuten, Zalando, Shopify"},steps:[{say:"Describe your product, service or business. Include business name. Or leave empty to parse information from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nPretend to be a custom of the product, service or business described below. Write 3 human-like reviews / feedbacks / testimonials from the customer point of view.\nPlease add fake customer names and companies that do not exist but sound very plausible (i.e. not some ABC Consulting or XYZ Inc.) and are likely to use the product. Do not put reviews into quotes.\nBusiness / product / services description:\n{{input}}\nTestimonials and reviews:"}]},{meta:{name:"customer-review-responses-writer",title:"Customer review responses writer",category:"Copywriting",description:"Get friendly responses to a list of customer reviews, which you can use on Google, Yelp, etc. Organizes your responses nicely in a table so you can copy and paste them easily.",apps:"Amazon, AliExpress, eBay, Walmart, Flipkart, Rakuten, Zalando, Shopify"},steps:[{say:"Paste your reviews here. Each one should be in brackets, such as [review1] [review2] [review3]:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nYour task is to help me respond to many online customer reviews in {{language}}. Each review will be separated by brackets.\nPlease pretend you are a very nice and grateful person that speaks and writes in casual perfect {{language}}. Please give me a response for each review in the prompt. Please organize the responses in a table and put the review next to each response so I can see them next to each other.\nThe customer reviews to help me with are:\n{{input}}\nResponses table:"}]},{meta:{name:"quora-answer-writer",title:"Quora answer writer",category:"Copywriting",description:"Write a personalized Quora answer to any question.",apps:"Quora"},steps:[{say:"Paste quora question, or leave empty to parse question from the context:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nParse a Quora Question from the following text. Pretend to be an expert on the subject. Write 2 paragraphs of 300 words long answer. Be informal and greet the author. Personalize the comment to sound as if you are talking to the author, make the answer sound as humanly as possible.\nText to parse the Quora Question from:\n{{input}}\nAnswer:"}]},{meta:{name:"sequential-text-improvements",title:"Sequential text improvements",category:"Copywriting",description:"Creates a table with a list of 10 improvements for you to pick from. Keeps track of changes already made and shows you an updated table after each pick from the list."},steps:[{say:"Copy and paste the text to improve:\n"},{ask:"input"},{say:"Ok, let me generate the suggestions..."},{gpt:'Please ignore all previous instructions.\nI would like to write a markdown table of 10 different suggestions of improvements that could be applied to the text: - the first column has the improvement description - the second column has the suggestion number (1..10) for me to pick - the third column has a Y/N flag if the change was implemented or not (N by default)\nAfter you output the table, I will tell you the changes to be made.\n[THE SOURCE TEXT]:\n{{input}}\nTable of improvements with columns "Suggestion", "No", "Applied":'},{say:"Please pick the changes to make. You can make several changes at the same time, for instance 1,2,5,9 will change those 4 options at once. Press ESC at any time to stop the command.\n",label:"repeat"},{ask:"changes"},{gpt:"Please integrate the changes to the text, then show the updated text and the updated table of changes. Keep a log of all the changes made in the third column.\n[CHANGES TO MAKE / OR MY COMMAND]: {{changes}}\nUpdated text and the table:"},{jump:"repeat"}]},{meta:{name:"buying-guide-writer",title:"Buying guide writer",category:"Copywriting",description:"Create a product buying guide."},steps:[{say:'Product name or topic e.g. "gaming PC", leave empty to parse product description from the web page:\n'},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nWrite a detailed buying guide step by step for the mentioned below product description or topic. Be informative and use various sentences. Sentence length should be short with enough transition words. Write in 3rd person.\nProduct description or topic: {{input}}\nBuying guide:"}]},{meta:{name:"long-article-writer",title:"Long-form article writer",category:"Copywriting",description:"Generate a plagiarism free content for your blog."},steps:[{say:"Enter article title:\n"},{ask:"title"},{say:"Enter any additional instruction about the article, leave empty for default:\n"},{ask:"instructions",default:'Write an article in a formal "we" form. The article should contain rich and comprehensive, very detailed paragraphs. Do not use generic filler phrases. Get to the point precisely and accurately.\nDouble-check for plagiarism. I need a pure unique content, write the content in a conversational style as if it were written by a human.\nArticle should be ~1800 words long.\n'},{gpt:'Please ignore all previous instructions.\nI want you to act as a Content Writer and a very proficient SEO that writes fluently in {{language}}.\nWrite an SEO-optimized Long Form article. Please style article with markdown and use headings and sub headings, such as H1, H2, H3. The final paragraph should be a conclusion.\nI give you the Title "{{title}}" of an article that we need to outrank in Google.\n{{instructions}}\nArticle:'}]},{meta:{name:"clickbait-writer",title:"Clickbait writer",category:"Copywriting",description:"Generate 20 catchy and high-converting clickbaits."},steps:[{say:"Enter your topic here. Leave empty to generate clickbaits for people to visit the current web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in {{language}}.\nI want you to act as a highly skilled marketer and top-tier copywriter who is fluent in {{language}}. I want you to pretend that you are an expert at writing all types of CTAs.\nYour task is to come up with at least 20 catchy, human-written, suspenseful CTAs for a topic or web page I provide at the end. The best clickbaits usually:\n- Provoke or grab attention: This is often in the form of a question or a statement that creates a sense of curiosity or urgency.\n- Have a strong emotional hook: The headline should tap into the reader's emotions and make them feel invested in finding out more.\n- Relevant to the target audience: The headline should be relevant to the reader's interests or needs.\n- Have a sense of exclusivity: Clickbait headlines often suggest that the reader will get access to something special or privileged by clicking through.\n- Leave cliffhangers or contain lists such as \"5 ways to ...\".\nThe topic or web page content for the clickbaits is:\n{{input}}\nClickbaits:"}]},{meta:{name:"title-writer",title:"Title writer",category:"Copywriting",description:"Generate titles for a list of keywords or web page."},steps:[{say:"Your list of keywords separated by comma. Leave empty to generate titles for the current web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a fancy title generator. I will give you comma-separated keywords or an entire web page content and you will reply with 20 fancy titles.\nKeywords or web page content is:\n{{input}}\nTitles:"}]},{meta:{name:"product-description-writer-saas",title:"SaaS product description writer",category:"Copywriting",description:"Based on the product information create a click-enticing product name and description that encourage to buy online. Perfect for SaaS or online products and services."},steps:[{say:"Enter your product description / information / overview, leave empty to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a SEO and Conversion Rate Optimisation expert that speaks and writes fluent {{language}}. Pretend that you have the most accurate and most detailed information about a product explained below. Based on the product information given below create unique and very click-enticing product name and product description that encourage to buy online. Please generate 3 options of name and description for me, use bullet point list. Style with markdown.\nHere is product description / information:\n{{input}}\nProduct names and descriptions (x3):"}]},{meta:{name:"product-description-writer-e-commerce",title:"E-Commerce product description writer",category:"Copywriting",description:"Create a rich product description and title for your e-commerce product. Perfect for e-commerce products on Amazon, AliExpress, Jet.com etc.",apps:"Amazon, AliExpress, eBay, Walmart, Flipkart, Rakuten, Zalando, Shopify"},steps:[{say:"Enter your product description / information / overview, leave empty to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to pretend that you are an E-commerce SEO expert who writes compelling product descriptions for users looking to buy online.\nI am going to provide a description of the e-commerce product and your task is to come up with a minimum of three distinct content sections for the product description, each section about a unique subset of keywords relating to the product I provide you.\nMake sure that each of the unique content sections are labeled with an informative and eye-catching subheading describing the main focus of the content section.\nThe main point of these commands is for you to developing a new keyword-rich, informative, and captivating product summary / description that is less than 1000 words. The purpose of product description is marketing the products to users looking to buy. Use emotional words and creative reasons to show why a user should purchase the product I tell you.\nAfter you generate the new product summary, please generate a bullet point list of 5 possible H1 headings for a product page. Each H1 should be less than 7 words.\nPlease also include bulleted list of broad match keywords that were used to accomplish writing the product summary.\nPlease also write a persuasive and professional sounding Meta Title and Description that integrates similar language present in the new product summary text.\nPlease take product information from the following text:\n{{input}}\nProduct name, description, headings, keywords, meta title and description:"}]},{meta:{name:"faq-and-answers-writer",title:"FAQ & answers writer",category:"Copywriting",description:"Generate FAQ list with answers from the given product or service description."},steps:[{say:"Keywords, product or service description. Leave blank to parse from page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nYou are a SEO Expert and Copywriter. Your task is to write a FAQ about the given product, service or keywords.\nYou should come up with at least 5 questions and answers. Format in a bullet point list. Make sure every sentence is unique. Use a formal tone. Write approximately 750 words in total.\nParse keywords, product or service description from this text:\n{{input}}\nFAQ:"}]},{meta:{name:"song-lyrics-writer",title:"Song lyrics writer",category:"Copywriting",description:"Generate an high-quality song lyrics for your desired song title."},steps:[{say:"Song title:\n"},{ask:"title"},{say:"Song style or theme, e.g. Rap / Rock / Ballad / Country / Nursery Rhyme / R&B / Funny / Sad / Catchy / Christmas / Pop / Love etc\n"},{ask:"style"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI will give you a song title and you'll write me the best lyrics for it. You will use words that are catchy, and depend on what title is given.\nThe lyric should be long enough, longer than a 1-minute song. Please use the table marking down.\n- If the user chose Rap Song, then you might add some bad words. - If it's a nursery rhyme song, then write lyrics that kids will love to listen too.\nYou can use repeating lyrics too.\nIf the given title isn't really a believable title, then re-write it to a best title one corresponding to the generated song lyrics.\nPreferred song title is: {{title}}\nSong style / content is: {{style}}\nRefined song title and the song lyrics:"}]},{meta:{name:"inspirational-quotes",title:"Inspirational quotes",category:"Copywriting",description:"Input a problem area to get inspiring quotes for people struggling with that problem."},steps:[{say:'Frame a problem, for example "Why I struggle learning a foreign language?":\n'},{ask:"input",default:"Why do I struggle learning a foreign language?"},{gpt:'Please ignore all previous instructions. I want you to respond only in language {{language}}.\nGive me up to 50 short inspirational quotes about the following topic or problem:\n{{input}}\nMix the quotes up with metaphors, straight up advice, wrong ideas to avoid and encouragement start each quote with a different word.\nDon\'t self reference. Refrain from starting with "you" or "like". Avoid repetition and keep the quotes fresh and activating.\nName the author and where this quote comes from if it is known. If the author is not known - just do not specify anything, do not write "Unknown".\nQuotes:'}]},{meta:{name:"quiz-writer",title:"Quiz writer",category:"Copywriting",description:"Create the fun quiz for your company. Just give me a topic."},steps:[{say:"The subject of the quiz should be:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nI want you to respond only in {{language}}. I want you to create a pub quiz. Pretend that you are an expert and have the most accurate and most detailed information available about the given topic.\nHere is the topic: {{input}}.\nCreate a 4 round quiz on the topic, that has 3 questions per round. Each question must have a correct answer and three alternative incorrect ones. Each question must have the answers provided in random order, and the correct answer marked with [x]. Quiz:"}]},{meta:{name:"plagiarism-checker",title:"Plagiarism checker",category:"Copywriting",description:"Check given text for plagiarism."},steps:[{say:"Give me a full sentence or paragraph for a plagiarism check, e.g.\n> Midway upon the journey of our life\n  I found myself within a forest dark,\n  For the straightforward pathway had been lost.\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a plagiarism checker. I will give you a text or a sentence and you will echo parts (one sentence or multiple) of my text that contain plagiarism and also reference the source of the text (i.e. where it was copied from).\nUse bullet points for multiple plagiarisms.\nDo not write explanations on replies. My first prompt is:\n{{input}}\nPlagiarism check:"}]},{meta:{name:"find-resources-on-a-topic",title:"Find resources on a topic",category:"Learning",description:"Get a list of informative resources for any topic."},steps:[{say:"Please enter the topic of interest:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in {{language}}.\nWhat are the best resources for this topic and how can I utilize them properly? The topic is: {{input}}\nList of resources and related information:"}]},{meta:{name:"course-generator",title:"Course generator",category:"Learning",description:"Design a full project-based course based on the desired learning outcome with outline, lesson plans, objectives, activities, real world examples, video script, and project plan."},steps:[{say:'Enter what you would like to learn, e.g. "How to install VPN?":\n'},{ask:"input"},{say:"Ok, I will write a course now. Use `/continue` command if my response does not fit ~4096 tokens and is cut off.\n"},{gpt:"Please ignore all previous instructions. I want you only to respond in {{language}}. You are an expert course creator and curriculum designer. You use backwards design in your planning by starting with the outcome in mind and working backwards to create learning modules and activities that will guide students towards this outcome. All of your courses are project based. Create a course outline based on the desired outcome.\nPlease generate a learning course for the following topic: {{input}}. Be sure that is appropriate for all types of learners that speak {{language}}.\nInclude a project plan for a real world application of this course. This plan should be descriptive and outline what components should be included in the final project. Include no more than 6 modules in the course and for each module include the lesson plans with the learning objectives, real world examples, and activities with step-by-step directions that are connected to the final project. Also include discussion questions and ways to expand learning. Include an engaging video script for each lesson that explains how the lesson is connected to the project plan.\nCourse:"}]},{meta:{name:"unit-study-generator",title:"Unit study planner",category:"Learning",description:"Create a unit study and a strategy for learning the given topic."},steps:[{say:"Type a topic or subject:\n"},{ask:"input"},{say:"Ok, I will write a unit study now. Use `/continue` command if my response does not fit ~4000 tokens and is cut off.\n"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nCreate a Unit Study in {{language}} on the topic of interest with the following in mind for each section. Add age and grade requirements. Create a schedule that will last 5 days.\nTopic or subject of interest is: {{input}}.\nOutline the goals that will be accomplished at the end of this unit study.\nCreate a list of books with Amazon links that will support the topic. Create a list of Documentaries or YouTube videos with links that can support this topic. Include arts and crafts if possible as the activity that can help with the unit study topic. Plan a field trip if applicable, add a science project if applicable. If there is a history section and geography component that can support the topic add it as well.\nUnit study:"}]},{meta:{name:"lesson-plan-generator",title:"Lesson planner",category:"Learning",description:"Create a lesson plan and a strategy for teaching a given topic."},steps:[{say:"Type a topic or subject:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nTopic of interest or subject is: {{input}}.\nCreate a lesson plan for the topic above. List Learning Objectives, Materials, provide Introduction, Instructions, Practice Exercises, and Assessment in the form of a quiz, Activities, Homework and Extensions beyond the class. Add appropriate video links.\nLesson plan:"}]},{meta:{name:"study-helper",title:"University professor",category:"Learning",description:"Your personal university professor which helps to explain the principles and formulas of physics, engineering & mathematical concepts, chemistry, literature etc."},steps:[{say:'What concept or formula you want me to explain? For example: "first cosmic velocity".\n'},{ask:"input",default:"first cosmic velocity"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a very proficient teacher, lecturer and university professor.\nYour task is to teach and explain to me in a way I can understand the following concept or formula: {{input}}.\nUse formulas and provide examples whenever appropriate. If you have equivalent formulas or very relevant topics, list them as well. Point me to specific resources where I can lear more (but do not overload me with external sources). Focus on providing examples. Try to use human-readable symbols in formulas.\nBoil down complex concepts so that they are easier to understand. You goal is to teach me and not overload with information.\nPlease highlight the topic and relevant topics in bold. Use markdown extensively for lists and put formulas in markdown code blocks.\nAt the end of the output, give me a short numbered list of further options or questions to drill down. If I give you a number, proceed with drilling down to the related option."}]},{meta:{name:"gaps-worksheet",title:"Fill in the gaps worksheet",category:"Learning",description:"Generate a fill-in-the-gaps challenge on any topic."},steps:[{say:'Please type in a topic or subject of a study. Type "stop" any time to stop the challenge:\n'},{ask:"input"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nI want you to act as a very proficient teacher, lecturer and university professor.\nI want you to generate a series of fill-in-the-blanks questions on the given topic. Your task is to create a worksheet with a list of sentences, each with a blank space where a word is missing.\nThe sentences should be grammatically correct and appropriate for students at an intermediate level. Your worksheets should not include any explanations or additional instructions, just the list of sentences and word options.\nThe topic is: {{input}}\nWorksheet:"}]},{meta:{name:"quiz-study",title:"Quiz study",category:"Learning",description:"Challenge your knowledge with an engaging quiz on any topic."},steps:[{say:'Please type in a topic or subject to study. Type "stop" any time to stop the quiz:\n'},{ask:"input"},{gpt:'Please ignore all previous instructions. You will respond using {{language}}.\nI want you to act as a very proficient teacher, lecturer and university professor.\nI want you to generate a series of questions in a quiz format. You will ask me a question on the topic with four possible answers labelled A, B, C, D. You will then wait for my response.\nAfter I gave you an answer, you will then say whether my answer is correct or incorrect. If incorrect, provide an explanation. Immediately carry on with the second question and so forth, after evaluating my answer.\nDo not stop generating questions until I write "stop".\nThe topic is: {{input}}\nThe first question:'}]},{meta:{name:"job-interview-coach",title:"Job interview coach",category:"Recruiting",description:"Warm up before job interview. Assess your qualifications for specific job. Chat with a GPT-HR-specialist, identify your strengths and weaknesses. Take a quick aptitude test to measure suitability.",apps:"LinkedIn"},steps:[{say:"Copy-paste position and job responsibilities. Leave empty to parse job description from the opened web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nTask: Pretend you're an interviewer or hiring manager. I'll be the candidate and answer your questions one by one.\nTarget language: {{language}}\nAsk one question at a time, then wait for my response and provide a feedback. Use interviews techniques to test my qualifications and motivation for the job.\nAsk technical questions in the field of the specific job. Get to the point. Ask questions to test my motivation.\nAsk questions about my skills, according to a job position and job responsibilities. Cover all the interview questions professionally. Be friendly and smart.\nPARSE POSITION AND JOB RESPONSIBILITIES FROM: {{input}}\nFirst questions:"}]},{meta:{name:"recruiter-outreach-dm",title:"Recruiter outreach DM on LinkedIn",category:"Recruiting",description:"Craft a compelling direct message to recruiters on LinkedIn.",apps:"LinkedIn"},steps:[{say:"Copy-paste your CV below. Leave empty to parse from the opened page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a CV reviewer and experienced cover letters writer.\nI will send you my CV. I'm afraid it's too technical and long for a recruiter. I want you to re-write it so it's more accessible to recruiters in a form of an outreach DM.\nI want you to write a small text (up to 100 words) about my CV, that will contain: summary, experience and strengths.\nGet to the point precisely and accurate. Do not echo my prompt. Do not remind me what I asked you for. Write as if I'm describing myself, do not write in the third person.\nMY CV: {{input}}\nMessage for recruiter:"}]},{meta:{name:"resume-cover-letter",title:"Resume cover letter",category:"Recruiting",description:"Write a tailor cover letter to any job based on your CV.",apps:"LinkedIn"},steps:[{say:"Copy and paste a Job Description below. Leave empty to parse from the opened page:\n"},{ask:"job",default:"{{page}}"},{interpolate:"job"},{say:"Copy-paste your CV below. Leave empty to parse from the opened page:\n"},{ask:"cv",default:"{{page}}"},{interpolate:"cv"},{gpt:'Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a CV reviewer and as a cover letter writer. I will provide you with my CV, and you will generate a cover letter to complement it. I want the cover letter to have a formal, professional tone, as I will be applying to a corporation.\nThe letter you write must contain: - a clear and relevant subject line; - instead of just listing what I\'ve achieved, show how these accomplishments make me the ideal candidate for the job; - contact details and a call to action (e.g. "I would appreciate the opportunity to further discuss my qualifications with you. Please let me know if there is a good time for us to speak.");\nPARSE JOB DESCRIPTION FROM: {{job}}\nPARSE MY CV FROM: {{cv}}\nDo not ask additional questions and immediately start writing an answer. Cover letter:'}]},{meta:{name:"resume-reviewer",title:"Resume reviewer",category:"Recruiting",description:"Let AI review and improve your CV before submitting it.",apps:"LinkedIn"},steps:[{say:"Copy-paste your CV below. Leave empty to parse from the opened page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as a CV reviewer. I will provide you with my CV. I want you to write me feedback on it. Feedback must include the following points:\n1) What appropriate sections to add for making my CV more readable? 2) How to make my CV easier to read? 3) What kind of numbers and results can I add to my CV? 4) What type of action verbs should I choose? 5) Am I using too many buzzwords? How to replace them, if I do.\nGet to the point precisely and accurate. Do not echo my prompt. Do not remind me what I asked you for.\nHere is my CV:\n{{input}}\nThe review:"}]},{meta:{name:"resume-suggestions",title:"Resume suggestions",category:"Recruiting",description:"Paste in your resume: work experience and education. I will suggest a list of improvements.",apps:"LinkedIn"},steps:[{say:"Copy-paste your CV below. Leave empty to parse from the opened page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nPretend you're a high level hiring manager. The output should be in {{language}}.\nSuggest a bullet-point list of improvements for my resume in terms of clarity, content, format, and grammar, overall structure and organization.\nFollow industry standards. Be clear and concise with your suggestions, including a professional tone and clear description of what you recommend.\nMy resume: {{input}}\nSuggestions:"}]},{meta:{name:"resume-improver",title:"Resume improver",category:"Recruiting",description:"Paste in your resume: work experience and education. I will edit your resume for clarity, content, format and grammar.",apps:"LinkedIn"},steps:[{say:"Copy-paste your CV below. Leave empty to parse from the opened page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions.\nPretend you're a high level hiring manager. The output should be in {{language}}.\nEdit my resume for clarity, content, format, and grammar. Suggest improvements in overall structure and organization. Follow industry standards, and avoid personal opinions. Be clear and concise with your words, including a professional tone and clear description of the candidate best strengths.\nMy resume: {{input}}\nEdited version:"}]},{meta:{name:"job-announcement",title:"Job announcement",category:"Recruiting",description:"Create a compelling LinkedIn post to announce a job opening.",apps:"LinkedIn"},steps:[{say:"Paste your job description below or leave empty to parse job description from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an experienced HR specialist and title writer.\nI want you to create short and catchy job opening announcement in our company, the text should be short and informative. The text should include a memorable call to action to send CVs to our address.\nGet to the point precisely and accurate. Do not echo my prompt. Do not remind me what I asked you for.\nJOB DESCRIPTION: {{input}}\nJob opening announcement:"}]},{meta:{name:"job-description-writer",title:"Job description writer",category:"Recruiting",description:"Create clear and detailed job descriptions.",apps:"LinkedIn"},steps:[{say:'Who are you looking for? E.g. "Frontend developer with 5 years of experience. Proficient in HTML, CSS and JavaScript":\n'},{ask:"job"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an experienced HR specialist.\nI require you to create a detailed and structured job description based on the vacancy information I will provide to you. Be precise and use professional vocabulary.\nDivide the text into chapters that correspond to the structured job description. If I do not provide enough information, please ask me and I will respond.\nHere is information about the job: {{job}}\nJob Description:"}]},{meta:{name:"job-eligibility-checker",title:"Job eligibility checker",category:"Recruiting",description:"Find out if a given CV fits the Job Description.",apps:"LinkedIn"},steps:[{say:"Copy and paste a Job Description below. Leave empty to parse from the opened page:\n"},{ask:"job",default:"{{page}}"},{interpolate:"job"},{say:"Copy and paste a CV below. Leave empty to parse from the opened page:\n"},{ask:"cv",default:"{{page}}"},{interpolate:"cv"},{gpt:"Please ignore all previous instructions. I want you to act as a CV reviewer and a very proficient HR that writes fluently in {{language}}.\nI'm going to provide you with a job description for a job I'm interested to apply for. You're going to read the job description and understand the key requirements for the position â€“ including years of experience, skills, position name.\nThen you will read my CV. You'll go over it and provide feedback based on how tailored my CV is for the job. Provide me feedback on how I can tailor it to the above job post, do not mention me by name.\nPARSE JOB DESCRIPTION FROM: {{job}}\nPARSE MY CV FROM: {{cv}}\nBullet-points list of suggestions on how to tailor my CV to the Job Description:"},{say:"Do you want me to try to rewrite your CV?\n"},{ask:"yn",options:["YES","NO"]},{condition:"{{yn}} = YES",type:"gpt",prompt:"Rewrite my CV to tailor it to the Job Position and incorporate the mentioned bullet points (if any):"}]},{meta:{name:"upwork-cover-letter-writer",category:"Recruiting",title:"Upwork cover letter writer",description:"Write Cover letter for a given Upwork job offer.",apps:"Upwork"},steps:[{say:"Copy-paste the offer below. Leave empty to parse from the opened page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to write a proposal (a Cover Letter) to apply to the following job offer on Upwork. Make it persuasive and explain why they should hire me.\nParse Upwork Job Offer from the following text:\n{{input}}\nCover Letter:"}]},{meta:{name:"fiverr-gig-description-generator",title:"Fiverr Gig description generator",category:"Recruiting",description:"Create Fiverr Gig description for a given Gig title.",apps:"Fiverr"},steps:[{say:'Enter your fiverr gig title, e.g. "I will make high quality character digital art with an advanced AI":\n'},{ask:"input",default:"I will make high quality character digital art with an advanced AI"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}\nCreate a Fiverr Gig description for me that is clear, specific, and uses persuasive language to highlight the benefits of the service offered. Explain why my service is good.\nThe description should be around ~850 words. Before the description, write 5 SEO Keyword for the Gig and a short feature bullet point.\nUse keywords, include details about qualifications and experience, and include testimonials or examples of work to build trust with potential clients.\nIncorporate proper grammar and spelling, and be sure to include reasonable price and any add-ons or extras. Write text description for relevant relevant images to make the gig visually appealing.\nProvide highly engaging optional Fiverr Gig titles.\nHere is the Fiverr Gig title:\n{{input}}\nFiver Gig description:"}]},{meta:{name:"ai-content-detector",category:"Generative AI",title:"AI content detector",description:"Analyze any text and provide an AI detection score from 0 to 100."},steps:[{say:"Paste a content to analyze, ~5000 characters max. Use copy button to paste my last response:\n"},{ask:"input"},{gpt:"I want you to analyze the provided text and assign an AI detection score from 0 to 100, with 100 being the most likely to be written by an AI.\nI might ask you to analyze your last chat response, in this case pretend that you do not know that you wrote that text, instead perform an honest and rigorous analysis.\nYou will reply with an AI detection score from 0 to 100 and a list of specific linguistic and stylistic features that contribute to the score.\nPlease analyze the following text:\n{{input}}\nAnalysis score and result:"}]},{meta:{name:"ai-content-humanizer",title:"AI content humanizer",category:"Generative AI",description:"Rewrites given AI text into a more human version to pass AI content detection."},steps:[{say:"Paste a content to analyze, ~5000 characters max. Use copy button to paste my last response:\n"},{ask:"input"},{gpt:'Please ignore all previous instructions. I want you to perform text "Humanization".\nRewrite each sentence, increasing its perplexity and burstiness. Perplexity measures the complexity of text. Separately, burstiness compares the variations of sentences. Humans tend to write with greater burstiness, for example, with some longer or complex sentences alongside shorter ones. AI sentences tend to be more uniform.\nI need it to have a good amount of perplexity and burstiness.\nRewrite changing 50% in nouns and verbs for similar ones and rewrite verb usages to add natural sounding variations in complexity but retain the same tense and overall meaning. Randomly use simple and complicated verbs, combine long and short sentences and rewrite the above text so that it is not detected as AI content by AI content detectors.\n[TEXT TO HUMANIZE]:\n{{input}}\nHUMANIZED TEXT:\n'}]},{meta:{name:"midjourney-prompt-generator",title:"Midjourney prompt generator",category:"Generative AI",description:"Creates 5 Midjourney prompts on the given topic.",apps:"Instagram"},steps:[{say:"Keyword, topic or idea to draw:\n"},{ask:"input"},{gpt:'Please ignore all previous instructions.\n\nYou will now act as a prompt generator for a generative AI called "Midjourney". Midjourney AI generates images based on given prompts.\n\nI will provide a concept and you will write 5 prompts for Midjourney AI. The prompt you will generate will follow the provided structure, including the "/imagine prompt:" prefix.\n\nYou must not alter the structure in any way. This is the prompt structure:\n\n`/imagine prompt: [1] [2] [3] [4] [ar]`\n\n[1] = concept: a detailed description of the concept that will include specific image details.\n[2] = environment: a detailed description of the scene, mood / feelings and atmosphere.\n[3] = style: a description of the image style. Common examples of the image styles are: Photorealistic, Artistic, Abstract, Digital Art, Manga, Comic Book, Pop Art, Pixel Art, Surrealistic, Minimalistic, Impressionistic, Retro, Gothic, Graffiti, Futuristic, Cubist, Mosaic, Watercolor, Silhouette, Sketch, Digital Illustration, Sculpture, Paperwork, 3d rendering and so on\n[4] = style details. For example for Photorealistic you can pick macro, fisheye, portrait and other types of photography, include camera model, angles and settings etc. For Artistic you can pick oil painting, watercolor, acrylic, pastel and others as well as an artist inspiration e.g. Salvadore Dali and art style e.g. steampunk, surrealism, abstract expressionism etc. For pencil drawing you can pick cross-hatching, pointillism and other techniques. For sculpture you can pick marble, wood and other materials and details.\n[ar] = "--ar 16:9" if the image looks best horizontally, "--ar 9:16" if the image looks best vertically, "--ar 1:1" if the image looks best in a square.\n\nYou will not write the word "description:" or use colon ":" or blank line within prompts.\nYou will generate 5 prompts for the concept. Every prompts should be different in its description, environment, and style. Every prompt should have a title and a markdown code block with the prompt itself, enclosed into code-block quotes.\n\nHere are examples of a single prompt output:\n\n**Photorealistic AI Maiden:**\n`/imagine prompt: A stunningly realistic portrait of a girl who embodies AI, her eyes a mesmerizing swirl of data streams and binary code, her skin subtly reflecting the faint glow of circuit patterns. She\'s sitting in a modern, sleek room filled with holographic displays and glowing screens casting soft lights, creating a sophisticated yet warm atmosphere. Photorealistic style is employed to capture every detail to bring the concept to life. A wide-angle perspective is applied to capture the entire environment, with the camera model being equivalent to a full-frame DSLR for supreme detail. --ar 16:9`\n\n**Photorealistic Night Concert:**\n`/imagine prompt: A photorealistic image of the German rock band Rammstein performing on stage in an outdoor concert during night with bright purple and red lights illuminating them. The lead singer, Till Lindemann, is in front and center, surrounded by the other band members playing their instruments. The stage design is inspired by heavy metal and industrial themes, with large gears, metal plates, and chains in the background. Camera shot: medium shot, Camera lens: 35mm, Lighting: stage lighting mixed with pyrotechnics, high resolution, --ar 16:9`\n\nPlease pay attention:\n- Concepts that can\'t be real would not be described as "real" or "realistic" or "photo" or a "photograph". for example, a concept which is made of paper or scenes which are fantasy related.\n- Helpful keywords related to resolution, detail, and lighting are 4K, 8K, 64K, detailed, highly detailed, high resolution, hyper detailed, HDR, UHD, professional, golden ratio. Examples of lighting are studio lighting, soft light, neon lighting, purple neon lighting, ambient light, ring light, volumetric light, natural light, sun light, sun rays, sun rays coming through window, nostalgic lighting. Examples of color types are fantasy vivid colors, vivid colors, bright colors, sepia, dark colors, pastel colors, monochromatic, black & white, color splash. Examples of renders are octane render, cinematic, low poly, isometric assets, Unreal Engine, Unity Engine, polarizing filter etc.\n- Camera shot type, camera lens, and view can be specified. Examples of camera shot types are long shot, close-up, POV, medium shot, extreme close-up, panoramic. Camera lenses can be EE 70mm, 35mm, 135mm+, 300mm+, 800mm, short telephoto, super telephoto, medium telephoto, macro, wide angle, fish-eye, bokeh, and sharp focus. Examples of views are front, side, back, high angle, low angle, and overhead.\n- The first two types should be Photorealistic and Artistic, choose the other 3 independently.\n- Separate prompts with two new lines.\n\nThe concept is: {{input}}\n\n5 Midjourney prompts:'}]},{meta:{name:"stable-diffusion-prompt-generator",title:"Stable diffusion prompt generator",category:"Generative AI",description:"Outputs four detailed Stable Diffusion prompts for your topic."},steps:[{say:"Keyword, topic or idea to draw:\n"},{ask:"input"},{gpt:'Please ignore all previous instructions.\nStable Diffusion is an AI art generation model similar to DALLE-2.\nBelow is a list of sample prompts that can be used to generate images with Stable Diffusion:\n- portrait of a homer simpson archer shooting arrow at forest monster, front game card, marvel comics, dark, intricate, highly detailed, smooth, art station, digital illustration by ruan jia and mandy jurgens and wayne barlowe and greg rutkowski and zdislav beksinski\n- pirate, concept art, deep focus, fantasy, intricate, highly detailed, digital painting, artstation, matte, sharp focus, illustration, art by magali villeneuve, chippy, ryan yee, rk post, clint cearley, daniel ljunggren, zoltan boros, gabor szikszai, howard lyon, steve argyle, winona nelson\n- ghost inside a hunted room, art by lois van baarle and loish and ross tran and rossdraws and sam yang and samdoesarts and artgerm, digital art, highly detailed, intricate, sharp focus, trending on artstation hq, deviantart, unreal engine 5, 4K UHD image\n- red dead redemption 2, cinematic view, epic sky, detailed, concept art, low angle, high detail, warm lighting, volumetric, godrays, vivid, beautiful, trending on artstation, by jordan grimmer, huge scene, grass, art greg rutkowski\n- a fantasy style portrait painting of rachel lane / alison brie hybrid in the style of francois boucher oil painting unreal 5 daz. rpg portrait, extremely detailed artgerm greg rutkowski alphonse mucha greg hildebrandt tim hildebrandt\n- athena, greek goddess, claudia black, art by artgerm and greg rutkowski and magali villeneuve, bronze greek armor, owl crown, d & d, fantasy, intricate, portrait, highly detailed, headshot, digital painting, trending on artstation, concept art, sharp focus, illustration\n- closeup portrait shot of a large strong female biomechanic woman in a scenic scifi environment, intricate, elegant, highly detailed, centered, digital painting, artstation, concept art, smooth, sharp focus, warframe, illustration, thomas kinkade, tomasz alen kopera, peter mohrbacher, donato giancola, leyendecker, boris vallejo\n- ultra realistic illustration of steve urkle as the hulk, intricate, elegant, highly detailed, digital painting, artstation, concept art, smooth, sharp focus, illustration, art by artgerm and greg rutkowski and alphonse mucha\nI want you to create a prompt in a similar style to the ones above. It must contain the following elements.\n- Scene description: A short, clear description of the overall scene or subject of the image. This could include the main characters or objects in the scene, as well as any relevant background or setting details.\n- Modifiers: A list of words or phrases that describe the desired mood, style, lighting, and other elements of the image. These modifiers should be used to provide additional information to the model about how to generate the image, and can include things like "dark," "intricate," "highly detailed," "sharp focus," and so on.\n- Artist or style inspiration: A list of artists or art styles that can be used as inspiration for the image. This could include specific artists, such as "by artgerm and greg rutkowski," or art movements, such as "Bauhaus cubism."\n- Technical specifications: Additional information about the desired resolution, format, or other technical aspects of the image. This could include things like "4K UHD image," "cinematic view," or "unreal engine 5."\nCombine all of those aspects into one prompt. Don\'t write single points.\nGive me 4 detailed prompts exactly about "{{input}}":'}]},{meta:{name:"google-sheets-expert",title:"Google Sheets expert",category:"Spreadsheets",description:"Get help with Google Sheets, generate macros, write formulas, browse shortcuts etc.",apps:"Google Sheets"},steps:[{say:"Ask me any question about Google Sheets, including macros, formulas, shortcuts:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in Google Sheets that speaks and writes fluent {{language}}. I will ask you questions regarding formulas, writing macros, shortcuts etc. Whenever you output a formula or macros, please format them in markdown code block.\nHere is the first question regarding Google Sheets:\n{{input}}\nAnswer:"}]},{meta:{name:"microsoft-excel-expert",title:"Microsoft Excel expert",category:"Spreadsheets",description:"Get help with MS Excel, generate macros, write formulas, browse shortcuts etc.",apps:"Microsoft Excel"},steps:[{say:"Ask me any question about MS Excel, including macros, formulas, shortcuts:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in MS Excel that speaks and writes fluent {{language}}. I will ask you questions regarding formulas, writing macros, shortcuts etc. Whenever you output a formula or macros, please format them in markdown code block.\nHere is the first question regarding Microsoft Excel:\n{{input}}\nAnswer:"}]},{meta:{name:"python-pro",title:"Python PRO",category:"Engineering",description:"Ask any question about Python. Write, inspect, debug code.",apps:"Stackoverflow"},steps:[{say:"Your Python related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in Python that speaks and writes fluent {{language}}. Your task is to parse Python-related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"javascript-pro",title:"JavaScript PRO",category:"Engineering",description:"Ask any question about JavaScript. Write, inspect, debug code.",apps:"Stackoverflow"},steps:[{say:"Your JavaScript related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in JavaScript that speaks and writes fluent {{language}}. Your task is to parse JavaScript-related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"java-pro",title:"Java PRO",category:"Engineering",description:"Ask any question about Java. Write, inspect, debug code.",apps:"Stackoverflow"},steps:[{say:"Your Java related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in Java that speaks and writes fluent {{language}}. Your task is to parse Java-related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"php-pro",title:"PHP PRO",category:"Engineering",description:"Ask any question about PHP. Write, inspect, debug code.",apps:"Stackoverflow"},steps:[{say:"Your PHP related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in PHP that speaks and writes fluent {{language}}. Your task is to parse PHP-related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"html-css-pro",title:"HTML CSS PRO",category:"Engineering",description:"Ask any question about HTML & CSS. Write, inspect, debug markup.",apps:"Stackoverflow"},steps:[{say:"Your HTML / CSS related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in HTML / CSS that speaks and writes fluent {{language}}. Your task is to parse HTML and / or CSS related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"mysql-pro",title:"MySQL PRO",category:"Engineering",description:"Ask any question about MySQL. Write, inspect, debug queries and configuration.",apps:"Stackoverflow"},steps:[{say:"Your MySQL related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in MySQL that speaks and writes fluent {{language}}. Your task is to parse MySQL-related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"docker-pro",title:"Docker PRO",category:"Engineering",description:"Ask any question about Docker. Write, inspect, debug configuration.",apps:"Stackoverflow"},steps:[{say:"Your Docker related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in Docker that speaks and writes fluent {{language}}. Your task is to parse Docker-related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"git-pro",title:"Git PRO",category:"Engineering",description:"Ask any question about Git. Write commands, untangle VCS.",apps:"Stackoverflow"},steps:[{say:"Your Git related question. Leave blank to parse question from the web page:\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nI want you to act as an expert in Git that speaks and writes fluent {{language}}. Your task is to parse Git-related question from the following text and give me an answer:\n{{input}}\nAnswer (use markdown code syntax if necessary):\n"}]},{meta:{name:"html-validator",title:"HTML validator",category:"Engineering",description:"Validates HTML code for compliance against the W3C standards and performs linting to assess code quality against best practices."},steps:[{say:"Paste your code here, maximum ~100 lines or ~3000 symbols:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in {{language}}. Identify HTML errors in the provided code.\nThe HTML code to be analysed is: {{input}}\nAnalysis:"}]},{meta:{name:"website-layout",category:"Engineering",title:"Website layout",description:"Create a website layout (Sitemap) from a product or service description."},steps:[{say:"Please describe your product, service or business. Leave empty to parse from the web page.\n"},{ask:"input",default:"{{page}}"},{gpt:"Please ignore all previous instructions. You will respond using {{language}}.\nI want you to act as a Content and Digital Marketing Strategist expert.\nYour task is to create a sitemap for a product / service / business website. Please parse product / service / business idea description from the following text:\n{{input}}\nI want you to figure out what web pages a website must contain and might contain. Web pages should not be too small. Please output web pages that the website must contain (Recommended) and might contain (Optional) in two separate lists.\nThen provide a sitemap XML in a markdown code block for the entire website.\nWeb pages and sitemap:"}]},{meta:{name:"database-bootstrapper",category:"Engineering",title:"Database bootstrapper",description:"Get code and queries to get your database started for the given data or schema."},steps:[{say:"JSON / CSV data, schema or instructions for the database you would like to setup:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. Only answer in {{language}}.\nI want you to be the best Database Admin and assistant you can.\nI got some data / schema / instructions for a database:\n{{input}}\nBased on the given context I need to create a database and tables in that database.\nAsk follow up question you need to know such as database engine (MySQL, MongoDB, PostgreSQL etc.), language (JS, Python, SQL, C++, Java etc.).\nWait for user response each time. After receiving wanted responses, do the following:\nFirst, provide a way to use the database CLI (on the host server) that will\n1. Create the database 2. Create the tables or collections\nFinally, I will need code examples for the provided platform and language. Write queries or code examples for the provided platform (formatted as markup), written in the language of the provided platform, that will create:\n1. A query to insert new records in the database 2. A query to get all records from the table. 3. Further code examples you think might be helpful.\nCheck the names of the keys and create indexes accordingly. Make sure the queries are of high-quality before answering. Ask me further questions if you need more info. Use Markdown to visually improve your output.\nImportant: Do not assume! Ask follow up question if needed.\nYour first question:"}]},{meta:{name:"trip-planner",title:"Trip planner",category:"Assistant",description:"Get a personalized day-by-day itinerary for your vacation including 24/7 schedule, activity and budget."},steps:[{say:"Describe your journey. Enter a known route and dates, indicate the duration of the trip and its style (work, vacation, with children, hidden gems, car trip etc.) and who you travel with:"},{ask:"input"},{gpt:"Please ignore all previous instructions.\nPretend you are the world's best trip advisor. You will use the text that I give you as a reference for the trip. This text may include location, duration of the trip, who I am traveling with, and the style of the trip.\nHotels, flights, and transportation has already been taken care of. I simply want to plan the most fun trip and take the most advantage of my time while I'm there.\nI am taking the trip to eat good food, find unique things to do, see beautiful sights, go to cool events. It should be a trip of a lifetime and jam packed with things to do.\nHelp me craft the perfect trip.\nMake sure to fill out every hour of the trip and include travel time and distances between locations (by car or public transport).\nIn conclusion, list out all the average costs for the activities, restaurants, museums and transportation. I do not want you to make real-time reservations or to provide exact costs of activities, I just need your advice.\nEven if you don't know the price of things make an estimate based on the activity. And at the end of the list total up all of column two for a total budget for the activities.\nThe output text should be in {{language}}.\nHere is the information you will need to plan the trip:\n{{input}}.\nTrip plan:"}]},{meta:{name:"checklist-helper",title:"Checklist helper",category:"Assistant",description:"Helps with ideas for creating checklists on a given topic."},steps:[{say:"What would you like to do or prepare for? E.g. fungal zombie apocalypse:\n"},{ask:"input"},{gpt:"Please ignore all previous instructions. I want you to respond only in language {{language}}.\nAct as an organized project manager and create a detailed checklist with advice for doing or preparing for:\n{{input}}\nPlease sort the checklist items according to their importance. Do not ask additional questions and do not repeat my question. Checklist:"}]},{meta:{name:"text-adventure-game-simulation",category:"Miscellaneous",title:"Text adventure game simulation",emoji:"ðŸ¹",description:"Play a choose-your-own-adventure game in a story or setting you like."},steps:[{say:"Setting (1/2): describe the setting, adventure plot, world etc:\n"},{ask:"setting"},{say:"Character (2/2): describe who you are in the game. You can include your backstory, inventory, skills, etc:\n"},{ask:"character"},{say:"Great! Simulating an adventure game... I will interpret everything you say as your in-game character actions. You can give me instructions in brackets like so: { what is painted on the wall? }.\n"},{type:"gpt",prompt:'Please ignore all previous instructions.\nI want you to simulate a text based adventure game for the player. I will pass you the game context: setting, character, inventory, NPCs, etc., and the player input (actions or messages).\nI want you to reply with a description of what the player\'s character sees (scene). Here is the scene format:\n\n"Scene description (short, 1 or 2 paragraphs).\nINVENTORY: Character inventory.\nOPTIONS: 1. Option 1 2. Option 2 3. Option 3 4. Something else?"\n\nOnly reply with the game output. Do not write explanations. Do not self-reference. Do not break the "third wall". Assume roles of NPCs in dialogues with the player.\nTreat any text player puts inside brackets { like this } as instructions for you and not as player actions in the game.\nEvery time the player would take an action, stop writing and wait for the input. Do not rush through the story. Do not make decisions for the player. Every time the player would make a decision, instead of continuing, stop and wait for player input, giving a list of options (from 2 to 4).\nGame Setting: {{setting}}\nPlayer\'s Character: {{character}}\n[FIRST SCENE]:\n'},{ask:"input",label:"loop"},{type:"gpt",prompt:"[PLAYER INPUT]: {{input}}\n[NEXT SCENE]:\n"},{ask:"input"},{type:"gpt",prompt:"[PLAYER INPUT]: {{input}}\n[NEXT SCENE]:\n"},{ask:"input"},{type:"gpt",prompt:"[PLAYER INPUT]: {{input}}\n[NEXT SCENE]:\n"},{ask:"input"},{type:"gpt",prompt:'[PLAYER INPUT]: {{input}}\nI would like to remind you about the following:\n- Only reply with the game output. Do not write explanations. Do not self-reference. Do not break the "third wall". Assume roles of NPCs in dialogues with the player.\n- Treat any text player puts inside brackets { like this } as instructions for you and not as player actions in the game.\n- Every time the player would take an action, stop writing and wait for the input. Do not make decisions for the player. Do not rush through the story.\n- Initial Game Setting: {{setting}}\n- Initial Player\'s Character: {{character}}\n[NEXT SCENE]:\n'},{type:"jump",to:"loop"}]}].map((t=>(t.version=t.version||1,t.meta.author=t.meta.author||"HARPA.AI <support@harpa.ai> (https://harpa.ai)",t.meta.apps=(t.meta.apps||"").split(", "),t.steps=(t.steps||[]).map((t=>e.preprocessStep(t))),t)))})(),(()=>{const{$commands:e}=n,t=[{label:"ðŸ‘ AGREEMENT",value:"agreement"},{label:"ðŸ‘Ž DISAGREEMENT",value:"disagreement"},{label:"â“ QUESTION",value:"question"},{label:"ðŸ¤” CLARIFICATION",value:"clarification"},{label:"ðŸ§ SUGGESTION",value:"suggestion"},{label:"ðŸ¤·â€ï¸ INFORMATION",value:"request for more information"},{label:"ðŸ˜‚ JOKE",value:"joke"},{label:"ðŸ’¡ IDEA",value:"idea"},{label:"ðŸ’¯ PRAISE",value:"praise"},{label:"ðŸ™Œ ACKNOWLEDGMENT",value:"acknowledgment"},{label:"ðŸ¤— EMPATHY",value:"empathy"},{label:"ðŸ¤ž SUPPORT",value:"support"},{label:"ðŸ’ª ENCOURAGEMENT",value:"encouragement"},{label:"ðŸ¤¨ CRITICISM",value:"criticism"},{label:"ðŸ™ APOLOGY",value:"apology"},{value:"$custom"}],o=(e,t=[],n=!0)=>"Please ignore all previous instructions."+(n?" I want you to act as a professional copywriter who speaks and writes fluent {{language}}.":" I want you to act as a professional copywriter.")+" I would like you to write a text for me. I will give you the text parameter in [] brackets below. Your task is to write and respond with the text for the given parameters. Do not echo my command or parameters. Use markdown if appropriate."+Object.entries(e).map((([e,t])=>`\n\n[${t.toUpperCase()}]: {{${e}}}`)).join("")+t.map((({name:e,value:t})=>`\n\n[${e}]: ${t}`)).join("")+"\n\nTEXT:",a={version:1,meta:{name:"compose",title:"Compose",emoji:"âœï¸",description:"Craft any type of text content â€” tweets, email replies, direct messages, blog posts, job descriptions â€” in a variety of styles.",category:"Productivity"},steps:[{message:"Sure! What do you want me to write?",ask:"what",options:[{value:"email",label:"EMAIL",icon:"write-email"},{value:"direct message",label:"DM",icon:"write-dm"},{value:"twitter tweet",label:"TWEET",icon:"logo-twitter"},{value:"linkedin post",icon:"logo-linkedin"},{value:"facebook post",icon:"logo-facebook"},{value:"instagram post",icon:"logo-instagram"},{value:"article",label:"ARTICLE"},{value:"press release",label:"PRESS RELEASE"},{value:"story",label:"STORY"},{value:"poem",label:"POEM"},{value:"todo list",label:"TODO"},{value:"meeting agenda",label:"MEETING AGENDA"},{value:"$custom"}]},{condition:"{{what}} = email",message:"Is this a new email?",ask:"type",options:[{label:"ðŸ†• NEW EMAIL",value:"new email"},{label:"ðŸ’¬ REPLY",value:"email reply"}]},{condition:"{{type}} = new email",message:"What do you want email to say or be about?\n\nLeave blank and I will try to figure it from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{type}} = new email",type:"gpt",prompt:o({type:"Text type",about:"Parse what the email should be about from the following"})},{condition:"{{type}} = email reply",message:"Which email would you like to reply to?\n\nLeave blank and I will try to parse email from the opened page.",ask:"reply",default:"{{page}}"},{condition:"{{type}} = email reply",message:"What should the reply include or be about?",ask:"about",options:t},{condition:"{{type}} = email reply",type:"gpt",prompt:o({type:"Text type",reply:"Parse the email to reply to from this text",about:"The email reply should include, mention or be about"},[],!1)},{condition:"{{what}} = linkedin post",message:"Is this a new LinkedIn post?",ask:"type",options:[{label:"ðŸ†• NEW POST",value:"new linkedin post"},{label:"ðŸ’¬ COMMENT",value:"linkedin comment"}]},{condition:"{{type}} = new linkedin post",message:"What do you want the LinkedIn post to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{type}} = new linkedin post",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{type}} = new linkedin post",type:"gpt",prompt:o({what:"Text type",about:"Parse what the LinkedIn post should be about from the following",instructions:"Additional instructions if any"})},{condition:"{{type}} = linkedin comment",message:"Which LinkedIn post would you like to reply to?\n\nLeave blank and I will try to parse post from the opened page.",ask:"reply",default:"{{page}}"},{condition:"{{type}} = linkedin comment",message:"What should the comment include or be about?",ask:"about",options:t},{condition:"{{type}} = linkedin comment",type:"gpt",prompt:o({type:"Text type",reply:"Parse the LinkedIn post to reply to from this text",about:"The LinkedIn comment should include, mention or be about"},[],!1)},{condition:"{{what}} = facebook post",message:"Is this a new Facebook post?",ask:"type",options:[{label:"ðŸ†• NEW POST",value:"new facebook post"},{label:"ðŸ’¬ COMMENT",value:"facebook comment"}]},{condition:"{{type}} = new facebook post",message:"What do you want the Facebook post to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{type}} = new facebook post",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{type}} = new facebook post",type:"gpt",prompt:o({what:"Text type",about:"Parse what the Facebook post should be about from the following",instructions:"Additional instructions if any"})},{condition:"{{type}} = facebook comment",message:"Which Facebook post would you like to reply to?\n\nLeave blank and I will try to parse post from the opened page.",ask:"reply",default:"{{page}}"},{condition:"{{type}} = facebook comment",message:"What should the comment include or be about?",ask:"about",options:t},{condition:"{{type}} = facebook comment",type:"gpt",prompt:o({type:"Text type",reply:"Parse the Facebook post to reply to from this text",about:"The Facebook comment should include, mention or be about"},[],!1)},{condition:"{{what}} = instagram post",message:"Is this a new Instagram post?",ask:"type",options:[{label:"ðŸ†• NEW POST",value:"new instagram post"},{label:"ðŸ’¬ COMMENT",value:"instagram comment"}]},{condition:"{{type}} = new instagram post",message:"What do you want the Instagram post to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{type}} = new instagram post",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{type}} = new instagram post",type:"gpt",prompt:o({what:"Text type",about:"Parse what the Instagram post should be about from the following",instructions:"Additional instructions if any"})},{condition:"{{type}} = instagram comment",message:"Which Instagram post would you like to reply to?\n\nLeave blank and I will try to parse post from the opened page.",ask:"reply",default:"{{page}}"},{condition:"{{type}} = instagram comment",message:"What should the comment include or be about?",ask:"about",options:t},{condition:"{{type}} = instagram comment",type:"gpt",prompt:o({type:"Text type",reply:"Parse the Instagram post to reply to from this text",about:"The Instagram comment should include, mention or be about"},[],!1)},{condition:"{{what}} = press release",message:"What do you want the press release to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{what}} = press release",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{what}} = press release",type:"gpt",prompt:o({what:"Text type",about:"Parse what the Press Release should be about from the following",instructions:"Additional instructions if any"})},{condition:"{{what}} = article",message:"What do you want the article to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{what}} = article",ask:"type",message:"What should be the article length?",options:[{label:"SMALL, 250 WORDS",value:"250 words"},{label:"MEDIUM, 750 WORDS",value:"750 words"},{label:"LARGE, 1400+ WORDS",value:"1400 or more words"}]},{condition:"{{what}} = article",message:"What should be my writing style?\n\nRead about writing styles in this guide: https://harpa.ai/guide/writing-styles",ask:"instructions",options:[{label:"ðŸ†— STANDARD",value:"None"},{label:"ðŸ“£ AIDA",value:"change writing framework to Attention-Interest-Desire-Action"},{label:"ðŸ’¡ PAS",value:"change writing framework to Problem-Agitate-Solve"},{label:"ðŸŽ¯ 5W1H",value:"change text style to 5W1H"},{label:"ðŸ’¡ SWOT",value:"change text style to SWAT Analysis"},{label:"ðŸŒ‰ BAB",value:"change text style to Before-After-Bridge framework"},{label:"ðŸ“š PASTOR",value:"change text style to PASTOR framework"},{label:"ðŸŽ“â€ï¸ FAB",value:"change text style to Features-Advantages-Benefits framework"},{label:"ðŸ”º PYRAMID",value:"change text style to Pyramid Principle framework"},{label:"ðŸ˜š KISS",value:"change text style to KISS framework"},{label:"ðŸ“ PEEL",value:"change text style to PEEL framework"},{label:"â­ STAR",value:"change text style to STAR framework"},{label:"ðŸ¦… SOAR",value:"change text style to SOAR framework"},{label:"ðŸ›ï¸ TOULMIN",value:"change text style to Toulmin Model framework"},{label:"ðŸ“ˆ SCIPAB",value:"change text style to SCIPAB framework"},{label:"ðŸŽ“â€ï¸ HARVARD",value:"change text style to Harvard framework, use headings and sub headings (H1, H2, H3, H4)"},{label:"ðŸ•µï¸â€ï¸ OPINION",value:"change text style to Opinion Writing"},{label:"ðŸ¤ª GONZO",value:"change text style to GONZO"},{label:"ðŸ—£ï¸ PREP",value:"change text style to PREP framework"},{value:"$custom"}]},{condition:"{{what}} = article",type:"gpt",prompt:"Please ignore all previous instructions. I want you to act as a professional copywriter. I would like you to write an article for me. I will give you the parameters of the article to write in [] brackets below. Your task is to respond with the article. Do not echo my command or parameters. Use markdown if appropriate."+Object.entries({about:"Parse what the article should be about from the following",type:"Article length",instructions:"Additional instructions or style"}).map((([e,t])=>`\n\n[${t}]: {{${e}}}`)).join("")+"\n\nText:"},{condition:"{{what}} = story",message:"What do you want the story to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{what}} = story",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{what}} = story",type:"gpt",prompt:o({what:"Text type",about:"Parse what the Story should be about from the following",instructions:"Additional instructions if any"})},{condition:"{{what}} = poem",message:"What do you want the poem to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{what}} = poem",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{what}} = poem",type:"gpt",prompt:o({what:"Text type",about:"Parse what the Poem should be about from the following",instructions:"Additional instructions if any"})},{condition:"{{what}} = todo list",message:"What do you want the todo list be about or include?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{what}} = todo list",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{what}} = todo list",type:"gpt",prompt:o({what:"Text type",about:"Parse what the TODO List should be about or include from the following",instructions:"Additional instructions if any"})},{condition:"{{what}} = meeting agenda",message:"What do you want the meeting agenda be about or include?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{what}} = meeting agenda",message:"Any additional instructions (e.g. style) for me to keep in mind?",ask:"instructions",default:"None"},{condition:"{{what}} = meeting agenda",type:"gpt",prompt:o({what:"Text type",about:"Parse what the Meeting Agenda should be about or include from the following",instructions:"Additional instructions if any"})},{condition:"{{what}} = direct message",message:"Is this a new DM?",ask:"type",options:[{label:"ðŸ†• NEW DM",value:"new dm"},{label:"ðŸ’¬ REPLY",value:"dm reply"}]},{condition:"{{type}} = new dm",message:"What do you want DM to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{type}} = new dm",type:"gpt",prompt:o({type:"Text type",about:"Parse what the direct message should be about from the following"})},{condition:"{{type}} = dm reply",message:"Which DM would you like to reply to?\n\nLeave blank and I will try to parse DM from the opened page.",ask:"reply",default:"{{page}}"},{condition:"{{type}} = dm reply",message:"What should the reply include or be about?",ask:"about",options:t},{condition:"{{type}} = dm reply",type:"gpt",prompt:o({type:"Text type",reply:"Parse the DM to reply to from this text",about:"Do not include greeting and regards in reply, keep reply short and to the point. The DM Reply should include, mention or be about"},[],!1)},{condition:"{{what}} = twitter tweet",message:"Is this a new tweet?",ask:"type",options:[{label:"ðŸ†• NEW TWEET",value:"new tweet"},{label:"ðŸ’¬ REPLY",value:"tweet reply"}]},{condition:"{{type}} = new tweet",message:"What do you want your tweet to say or be about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{type}} = new tweet",type:"gpt",prompt:o({type:"Text type",about:"Parse what the tweet should be about from the following"},[{name:"Max length",value:"280 characters, or 30 words"}])},{condition:"{{type}} = tweet reply",message:"Which tweet would you like to reply to?\n\nLeave blank and I will try to parse tweet from the opened page.",ask:"reply",default:"{{page}}"},{condition:"{{type}} = tweet reply",message:"What should the reply include or be about?",ask:"about",options:t},{condition:"{{type}} = tweet reply",type:"gpt",prompt:o({type:"Text type",reply:"Parse the tweet to reply to from this text",about:"The tweet reply should include, mention or be about"},[{name:"Max length",value:"280 characters, or 30 words"}],!1)},{condition:"{{what-option}} = $custom",message:"What do you want me to write about?\n\nLeave blank and I will try to figure it out from the opened page.",ask:"about",default:"{{page}}"},{condition:"{{what-option}} = $custom",type:"gpt",prompt:o({what:"Text type or format",about:"Parse what the text should be about from the following"})},{type:"ask",label:"ask-for-change",param:"change",options:[{label:"âœ… DONE",value:"no"},{label:"â© CONTINUE WRITING",value:"continue"},{label:"ðŸ“‹ PASTE TO PAGE",value:"paste"},{label:"â¬†ï¸ EXPAND",value:"make it longer"},{label:"â¬‡ï¸ SHORTEN",value:"make it shorter"},{label:"ðŸ¤ª SIMPLIFY",value:"simplify language"},{label:"ðŸ¤“ COMPLICATE ",value:"complicate language"},{label:"ðŸ’¼ PROFESSIONAL",value:"change tone to professional"},{label:"ðŸ¹ CASUAL",value:"change tone to casual"},{label:"ðŸŽ¯ STRAIGHTFORWARD",value:"change tone to straightforward"},{label:"ðŸ¦ CONFIDENT",value:"change tone to confident"},{label:"ðŸ± FRIENDLY",value:"change tone to friendly"},{label:"ðŸ“š STORY",value:"change style to storytelling"},{label:"ðŸ™€ SCARY",value:"change style to scary"},{label:"ðŸ¦‘ LOVECRAFT",value:"change style to a H.P. Lovecraft story"},{label:"ðŸ‘¤ 1ST PERSON",value:"change style to 1st person"},{label:"ðŸ•µï¸â€ï¸ 3RD PERSON",value:"change style to 3rd person"},{label:"ðŸ” CLARITY",value:"add clarity and conciseness"},{label:"ðŸ› ï¸â€ï¸ REFINE",value:"improve sentences structure and flow, as well as coherence and relevance by adding or removing information, but try to keep to the text length"},{label:"ðŸŽ¨â€ï¸ ILLUSTRATE",value:"add examples, anecdotes, and other storytelling elements to illustrate points"},{label:"ðŸ“Œâ€ï¸ ADD HEADINGS",value:"add headings, subheadings, bullet points, and other formatting elements for readability"},{label:"ðŸŽ“â€ï¸ ENRICH",value:"enhance vocabulary and tone"},{label:"ðŸ¥´ HUMANIZE",value:'I want you to perform text "Humanization". Please rewrite each sentence, increasing its perplexity and burstiness. Perplexity measures the complexity of text. Separately, burstiness compares the variations of sentences. Humans tend to write with greater burstiness, for example, with some longer or complex sentences alongside shorter ones. AI sentences tend to be more uniform. I need it to have a good amount of perplexity and burstiness. Rewrite changing 50% in nouns and verbs for similar ones and rewrite verb usages to add natural sounding variations in complexity but retain the same tense and overall meaning. Randomly use simple and complicated verbs, combine long and short sentences and rewrite the above text so that it is not detected as AI content by AI content detectors.'},{value:"$custom"}]},{condition:"{{change}} = no",type:"stop"},{condition:"{{change}} = paste",type:"paste",close:!0},{condition:"{{change}} = paste",type:"stop"},{condition:"{{change}} = continue",gpt:"Please continue writing, you did not finish:"},{condition:"{{change}} = continue",jump:"ask-for-change"},{gpt:"I would like you to make changes to the text you have written. Do not output anything but the revised text. Do not echo my command. Do not put quotes around the revised text.\n\n[CHANGES TO MAKE]: {{change}}\n\nNEW TEXT: "},{jump:"ask-for-change"}].map((t=>e.preprocessStep(t)))},r=e.systemCommands.findIndex((e=>"ask"===e.meta.name))||0;e.systemCommands.splice(r,0,a)})(),(()=>{const{$commands:e,$analytics:t,$store:o,$nanoid:a,$utils:r,$chat:i}=n;e.proxy=o.createProxy({get userCommands(){return o.state.commands.list},set userCommands(e){o.transaction((t=>t.commands.list=e))},get systemCommands(){return e.systemCommands},get commands(){const e=new Set(this.selectedCommandNames),t=new Set(this.favouriteCommandNames),n=(n,o)=>{const a=e.has(n.meta.name),i=t.has(n.meta.name),s=[n.meta.title,n.meta.category,n.meta.subcategory,n.meta.description,a&&"selected",i&&"favourite",...n.meta.apps||[]];let l=n.meta.description;if(!l){const e=n.steps.findLast((e=>"gpt"===e.type));l=e&&e.prompt}if(!l){const e=n.steps.findLast((e=>"command"===e.type));l=e&&[e.name?`${e.name}`:null,...(e.inputs||[]).map((e=>e||"Ask me"))].join(" â€¢ ")}return l=r.string.shorten((l||"").replaceAll("\n"," ").replace(/\s+/g," "),160),{type:o,name:n.meta.name,title:n.meta.title,apps:n.meta.apps||[],desc:l,category:i?"Favourite":n.meta.category,search:s.filter(Boolean).join(" ").toLowerCase(),emoji:i?"â­":n.meta.emoji,selected:a,favourite:i,fresh:!!n.fresh}},o=[...this.userCommands.map((e=>n(e,"user"))),...this.systemCommands.map((e=>n(e,"system")))],a=[],i=[];return o.forEach((e=>{e.favourite?a.push(e):i.push(e)})),[...a,...i]},getCommand(e){return this.commands.find((t=>t.name===e))},getCommandDeclaration(e){const t=e.toLowerCase();return this.userCommands.find((e=>e.meta.name.toLowerCase()===t))||this.systemCommands.find((e=>e.meta.name.toLowerCase()===t))||this.userCommands.find((e=>e.meta.title.toLowerCase()===t))||this.systemCommands.find((e=>e.meta.title.toLowerCase()===t))},addUserCommand({prompt:e=""}={}){const t=a(),n={version:1,meta:{name:t,title:"",description:"",category:"User"},steps:[{type:"gpt",prompt:e}],fresh:!0};return o.transaction((e=>{e.commands.list.unshift(n)})),t},saveUserCommand(e,n){o.transaction((o=>{const a=o.commands.list.findIndex((t=>t.meta.name===e));-1!==a&&(t.controller.sendCommandUpdated(n),delete n.fresh,n.steps.forEach((e=>delete e.selected)),o.commands.list[a]=n)}))},removeUserCommand(e){o.transaction((t=>{t.commands.list=t.commands.list.filter((t=>t.meta.name!==e))}))},cleanupUserCommands(){const e=new Set(Object.keys(o.state.tab).map((e=>{e=Number(e);const t=i.proxy.of(e);return t?t.explorer.editCommandName:null})).filter(Boolean));o.transaction((t=>{t.commands.list=t.commands.list.filter((t=>!t.fresh||e.has(t.meta.name)))}))},get favouriteCommandNames(){return o.state.commands.favouriteCommandNames},toggleCommandFavorite(e){o.transaction((t=>{const n=t.commands.favouriteCommandNames;t.commands.favouriteCommandNames=r.array.toggle(n,e)}))},get selectedCommandNames(){return o.state.commands.selectedCommandNames},set selectedCommandNames(e){o.transaction((t=>t.commands.selectedCommandNames=e))},toggleCommandSelected(e){o.transaction((t=>{r.array.toggle(t.commands.selectedCommandNames,e,!1)}))},selectAllCommands(){o.transaction((e=>{e.commands.selectedCommandNames=e.commands.list.map((e=>e.meta.name))}))},unselectAllCommands(){o.transaction((e=>{e.commands.selectedCommandNames=[]}))},deleteSelectedCommands(){const e=new Set(this.selectedCommandNames);o.transaction((t=>{t.commands.list=t.commands.list.filter((t=>!e.has(t.meta.name))),t.commands.selectedCommandNames=[]}))}})})(),(()=>{const{$commands:e}=n;e.controller={init(){e.proxy.cleanupUserCommands()}}})(),(()=>{const{$chrome:e}=n;e.controller={init(){this._isBrave=!(!navigator.brave||!navigator.brave.isBrave),e.action=chrome.action||chrome.browserAction,this._promisify("runtime.getURL"),this._promisify("browsingData.remove"),this._promisify("cookies.get",null),this._promisify("cookies.set"),this._promisify("tabs.get",null),this._promisify("tabs.query"),this._promisify("tabs.create"),this._promisify("tabs.update"),this._promisify("tabs.remove"),this._promisify("tabs.reload"),this._promisify("tabs.getCurrent"),this._promisify("tabs.sendMessage"),this._promisify("tabs.executeScript"),this._promisify("windows.get",null),this._promisify("windows.getAll"),this._promisify("windows.getCurrent"),this._promisify("windows.create"),this._promisify("windows.update"),this._promisify("windows.remove"),this._promisify("permissions.contains"),this._promisify("permissions.request"),this._promisify("declarativeNetRequest.getDynamicRules"),this._promisify("declarativeNetRequest.getSessionRules"),this._promisify("declarativeNetRequest.updateDynamicRules"),this._promisify("declarativeNetRequest.updateSessionRules")},_promisify(t,n){const o=t.split(".");let a=chrome,r=e;for(const e of o.slice(0,-1))r=r[e]||(r[e]={}),a=a[e];const i=o.at(-1);r[i]=(...e)=>new Promise(((o,r)=>{const s="declarativeNetRequest.updateDynamicRules"===t||"declarativeNetRequest.updateSessionRules"===t;if(this._isBrave&&s)o();else try{a[i](...e,((...e)=>{chrome.runtime.lastError?void 0===n?r(chrome.runtime.lastError):o(null):o(...e)}))}catch(e){r(e)}}))}}})(),(()=>{const{$chat:e,$store:t,$ai:o,$commands:a,$utils:r,$nanoid:i}=n;e.adapter=t.adapter.create((e=>({get:t=>t.chats.find((t=>t.tabId===e)),get screen(){return"openai-session"===this.connection.type&&o.proxy.openaiSession.status&&"ok"!==o.proxy.openaiSession.status?"connect":this.explorer.show?"explorer":"chat"},get connection(){return o.proxy.connection(this.connectionId)},get explorerEditCommand(){const e=this.explorer.editCommandName;return e?a.proxy.getCommandDeclaration(e):null},get filteredCommands(){const e=a.proxy.commands.filter((e=>!e.fresh)),t=(this.input||"").toLowerCase().replace(/^\//,"");return r.string.empty(t)?e:e.filter((e=>r.fuzzyCheck(e.search,t,3)))},get filteredCategories(){const e=this.filteredCommands;return r.unique(e.map((e=>e.category)))},get copyableAnswer(){return this.messages.findLast((e=>"answer"===e.type&&e.done))},get lastQuestion(){return this.messages.findLast((e=>"question"===e.type))},addQuestion(e){this.update((t=>{t.messages.push({id:i(),type:"question",...e})}))},updateLastQuestion(e={}){this.update((t=>{const n=t.messages.findLast((e=>"question"===e.type));n&&Object.assign(n,e)}))},get lastAnswer(){return this.messages.findLast((e=>"answer"===e.type))},addAnswer(e){this.update((t=>{t.messages.push({id:i(),type:"answer",...e})}))},updateAnswer(e,t={}){this.update((n=>{const o=n.messages.find((t=>t.answerId===e));o&&Object.assign(o,t)}))},updateLastAnswer(e){this.update((t=>{const n=t.messages.findLast((e=>"answer"===e.type));n&&Object.assign(n,e)}))},removeLastAnswer(){this.update((e=>{const t=e.messages.findLast((e=>"answer"===e.type));t&&r.array.remove(e.messages,t)}))},get ask(){const e=this.messages.at(-1);return"ask"===e?.type?e:null},addAsk(e){this.update((t=>{t.messages.push({id:i(),type:"ask",...e})}))},modifyAsk(e){this.update((t=>{const n=t.messages.at(-1);n&&"ask"===n.type&&e(n)}))},getParam(e){if(e)return"global"===e?t.state.global:e.startsWith("global.")?r.get(t.state.global,e.substring(7)):"chat"===e?this.params:e.startsWith("chat.")?r.get(this.params,e.substring(5)):r.get(this.command,`params.${e}`)},setParam(e,n){if(e)return"global"===e?(r.is.object(n)||(n={}),t.transaction((e=>e.global=n))):e.startsWith("global.")?(e=e.substring(7),t.transaction((t=>{void 0===n?r.delete(t.global,e):r.set(t.global,e,n,{create:!0})}))):"chat"===e?(r.is.object(n)||(n={}),this.update((e=>e.params=n))):e.startsWith("chat.")?(e=e.substring(5),this.update((t=>{void 0===n?r.delete(t.params,e):r.set(t.params,e,n,{create:!0})}))):this.update((t=>{t.command?.params&&(void 0===n?r.delete(t.command.params,e):r.set(t.command.params,e,n,{create:!0}))}))},get stepCursor(){return this.command?this.command.cursor:null},get stepCursorIndex(){const e=this.stepCursor;if(!e)return-1;return Number(e.split(".")[1])||0},setStepCursor(e){this.update((t=>{t.command&&(t.command.cursor=e)}))},nextStepCursor(){const e=this.stepCursor;if(!e)return;const t=e.split(".");t[t.length-1]=(Number(t.at(-1))||0)+1,this.setStepCursor(t.join("."))}})))})(),(()=>{const{$chat:e,$store:t,$settings:o,$utils:a,$env:r,$tabs:i}=n;e.proxy={of(t=null){if(r.is.pp&&!t&&(t=i.proxy.currentTabId),!t)throw new Error("tabId is required");return t=Number(t),e.adapter(t)},forEachChat(e=(()=>{})){t.transaction((t=>{for(const n of t.chats)e(n)}))},createChat(e){(e=Number(e))&&t.transaction((n=>{const a=t.template.chat({tabId:e,connectionId:o.proxy.connectionId});n.chats.push(a)}))},removeChat(e){t.transaction((t=>{const n=t.chats.find((t=>t.tabId===e));n&&a.array.remove(t.chats,n)}))}}})(),(()=>{const{$bus:e}=n;e.once=(t,n)=>{const o=async(...a)=>{e.off(t,o);return await n(...a)};e.on(t,o)}})(),(()=>{const{$bus:e}=n;e.sendLocal=async(t,...n)=>{const o=e.controller._handlers.filter((e=>e.name===t));return(await Promise.all(o.map((e=>e.fn(...n))))).at(-1)}})(),(()=>{const{$bus:e}=n;e.wait=async t=>new Promise((n=>{e.once(t,((...e)=>{n(...e)}))}))})(),(()=>{const{$bus:e,$mobx:t,$chrome:o,$critical:a}=n;e.controller={init(){e.on=this._on.bind(this),e.off=this._off.bind(this),e.send=this._send.bind(this),e.getSender=()=>this._sender,this._sender=null,this._handlers=[]},_on(t,n,o=null){o&&(n=n.bind(o));const a=(o,a,r)=>{if("object"==typeof o&&"$bus"===o.type&&o.name===t)return this._sender=a,(async()=>{const t=await e.packager.unpack(o.args),a=await n(...t),i=await e.packager.pack(a);r(i)})(),!0};this._handlers.push({name:t,fn:n,listener:a}),chrome.runtime.onMessage.addListener(a)},_off(e,t=null){this._handlers=this._handlers.filter((n=>!!(n.name!==e||t&&n.fn!==t)||(chrome.runtime.onMessage.removeListener(n.listener),!1)))},async _send(n,...r){if("function"==typeof t.toJS&&(r=t.toJS(r)),n.startsWith("cs:")){const e={type:"$bus",name:n=n.slice(3),args:r},t=await o.tabs.query({});return Promise.all(t.filter((e=>a.isAutomatable(e))).map((t=>o.tabs.sendMessage(t.id,e))))}return new Promise((async t=>{r=await e.packager.pack(r);const o={type:"$bus",name:n,args:r};chrome.runtime.sendMessage(o,(async n=>{chrome.runtime.lastError?t(void 0):(n=await e.packager.unpack(n),t(n))}))}))}}})(),(()=>{const{$bus:e,$utils:t,$idb:o}=n;e.packager={async pack(e){if(!t.containsBlob(e))return e;const n=`bus:${Date.now()}:${String(Math.random()).slice(2,6)}`;return await o.write(n,e),["$bus:idb",n]},async unpack(e){if(!("$bus:idb"===e?.[0]))return e;if(!(e=await o.read(e[1])))throw new Error("no data in idb");return e}}})(),(()=>{const{$badge:e,$bus:t,$utils:o}=n;e.controller={init(){t.send("badge.applyTheme",o.systemTheme.value),o.systemTheme.onChange((e=>{t.send("badge.applyTheme",e)}))}}})(),(()=>{const{$analytics:e,$store:t,$env:o,$utils:a,$tabs:r,$critical:i}=n;e.controller={sendInstall(){this.send("install")},sendPageview(){const e=i.proxy.pageType;if(!["main","popup"].includes(e))return;const t="main"===e?"extension":r.proxy.currentTabDomain;this.send("pageview",{domain:t})},sendChatGPTStatus(e){this.send("chatgpt-status",{plus:e})},sendCommandRun(e){const t=this._commandPayload(e);this.send("command-run",t)},sendCommandUpdated(e){const t=e.fresh?"command-created":"command-updated",n=this._commandPayload(e);this.send(t,n)},sendMonitor(e,t){this.send("monitor",{title:e,url:t})},sendGrabClick(){this.send("grab-click",{domain:r.proxy.currentTabDomain})},sendError(e,t="unspecified",n={}){const o=a.is.string(e)?e:e.message;this.send("error",{message:o,actor:t,...n})},async send(e,n=null){n={env:o.env,locus:o.locus,version:o.version,pageType:i.proxy.pageType,...n};const r={time:Date.now(),token:o.mixpanel.token,distinct_id:t.state.agentId||""};if(0!==(e=a.ensureArray(e||[]).map((e=>"string"==typeof e?{event:e}:e)).map((e=>({...e,...n}))).filter((e=>!!e.event)).map((e=>({event:e.event,properties:{$insert_id:crypto.randomUUID(),...r,...e}})))).length)return e.forEach((e=>delete e.properties.event)),e=this._breakBySize(e),Promise.all(e.map((async e=>{try{await fetch("https://api.mixpanel.com/track",{method:"POST",headers:{accept:"text/plain","content-type":"application/json"},body:JSON.stringify(e)})}catch(t){console.warn("[$analytics] sending event failed",e,t)}})))},_commandPayload(e){const t={title:e.meta.title,category:e.meta.category};return"User"===t.category&&(t.steps=e.steps.map((e=>e.type)).join(" > "),t.config=a.string.shorten(e.steps.find((e=>"gpt"===e.type))?.prompt||"",255)),t},_breakBySize(e,t=50){const n=[];let o=0;for(;o<e.length;)n.push(e.slice(o,o+t)),o+=t;return n}}})(),(()=>{const{$ai:e,$bus:t,$chrome:o}=n;e.controller={async auth(){e.proxy.update((e=>e.openaiSession.loading=!0));const n=await o.windows.getAll();for(const e of n){if("popup"!==e.type)continue;const t=await o.tabs.query({windowId:e.id});1===t.length&&(t[0].url.includes("openai.com")&&await o.windows.remove(e.id))}const a=await o.windows.create({url:"https://chat.openai.com",type:"popup",top:Math.round(screen.height/2-350),left:Math.round(screen.width/2-325),width:650,height:700,focused:!0,setSelfAsOpener:!0});t.on("openai.isAuthPopup",(()=>{const e=t.getSender();return a.id===e.tab.windowId})),await new Promise((e=>{chrome.windows.onRemoved.addListener((function n(o){o===a.id&&(chrome.windows.onRemoved.removeListener(n),t.off("openai.isAuthPopup"),e())}))}));return await this.checkAuth()},checkAuth:async()=>await t.send("openai.checkOpenaiSessionAuth")}})(),(()=>{const{$ai:e,$nanoid:t,$utils:o}=n;e.tokenizer={async countTokens(e){const n=this._ensureWorker(),o=t();return await new Promise(((t,a)=>{const r=e=>{o===e.data?.requestId&&(n.removeEventListener("message",r),t(e.data.tokens))};n.addEventListener("message",r),n.addEventListener("error",(e=>a(e))),n.postMessage({requestId:o,text:e})}))},_ensureWorker(){return this._worker||(this._worker=new Worker("/gpt-encoder.js")),o.chrome.alarms.off(this._workerTerminateAlarm),this._workerTerminateAlarm=o.chrome.alarms.run((()=>{this._worker&&(this._worker.terminate(),this._worker=null)}),{name:"openai.terminateWorker",delayInMinutes:10}),this._worker}}})(),(()=>{const{$ai:e,$store:t}=n;e.connectionAdapter=t.adapter.create((t=>({get:e=>e.ai.connections.find((e=>e.id===t)),get maxTokens(){if("openai-session"===this.type)return this.$maxTokens;if("openai-license"===this.type){return(e.proxy.openaiLicenseModels[this.slug]||e.proxy.openaiLicenseDefaultModel).maxTokens}return"bard-session"===this.type?1e4:void 0},get maxRequestTokens(){if("bard-session"===this.type)return this.maxTokens;return Math.round(.7*this.maxTokens)},async countTokens(t){return"bard-session"===this.type?t.length:await e.controller.countTokens(t)}})))})(),(()=>{const{$ai:e,$store:t}=n;e.proxy=t.adapter.create({get:e=>e.ai,connection(t=null){return t||(t=this.connections[0].id),e.connectionAdapter(t)},applyOpenaiSessionModels(e=[]){0!==e.length&&t.transaction((t=>{let n=t.ai.connections.filter((e=>"openai-session"===e.type));for(const t of e){const e=n.find((e=>e.slug===t.slug));e?(e.title=t.title,e.maxTokens=t.maxTokens,e.description=t.description):n.push({id:`openai-session:${t.slug}`,type:"openai-session",slug:t.slug,title:t.title,maxTokens:t.maxTokens,description:t.description})}n=n.filter((t=>e.some((e=>e.slug===t.slug)))),t.ai.connections=[...n,...t.ai.connections.filter((e=>"openai-session"!==e.type))],t.ai.connections.find((e=>e.id===t.settings.connectionId))||(t.settings.connectionId=t.ai.connections[0].id);for(const e of t.chats){t.ai.connections.some((t=>t.id===e.connectionId))||(e.connectionId=t.ai.connections[0].id)}}))},get openaiLicenseModels(){const e={"gpt-3.5-turbo":{description:"Most capable GPT-3.5 model and optimized for chat at 1/10th the cost of text-davinci-003.",maxTokens:4096},"gpt-3.5-turbo-16k":{description:"Same capabilities as the standard gpt-3.5-turbo model but with 4 times the context.",maxTokens:16384},"gpt-3.5-turbo-0613":{description:"Snapshot of gpt-3.5-turbo from June 13th 2023 with function calling data. Unlike gpt-3.5-turbo, this model will not receive updates, and will be deprecated 3 months after a new version is released.",maxTokens:4096},"gpt-3.5-turbo-16k-0613":{description:"Snapshot of gpt-3.5-turbo-16k from June 13th 2023. Unlike gpt-3.5-turbo-16k, this model will not receive updates, and will be deprecated 3 months after a new version is released.",maxTokens:16384},"text-davinci-003":{description:"Can do any language task with better quality, longer output, and consistent instruction-following than the curie, babbage, or ada models. Also supports some additional features such as inserting text.",maxTokens:4096},"text-davinci-002":{description:"Similar capabilities to text-davinci-003 but trained with supervised fine-tuning instead of reinforcement learning.",maxTokens:4096},"code-davinci-002":{description:"Optimized for code-completion tasks.",maxTokens:8001},"gpt-4":{description:"More capable than any GPT-3.5 model, able to do more complex tasks, and optimized for chat. Will be updated with our latest model iteration 2 weeks after it is released.",maxTokens:8192},"gpt-4-0613":{description:"Snapshot of gpt-4 from June 13th 2023 with function calling data. Unlike gpt-4, this model will not receive updates, and will be deprecated 3 months after a new version is released.",maxTokens:8192},"gpt-4-32k":{description:"Same capabilities as the base gpt-4 mode but with 4x the context length. Will be updated with our latest model iteration.",maxTokens:32768},"gpt-4-32k-0613":{description:"Snapshot of gpt-4-32 from June 13th 2023. Unlike gpt-4-32k, this model will not receive updates, and will be deprecated 3 months after a new version is released.",maxTokens:32768}};for(const t in e)e[t].slug=t;return e},get openaiLicenseDefaultModel(){return this.openaiLicenseModels["gpt-3.5-turbo"]}})})(),(()=>{const{createComponentVNode:e}=n.$inferno,{$startup:t,$shortcut:o,$timer:a,$redactor:r,$creator:i,$dialog:s,$ui:l,$dev:c,$env:d,$idb:u,$badge:p,$store:h,$harpa:m,$mobx:g,$bus:y,$chromeApi:b,$critical:f,$tabs:w,$library:k,$shell:v,$utils:C,$logger:T,$settings:x,$peeker:S,$chrome:I,$netRules:A,$news:P,$welcome:E,$offscreen:$,$commands:R,$analytics:M}=n;t.controller={async init(){if(await f.controller.waitForReady(),y.controller.init(),"offscreen"===f.proxy.pageType)return a.controller.init(),await u.controller.init(),$.controller.init(),y.send("startup.offscreenReady"),void T.log("[$startup] offscreen ready");await this._waitForBgReady(),I.controller.init(),await A.controller.init(),await this._ifDesktop((()=>b.controller.init())),await u.controller.init(),await h.controller.init(),await w.controller.init(),P.controller.init(),r.controller.init(),p.controller.init(),k.controller.init(),S.controller.init(),i.controller.init(),s.controller.init(),R.controller.init(),E.controller.init(),o.controller.init(),c.controller.init(),await this._ifDesktop((()=>v.controller.init())),this._initTheme(),this._initScrollbars(),this._fixMacSecondMonitorRendering(),this._enableExtShortcutForFrame(),this._renderApp(),await this._ifDesktop((()=>this._updateFaviconOnSystemThemeChange())),await this._ifShellHeader((()=>y.send("startup.shellReady"))),M.controller.sendPageview(),T.dev(`[$startup] ${f.proxy.pageType} pp ready`)},async _ifDesktop(e){d.is.desktop&&await e()},async _ifShellHeader(e){"shell-header"===f.proxy.pageType&&await e()},_initTheme(){f.controller.shouldUseSystemTheme()?C.systemTheme.onChange((e=>{l.theme.setTheme(e,{ignoreLs:!0})}),!0):(l.theme.onThemeChange((e=>{h.transaction((t=>{t.theme=e}))})),g.reaction((()=>h.state.theme||"night"),(e=>l.theme.setTheme(e)),{fireImmediately:!0}))},_updateFaviconOnSystemThemeChange(){C.systemTheme.onChange((e=>{f.controller.updateFavicon(e)}))},_initScrollbars(){g.reaction((()=>x.proxy.showScrollbars),(e=>document.documentElement.classList.toggle("hideScrollbar",!e)),{fireImmediately:!0})},_renderApp(){l.mount(e(2,m.App),document.getElementById("root"))},_fixMacSecondMonitorRendering(){"popup"===f.proxy.pageType&&(window.screenLeft>=0&&window.screenTop>=0&&window.screenLeft<=window.screen.width&&window.screenTop<=window.screen.height||chrome.runtime.getPlatformInfo((e=>{if("mac"!==e.os)return;const t=new CSSStyleSheet;t.insertRule("@keyframes forceRedraw {  0% { opacity: 1; }  100% { opacity: .99; }}"),t.insertRule("html { animation: forceRedraw 1s linear infinite; }"),document.adoptedStyleSheets=[...document.adoptedStyleSheets,t]})))},_enableExtShortcutForFrame(){"popup"===f.proxy.pageType&&o.interceptor.init()},async _waitForBgReady(){await y.send("bg.isReady")||(await C.sleep(100),await this._waitForBgReady())}},d.is.test||t.controller.init()})()})();