(()=>{const e=!1,t="_actors_ifdt";let n=globalThis[t];(()=>{if(n)return;const r={};n=function t(n){const i={},s=new Proxy(n,{get:(o,a)=>"assign"===a?e=>{Object.assign(s,e)}:(a in n||(n[a]={},i[a]=t(n[a]),n===r&&e&&(globalThis[a]=n[a])),a in i?i[a]:n[a]),set:(t,s,o)=>(n[s]=o,i[s]=o,n===r&&e&&(globalThis[s]=n[s]),!0)});return s}(r),globalThis[t]=n,e&&(globalThis.app=r)})();const r=window.logger||window.console,i=(window.Audio,window.Blob),s=(window.CSSStyleSheet,window.CanvasRenderingContext2D,window.CustomEvent,window.DOMParser,window.Event,window.File,window.FileReader),o=(window.HTMLAnchorElement,window.HTMLElement,window.HTMLImageElement,window.HTMLVideoElement,window.Headers,window.Image,window.IntersectionObserver,window.MouseEvent,window.MutationObserver),a=window.Node,l=window.NodeFilter,c=window.NodeList,m=window.Request,h=(window.ResizeObserver,window.Response,window.SVGElement),u=window.URL,d=(window.WebSocket,window.Worker,window.XMLHttpRequest),p=window.XMLSerializer,f=window.XPathResult,g=(window.alert,window.atob,window.btoa,window.chrome,window.clearInterval,window.clearTimeout),y=window.document,_=window.fetch,b=window.getComputedStyle,w=(window.getSelection,window.history,window.indexedDB,window.location),v=window.navigator,E=(window.parent,window.requestAnimationFrame),x=(window.screen,window.setInterval,window.setTimeout),T=window.top;let N=null;try{N=window.localStorage}catch{}let S=null;try{S=window.sessionStorage}catch{}(()=>{const{$utils:e}=n;function t(e,n,r,i){if(i&&(e=i(e)),!e)return e;if("object"!=typeof e)return e;let s,o=Array.isArray(e)?[]:{};for(const a in e)e.hasOwnProperty(a)&&(s=e[a],n.has(s)?r.push({clone:o,key:a,value:s}):(n.set(s,!0),o[a]=t(s,n,r,i),n.set(s,o[a])));return o}e.cloneDeep=(e,n=null)=>{if(!n&&globalThis.structuredClone)return structuredClone(e);const r=new Map,i=[],s=t(e,r,i,n);return i.forEach((({clone:e,key:t,value:n})=>{e[t]=r.get(n)})),s}})(),(()=>{const{$utils:e}=n;e.createPromise=()=>{let e=null,t=null;const n=new Promise(((n,r)=>{e=n,t=r}));return n.__defineGetter__("resolve",(()=>e)),n.__defineGetter__("reject",(()=>t)),n}})(),(()=>{const{$utils:e}=n,t=[{name:"US Dollar",symbol:"$",symbolNative:"$",code:"USD",namePlural:"US dollars",alt:["US$","US $"]},{name:"Canadian Dollar",symbol:"CA$",symbolNative:"$",code:"CAD",namePlural:"Canadian dollars",alt:["CA $","CAN$","CAN $","C$"]},{name:"Euro",symbol:"€",symbolNative:"€",code:"EUR",namePlural:"euros"},{name:"United Arab Emirates Dirham",symbol:"AED",symbolNative:"د.إ.‏",code:"AED",namePlural:"UAE dirhams"},{name:"Afghan Afghani",symbol:"Af",symbolNative:"؋",code:"AFN",namePlural:"Afghan Afghanis"},{name:"Albanian Lek",symbol:"ALL",symbolNative:"Lek",code:"ALL",namePlural:"Albanian lekë"},{name:"Armenian Dram",symbol:"AMD",symbolNative:"դր.",code:"AMD",namePlural:"Armenian drams"},{name:"Argentine Peso",symbol:"AR$",symbolNative:"$",code:"ARS",namePlural:"Argentine pesos",alt:["AR $"]},{name:"Australian Dollar",symbol:"AU$",symbolNative:"$",code:"AUD",namePlural:"Australian dollars",alt:["AU $"]},{name:"Azerbaijani Manat",symbol:"₼",symbolNative:"ман.",code:"AZN",namePlural:"Azerbaijani manats"},{name:"Bosnia-Herzegovina Convertible Mark",symbol:"KM",symbolNative:"KM",code:"BAM",namePlural:"Bosnia-Herzegovina convertible marks"},{name:"Bangladeshi Taka",symbol:"Tk",symbolNative:"৳",code:"BDT",namePlural:"Bangladeshi takas"},{name:"Bulgarian Lev",symbol:"BGN",symbolNative:"лв.",code:"BGN",namePlural:"Bulgarian leva"},{name:"Bahraini Dinar",symbol:"BD",symbolNative:"د.ب.‏",code:"BHD",namePlural:"Bahraini dinars"},{name:"Burundian Franc",symbol:"FBu",symbolNative:"FBu",code:"BIF",namePlural:"Burundian francs"},{name:"Brunei Dollar",symbol:"BN$",symbolNative:"$",code:"BND",namePlural:"Brunei dollars",alt:["BN $"]},{name:"Bolivian Boliviano",symbol:"Bs",symbolNative:"Bs",code:"BOB",namePlural:"Bolivian bolivianos"},{name:"Brazilian Real",symbol:"R$",symbolNative:"R$",code:"BRL",namePlural:"Brazilian reals"},{name:"Botswanan Pula",symbol:"BWP",symbolNative:"P",code:"BWP",namePlural:"Botswanan pulas"},{name:"Belarusian Ruble",symbol:"Br",symbolNative:"руб.",code:"BYN",namePlural:"Belarusian rubles"},{name:"Belize Dollar",symbol:"BZ$",symbolNative:"$",code:"BZD",namePlural:"Belize dollars",alt:["BZ $"]},{name:"Congolese Franc",symbol:"CDF",symbolNative:"FrCD",code:"CDF",namePlural:"Congolese francs"},{name:"Swiss Franc",symbol:"CHF",symbolNative:"CHF",code:"CHF",namePlural:"Swiss francs"},{name:"Chilean Peso",symbol:"CL$",symbolNative:"$",code:"CLP",namePlural:"Chilean pesos",alt:["CL $"]},{name:"Chinese Yuan",symbol:"CN¥",symbolNative:"CN¥",code:"CNY",namePlural:"Chinese yuan"},{name:"Colombian Peso",symbol:"CO$",symbolNative:"$",code:"COP",namePlural:"Colombian pesos",alt:["CO $"]},{name:"Costa Rican Colón",symbol:"₡",symbolNative:"₡",code:"CRC",namePlural:"Costa Rican colóns"},{name:"Cape Verdean Escudo",symbol:"CV$",symbolNative:"CV$",code:"CVE",namePlural:"Cape Verdean escudos",alt:["CV $"]},{name:"Czech Republic Koruna",symbol:"Kč",symbolNative:"Kč",code:"CZK",namePlural:"Czech Republic korunas"},{name:"Djiboutian Franc",symbol:"Fdj",symbolNative:"Fdj",code:"DJF",namePlural:"Djiboutian francs"},{name:"Danish Krone",symbol:"Dkr",symbolNative:"kr",code:"DKK",namePlural:"Danish kroner"},{name:"Dominican Peso",symbol:"RD$",symbolNative:"RD$",code:"DOP",namePlural:"Dominican pesos",alt:["RD $"]},{name:"Algerian Dinar",symbol:"DA",symbolNative:"د.ج.‏",code:"DZD",namePlural:"Algerian dinars"},{name:"Estonian Kroon",symbol:"Ekr",symbolNative:"kr",code:"EEK",namePlural:"Estonian kroons"},{name:"Egyptian Pound",symbol:"EGP",symbolNative:"ج.م.‏",code:"EGP",namePlural:"Egyptian pounds"},{name:"Eritrean Nakfa",symbol:"Nfk",symbolNative:"Nfk",code:"ERN",namePlural:"Eritrean nakfas"},{name:"Ethiopian Birr",symbol:"Br",symbolNative:"Br",code:"ETB",namePlural:"Ethiopian birrs"},{name:"British Pound Sterling",symbol:"£",symbolNative:"£",code:"GBP",namePlural:"British pounds sterling"},{name:"Georgian Lari",symbol:"GEL",symbolNative:"GEL",code:"GEL",namePlural:"Georgian laris"},{name:"Ghanaian Cedi",symbol:"GH₵",symbolNative:"GH₵",code:"GHS",namePlural:"Ghanaian cedis"},{name:"Guinean Franc",symbol:"FG",symbolNative:"FG",code:"GNF",namePlural:"Guinean francs"},{name:"Guatemalan Quetzal",symbol:"GTQ",symbolNative:"Q",code:"GTQ",namePlural:"Guatemalan quetzals"},{name:"Hong Kong Dollar",symbol:"HK$",symbolNative:"$",code:"HKD",namePlural:"Hong Kong dollars",alt:["HK $"]},{name:"Honduran Lempira",symbol:"HNL",symbolNative:"L",code:"HNL",namePlural:"Honduran lempiras"},{name:"Croatian Kuna",symbol:"kn",symbolNative:"kn",code:"HRK",namePlural:"Croatian kunas"},{name:"Hungarian Forint",symbol:"Ft",symbolNative:"Ft",code:"HUF",namePlural:"Hungarian forints"},{name:"Indonesian Rupiah",symbol:"Rp",symbolNative:"Rp",code:"IDR",namePlural:"Indonesian rupiahs"},{name:"Israeli New Sheqel",symbol:"₪",symbolNative:"₪",code:"ILS",namePlural:"Israeli new sheqels"},{name:"Indian Rupee",symbol:"Rs",symbolNative:"টকা",code:"INR",namePlural:"Indian rupees"},{name:"Iraqi Dinar",symbol:"IQD",symbolNative:"د.ع.‏",code:"IQD",namePlural:"Iraqi dinars"},{name:"Iranian Rial",symbol:"IRR",symbolNative:"﷼",code:"IRR",namePlural:"Iranian rials"},{name:"Icelandic Króna",symbol:"Ikr",symbolNative:"kr",code:"ISK",namePlural:"Icelandic krónur"},{name:"Jamaican Dollar",symbol:"J$",symbolNative:"$",code:"JMD",namePlural:"Jamaican dollars"},{name:"Jordanian Dinar",symbol:"JD",symbolNative:"د.أ.‏",code:"JOD",namePlural:"Jordanian dinars"},{name:"Japanese Yen",symbol:"¥",symbolNative:"￥",code:"JPY",namePlural:"Japanese yen"},{name:"Kenyan Shilling",symbol:"Ksh",symbolNative:"Ksh",code:"KES",namePlural:"Kenyan shillings"},{name:"Cambodian Riel",symbol:"KHR",symbolNative:"៛",code:"KHR",namePlural:"Cambodian riels"},{name:"Comorian Franc",symbol:"CF",symbolNative:"FC",code:"KMF",namePlural:"Comorian francs"},{name:"South Korean Won",symbol:"₩",symbolNative:"₩",code:"KRW",namePlural:"South Korean won"},{name:"Kuwaiti Dinar",symbol:"KD",symbolNative:"د.ك.‏",code:"KWD",namePlural:"Kuwaiti dinars"},{name:"Kazakhstani Tenge",symbol:"KZT",symbolNative:"тңг.",code:"KZT",namePlural:"Kazakhstani tenges"},{name:"Lebanese Pound",symbol:"LB£",symbolNative:"ل.ل.‏",code:"LBP",namePlural:"Lebanese pounds"},{name:"Sri Lankan Rupee",symbol:"SLRs",symbolNative:"SL Re",code:"LKR",namePlural:"Sri Lankan rupees"},{name:"Lithuanian Litas",symbol:"Lt",symbolNative:"Lt",code:"LTL",namePlural:"Lithuanian litai"},{name:"Libyan Dinar",symbol:"LD",symbolNative:"د.ل.‏",code:"LYD",namePlural:"Libyan dinars"},{name:"Moroccan Dirham",symbol:"MAD",symbolNative:"د.م.‏",code:"MAD",namePlural:"Moroccan dirhams"},{name:"Moldovan Leu",symbol:"MDL",symbolNative:"MDL",code:"MDL",namePlural:"Moldovan lei"},{name:"Malagasy Ariary",symbol:"MGA",symbolNative:"MGA",code:"MGA",namePlural:"Malagasy Ariaries"},{name:"Macedonian Denar",symbol:"MKD",symbolNative:"MKD",code:"MKD",namePlural:"Macedonian denari"},{name:"Myanma Kyat",symbol:"MMK",symbolNative:"K",code:"MMK",namePlural:"Myanma kyats"},{name:"Macanese Pataca",symbol:"MOP$",symbolNative:"MOP$",code:"MOP",namePlural:"Macanese patacas",alt:["MOP $"]},{name:"Mauritian Rupee",symbol:"MURs",symbolNative:"MURs",code:"MUR",namePlural:"Mauritian rupees"},{name:"Mexican Peso",symbol:"MX$",symbolNative:"$",code:"MXN",namePlural:"Mexican pesos",alt:["MX $"]},{name:"Malaysian Ringgit",symbol:"RM",symbolNative:"RM",code:"MYR",namePlural:"Malaysian ringgits"},{name:"Mozambican Metical",symbol:"MTn",symbolNative:"MTn",code:"MZN",namePlural:"Mozambican meticals"},{name:"Namibian Dollar",symbol:"N$",symbolNative:"N$",code:"NAD",namePlural:"Namibian dollars"},{name:"Nigerian Naira",symbol:"₦",symbolNative:"₦",code:"NGN",namePlural:"Nigerian nairas"},{name:"Nicaraguan Córdoba",symbol:"C$",symbolNative:"C$",code:"NIO",namePlural:"Nicaraguan córdobas"},{name:"Norwegian Krone",symbol:"Nkr",symbolNative:"kr",code:"NOK",namePlural:"Norwegian kroner"},{name:"Nepalese Rupee",symbol:"NPRs",symbolNative:"नेरू",code:"NPR",namePlural:"Nepalese rupees"},{name:"New Zealand Dollar",symbol:"NZ$",symbolNative:"$",code:"NZD",namePlural:"New Zealand dollars",alt:["NZ $"]},{name:"Omani Rial",symbol:"OMR",symbolNative:"ر.ع.‏",code:"OMR",namePlural:"Omani rials"},{name:"Panamanian Balboa",symbol:"B/.",symbolNative:"B/.",code:"PAB",namePlural:"Panamanian balboas"},{name:"Peruvian Nuevo Sol",symbol:"S/.",symbolNative:"S/.",code:"PEN",namePlural:"Peruvian nuevos soles"},{name:"Philippine Peso",symbol:"₱",symbolNative:"₱",code:"PHP",namePlural:"Philippine pesos"},{name:"Pakistani Rupee",symbol:"PKRs",symbolNative:"₨",code:"PKR",namePlural:"Pakistani rupees"},{name:"Polish Zloty",symbol:"zł",symbolNative:"zł",code:"PLN",namePlural:"Polish zlotys"},{name:"Paraguayan Guarani",symbol:"₲",symbolNative:"₲",code:"PYG",namePlural:"Paraguayan guaranis"},{name:"Qatari Rial",symbol:"QR",symbolNative:"ر.ق.‏",code:"QAR",namePlural:"Qatari rials"},{name:"Romanian Leu",symbol:"RON",symbolNative:"RON",code:"RON",namePlural:"Romanian lei"},{name:"Serbian Dinar",symbol:"din.",symbolNative:"дин.",code:"RSD",namePlural:"Serbian dinars"},{name:"Russian Ruble",symbol:"RUB",symbolNative:"₽.",code:"RUB",namePlural:"Russian rubles"},{name:"Rwandan Franc",symbol:"RWF",symbolNative:"FR",code:"RWF",namePlural:"Rwandan francs"},{name:"Saudi Riyal",symbol:"SR",symbolNative:"ر.س.‏",code:"SAR",namePlural:"Saudi riyals"},{name:"Sudanese Pound",symbol:"SDG",symbolNative:"SDG",code:"SDG",namePlural:"Sudanese pounds"},{name:"Swedish Krona",symbol:"Skr",symbolNative:"kr",code:"SEK",namePlural:"Swedish kronor"},{name:"Singapore Dollar",symbol:"S$",symbolNative:"$",code:"SGD",namePlural:"Singapore dollars"},{name:"Somali Shilling",symbol:"Ssh",symbolNative:"Ssh",code:"SOS",namePlural:"Somali shillings"},{name:"Syrian Pound",symbol:"SY£",symbolNative:"ل.س.‏",code:"SYP",namePlural:"Syrian pounds"},{name:"Thai Baht",symbol:"฿",symbolNative:"฿",code:"THB",namePlural:"Thai baht"},{name:"Tunisian Dinar",symbol:"DT",symbolNative:"د.ت.‏",code:"TND",namePlural:"Tunisian dinars"},{name:"Tongan Paʻanga",symbol:"T$",symbolNative:"T$",code:"TOP",namePlural:"Tongan paʻanga",alt:["T $"]},{name:"Turkish Lira",symbol:"₺",symbolNative:"₺",code:"TRY",namePlural:"Turkish Lira"},{name:"Trinidad and Tobago Dollar",symbol:"TT$",symbolNative:"$",code:"TTD",namePlural:"Trinidad and Tobago dollars",alt:["TT $"]},{name:"New Taiwan Dollar",symbol:"NT$",symbolNative:"NT$",code:"TWD",namePlural:"New Taiwan dollars",alt:["NT $"]},{name:"Tanzanian Shilling",symbol:"TSh",symbolNative:"TSh",code:"TZS",namePlural:"Tanzanian shillings"},{name:"Ukrainian Hryvnia",symbol:"₴",symbolNative:"₴",code:"UAH",namePlural:"Ukrainian hryvnias"},{name:"Ugandan Shilling",symbol:"USh",symbolNative:"USh",code:"UGX",namePlural:"Ugandan shillings"},{name:"Uruguayan Peso",symbol:"$U",symbolNative:"$",code:"UYU",namePlural:"Uruguayan pesos"},{name:"Uzbekistan Som",symbol:"UZS",symbolNative:"UZS",code:"UZS",namePlural:"Uzbekistan som"},{name:"Venezuelan Bolívar",symbol:"Bs.F.",symbolNative:"Bs.F.",code:"VEF",namePlural:"Venezuelan bolívars"},{name:"Vietnamese Dong",symbol:"₫",symbolNative:"₫",code:"VND",namePlural:"Vietnamese dong"},{name:"CFA Franc BEAC",symbol:"FCFA",symbolNative:"FCFA",code:"XAF",namePlural:"CFA francs BEAC"},{name:"CFA Franc BCEAO",symbol:"CFA",symbolNative:"CFA",code:"XOF",namePlural:"CFA francs BCEAO"},{name:"Yemeni Rial",symbol:"YR",symbolNative:"ر.ي.‏",code:"YER",namePlural:"Yemeni rials"},{name:"South African Rand",symbol:"R",symbolNative:"R",code:"ZAR",namePlural:"South African rand"},{name:"Zambian Kwacha",symbol:"ZK",symbolNative:"ZK",code:"ZMK",namePlural:"Zambian kwachas"},{name:"Zimbabwean Dollar",symbol:"ZWL$",symbolNative:"ZWL$",code:"ZWL",namePlural:"Zimbabwean Dollar",alt:["ZWL $"]}],r={};t.forEach((e=>{const t=e.symbolNative;t.endsWith(".")&&(e.symbolNative=t.substr(0,t.length-1)),r[e.code]=e}));e.currency={list:t,byCode:r,formatCurrency:(t,n="name")=>{const r=t.indexOf(":"),i=-1===r?t:t.substr(r+1);return e.currency.byCode[i]?.[n]||t}}})(),(()=>{const{$utils:e}=n;e.ensureArray=e=>Array.isArray(e)?e:[e]})(),(()=>{const{$utils:e}=n;e.is={undefined:e=>void 0===e,defined:e=>void 0!==e,null:e=>null===e,nil:e=>null==e,array:e=>Array.isArray(e),object:e=>"[object Object]"===Object.prototype.toString.call(e),nan:e=>Number.isNaN(e),number:e=>"number"==typeof e,function:e=>"function"==typeof e,set:e=>e instanceof Set,map:e=>e instanceof Map,url:e=>e instanceof u,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,symbol:e=>"symbol"==typeof e,regexp:e=>e instanceof RegExp,blob:e=>e instanceof i}})(),(()=>{const{$utils:e}=n;e.mutation={addedNodes:e=>{const t=new Set,n=e=>{if(!t.has(e)){t.add(e);for(const t of e.childNodes)n(t)}};for(const t of e)for(const e of t.addedNodes)n(e);return Array.from(t)},addedElements:e=>{const t=new Set,n=e=>{if(e.nodeType===Element.ELEMENT_NODE&&!t.has(e)){t.add(e);for(const t of e.children)n(t)}};for(const t of e)for(const e of t.addedNodes)n(e);return Array.from(t)},removedNodes:e=>{const t=new Set,n=e=>{if(!t.has(e)){t.add(e);for(const t of e.childNodes)n(t)}};for(const t of e)for(const e of t.removedNodes)n(e);return Array.from(t)},removedElements:e=>{const t=new Set,n=e=>{if(e.nodeType===Element.ELEMENT_NODE&&!t.has(e)){t.add(e);for(const t of e.children)n(t)}};for(const t of e)for(const e of t.removedNodes)n(e);return Array.from(t)},on:(e,t,n)=>{if(!n&&(n=t,t=e,e=null,!n&&(n=t,t=null,!n)))throw new Error("$utils.mutation.on listener must be specified");if(e=e||y.documentElement,"string"==typeof(t=t||{childList:!0,subtree:!0}))t={[t]:!0};else if(Array.isArray(t)){const e={};t.forEach((t=>e[t]=!0)),t=e}const r=new o(n);return r.observe(e,t),r},off:e=>{e.disconnect()}}})(),(()=>{const{$utils:e}=n;e.noThrow=(e,t=null)=>{if(!e)return;let n;try{n=e()}catch{n=t}return n instanceof Promise?new Promise((async e=>{try{n=await n}catch{n=t}e(n)})):n}})(),(()=>{const{$utils:e}=n;e.occurrences={regex:(t,n)=>("string"==typeof n&&(n=n.split("\n")),0===(n=e.ensureArray(n)).length?0:(n=n.map((t=>e.string.toRegex(t))).filter((e=>!!e))).reduce(((e,n)=>e+(t.match(n)||[]).length),0)),string(e,t,n=!1){if(t.length<=0)return e.length+1;let r=0,i=0,s=n?1:t.length;for(;i=e.indexOf(t,i),i>=0;)++r,i+=s;return r}}})(),(()=>{const{$utils:e}=n,t=e=>{if(null==e)return e;return("string"!=typeof e?String(e):e).length>0?`${e[0].toLowerCase()}${e.substring(1)}`:""},r=e=>{if(null==e)return e;return("string"!=typeof e?String(e):e).replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};e.string={shorten:(e,t=40,n="",r="…")=>{if(null==e)return n;const i="string"!=typeof e?String(e):e;return i.length>t?i.substr(0,t)+r:i},toCamelCase:(e,n=" -_")=>{if(null==e)return e;n=r(n);const i=new RegExp(`[${n}]+`,"g");let s="string"!=typeof e?String(e):e;return s=s.split(i).map((e=>e[0].toUpperCase()+e.substr(1))).join(""),s=t(s),s},toKebabCase:(e,t="-_",n=!1)=>{let r=String(e);return n||(r=r.replace(/(\p{Ll})(\p{Lu})/gu,"$1-$2")),r.toLowerCase().replace(new RegExp(`[${t}]+`,"g")," ").trim().replaceAll(" ","-")},toCapitalFirst:e=>{if(null==e)return e;return("string"!=typeof e?String(e):e).length>0?`${e[0].toUpperCase()}${e.substring(1)}`:""},toLowerFirst:t,containsInMiddle:(e,t)=>{const n=e.indexOf(t);return-1!==n&&0!==n&&n!==e.length-t.length},escapeRegExp:r,toRegex:(e,t="gi")=>{if(null==e)return e;if(e instanceof RegExp)return e;if("string"!=typeof e||0===e.length)return null;if(e.startsWith("/")&&-1!==e.indexOf("/",2))try{const t=e.replace(/.*\/([gimy]*)$/,"$1"),n=e.replace(new RegExp("^/(.*?)/"+t+"$"),"$1");return RegExp(n,t)}catch(e){}return e=r(e),new RegExp(e,t)},incrementNumberSuffix:e=>{if(null==e)return e;const t="string"!=typeof e?String(e):e;let n=t.match(/ #(\d+)$/)||t.match(/ (\d+)$/);if(!n)return`${t} #2`;const r=Number(n[1])||1,i=n[0].includes("#")?"#":"";return`${t.substr(0,n.index)} ${i}${r+1}`},empty:e=>0===e.trim().length,rotate:(e,t=1)=>{const n=e.length;return t>0?e.substring(t,n)+e.substring(0,t):e.substring(n+t,n)+e.substring(0,n+t)}}})(),(()=>{const{$utils:e}=n;e.sleep=async e=>new Promise((t=>{x(t,e)}))})(),(()=>{const{$utils:e}=n;e.canvasToBlob=async(e,t="image/webp",n=.9)=>await new Promise(((r,i)=>{try{e.toBlob((t=>{t?r(t):0===e.width||0===e.height?i("canvas.toBlob failed, canvas has no dimensions"):i("canvas.toBlob failed")}),t,n)}catch(e){i(e)}}))})(),(()=>{const{$utils:e}=n;e.maxZIndex=2147483647})(),(()=>{const{$utils:e}=n;e.raf=async(t=1)=>{0!==t&&(await new Promise((e=>E(e))),await e.raf(t-1))}})(),(()=>{const{$engine:e,$utils:t}=n;e.extractor={extract(e){this.init();const t=this._cache.get(e);if(t)return t;let n={value:e,template:null,items:[]};return n.value.match(/\d/)&&(n=this._parseTime(n),n=this._parseDuration(n),n=this._parseCopyright(n),n=this._parseDate(n,this.config.regex.date_triplex,!0),n=this._parseDate(n,this.config.regex.date_dmy,!0),n=this._parseDate(n,this.config.regex.date_mdy,!0),n=this._parseDate(n,this.config.regex.date_my,!0),n.value=e,n=this._parseNumber(n),n=this._mergeNumbers(n),n=this._cleanSourceMetrics(n)),this._maskItemsInValue(n),n=this._parseCurrency(n),this._maskItemsInValue(n,"currency"),n.template=this._replaceMask(n.value),n.value=e,n.items=n.items.sort(((e,t)=>e.index-t.index)),this._cache.set(e,n),n},config:{currencies:t.currency.list,time:{millisecond:1,second:1e3,minute:6e4,hour:36e5},monthsMap:{},currenciesMap:{},metricsMap:{"μs":{to:"ms",mult:.001},microsecond:{to:"ms",mult:.001},microseconds:{to:"ms",mult:.001},ms:{to:"ms",mult:1},millisecond:{to:"ms",mult:1},milliseconds:{to:"ms",mult:1},s:{to:"ms",mult:1e3},second:{to:"ms",mult:1e3},seconds:{to:"ms",mult:1e3},m:{to:"ms",mult:6e4},min:{to:"ms",mult:6e4},minute:{to:"ms",mult:6e4},minutes:{to:"ms",mult:6e4},h:{to:"ms",mult:36e5},hour:{to:"ms",mult:36e5},hours:{to:"ms",mult:36e5},d:{to:"ms",mult:864e5},day:{to:"ms",mult:864e5},days:{to:"ms",mult:864e5},w:{to:"ms",mult:6048e5},week:{to:"ms",mult:6048e5},weeks:{to:"ms",mult:6048e5},mo:{to:"ms",mult:2592e6},month:{to:"ms",mult:2592e6},months:{to:"ms",mult:2592e6},y:{to:"ms",mult:31536e6},year:{to:"ms",mult:31536e6},years:{to:"ms",mult:31536e6},"μm":{to:"meters",mult:1e-6},micrometre:{to:"meters",mult:1e-6},micrometer:{to:"meters",mult:1e-6},micrometres:{to:"meters",mult:1e-6},micrometers:{to:"meters",mult:1e-6},mm:{to:"meters",mult:.001},millimetre:{to:"meters",mult:.001},millimeter:{to:"meters",mult:.001},millimetres:{to:"meters",mult:.001},millimeters:{to:"meters",mult:.001},cm:{to:"meters",mult:.01},centimetre:{to:"meters",mult:.01},centimeter:{to:"meters",mult:.01},centimetres:{to:"meters",mult:.01},centimeters:{to:"meters",mult:.01},dm:{to:"meters",mult:.1},decimetre:{to:"meters",mult:.01},decimeter:{to:"meters",mult:.01},decimetres:{to:"meters",mult:.01},decimeters:{to:"meters",mult:.01},metre:{to:"meters",mult:1},metres:{to:"meters",mult:1},meter:{to:"meters",mult:1},meters:{to:"meters",mult:1},km:{to:"meters",mult:1e3},kilometre:{to:"meters",mult:1e3},kilometer:{to:"meters",mult:1e3},kilometres:{to:"meters",mult:1e3},kilometers:{to:"meters",mult:1e3},inch:{to:"meters",mult:.0254},inches:{to:"meters",mult:.0254},foot:{to:"meters",mult:.3048},feet:{to:"meters",mult:.3048},yard:{to:"meters",mult:.9144},yards:{to:"meters",mult:.9144},mile:{to:"meters",mult:1609.344},miles:{to:"meters",mult:1609.344},"μg":{to:"grams",mult:1e-6},microgram:{to:"grams",mult:1e-6},micrograms:{to:"grams",mult:1e-6},mg:{to:"grams",mult:.001},milligram:{to:"grams",mult:.001},milligrams:{to:"grams",mult:.001},g:{to:"grams",mult:1},gram:{to:"grams",mult:1},grams:{to:"grams",mult:1},kg:{to:"grams",mult:1e3},kilogram:{to:"grams",mult:1e3},kilograms:{to:"grams",mult:1e3},tonne:{to:"grams",mult:1e6},tonnes:{to:"grams",mult:1e6},oz:{to:"grams",mult:28.349523125},ounce:{to:"grams",mult:28.349523125},ounces:{to:"grams",mult:28.349523125},lb:{to:"grams",mult:453.59237},pound:{to:"grams",mult:453.59237},pounds:{to:"grams",mult:453.59237},byte:{to:"bytes",mult:1},bytes:{to:"bytes",mult:1},kb:{to:"bytes",mult:1e3},kilobyte:{to:"bytes",mult:1e3},kilobytes:{to:"bytes",mult:1e3},mb:{to:"bytes",mult:1e6},megabyte:{to:"bytes",mult:1e6},megabytes:{to:"bytes",mult:1e6},gb:{to:"bytes",mult:1e9},gigabyte:{to:"bytes",mult:1e9},gigabytes:{to:"bytes",mult:1e9},tb:{to:"bytes",mult:1e12},terabyte:{to:"bytes",mult:1e12},terabytes:{to:"bytes",mult:1e12},pb:{to:"bytes",mult:1e15},petabyte:{to:"bytes",mult:1e15},petabytes:{to:"bytes",mult:1e15},"%":{to:"%",mult:1},percent:{to:"%",mult:1}},regex:{delimiter:/^(,\s|,|\s| and )$/gi,number:/LA(?<content>(?:(?<currency>CURRENCY)\s?)?(?<sign>>|~|\+|±|-|\+-|-\+)?(?<value>(?<integer>\d+(?:(?: \d\d\d)*|(?:,\d\d\d)*|(?:\.\d\d\d)*))(?<decimal>[,.]\d+)?(?<multiplier>(k|m|b|t| ?thousands?| ?millions?| ?billions?| ?trillions?)(?!\w))?\+?)(?:[ -]?(?<metric>METRIC|CURRENCY))?)LB/gim,time:/LA(?<content>((?<hours>\d?\d):)?(?<minutes>\d?\d):(?<seconds>\d\d)(?:.(?<ms>\d?\d?\d))?\s*(?<ampm>am|pm|a\.m\.|p\.m\.)?)LB/gim,duration:/LA(?<content>(?:(?<hours>\d+):)?(?<minutes>\d?\d):(?<seconds>\d\d)(?:.(?<ms>\d?\d?\d))?)LB/gim,copyright:/LA(?<content>(?:©|\(c\))\s(?<year>(\d\d)?\d\d))LB/gim,date_triplex:/LA(?<content>(?<date>\d?\d)(?<sep1>[/.])(?<month>\d?\d)((?<sep2>[/.])(?<year>(\d?\d?\d\d)))?)LB/gim,date_dmy:/LA(?<content>(?<date>\d?\d)(?:st|nd|rd|th)?(?:[ -]| of )(?<month>MONTH)((, |,| |-)(?<year>\d?\d?\d\d)?)?)LB/gim,date_mdy:/LA(?<content>(?<month>MONTH)(?: |-| the )(?<date>\d?\d)(?:st|nd|rd|th)?((?:, |,| |-)(?<year>\d?\d?\d\d)?)?)LB/gim,date_my:/LA(?<content>(?<month>MONTH)((?:, |,| |-| of )(?<year>\d?\d?\d\d)))LB/gim,currency:/LA(?<content>CURRENCY)LB/gim}},init(){this._initialized||(this._initialized=!0,this._cache=new Map,this._maskCache=[],this._ensureReplaceAllPolyfill(),this._enrichConfigWithMonths(),this._enrichConfigWithCurrencies(),this._enrichRegexes("LA",/(?<=^|\s|\w-|\w\/|"|'|\()/),this._enrichRegexes("LB",/(?=\/\w|°|-\w|\s|\W\s|\W$|\)|$)/),this._parseNumber=this._createRegexParser(this._parseNumber,this.config.regex.number),this._parseTime=this._createRegexParser(this._parseTime,this.config.regex.time),this._parseDuration=this._createRegexParser(this._parseDuration,this.config.regex.duration),this._parseCopyright=this._createRegexParser(this._parseCopyright,this.config.regex.copyright),this._parseDate=this._createRegexParser(this._parseDate,this.config.regex.date_triplex),this._parseCurrency=this._createRegexParser(this._parseCurrency,this.config.regex.currency))},_ensureReplaceAllPolyfill(){String.prototype.replaceAll||(String.prototype.replaceAll=function(e,t){return"[object regexp]"===Object.prototype.toString.call(e).toLowerCase()?this.replace(e,t):this.replace(new RegExp(e,"g"),t)})},_enrichConfigWithMonths(){let e=["en"];if(globalThis.navigator){const t=v.languages;t&&e.push(...t)}if(globalThis.document?.documentElement){const t=y.documentElement.getAttribute("lang");t&&e.push(t)}let t=[];e=Array.from(new Set(e)),e.forEach((e=>{try{[...this._getMonthList(e,"short"),...this._getMonthList(e,"long")].forEach(((e,n)=>{e=e.toLowerCase(),void 0===this.config.monthsMap[e]&&(this.config.monthsMap[e]=n%12,t.push(e))}))}catch{}})),t=t.join("|"),this._enrichRegexes("MONTH",t)},_enrichConfigWithCurrencies(){let e=["$","USD","kr"],t="all,lvl,try,top,bob,pen,php,af,fc,fr,bs,km,rm,qr,tl,ft,jd,k,r,p,l,q";t=new Set(t.split(",")),this.config.currenciesMap={$:"USD",USD:"USD",kr:"SEK"};const n=(n,r)=>{this.config.currenciesMap[n]||t.has(n)||(this.config.currenciesMap[n]=r,e.push(n))};this.config.currencies.forEach((e=>{n(e.code.toLowerCase(),e.code),n(e.name.toLowerCase(),e.code),n(e.namePlural.toLowerCase(),e.code),n(e.symbol.toLowerCase(),e.code),n(e.symbolNative.toLowerCase(),e.code),(e.alt||[]).forEach((t=>n(t.toLowerCase(),e.code)))})),e=e.map((e=>e.replace("$","\\$").replace(".","\\."))).join("|"),this._enrichRegexes("CURRENCY",e);const r=Object.keys(this.config.metricsMap).join("|");this._enrichRegexes("METRIC",r)},_enrichRegexes(e,t){"[object regexp]"===Object.prototype.toString.call(t).toLowerCase()&&(t=t.source),Object.keys(this.config.regex).forEach((n=>{this.config.regex[n].source.includes(e)&&(this.config.regex[n]=new RegExp(this.config.regex[n].source.replaceAll(e,t),this.config.regex[n].flags))}))},_getMonthList:(e="en",t="long")=>"auto"===e?[]:Array.from(Array(12).keys(),(n=>Intl.DateTimeFormat(e,{month:{s:"short",n:"numeric"}[t[0]]||"long"}).format(new Date(0,n)))),_createRegexParser(e,t){const n=t;return function({value:t,items:r},i,s=!1){const o=Array.from(t.matchAll(i||n)).filter((e=>e.groups));return 0===o.length?arguments[0]:(o.forEach((n=>{let i=e(n,this.config);i&&(i=Array.isArray(i)?i:[i],0!==i.length&&(i.forEach((e=>{e.hasOwnProperty("content")||(e.content=n.groups.content),e.hasOwnProperty("index")||(e.index=n.index)})),r=[...r,...i],s&&(t=this._replaceMatch(t,n))))})),{value:t,items:r})}},_replaceMatch(e,t,n="#"){const r=t.groups.content,i=t.index+t.input.substr(t.index).indexOf(r),s=e.slice(0,i),o=e.slice(i+r.length);return s+n.repeat(r.length)+o},_parseTime(e,t){let n=Number(e.groups.hours),r=Number(e.groups.minutes),i=Number(e.groups.seconds);const s=e.groups.ms?1e3*Number("0."+e.groups.ms):0;Number.isNaN(n)&&(n=r,r=i,i=0);const o=(e.groups.ampm||"").toLowerCase().replaceAll(/\./g,"").trim();return o&&n>12?null:("am"===o?12===n&&(n=0):"pm"===o&&n<12&&(n+=12),{type:"time",value:s*t.time.millisecond+i*t.time.second+r*t.time.minute+n*t.time.hour,content:e.groups.content,index:e.index})},_parseDuration(e,t){const n=Number(e.groups.hours)||0,r=Number(e.groups.minutes)||0,i=Number(e.groups.seconds)||0;return{type:"number",value:(e.groups.ms?1e3*Number("0."+e.groups.ms):0)*t.time.millisecond+i*t.time.second+r*t.time.minute+n*t.time.hour,metric:"ms"}},_parseCopyright(e){const t=Number(e.groups.year);return Number.isNaN(t)?null:{type:"copyright",value:t}},_parseDate(e,t){if(e.groups.sep1&&e.groups.sep2&&e.groups.sep1!==e.groups.sep2)return null;let n=e.groups.date?Number(e.groups.date):1,r=e.groups.month;if(e.groups.sep1)"/"===e.groups.sep1&&([r,n]=[n,r]),r>12&&([r,n]=[n,r]),r-=1;else if(r=t.monthsMap[e.groups.month.toLowerCase()],void 0===r)return null;if(Number.isNaN(n)||n<1||n>31)return null;if(Number.isNaN(r)||r<0||r>11)return null;let i=Number(e.groups.year||(new Date).getFullYear());if(i<100){const e=(new Date).getFullYear();i=Number(e.toString().substr(0,2)+i),i>e&&(i-=100)}const s=new Date(Date.UTC(i,r,n));return{type:"date",value:s.getTime(),date:s}},_parseNumber(e,t){let{integer:n,decimal:r,sign:i,multiplier:s,currency:o,metric:a}=e.groups;o=o&&o.toLowerCase(),a=a&&a.toLowerCase(),r=r||"";const l={type:"number"},c=[l];if(4===r.length&&n.length<4&&(n+=r,r=""),!r.startsWith(",")||4!==r.length||n.includes(".")||n.includes(" ")||(n+=r,r=""),n=n.replaceAll(/[ ,.]/g,""),r=r.replaceAll(/[ ,.]/g,"."),l.value=Number(n+r),"-"===i&&(l.value*=-1),s=s?s.toLowerCase():s||"","k"===s||s.includes("thousand")?l.value*=1e3:"m"===s||s.includes("million")?l.value*=1e6:"b"===s||s.includes("billion")?l.value*=1e9:("t"===s||s.includes("trillion"))&&(l.value*=1e12),l.value=parseFloat(l.value.toFixed(6)),(o||a)&&(l.metric=o||a),"m"===s&&!a&&l.value%1e6==0){const e={...l};e.value/=1e6,e.metric="minutes",c.push(e);const t={...l};t.value/=1e6,t.metric="meters",c.push(t)}return c.filter((e=>e.metric)).forEach((e=>{const n=e.metric;t.currenciesMap[n]?(e.type="price",e.sourceMetric=n,e.metric="CUR:"+t.currenciesMap[n]):(e.sourceMetric=n,e.metric=t.metricsMap[n].to,e.value=e.value*t.metricsMap[n].mult)})),c},_mergeNumbers(e){if(e.items.length<2)return e;let t=!1;const n={};return e.items.forEach(((e,r)=>{e.metric&&"number"!==!e.type&&(n[e.metric]=n[e.metric]||[],n[e.metric].push({item:e,index:r}),n[e.metric].length>1&&(t=!0))})),t?(Object.values(n).forEach((t=>{let n=[];const r=()=>{if(n.length<2)n=[];else for(let t=1;t<n.length;t++){const r=n[t],i=n[t-1];e.items[n[0].index].value+=r.item.value,e.items[n[0].index].content=e.items[n[0].index].content+e.value.substring(i.item.index+i.item.content.length,r.item.index)+r.item.content,e.items[r.index]=null}};n.push(t[0]);for(let i=1;i<t.length;i++){const s=t[i-1],o=t[i];s.item.sourceMetric!==o.item.sourceMetric&&this.config.metricsMap[s.item.sourceMetric]?.mult>this.config.metricsMap[o.item.sourceMetric]?.mult&&e.value.substring(s.item.index+s.item.content.length,o.item.index).match(this.config.regex.delimiter)?n.push(o):(r(),n.push(o))}r()})),e.items=e.items.filter((e=>Boolean(e))),e):e},_cleanSourceMetrics:e=>(e.items.forEach((e=>{e.sourceMetric&&delete e.sourceMetric})),e),_parseCurrency(e,t){const{content:n}=e.groups;return{type:"currency",value:"CUR:"+t.currenciesMap[n.toLowerCase()]}},_maskItemsInValue(e,t=null){let n=e.value,r=e.items;if(t&&(r=r.filter((e=>e.type===t))),0===r.length)return n.trim();r.forEach((e=>{const t=n.substr(0,e.index),r=n.substr(e.index+e.content.length);let i=this._maskCache[e.content.length];i||(i="҉".repeat(e.content.length),this._maskCache[e.content.length]=i),n=t+i+r})),e.value=n},_replaceMask:(e,t="{{data}}")=>e.replace(/҉+/gi,t).trim()}})(),(()=>{const{$engine:e}=n;e.noIdleCommands=["idle","wait","reload"]})(),(()=>{const{$engine:e}=n;function t(e){let t=e.parentNode;for(;t;){if("TABLE"===t.nodeName)return(t.getAttribute("role")||"").split(" ").includes("grid");t=t.parentNode}return!1}e.tagsToRoles={A:e=>e.hasAttribute("href")?"link":null,AREA:e=>e.hasAttribute("href")?"link":null,ARTICLE:"article",ASIDE:"complementary",BUTTON:"button",DATALIST:"listbox",DD:"definition",DFN:"term",DETAILS:"group",DIALOG:"dialog",DT:"term",FIELDSET:"group",FIGURE:"figure",FOOTER:t=>{const n=["ARTICLE","ASIDE","MAIN","NAV","SECTION"],r=["article","complementary","main","navigation","region"];let i=t.parentElement;for(;i;){if(n.includes(i.nodeName))return null;if(r.includes(e.inspector.role(i)))return null;i=i.parentElement}return"contentinfo"},FORM:"form",H1:"heading",H2:"heading",H3:"heading",H4:"heading",H5:"heading",H6:"heading",HEADER:t=>{const n=["ARTICLE","ASIDE","MAIN","NAV","SECTION"],r=["article","complementary","main","navigation","region"];let i=t.parentElement;for(;i&&i!==y.documentElement;){if(n.includes(i.nodeName))return null;if(r.includes(e.inspector.role(i)))return null;i=i.parentElement}return"banner"},HR:"separator",HTML:"document",IMG:e=>""===e.getAttribute("alt")?"presentation":"img",INPUT:e=>{const t=e.getAttribute("type");return e.hasAttribute("list")&&[null,"text","search","tel","url","email"].includes(t)?"combobox":"button"===t?"button":"checkbox"===t?"checkbox":"email"===t?"textbox":"image"===t?"button":"number"===t?"spinbutton":"radio"===t?"radio":"range"===t?"slider":"reset"===t?"button":"search"===t?"searchbox":"submit"===t?"button":"tel"===t||"text"===t||"url"===t?"textbox":null},LI:"listitem",MAIN:"main",MATH:"math",MENU:"list",NAV:"navigation",OL:"list",OPTGROUP:"group",OPTION:"option",OUTPUT:"status",PROGRESS:"progressbar",SECTION:"region",SELECT:e=>e.hasAttribute("multiple")||Number(e.getAttribute("size"))>1?"listbox":"combobox",SUMMARY:"button",SVG:"graphics-document",TABLE:"table",TBODY:"rowgroup",TEXTAREA:"textbox",TFOOT:"rowgroup",THEAD:"rowgroup",TD:e=>t(e)?"gridcell":"cell",TH:e=>{const n=t(e)?"gridcell":"cell";return`${"row"===e.getAttribute("scope")?"rowheader":"columnheader"} ${n}`},TR:"row",UL:"list"}})(),(()=>{const{$engine:e}=n;e.fetcher={async fetch(e,t){let n=(t={credentials:"include",...t}).representation||"auto";const r=await _(e,t),i={headers:Object.fromEntries(r.headers.entries()),ok:r.ok,redirected:r.redirected,status:r.status,type:r.type,url:r.url};if(!r.ok)return i;if("auto"===n){const e=r.headers.get("content-type")||"";n=e.startsWith("text/")?"text":e.startsWith("multipart/form-data")?"formData":e.startsWith("application/json")?"json":"text"}if(n&&"none"!==n)try{"text"===n?i.body=await r.text():"formData"===n?i.body=await r.formData():"json"===n&&(i.body=await r.json())}catch(e){i.body=new Error(`failed converting response to ${n}`)}return i}}})(),(()=>{const{$engine:e,$utils:t}=n;e.frame={init(){this._root=null,this._frame=null,this._header=null,this._iframe=null,this._watchEngineState(),this._state={wide:!1,open:!1,collapsed:!1,theme:"day",dx:0,dy:0,dragging:!1}},send(e,...t){this._iframe.contentWindow.postMessage({name:e,args:t},"*")},inject(e=!1){return!this._frame&&(this._root=y.querySelector("__hrp__"),this._injectStyles(),this._createFrame(),this._createHeader(),this._createIframe(),this._setupDragLogic(),this._fitFrameToScreenOnResize(),this._update({collapsed:e}),!0)},_createFrame(){this._frame=y.createElement("div"),this._frame.classList.add("__hrp-frame"),this._root.append(this._frame)},_createHeader(){this._header=y.createElement("div"),this._header.classList.add("__hrp-frame__header"),this._frame.append(this._header)},_createIframe(){const e=this._root.dataset.extId;this._iframe=y.createElement("iframe"),this._iframe.src=`chrome-extension://${e}/harpa.html?popup`,this._iframe.allow="clipboard-write",this._iframe.classList.add("__hrp-frame__iframe"),this._frame.append(this._iframe)},_watchEngineState(){e.state.watch((e=>{this._update({wide:e.frameWide,open:e.frameOpen,collapsed:e.frameCollapsed,theme:e.theme}),x((()=>this._fitFrameToScreen()),50)}))},_setupDragLogic(){let t=0,n=0;const r=t=>{this._update({dragging:!1}),this._fitFrameToScreen(),y.removeEventListener("mouseup",r),y.removeEventListener("mousemove",i),t.clientY>.35*window.innerHeight&&e.state.transaction((e=>e.frameCollapsed=!0))},i=e=>{this._update({dx:e.clientX-t,dy:e.clientY-n})};this._header.addEventListener("mousedown",(e=>{e.preventDefault(),e.stopPropagation(),this._update({dragging:!0}),t=e.clientX-this._state.dx,n=e.clientY-this._state.dy,y.addEventListener("mouseup",r),y.addEventListener("mousemove",i)}),!0)},_fitFrameToScreenOnResize(){let e;window.addEventListener("resize",(()=>{g(e),e=x((()=>this._fitFrameToScreen()),300)}))},_update(e={}){const t=Object.assign(this._state,e);this._frame.classList.toggle("__hrp-frame_wide",t.wide),this._frame.classList.toggle("__hrp-frame_open",t.open),this._frame.classList.toggle("__hrp-frame_collapsed",t.collapsed),this._frame.classList.toggle("__hrp-frame_night","night"===t.theme),this._frame.classList.toggle("__hrp-frame_dragging",t.dragging),y.body&&y.body.classList.toggle("__body-dragged-over",t.dragging),t.collapsed?this._frame.style.translate=t.open?`${t.dx}px calc(100% + 24px - 50px)`:`${t.dx}px calc(100% + 24px)`:this._frame.style.translate=`${t.dx}px ${t.dy}px`},_getSafeDx(){let e=this._state.dx;const t=window.innerWidth,n=this._frame.offsetWidth,r=t-24-n+e;return r<24?e+=24-r:r+n>t-24&&(e-=r+n-t+24),Math.round(e)},_getSafeDy:()=>0,_fitFrameToScreen(){this._update({dx:this._getSafeDx(),dy:this._getSafeDy()})},_injectStyles(){const e=`\n          <style>\n            .__hrp-frame {\n              position: fixed;\n              right: 24px;\n              bottom: 24px;\n              width: 430px;\n              height: calc(100vh - 48px);\n              overflow: hidden;\n              border-radius: 6px;\n              transition: all 0.2s ease-out;\n              transition-property: scale, translate, opacity;\n              will-change: scale, translate, opacity;\n              box-shadow: 0 2px 10px rgb(0 0 0 / 20%);\n              z-index: ${t.maxZIndex};\n              user-select: none;\n            }\n            .__hrp-frame_wide {\n              width: 700px;\n            }\n            .__body-dragged-over {\n              pointer-events: none;\n            }\n            .__hrp-frame_dragging {\n              transition: none;\n              pointer-events: none;\n            }\n            /* expanded hidden */\n            .__hrp-frame:not(.__hrp-frame_open):not(.__hrp-frame_collapsed) {\n              opacity: 0;\n              scale: 0.95;\n              pointer-events: none;\n            }\n            /* collapsed */\n            .__hrp-frame_open.__hrp-frame_collapsed {\n              translate: 0 calc(100% + 24px - 50px);\n            }\n            /* collapsed hidden */\n            .__hrp-frame:not(.__hrp-frame_open).__hrp-frame_collapsed {\n              translate: 0 calc(100% + 24px);\n            }\n    \n            .__hrp-frame__header {\n              display: flex;\n              flex-direction: row;\n              align-items: center;\n              justify-content: center;\n              position: absolute;\n              top: 0;\n              left: 0;\n              right: 0;\n              height: 12px;\n              transition: all 0.3s;\n              cursor: pointer;\n            }\n            .__hrp-frame_collapsed .__hrp-frame__header {\n              display: none;\n            }\n    \n            /* drag handle */\n            .__hrp-frame__header::before {\n              content: '';\n              width: 65px;\n              height: 5px;\n              border-radius: 4px;\n              transition: opacity 0.3s ease;\n              opacity: 0.3;\n              background: #a5aab1;\n            }\n            .__hrp-frame_night .__hrp-frame__header::before {\n              opacity: 0.6;\n              background: #414a50;\n            }\n            .__hrp-frame__header:hover::before {\n              opacity: 1;\n            }\n    \n            .__hrp-frame__iframe {\n              width: 100% !important;\n              height: 100% !important;\n              border: none;\n            }\n          </style>\n        `;this._root.insertAdjacentHTML("beforeend",e)}}})(),(()=>{const{$engine:e,$utils:t}=n;e.idleWatcher={DEBUG_LOG:!1,IDLE_DURATION:1500,MAX_REQUESTS_PER_URL:1,MAX_MUTATIONS_PER_TARGET:1,VISIBLE_ATTRIBUTES:new Set(["class","style","alt","cols","colspan","dir","disabled","height","hidden","label","name","poster","readonly","required","reversed","rows","rowspan","shape","size","span","src","srcdoc","srcset","start","step","title","translate","type","value","width"]),init(){this._navigationPromise=new Promise((e=>{if("complete"===y.readyState)return void e();const t=n=>{"complete"===n.target.readyState&&(y.removeEventListener("readystatechange",t),e())};y.addEventListener("readystatechange",t)})),this._lastNetIdle=Date.now(),this._requestCount=0,this._requestsPerUrl={},this._scripts=new Set,this._loadedScriptPaths=new Set,this._lastDomIdle=Date.now(),this._mutations={attributes:Symbol("mAttributes"),characterData:Symbol("mCharacterData"),childList:Symbol("mChildList")},this._eraseMutationsBefore=-1,this._observeXhr(),this._observeFetch(),this._observeScripts(),this._navigationPromise.then((()=>{this._observeMutations()}))},async waitForDocumentReady(){return this._navigationPromise},async waitForIdle(e){if(!e||e<1)return;let t=!1;const n=new Promise((n=>setSafeTimeout((()=>{t=!0,n()}),e)));await Promise.race([n,this._navigationPromise.then((()=>new Promise((e=>{this._requestsPerUrl={},this._eraseMutationsBefore=Date.now()-this.IDLE_DURATION;const n=()=>{if(t)return void e();const n=-1!==this._lastNetIdle?this._lastNetIdle+this.IDLE_DURATION-Date.now():this.IDLE_DURATION/5,i=-1!==this._lastDomIdle?this._lastDomIdle+this.IDLE_DURATION-Date.now():this.IDLE_DURATION/5,s=Math.max(n,i);s<=0?e():setSafeTimeout(r,s)},r=()=>{const e={timeout:this.IDLE_DURATION/5};window.requestIdleCallback(n,e)};r()}))))]),i("page is idle"),t=!0},get requestCount(){return this._requestCount},set requestCount(e){this._requestCount!==e&&(this._requestCount=e,this._lastNetIdle=0===e?Date.now():-1)},_onRequestSent(e){if(!e)return!1;let t=e instanceof m?e.url:e;if(t=t.split("?")[0],!t)return!1;return(this._requestsPerUrl[t]||0)<this.MAX_REQUESTS_PER_URL&&(this.requestCount++,this._requestsPerUrl[t]=(this._requestsPerUrl[t]||0)+1,i("+ request"),!0)},_onResponseReceived(t){let n=t instanceof m?t.url:t;n=n.split("?")[0],this._requestsPerUrl[n]=(this._requestsPerUrl[n]||1)-1,e.idleWatcher.requestCount--,i("- request")},_observeXhr(){function t(){this._track&&(this.readyState!==d.DONE&&this.readyState!==d.UNSENT||(this.removeEventListener("readystatechange",t),e.idleWatcher._onResponseReceived(this._url)))}const n=d.prototype.open;d.prototype.open=function(){return this._url=arguments[1],this.addEventListener("readystatechange",t),n.apply(this,arguments)};const r=d.prototype.send;d.prototype.send=function(){return this._track=e.idleWatcher._onRequestSent(this._url),r.apply(this,arguments)}},_observeFetch(){const t=window.fetch;window.fetch=function(...n){return e.idleWatcher._onRequestSent(n[0])?new Promise(((r,i)=>{t(...n).then(((...t)=>{e.idleWatcher._onResponseReceived(n[0]),r(...t)})).catch(((...t)=>{e.idleWatcher._onResponseReceived(n[0]),i(...t)}))})):t(...n)}},_observeScripts(){const e=new Set([null,"module","text/javascript","application/javascript"]),n=e=>{e.target.removeEventListener("load",n),e.target.removeEventListener("error",n);const t=this._scripts.size,r=(e.target.src||"").split("?")[0];this._loadedScriptPaths.add(r),this._scripts=new Set(Array.from(this._scripts).filter((e=>!e.src.startsWith(r))));const s=t-this._scripts.size;this.requestCount-=s,i("- script request")};return t.mutation.on(y.documentElement,{childList:!0,subtree:!0},(r=>{t.mutation.addedElements(r).filter((t=>"SCRIPT"===t.tagName&&t.src&&!t.noModule&&!t.textContent&&e.has(t.getAttribute("type"))&&!this._loadedScriptPaths.has(t.src.split("?")[0])&&!this._scripts.has(t))).forEach((e=>{i("+ script request"),this._scripts.add(e),this.requestCount+=1,e.addEventListener("load",n),e.addEventListener("error",n)})),t.mutation.removedElements(r).filter((e=>this._scripts.has(e))).forEach((e=>n({target:e})))}))},_observeMutations(){return t.mutation.on(y.documentElement,{childList:!0,subtree:!0,attributeFilter:Array.from(this.VISIBLE_ATTRIBUTES)},(e=>{let t=!1;const n=Date.now();e.forEach((e=>{const r=this._mutations[e.type];if(!r)return;if("attributes"===e.type&&!this.VISIBLE_ATTRIBUTES.has(e.attributeName))return;const s=e.target;s[r]||(s[r]={count:0,last:n});const o=s[r];o.last<=this._eraseMutationsBefore?(i(`+ mutation ${e.type}`),t=!0,o.count=1,o.last=n):o.count<this.MAX_MUTATIONS_PER_TARGET&&(i(`+ mutation ${e.type}`),t=!0,o.count++,o.last=n)})),t&&(this._lastDomIdle=Date.now())}))}};const i=t=>{if(!e.idleWatcher.DEBUG_LOG)return;const n=e.idleWatcher._requestCount;r.log(`[idle-watcher] ${t}: requests ${n}`)}})(),(()=>{const{$engine:e,$utils:t}=n,i=globalThis.__elPreload?.ipcRenderer,s=!!globalThis.__elPreload;e.injection={async init(){if(v.config)this.config=v.config;else try{this.config=JSON.parse(N.getItem("__hrp.config")),N.removeItem("__hrp.config")}catch{}this.config&&this.config.frameName&&(this._addTrustedTypePolicy(),e.state.init(),e.timer.init(),e.idleWatcher.init(),e.memoizer.init(),e.query.init(),e.inspector.init(),e.pdf.init(),e.parser.init(),e.muter.init(this.config),e.simulator.init(),e.screenshotter.init(),e.frame.init(),e.trapper.init(),this._registerCommandListeners(),this._handleIframes(),this.config.waitForDocumentBody&&await this._waitForDocumentBody(),this.config.waitForDocumentReady&&await e.idleWatcher.waitForDocumentReady(),this._sendConnected())},_handleIframes(){if("docs.google.com"===y.domain)return;let e=this.config.configString;const n=t=>{if(t.closest("__hrp__"))return;const n=(e=>{try{return new u(e.src)}catch{return null}})(t);n&&n.origin!==w.origin?(n.hash?n.searchParams.set("__hrp",e):n.hash=`__hrp=${e}`,t.src=n.href):t.setAttribute("__hrp",e)};y.querySelectorAll("iframe").forEach((e=>n(e))),t.mutation.on(y.documentElement,["childList","subtree"],(e=>{t.mutation.addedElements(e).filter((e=>"IFRAME"===e.tagName)).forEach((e=>n(e)))}))},sendEvent(t,n){this.config?.frameName&&this._sendMessage({type:t,frameName:this.config.frameName,...n&&e.serializer.serialize(n)})},_sendResponse(t,n){this.config?.frameName&&this._sendMessage({type:"response",frameName:this.config.frameName,request:t,result:e.serializer.serialize(n.result),error:e.serializer.serialize(n.error)})},async _waitForDocumentBody(){if(y.body)return;const e=y.documentElement;return new Promise((n=>{const r=t.mutation.on(e,"childList",(()=>{y.body&&(r.disconnect(),n())}))}))},_sendConnected(){this.config?.frameName&&this._sendMessage({type:"connected",frameName:this.config.frameName})},_addTrustedTypePolicy(){if(window.trustedTypes?.createPolicy&&!window.trustedTypes.defaultPolicy)try{trustedTypes.createPolicy("default",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(e){r.warn(e)}},_registerCommandListeners(){this._onMessage((async t=>{const n=this._getRequestFromMessage(t);if(!n)return;const r=this._getMethodToCall(n);if(!r)return;const i=this._getMethodOptions(n);if(i)try{if(i.hasOwnProperty("frame")&&null!==i.frame)return void this._proxyMessageToIframe(t,i.frame);if(!e.noIdleCommands.includes(n.command)){const t=Math.min(i.idle,i.timeout);if(t>0&&await e.page.idle({timeout:t}),i.timeout&&Date.now()-i.startedAt>=i.timeout)throw"skip-response"}const s=e.serializer.deserialize(n.params)||[],o=await r(...s,i);e.injection._sendResponse(n,{result:o})}catch(t){if("skip-response"===t)return;e.injection._sendResponse(n,{error:t})}}))},_proxyMessageToIframe(e,t){Array.isArray(t)||(t=[t]);const n=t.shift();0===t.length&&delete e.data.options.frame;const r=this._resolveFrame(n);if(!r)throw new Error(`frame not found: ${JSON.stringify(n)}`);r.contentWindow.postMessage(e.data,"*")},_resolveFrame(t){if(null==t)return null;if("number"==typeof t){return y.querySelectorAll("iframe")[t]}if("string"==typeof t){const e=y.querySelectorAll("iframe");return Array.from(e).find((e=>e.name===t))}return(t=e.query.run(t))&&"IFRAME"===t.tagName?t:null},_getRequestFromMessage(e){const t=e.data;return t.frameName!==this.config.frameName?null:t},_getMethodToCall(t){let n=t.command;if(!n)return null;let r=e.page;for(;n.includes(".");){const[e,...t]=n.split(".");r=r[e],n=t.join(".")}const i=r[n];return i?i.bind(r):(e.injection._sendResponse(t,{error:"command-not-supported"}),null)},_getMethodOptions:e=>({startedAt:Date.now(),...e.options}),_sendMessage(e){T.postMessage(e,"*"),s&&i.send("engine.mediumMessage",e)},_onMessage(e){window.__hrpc&&window.removeEventListener("message",window.__hrpc),window.__hrpc=e,window.addEventListener("message",e),s&&i.on("engine.mediumMessage",((t,n)=>e({data:n})))}}})(),(()=>{const{$engine:e,$utils:t}=n,r=y.TEXT_NODE;e.inspector={CACHED_METHODS:["isConnected","isVisible","isHiddenByStyles","isClickable","isFixed","innerText","style","styleHashDefault","fontSize","lineHeight","rect","contentRect","rectAdjustedToViewport","clientRects","boundingClientRect","blockLineHeight","role","path","anchorPoint","toElement"],init(){this._range=y.createRange(),e.memoizer.memoizeAll(this,this.CACHED_METHODS)},isConnected:e=>!!e&&(e instanceof a&&e.isConnected),isVisible(e){if(!e)return!1;if(!this.isConnected(e))return!1;const t=this.toElement(e);if(!t)return!1;{const e=this.style(t).visibility;if("hidden"===e)return!1;if("collapse"===e)return!1}if(this.isHiddenByStyles(t))return!1;{const e=this.contentRect(t);if(e.width<=1)return!1;if(e.height<=1)return!1;if(e.right<=0)return!1;if(!e.sx&&e.left>=y.documentElement.scrollWidth)return!1}return!0},isHiddenByStyles(e){const t=this.style(e);if("none"===t.display)return!0;if("hidden"===t.contentVisibility)return!0;if(Number(t.opacity)<.1)return!0;const n=t.clip;return"rect(0px, 0px, 0px, 0px)"===n||"rect(1px, 1px, 1px, 1px)"===n||!(!(e=e.parentElement)||e===y.body)&&this.isHiddenByStyles(e)},isInViewport(e,t="center"){if(!e)return!1;const n=this.toElement(e);if(!n)return!1;if(!this.isConnected(e))return!1;const r=this.rectAdjustedToViewport(n),{clientWidth:i,clientHeight:s}=y.documentElement;if("center"===t)return r.cx>=0&&r.cy>=0&&r.cx<=i&&r.cy<=s;if("full"===t)return r.left>=0&&r.top>=0&&r.right<=i&&r.bottom<=s;if("part"===t)return!(r.top>=s)&&(!(r.bottom<=0)&&(!(r.left>=i)&&!(r.right<=0)));throw new Error(`unsupported isInViewport algorithm ${t}`)},isClickable(e){if(!e)return!1;const t=this.toElement(e);if(!t)return!1;if(!this.isInViewport(t))return!1;if(!this.isVisible(t))return!1;const n=this.rectAdjustedToViewport(t);let r=y.elementFromPoint(n.cx,n.cy);for(;r;){if(r===t)return!0;r=r.parentNode}return!1},isFixed(e){if(!e)return!1;let t=this.toElement(e);for(;t&&t!==y.body;){const e=this.style(t).position;if("fixed"===e||"sticky"===e)return!0;t=t.parentElement}return!1},innerText:e=>e.innerText||"",style(e){return e.nodeType===r?this.style(e.parentElement):window.getComputedStyle(e)},styleHash(e,t){const n=this.style(e);if(t){if(0===(t=t.split(":")).length)return""}else t=["fontFamilyPrimary","fontSize","fontWeight","fontStyle"];let r=[];return t.forEach((e=>{if("fontFamilyPrimary"===e){const e=n.fontFamily||"",t=e.indexOf(", ");r.push(t>0?e.substr(0,t):e)}else r.push(n[e])})),r.join(":")},styleHashDefault(e){return this.styleHash(e)},rect(t){let n;if(t.nodeType===r){try{this._range.selectNode(t)}catch{}n=this._range.getBoundingClientRect(),this._range.setStart(t,0),this._range.setEnd(t,0);const e=this._range.getBoundingClientRect();e.top>=n.top&&(n.lineShift=e.left-n.left)}else if(n=t.getBoundingClientRect(),0===n.height&&0===this.lineHeight(t)){try{this._range.selectNode(t)}catch{}n=this._range.getBoundingClientRect()}let{top:i,left:s,width:o,height:a}=n;const{scrollX:l,scrollY:c}=window;0===l&&0===c||this.isFixed(t)||(s+=l,i+=c);const m=new e.Rect(i,s+o,i+a,s);if(void 0!==n.lineShift&&(m.lineShift=n.lineShift),t.nodeType===r){const e=this.blockLineHeight(t);if(e>=m.height){const t=e-m.height;m.top-=t/2,m.bottom+=t/2}}return m},contentRect(e){const t=this.rect(e);if(0===t.width||0===t.height)return t;if(e.nodeType!==r){const n=this.style(e),{paddingTop:r,paddingRight:i,paddingBottom:s,paddingLeft:o}=n,a={top:Number(r.substr(0,r.length-2)),right:Number(i.substr(0,i.length-2)),bottom:Number(s.substr(0,s.length-2)),left:Number(o.substr(0,o.length-2))};t.top+=a.top,t.right-=a.right,t.bottom-=a.bottom,t.left+=a.left}let n=this.toElement(e);for(;n&&n!==y.body;){const e=this.style(n);if(!t.sx){const r=e.overflowX;if("auto"===r||"scroll"===r){if(t.sy)break;t.sx=!0}else if("hidden"===r){const e=this.rect(n);t.left=Math.max(t.left,e.left),t.right=Math.min(t.right,e.right)}}if(!t.sy){const r=e.overflowY;if("auto"===r||"scroll"===r){if(t.sx)break;t.sy=!0}else if("hidden"===r){const e=this.rect(n);t.top=Math.max(t.top,e.top),t.bottom=Math.min(t.bottom,e.bottom)}}n=n.parentElement}return t},clientRects:e=>e.getClientRects(),boundingClientRect:e=>e.getBoundingClientRect(),blockLineHeight(e){const t=this.toElement(e),n=this.fontSize(t);let r=this.lineHeight(t);if(r>1.75*n&&(r=n),0!==t.offsetWidth){const e=this.clientRects(t);if(0===e.length)return r;let{left:n,right:i}=e[0];for(let t=1;t<e.length;t++)e[t].left<n&&(n=e[t].left),e[t].right>i&&(i=e[t].right);const s=Math.round(i-n)/t.offsetWidth;(s<.9||s>1.1)&&(r*=s)}return r},fontSize(e){const t=this.toElement(e),n=this.style(t)["font-size"];return Number(n.substr(0,n.length-2))},lineHeight(e){const t=this.toElement(e),n=this.style(t).lineHeight;return"normal"===n?1.2*this.fontSize(t):Number(n.substr(0,n.length-2))},rectAdjustedToViewport(t){const n=this.rect(t),{scrollX:r,scrollY:i}=window;if(0===r&&0===i)return n;if(this.isFixed(t))return n;const s=new e.Rect(n.top-i,n.right-r,n.bottom-i,n.left-r);return void 0!==n.lineShift&&(s.lineShift=n.lineShift),s},role(t){const n=this.toElement(t);if(n.hasAttribute("role"))return n.getAttribute("role");const r=e.tagsToRoles[n.nodeName];return r?"function"==typeof r?r(n):r:null},path(e){if(!e||!e.isConnected)return null;if(e===y.documentElement)return[];const t=e.parentElement,n=Array.prototype.indexOf.call(t.children,e);return[...this.path(t),n]},commonParentNode(e){if(!e||0===e.length)return null;if(1===e.length)return e[0];let t=e[0].parentNode,n=e.slice(1);if(n.every((e=>e===t||e.parentNode===t)))return t;for(;t;){if(n=n.filter((e=>!t.contains(e))),0===n.length)return t;t=t.parentNode}return t},toElement(e){for(;e&&!(e instanceof Element);)e=e.parentElement;return e},anchorPoint(e){const t=this.style(e)["text-align"],n=this.rect(e),r=Math.round(n.top+Math.min(5,n.height/2));return{x:Math.round("right"===t?n.right-Math.min(5,n.width/2):"center"===t?n.cx:n.left+Math.min(5,n.width/2)),y:r}},distance(e,t,n="number"){e=e instanceof a?this.anchorPoint(e):e;const r=(t=t instanceof a?this.anchorPoint(t):t).x-e.x,i=t.y-e.y,s=Math.sqrt(Math.pow(r,2)+Math.pow(i,2));return"number"===n?s:{d:s,dx:r,dy:i}},inspect(n,r={}){if(r={inspect:!0,computeAiLocator:!1,parsedPage:null,...r},!n)return[];let i=Array.isArray(n);if(i||(n=[n]),0===n.length)return[];const s=new Map;let o=r.computeAiLocator&&e.locatorAi.computeAnchors(r.parsedPage);const a=n.map((n=>{const i=s.get(n);if(i)return t.cloneDeep(i);let a,l;return r.inspect&&(a=e.locatorAi.computeInspectionData(n)),r.computeAiLocator&&(l=e.locatorAi.computeAiLocator(n,a,o),a={...a,locator:l}),s.set(n,a),a}));return i?a:a[0]}}})(),(()=>{const{$engine:e}=n;e.locatorAi={computeAiLocator(t,n,r){n=n||this.computeInspectionData(t),r=r||this.computeAnchors();const i=new Set(["id","class","placeholder","data-testid","title","alt","src"]);let s=[this._canUseSelector(n.tag)&&{$tag:n.tag},this._canUseSelector(n.role)&&{$role:n.role},this._canUseSelector(n.id)&&{$id:n.id},...n.classes.filter((e=>this._canUseSelector(e))).map((e=>({$class:e}))),...Object.keys(n.attributes).filter((e=>!i.has(e))).filter((e=>{const t=n.attributes[e]||"";return t.length<=256&&!t.includes('"')})).map((e=>{const t=n.attributes[e];return{$attribute:t?`${e}=${t}`:`${e}`}})),this._canUseSelector(n.testId)&&{$testId:n.testId},this._canUseSelector(n.title)&&{$title:n.title},this._canUseSelector(n.altText)&&{$altText:n.altText},this._canUseSelector(n.src)&&{$src:n.src},this._canUseSelector(n.style)&&{$style:n.style},this._canUseSelector(n.template)&&{$content:n.template},this._canUseSelector(n.placeholder)&&{$placeholder:n.placeholder},...this._createTraverseSelectors(t,5),...this._createAnchorSelectors(t,r)].filter((e=>Boolean(e)));const o=new Map;let a=0;return s.map((t=>e.query.run(t,{m:!0}))).flat().forEach((e=>{const n=(o.get(e)||0)+1;o.set(e,n),e!==t&&(a=a<n?n:a)})),a===s.length&&s.push({$tag:y.documentElement.tagName,traverse:this._traversePath(y.documentElement,t)}),s=[{$matches:s,min:a+1},{$size:1}],{__$ht:"locator",selector:s}},computeInspectionData(t){if(!(t&&t instanceof a))return null;const n=t.tagName,r=Array.from(t.classList),i={};t.getAttributeNames().forEach((e=>{i[e]=t.getAttribute(e)}));const s=(e.inspector.innerText(t)||"").trim(),o=e.extractor.extract(s).template,l={isConnected:e.inspector.isConnected(t),isVisible:e.inspector.isVisible(t),isInViewport:e.inspector.isInViewport(t),isClickable:e.inspector.isClickable(t),isFixed:e.inspector.isFixed(t),rect:e.inspector.rect(t),cr:e.inspector.contentRect(t),tag:n,classes:r,attributes:i,id:i.id,testId:i["data-testid"],placeholder:i.placeholder,title:i.title,altText:i.alt,src:i.src,role:e.inspector.role(t),fontSize:e.inspector.fontSize(t),style:e.inspector.styleHashDefault(t),text:s,template:o};return Object.keys(l).filter((e=>["",null,void 0].includes(l[e]))).forEach((e=>delete l[e])),l},computeAnchors(t=null){t=t||e.parser.parse(null,{inspect:!1,extract:!0});const n=new Set,r={};return t.filter((e=>"text"===e.type)).filter((e=>!n.has(e.container)&&(n.add(e.container),!0))).map((e=>({container:e.container,text:e.template||e.value}))).filter((e=>e.text)).map((e=>(r[e.text]=(r[e.text]||0)+1,e))).filter((e=>!e.text.includes("{{data}}"))).filter((e=>r[e.text]<5))},findClosestAnchors(t,n){if(!n)return[];if(0===(n=n.filter((e=>e.container!==t&&!t.contains(e.container)&&!e.container.contains(t)))).length)return[];n=n.map((n=>({text:n.text,container:n.container,...e.inspector.distance(n.container,t,"object")})));const r=[];return n.forEach((e=>{!r[0]||e.d<r[0].d?(r[2]=r[1],r[1]=r[0],r[0]=e):!r[1]||e.d<r[1].d?(r[2]=r[1],r[1]=e):(!r[2]||e.d<r[2].d)&&(r[2]=e)})),r.filter((e=>Boolean(e)))},_createAnchorSelectors(e,t){return(t=this.findClosestAnchors(e,t)).map((t=>[{$anchor:t.text,shift:[t.dx,t.dy].join(":")},{$text:t.text,traverse:this._traversePath(t.container,e)}])).flat()},_createTraverseSelectors(t,n=null){const r=[],i=t.parentNode,s=t.childNodes,o=[];let a=i?.parentNode;for(;a;)o.push(a),a=a.parentNode;const l=[i,...s,...o].filter((e=>e!==y.body&&y.body.contains(e))).filter((e=>e.nodeType!==y.TEXT_NODE)).filter((e=>e.nodeType!==y.COMMENT_NODE));for(const i of l){let s=[];i.id&&s.push({$id:i.id});const o=e.inspector.role(i);o&&s.push({$role:o});const a=Array.from(i.classList).filter((e=>this._canUseSelector(e))).map((e=>({$class:e})));if(s.push(...a),0===s.length)continue;const l={traverse:this._traversePath(i,t)};if(s=s.filter((t=>1===e.query.run(t,{m:!0}).length)).forEach((e=>{r.push({...e,...l})})),n&&r.length>=n)return r.slice(0,n)}return r},_traversePath(t,n){if(t===n)return[];const r=e.inspector.path(t),i=e.inspector.path(n);let s=0;for(;r[s]===i[s];)s++;const o=r.length-s;return(o>0?[-o]:[]).concat(i.slice(s)).join(":")},_canUseSelector:e=>e&&String(e).length<=256}})(),(()=>{const{$engine:e}=n;e.memoizer={init(){this._isObserving=!1,this._caches=[],this._caches.hasUpdates=!1,this._onMutation=this._onMutation.bind(this),this._mutationObserver=new o(this._onMutation)},memoizeAll(e,t){t.forEach((t=>{const n=e[t].bind(e);e[t]=this.memoize(n)}))},memoize(e){const t=new Map;return this._caches.push(t),n=>{const r=arguments.length;if(1!==r)throw new Error(`function is memoized and expects single argument, passed ${r}`);this._isObserving||(this._isObserving=!0,this._observeChanges());let i=t.get(n);return void 0!==i||(i=e(n),t.set(n,i),this._caches.hasUpdates=!0),i}},_observeChanges(){y.addEventListener("scroll",this._onMutation),this._mutationObserver.observe(y.documentElement,{attributes:!0,childList:!0,characterData:!0,subtree:!0})},_onMutation(){this._caches.hasUpdates&&this.cleanupCache(),this._caches.hasUpdates=!1,y.removeEventListener("scroll",this._onMutation),this._mutationObserver.disconnect(),this._isObserving=!1},cleanupCache(){this._caches.forEach((e=>e.clear()))}}})(),(()=>{const{$engine:e,$utils:t}=n;e.muter={init(e){(e={muter:!0,...e}).muter&&(y.querySelectorAll("audio, video").forEach((e=>this._muteMediaElements(e))),t.mutation.on(y.documentElement,["childList","subtree"],(e=>{t.mutation.addedElements(e).forEach((e=>this._muteMediaElements(e)))})))},_muteMediaElements(e){if(!["AUDIO","VIDEO"].includes(e.tagName))return;e.muted=!0,e.removeAttribute("autoplay");const t=()=>{e.pause(),e.muted=!0};e.addEventListener("canplay",t),e.addEventListener("play",t)}}})(),(()=>{const{$engine:e,$utils:t}=n;e.page={get timer(){return e.timer},get frame(){return e.frame},get trapper(){return e.trapper},get screenshotter(){return e.screenshotter},get state(){return e.state},url:()=>window.location.href,async reload(){w.reload()},async content(t,n){let r=y.documentElement;t&&(r=e.query.run(t));const i=n.contentType||"innerText";if("htmlContent"===i){let e="";return r===y.documentElement&&y.doctype&&(e+=(new p).serializeToString(y.doctype)),r&&(e+=r.outerHTML),e}if("textContent"===i)return r?.textContent;if("innerText"===i)return r?.innerText;if("outerText"===i)return r?.outerText;if("outerHTML"===i)return r?.outerHTML;if("innerHTML"===i)return r?.innerHTML;if("pdf"===i)return e.pdf.pdfContent();throw new Error(`unsupported options.contentType ${i}`)},async favicons(){const e=e=>{const t=e.sizes?.value?.match(/^(\d+)/);return t?Number(t[1]):0},t=Array.from(y.querySelectorAll('link[rel*="icon"]'));return t.sort(((t,n)=>"icon"===t.rel&&"icon"!==n.rel?-1:"icon"!==t.rel&&"icon"===n.rel?1:e(n)-e(t))),t.map((e=>e.href)).filter(Boolean)},async idle(t){const{timeout:n}=t;if(!n||n<1)return{durationMs:0};const r=Date.now();return await e.idleWatcher.waitForIdle(n),{durationMs:Date.now()-r}},fetch:async(t,n)=>e.fetcher.fetch(t,n),query:async(t,n)=>e.query.run(t,n),async parse(t,n){const r=t&&this._toNode(t,n)||y.body;return e.parser.parse(r,n)},async inspect(t,n){const r=t&&this._toNode(t,n)||y.body;return e.inspector.inspect(r,n)},async click(t,n,r){const i=this._toNode(t,r)||y.body,s=i.innerText||null;return r.noScroll||await e.scroller.scroll(i),await e.simulator.click(i,n),{status:"ok",innerText:s}},async scroll(t,n){return"object"!=typeof t||t.hasOwnProperty("x")||t.hasOwnProperty("y")||(t=await this._toNode(t)),e.scroller.scroll(t,n)},async evaluate(n,r){r=r||[],this._constructApi("$harpa");const i=t.createPromise(),s=`__hrp_evaluate_${Math.random().toString(36).slice(2)}`;return window[s]=i,e.injection.sendEvent("execute",{js:`(async () => {\n            const fn = ${n}\n            const args = ${JSON.stringify(r)}\n            const result = await fn(...args)\n            window.${s}.resolve(result)\n            delete window.${s}\n          })()`}),i},async paste(e){const t=e=>{const t=b(e),n=parseInt(t.paddingTop),r=parseInt(t.paddingLeft),i=parseInt(t.paddingRight),s=parseInt(t.paddingBottom);return(e.offsetWidth-r-i)*(e.offsetHeight-n-s)},n=["[contenteditable]","input:not([type]):not(:disabled)",'input[type="text"]:not(:disabled)','input[type="search"]:not([disabled])',"textarea:not([disabled])"].join(", "),r=[...y.querySelectorAll(n)].reduce(((e,n)=>n.hasAttribute("data-last-active-input")||t(n)>(e?t(e):-1)?n:e),null);return r?(y.body.focus(),r.focus(),"true"===r.contentEditable?y.execCommand("insertHtml",null,e.split("\n").join("<br/>")):y.execCommand("insertText",null,e),e):null},wait:async(t,n)=>e.waiter.wait(t,n),title:()=>y.title,description:()=>y.querySelector('meta[name="description"]')?.content||"",selection:()=>window.getSelection()?.toString()||null,_constructApi(n){if(window.hasOwnProperty(n))return;const r={fetcher:e.fetcher,inspector:e.inspector,page:e.page,parser:e.parser,query:e.query,Rect:e.Rect,rectUtils:e.rectUtils,screenshot:e.screenshotter,scroller:e.scroller,waiter:e.waiter,utils:t};try{const e={value:r,configurable:!1,writable:!1};Object.defineProperty(window,n,e)}catch{}},_toNode(t,n){if(!t)return t;if(t instanceof a)return t;if("object"==typeof t){let r=e.query.run(t,n);if(!r)throw new Error("element not found");if(Array.isArray(r)){if(0===r.length)throw new Error("element not found");if(r.length>1)throw new Error(`${r.length} matching elements found`);if(r=r[0],!r)throw new Error("element not found")}return r}throw new Error("unsupported locator type "+typeof t)}},window.page=e.page})(),(()=>{const{$engine:e}=n,t=y.ELEMENT_NODE,r=y.TEXT_NODE,i=y.DOCUMENT_NODE;e.parser={init(){e.memoizer.memoizeAll(this,["_orderedTree"])},parse(e,t){if(e=e||y.body,t={extract:!1,inspect:!1,computeAiLocator:!1,...t},!(e=this._toDocumentBodyChild(e)))return[];let n=this._orderedTree();if(!n)return null;n=this._cloneTree(n),this._dropEmptyNodes(n),this._trimAllTextNodes(n),this._extractNumericNodes(n,t),this._pruneTree(n),this._addNodePath(n),this._flattenTree(n),this._cleanupTree(n),this._addContainer(n);const r=n.children;return this._reduceTree(n,e),this._addAtSiblingIndex(n),this._inspectNodes(n,r,t),n.children},_orderedTree(){let e=this._toTree(y.body);if(!e)return null;const t=this._injectViewportContainer(e);return this._reorderByContainingBlock(e,e,t),this._markViewportChildren(t),this._sortTree(e),this._mergeTreeNodes(e),this._removeViewportContainer(e,t),e},_toDocumentBodyChild:e=>e===y.body||y.body.contains(e)?e:e.contains(y.body)?y.body:null,_toTree(e){if(!e)return null;if(e.nodeType!==t&&e.nodeType!==i&&e.nodeType!==r)return null;if(e.nodeType===r)return this._textToTreeNode(e);const n=this._elementToTreeNode(e);return n.children=[...n.children||[],...Array.from(e.childNodes).map((e=>this._toTree(e))).filter((e=>Boolean(e)))],n},_textToTreeNode(t){if(!e.inspector.isVisible(t))return null;const n=t.textContent;if(!n)return null;const r=e.inspector.contentRect(t);if(0===r.width||0===r.height)return null;const i=e.inspector.style(t.parentElement);let s=n;return s=this._applyWhiteSpace(s,i["white-space"]),s=this._applyTextTransform(s,i.textTransform),{elements:[t],children:[{type:"text",value:s,elements:[t],cr:r}]}},_applyWhiteSpace:(e,t)=>["pre-line"].includes(t)?e.replaceAll(/[^\S\r\n]+/g," "):["pre","pre-wrap","break-spaces"].includes(t)?e:e.replaceAll(/\s+/g," "),_applyTextTransform:(e,t)=>"capitalize"===t?e.replace(/^\w|\W\w/g,(e=>e.toLocaleUpperCase())):"uppercase"===t?e.toLocaleUpperCase():"lowercase"===t?e.toLocaleLowerCase():e,_elementToTreeNode(t){const n=e.inspector.style(t),r=e.inspector.contentRect(t),i={elements:[t],cr:r};"static"!==n.position&&(i.position=n.position);const s=e=>{e&&null!==e.value&&void 0!==e.value&&(i.children||(i.children=[]),i.children.push({...e,elements:[t],cr:r}))},o=t=>e.inspector.contentRect(t).height/e.inspector.blockLineHeight(t);if("BR"===t.tagName&&e.inspector.isVisible(t.parentNode))return s({type:"text",value:"\n"}),i;if(!e.inspector.isVisible(t))return i;if("INPUT"===t.tagName)i.isFormElement=!0,"checkbox"===t.type?s({type:"text",value:t.checked?"ON":"OFF"}):s({type:"text",value:t.value||t.placeholder||""});else if("TEXTAREA"===t.tagName)i.isFormElement=!0,s({type:"text",value:t.value||t.placeholder||""});else if("SELECT"===t.tagName){i.isFormElement=!0;const e=Array.from(t.options).filter((e=>e.selected)).map((e=>e.textContent)).join(" & ");s({type:"text",value:e})}else if("VIDEO"===t.tagName)s({type:"video",value:t.getAttribute("src")});else if("IFRAME"===t.tagName){const e=t.getAttribute("src")||"";if(e.startsWith("https://www.youtube.com/embed/")||e.startsWith("https://youtube.com/embed/")){let t=e.split("/")[4];t&&(t=`https://www.youtube.com/watch?v=${t}`,s({type:"video",value:t}))}}else"IMG"===t.tagName?(o(t)<1.5&&s({type:"text",value:""}),s({type:"image",value:t.getAttribute("src")})):"SVG"===t.tagName?(o(t)<1.5&&s({type:"text",value:""}),s({type:"icon",value:"svg"})):"I"===t.tagName&&0===t.childNodes.length&&(t.getAttribute("class")||"").startsWith("icon-")?(o(t)<1.5&&s({type:"text",value:""}),s({type:"icon",value:t.getAttribute("class").substr(5)})):"A"===t.tagName&&s({type:"link",value:t.getAttribute("href"),content:e.inspector.innerText(t)});const a=n["background-image"];if("none"!==a){Array.from(a.matchAll(/url\(["']([^)]+)["']\)/g)).map((e=>e[1])).filter((e=>e)).forEach((e=>{o(t)<1.5&&s({type:"text",value:""}),s({type:"image",value:e})}))}return i},_injectViewportContainer(e){const t={children:[],multiblock:!0};return e.children.unshift(t),t},_removeViewportContainer(e,t){e.children=e.children.filter((e=>e!==t)),e.elements[0]===y.body&&(e.children=[...t.children||[],...e.children||[]])},_reorderByContainingBlock(e,t,n){e!==n&&e.children&&0!==e.children.length&&(["relative","sticky","fixed"].includes(e.position)&&(t=e),e.children.forEach((e=>{this._reorderByContainingBlock(e,t,n)})),e.children=e.children.filter((e=>"fixed"!==e.position&&"sticky"!==e.position||(n.children.push(e),!1))),e!==t&&(e.children=e.children.filter((e=>"absolute"!==e.position||(t.children.push(e),!1)))))},_markViewportChildren(e){e.vc=!0,(e.children||[]).forEach((e=>this._markViewportChildren(e)))},_cloneTree(e){if(!e)return e;const t={...e};return t.cr&&(t.cr={...t.cr}),t.children&&(t.children=t.children.map((e=>this._cloneTree(e)))),t.elements&&(t.elements=[...t.elements]),t},_mergeTreeNodes(e){let t=e.children||[];t.filter((e=>!e.type&&e.children.length>0)).forEach((t=>{this._mergeTreeNodes(t,e)})),t.filter((e=>e.children&&!e.multiblock)).forEach((e=>{t=[...t,...e.children],e.children=null}));let n=t.filter((e=>"text"===e.type));n.length>1&&(n=this._sortByLines(n),n=this._mergeTextNodes(n,e)),e.multiblock=t.some((e=>e.multiblock))||n.filter((e=>"text"===e.type)).length>1,t=[...t.filter((e=>"text"!==e.type)),...n],t=t.filter((e=>e.type||e.children&&e.children.length>0)),e.children=this._sortByLines(t)},_trimAllTextNodes(e){e.children&&e.children.filter((e=>!e.type)).forEach((e=>this._trimAllTextNodes(e))),e.children&&e.children.length>0&&(e.children.filter((e=>"text"===e.type)).filter((e=>e.value)).forEach((e=>e.value=e.value.trim())),e.children=e.children.filter((e=>"text"!==e.type||e.value)))},_sortTree(e){e.children&&(e.children=this._sortByLines(e.children),e.children.forEach((e=>this._sortTree(e))))},_sortByLines(e){return e.sort(((e,t)=>{if(e.vc&&!t.vc)return-1;if(t.vc&&!e.vc)return 1;if(!e.cr)return 1;if(!t.cr)return-1;if(e.cr.bottom<t.cr.top)return-1;if(t.cr.bottom<e.cr.top)return 1;if(e.cr.lineShift||t.cr.lineShift||!(e.cr.top>=t.cr.top&&t.cr.bottom>=e.cr.bottom||t.cr.top>=e.cr.top&&e.cr.bottom>=t.cr.bottom)){const n=this._nodeLineHeight(e);if(e.cr.top+2/3*n<t.cr.top)return-1;const r=this._nodeLineHeight(t);if(t.cr.top+2/3*r<e.cr.top)return 1}else;const n=e.cr.left+(e.cr.lineShift||0),r=t.cr.left+(t.cr.lineShift||0);return n<r?-1:r<n?1:0}))},_mergeContentRects(e){if(0===(e=e.filter((e=>e.cr))).length)return null;if(1===e.length)return e[0].cr;let{top:t,right:n,bottom:r,left:i}=e[0].cr;for(let s=1;s<e.length;s++){const o=e[s];t=Math.min(o.cr.top,t),n=Math.max(o.cr.right,n),r=Math.max(o.cr.bottom,r),i=Math.min(o.cr.left,i)}return{top:t,right:n,bottom:r,left:i}},_dropEmptyNodes(e){return!!(e.children&&e.children.length>0)&&(e.children=e.children.filter((t=>t.type||this._dropEmptyNodes(t,e))),e.children.length>0)},_extractNumericNodes(t,n={}){if(!n.extract)return;const i=t.children;if(i)for(let t=0;t<i.length;t++){const s=i[t];if(!s.type){this._extractNumericNodes(s,n);continue}if("text"!==s.type)continue;const o=e.extractor.extract(s.value),a=o.items;if(0===a.length)continue;s.template=o.template;const l={};a.forEach((e=>l[e.type]=(l[e.type]||0)+1));const c={},m=s.elements.map((e=>e.textContent));m.forEach((e=>c[e]=(c[e]||0)+1)),this._injectDotIntoPrices(s,a),a.forEach((e=>{const n={...e};if(n.cr=s.cr,n.context=s.value,n.elements=s.elements,s.vc&&(n.vc=!0),i.splice(++t,0,n),1===l[e.type])return;if(c[e.content]>1)return;const o=s.elements.filter(((t,n)=>m[n].includes(e.content)));1===o.length&&(n.elements=o,n.container=o[0],n.container.nodeType===r&&(n.container=n.container.parentElement))}))}},_injectDotIntoPrices(t,n){const{elements:r}=t;if(r.length<=1)return;const i=n.map((e=>"price"===e.type&&e.value%1==0?e:null));if(!i.some((e=>!!e)))return;let s=-1;for(let t=0;t<r.length-1;t++){if(e.inspector.fontSize(r[t])<=e.inspector.fontSize(r[t+1])+1)continue;const o=r[t].textContent;if(!/\d$/.test(o))continue;const a=r[t+1].textContent;if(!/^\d\d?(?:\D|$)/.test(a))continue;const l=o.replaceAll(/\D/g,""),c=/^\d\d/.test(a)?a.substr(0,2):a.substr(0,1),m=l+c;for(let e=s+1;e<n.length;e++){if(!i[e])continue;if(!String(i[e].value).endsWith(m))continue;let t=String(i[e].value);const n=t.length,r=c.length;t=t.substr(0,n-r)+"."+t.substr(n-r),i[e].value=Number(t),s=e;break}}},_addContainer(t){t.children.forEach((t=>{const n=e.inspector.commonParentNode(t.elements);t.container=e.inspector.toElement(n)}))},_addAtSiblingIndex(e){for(let t=0;t<e.children.length;t++){const{container:n,type:r}=e.children[t];let i=0;for(let s=t-1;s>=0;s--){const t=e.children[s];if(t.container!==n&&!n.contains(t.container))break;t.type===r&&i++}e.children[t].at=i}},_inspectNodes(t,n,r={}){if(!r.inspect&&!r.computeAiLocator)return;const i=t.children.map((e=>e.container)),s=e.inspector.inspect(i,{...r,parsedPage:n});t.children.forEach(((e,t)=>{e.data=s[t]}));for(let e=0;e<t.children.length;e++){const{data:n,type:r,at:i}=t.children[e];if(!n.locator?.selector)continue;const s={$parse:r,at:i};n.locator.selector.push(s)}},_pruneTree(e,t){return e.type?e:(e.children&&(e.children=e.children.map((t=>this._pruneTree(t,e)))),t&&1===e.children.length?e.children[0]:e)},_flattenTree(e){const t=[],n=e=>{(e.children||[]).forEach((e=>{e.type?t.push(e):n(e)}))};return n(e),e.children=t,e},_reduceTree(e,t){t&&t!==y.body&&(e.children=e.children.filter((e=>e.elements.every((e=>t===e||t.contains(e))))))},_cleanupTree(e){e.children.forEach((e=>{delete e.multiblock,delete e.textContent}))},_addNodePath(e,t=[],n=0){e.path=[...t,n],e.children&&e.children.length>0&&e.children.forEach(((t,n)=>this._addNodePath(t,e.path,n)))},_mergeTextNodes(t,n){const i=[],s=t=>{if(n.vc&&!n.elements)return!1;let i=t.nodeType===r?t.parentElement:t;for(;i!==n.elements[0];){if("inline"!==e.inspector.style(i).display)return!1;i=i.parentElement}return!0},o=[];for(let e=0;e<t.length;e++){let n=e+1;for(;n<t.length;){const e=t[n-1],r=t[n];if(1===e.elements.length&&1===r.elements.length&&s(e.elements[0])&&s(r.elements[0])){n++;continue}if(r.cr.top-e.cr.bottom>=1)break;if(e.cr.top+2*this._nodeLineHeight(e)/3<r.cr.top){if(this._nodeLineHeight(e)!==this._nodeLineHeight(r))break}n++}o.push(t.slice(e,n)),e=n-1}const a=n.elements?e.inspector.style(n.elements[0])["white-space"]:null,l=["fontSize","color"];return o.forEach((t=>{if(1===t.length)return void i.push([t[0]]);let n=[];function r(){0!==n.length&&(i.push(n),n=[])}if((e=>{if(["pre-line","pre","pre-wrap","break-spaces"].includes(a))return!0;if(e.length<2)return!0;let t=e[0];for(let n=1;n<e.length;n++){const r=e[n];if(r.cr.top-t.cr.bottom<-1)return!0;t=r}return!1})(t=this._sortByLines(t))||(t=>{const n=t.map((e=>e.elements)).flat();if(n.length<2)return!0;const r=e.inspector.style(n[0]);for(let t=1;t<n.length;t++){const i=e.inspector.style(n[t]);if(i!==r)for(const e of l)if(r[e]!==i[e])return!1}return!0})(t)){for(let o=0;o<t.length;o++){const a=t[o];if(1===(s=a).elements.length&&["INPUT","TEXTAREA","SELECT"].includes(s.elements[0].tagName))r(),i.push([a]);else{if(o>0){const i=t[o-1],s=Math.max(this._nodeLineHeight(i),this._nodeLineHeight(a)),l=a.cr.top-i.cr.bottom,c=a.cr.left+(a.cr.lineShift||0)-i.cr.right;if(l<0&&c<0&&("absolute"===e.inspector.style(i.elements[0]).position||"absolute"===e.inspector.style(a.elements[0]).position)){r(),n.push(a);continue}if(c>=s/3){r(),n=[a];continue}if((c>1||l>-s/3)&&!a.value.startsWith(" ")&&!i.value.endsWith(" ")){n.push(" "),n.push(a);continue}}n.push(a)}}var s;n.length>0&&i.push(n)}else for(let e=0;e<t.length;e++)n.push(t[e]),r()})),i.map((e=>{const t=e.map((e=>"string"==typeof e?e:e.value)).join(""),n={type:"text",elements:e.filter((e=>"string"!=typeof e)).map((e=>e.elements)).flat(),cr:this._mergeContentRects(e),value:this._applyWhiteSpace(t,a)};return e.some((e=>e.vc))&&(n.vc=!0),n}))},_nodeLineHeight(t){const n=t.elements.filter((e=>!!e&&"string"!=typeof e));return 0===n.length?0:1===n.length?e.inspector.blockLineHeight(n[0]):n.map((t=>e.inspector.blockLineHeight(t))).reduce(((e,t)=>e>t?e:t))}}})(),(()=>{const{$engine:e}=n;e.pdf={CACHED_METHODS:["hasPdfDocument","isPdfDocument","getPdfUrl","pdfContent"],init(){e.memoizer.memoizeAll(this,this.CACHED_METHODS)},async hasPdfDocument(){const e=this.getPdfUrl();return!!e&&this.isPdfDocument(e)},async isPdfDocument(e){try{const t=await _(e,{method:"HEAD",credentials:"include",cache:"force-cache"});if(!t.ok)return!1;return"application/pdf"===t.headers.get("Content-Type")}catch(e){return!1}},getPdfUrl(){let e;const t=y.querySelector("pdf-viewer")?.shadowRoot?.querySelector("embed");return t&&(e=t.getAttribute("original-url")||t.getAttribute("src")),e||w.href||null},async pdfContent(){if(!await this.hasPdfDocument())return null;const e=y.querySelector("__hrp__")?.dataset?.extId;if(!e)return null;let t=window["pdfjs-dist/build/pdf"];if(!t){const n=t=>`chrome-extension://${e}/js/${t}.min.js`;try{await new Promise(((e,t)=>{const r=y.createElement("script");r.onload=e,r.onerror=t,r.type="text/javascript",r.src=n("pdf"),y.getElementsByTagName("head")[0].appendChild(r)}))}catch(e){return r.warn("[$engine] failed loading pdfjs script",e),null}if(t=window["pdfjs-dist/build/pdf"],!t)return null;t.GlobalWorkerOptions.workerSrc=n("pdf.worker")}const n=this.getPdfUrl();if(!n)return null;let i=null;try{const e=await _(n,{credentials:"include",cache:"force-cache"}),r=await e.arrayBuffer();i=await t.getDocument({data:r}).promise}catch(e){return r.warn("[$engine] failed loading pdf document",e),null}const s=async e=>(await e.getTextContent()).items.map((e=>e.str));let o=[];for(let e=1;e<=i.numPages;e++)await i.getPage(e).then(s).then((e=>{o=o.concat(e)}));return o.reduce(((e,t)=>""===t?e+"\n":e.endsWith("-")?e.slice(0,-1)+t:e+(0===e.length||e.endsWith("\n")?"":" ")+t),"")}}})(),(()=>{const{$engine:e,$utils:t}=n;function r(e){return Array.from(new Set(e))}function i(t){return t.includes("{{data}}")?t=>{const n=e.inspector.innerText(t);return(e.extractor.extract(n).template||n).trim()}:t=>(e.inspector.innerText(t)||"").trim()}e.query={init(){this.byCss=e.memoizer.memoize(this.byCss),this.byAll=e.memoizer.memoize(this.byAll),this.byXpath=e.memoizer.memoize(this.byXpath),this.byTag=e.memoizer.memoize(this.byTag),this.byClass=e.memoizer.memoize(this.byClass),this.byId=e.memoizer.memoize(this.byId),this.byRole=e.memoizer.memoize(this.byRole),this.byContent=e.memoizer.memoize(this.byContent),this.byText=e.memoizer.memoize(this.byText),this.byStyle=e.memoizer.memoize(this.byStyle),this._selectorMethods={$role:e=>this.byRole(e),$placeholder:e=>this.byPlaceholder(e),$text:e=>this.byText(e),$content:e=>this.byContent(e),$displayValue:e=>this.byDisplayValue(e),$altText:e=>this.byAltText(e),$title:e=>this.byTitle(e),$testId:e=>this.byTestId(e),$id:e=>this.byId(e),$tag:e=>this.byTag(e),$class:e=>this.byClass(e),$attribute:e=>this.byAttribute(e),$src:e=>this.bySrc(e),$style:e=>this.byStyle(e),$css:e=>this.byCss(e),$xpath:e=>this.byXpath(e),$anchor:(e,t)=>this.byAnchor(e,t)},this.cache=new Map},run(t,n={}){const r=n.multiple||n.mult||n.m;if(!t)return r?[]:null;if(t instanceof Element)return r?[t]:t;if("object"!=typeof t)throw new Error("locator must be a node or an object");const i=this._resolve(t.selector||t,!0);if(!r){const e=i.length;if(0===e)throw new Error("element not found");if(e>1)throw new Error(`${e} matching elements found`)}if(n.inspect||n.computeAiLocator){const t=e.serializer.elementData,r=e.inspector.inspect(i,n);i.forEach(((e,n)=>e[t]=r[n]))}return r?i:i[0]},_resolve(e,n=!1){return e?e instanceof a?[e]:t.is.array(e)?this._resolveFind({$find:e},n):t.is.array(e.$find)?this._resolveFind(e,n):t.is.array(e.$matches)?this._resolveMatches(e):this._resolveSelector(e,n):[]},_resolveSelector(e,n=!1){let r=[];t.is.string(e)&&!e.includes(": ")&&(e=e.startsWith("//")?{$xpath:e}:{$text:e});const i=Object.keys(e).filter((e=>e.startsWith("$")));if(0===i.length)return r;if(1===i.length){const t=this._selectorMethods[i[0]];if(!t)throw new Error(`selector ${i[0]} is not supported by query engine`);r=t(e[i[0]],e)}return i.length>1&&(r=this._resolveMatches({$matches:i.map((t=>({[t]:e[t]}))),type:"all"})),e.hasOwnProperty("traverse")&&(r=this._resolveTraverse(e.traverse,r)),e.hasOwnProperty("filter")&&(r=this._resolveFilter(e.filter,r)),e.hasOwnProperty("size")&&(r=this._resolveSize(e.size,r)),e.hasOwnProperty("at")&&(r=this._resolveAt(e.at,r)),e.hasOwnProperty("parse")&&(r=this._resolveParse(e,r,n)),r},_resolveMatches(e){const t=e.$matches;if(!t||0===t.length)return[];let n=[],r=new Map;for(const e of t){this._resolve(e).forEach((e=>{const t=r.get(e)||0;0===t&&n.push(e),r.set(e,t+1)}))}if(0===r.size)return[];const i=e.type||"most";if("most"===i){const e=Array.from(r.values()).reduce(((e,t)=>e>t?e:t));n=n.filter((t=>r.get(t)===e))}else if("any"===i);else if("all"===i)n=n.filter((e=>r.get(e)===t.length));else if("none"===i){const e=new Set(n);n=this.byAll().filter((t=>!e.has(t)))}const s=e.min||0;s>0&&(n=n.filter((e=>r.get(e)>=s)));const o=e.max||0;return o>0&&(n=n.filter((e=>r.get(e)<=o))),n},_resolveFind(e,t=!1){const n=e.$find;if(!n||0===n.length)return[];let i=[],s=new Set,o=0;for(const e of n)if(o++,e.hasOwnProperty("$at"))i=this._resolveAt(e.$at,i),s=r(i);else if(e.hasOwnProperty("$traverse"))i=this._resolveTraverse(e.$traverse,i),s=r(i);else if(e.hasOwnProperty("$filter"))i=this._resolveFilter(e.$filter,i),s=r(i);else if(e.hasOwnProperty("$size"))i=this._resolveSize(e.$size,i),s=r(i);else if(e.hasOwnProperty("$parse"))t=t&&o===n.length,i=this._resolveParse(e,i,t),s=r(i);else{this._resolve(e).filter((e=>!s.has(e))).forEach((e=>{i.push(e),s.add(e)}))}return i},_resolveAt:(e,t)=>("first"===e?e=0:"last"===e&&(e=t.length-1),e>=0&&e<t.length?[t[e]]:[]),_resolveTraverse(e,n){return"parent"===e?this.getParents(n):"children"===e?this.getChildren(n):"ancestors"===e?this.getAncestors(n):"descendants"===e?this.getDescendants(n):t.is.string(e)?(e=e.split(":").map((e=>Number(e))),this.traversePath(n,e)):t.is.array(e)?this.traversePath(n,e):[]},_resolveFilter(t,n){const r=n;if("roots"===(t=t.startsWith("not-")?t.substr(4):t)?n=this.filterRoots(n):"branches"===t?n=this.filterBranches(n):"leaves"===t?n=this.filterLeaves(n):"connected"===t?n=n.filter((t=>e.inspector.isConnected(t))):"visible"===t?n=n.filter((t=>e.inspector.isVisible(t))):"clickable"===t?n=n.filter((t=>e.inspector.isClickable(t))):"fixed"===t&&(n=n.filter((t=>e.inspector.isFixed(t)))),t.startsWith("not-")){const e=new Set(n);n=r.filter((t=>!e.has(t)))}return n},_resolveSize(e,n){t.is.number(e)&&(e={min:e,max:e});const{min:r,max:i,throws:s}=e,o=n.length,a=void 0!==r&&o<r||void 0!==i&&o>i;if(a&&!1!==s)throw 0===o?new Error("Element not found"):new Error(`Found ${o} matching elements`);return a?[]:n},_resolveParse(t,n,r=!1){if(0===(n=n||[y.body]).length)return[];n.length>1&&(n=this.filterRoots(n));const i=t.$parse??"*",s=t.at??"*";let o=0;const a=n.map((t=>{if("*"!==s&&s<o)return[];let n=e.parser.parse(t,{extract:!0});return"*"!==i&&(n=n.filter((e=>e.type===i))),o+=n.length,r?n:n.map((e=>e.container))})).flat();return"*"===s?a:s<0||s>=a.length?[]:[a[s]]},byCss(e=""){try{return Array.from(y.querySelectorAll(e))}catch(e){return[]}},byAll(){try{return Array.from(y.getElementsByTagName("*"))}catch(e){return[]}},byXpath(e="",t){t=t||y.documentElement;try{const n=y.evaluate(e,t,null,f.ORDERED_NODE_SNAPSHOT_TYPE,null),r=[];for(let e=0;e<n.snapshotLength;e++)r.push(n.snapshotItem(e));return r}catch(e){return[]}},byTag(e=""){try{return Array.from(y.getElementsByTagName(e))}catch(e){return[]}},byClass(e=""){try{return Array.from(y.getElementsByClassName(e))}catch(e){return[]}},byId(e=""){try{const t=y.getElementById(e);return t?[t]:[]}catch(e){return[]}},byAttribute(e=""){const t=e.indexOf("=");return-1!==t?this.byCss(`*[${e.substr(0,t)}="${e.substr(t+1)}"]`):this.byCss(`*[${e}]`)},byAltText(e=""){return this.byCss(`*[alt="${e}"]`)},byDisplayValue(e=""){return this.byCss("input,textarea,select").filter((t=>"SELECT"===t.tagName?Array.from(t.options).filter((e=>e.selected)).map((e=>e.textContent)).join(" & ")===e:t.value===e))},byRole(t=""){if(!t)return[];const n=["*[role]",...Object.keys(e.tagsToRoles)].join(",");return Array.from(y.querySelectorAll(n)).filter((n=>{const r=e.inspector.role(n);return!!r&&("*"===t||r.split(" ").some((e=>e===t)))}))},byText(n=""){if(n.length<1)return[];const r=t.string.toRegex(n),s=i(n);let o=[y.body];const a=[];for(;o.length>0;){const n=o.shift(),i=s(n),l=t.occurrences.regex(i,r);if(0===l)continue;let c=0;const m=e.inspector.innerText(n),h=Array.from(n.children).filter((t=>m.includes(e.inspector.innerText(t)))).map((e=>{const n=t.occurrences.regex(s(e),r);return c+=n,n>0?{child:e,occurrences:n}:null})).filter((e=>Boolean(e)));l>c&&a.push(n),h.length>0&&(o=o.concat(h.map((e=>e.child))))}return a},byContent(n=""){if(n.length<1)return[];const r=t.string.toRegex(n),s=i(n);let o=[y.body];const a=[];for(;o.length>0;){const n=o.shift();if(0===t.occurrences.regex(s(n),r))continue;a.push(n);const i=e.inspector.innerText(n),l=Array.from(n.children).filter((t=>i.includes(e.inspector.innerText(t)))).filter((e=>0!==t.occurrences.regex(s(e),r)));l.length>0&&(o=o.concat(l))}return a},byPlaceholder(e=""){return this.byCss(`*[placeholder="${e}"]`)},byTestId(e=""){return this.byCss(`*[data-testid="${e}"]`)},byTitle(e=""){return this.byCss(`*[title="${e}"]`)},bySrc(e=""){return this.byCss(`*[src="${e}"]`)},byStyle(t=""){let[n,r]=t.split("=");t.includes("=")||(r=t,n=null);return e.query.byAll().filter((t=>e.inspector.styleHash(t,n)===r))},byAnchor(e="",t){if(!e)throw new Error("anchor selector value must be provided");const n=this._resolve(e);return 0===n.length?[]:t.shift?this._byAnchorShifted(n,t):this._byAnchorClosest(n,t)},_byAnchorShifted(n,r){const i=this.byAll();if(0===i.length)return[];let s=new Map;const o=t.is.string(r.shift)?r.shift.split(":").map((e=>Number(e)||0)):r.shift,[a,l]=o;if(n.forEach((t=>{let n=e.inspector.anchorPoint(t);n={x:n.x+a,y:n.y+l},i.filter((t=>e.inspector.rect(t).covers(n.x,n.y))).filter((e=>e!==t&&!e.contains(t)&&!t.contains(e))).map((t=>{const r=s.get(t)||Number.MAX_VALUE,i=e.inspector.distance(n,t);s.set(t,Math.min(i,r))}))})),s=Array.from(s.entries()),0===s.length)return[];return s.sort(((t,n)=>t[1]!==n[1]?t[1]-n[1]:e.inspector.path(n[0]).length-e.inspector.path(t[0]).length)),s.map((e=>e[0]))},_byAnchorClosest(t){let n=[];return t.forEach((t=>{let r=t.parentElement;for(;r;){const i=Array.from(r.children).filter((t=>Boolean(e.inspector.innerText(t)))).filter((e=>e!==t&&!e.contains(t))).filter((t=>e.inspector.isVisible(t)));if(i.length>0){i.forEach((r=>n.push({n:r,d:e.inspector.distance(t,r)})));break}r=r.parentElement}})),0===n.length?[]:1===n.length?[n[0].n]:[n.reduce(((e,t)=>t.d<e.d?t:e)).n]},getParents:e=>r(e.map((e=>e.parentNode)).filter(Boolean)),getChildren:e=>r(e.map((e=>Array.from(e.children))).flat()),getDescendants:e=>r(e.map((e=>Array.from(e.getElementsByTagName("*")))).flat()),getAncestors(e){const t=new Set;return e.forEach((e=>{let n=e;for(;n;)t.add(n),n=n.parentNode})),Array.from(t)},traversePath:(e,t)=>r(e.map((e=>{for(let n of t){if(!e)return null;if(n>=0)e=e.children[n];else for(;n++<0;)if(!(e=e.parentNode))return null}return e})).filter((e=>Boolean(e)))),filterRoots(e){const t=new Set(e);return e.filter((e=>{for(e=e.parentNode;e;){if(t.has(e))return!1;e=e.parentNode}return!0}))},filterBranches(e){const t=new Set(this.filterRoots(e)),n=new Set(this.filterLeaves(e));return e.filter((e=>!t.has(e)&&!n.has(e)))},filterLeaves(e){const t=new Set(e);return e.map((e=>e.parentNode)).forEach((e=>{for(;e;)t.delete(e),e=e.parentNode})),Array.from(t)}}})(),(()=>{const{$engine:e}=n;e.rectUtils={merge(t,n){if(t.length<1)return null;const r=e.Rect.of(t[0]);return t.length>1&&t.forEach((e=>{e.top<r.top&&(r.top=e.top),e.bottom>r.bottom&&(r.bottom=e.bottom),e.left<r.left&&(r.left=e.left),e.right>r.right&&(r.right=e.right)})),n&&(r.top-=n.top,r.right+=n.right,r.bottom+=n.bottom,r.left-=n.left),r},recombine(e){if(e.length<2)return e;e=[...e].sort(((e,t)=>e.top-t.top));for(let t=0;t<e.length-1;t++)for(let n=t+1;n<e.length;n++){const r=e[t],i=e[n];if(r.bottom<=i.top)break;if(this.contains(r,i))e.splice(n,1),n--;else if(this.contains(i,r)){e.splice(t,1),t--;break}}for(let t=0;t<e.length-1;t++)for(let n=t+1;n<e.length;n++){const r=e[t],i=e[n];if(r.bottom<=i.top)break;if(this.overlaps(r,i)){e.splice(n,1),e.splice(t,1,...this._breakOverlap(r,i)),e=e.sort(((e,t)=>e.top-t.top)),t--;break}}return e},intersect:(t,n)=>new e.Rect(Math.max(t.top,n.top),Math.min(t.right,n.right),Math.min(t.bottom,n.bottom),Math.max(t.left,n.left)),intersectByX:(t,n)=>new e.Rect(t.top,Math.min(t.right,n.right),t.bottom,Math.max(t.left,n.left)),intersectByY:(t,n)=>new e.Rect(Math.max(t.top,n.top),t.right,Math.min(t.bottom,n.bottom),t.left),contains:(e,t)=>!(t.top<e.top||t.bottom>e.bottom||t.left<e.left||t.right>e.right),overlaps:(e,t)=>!(e.top>=t.bottom||t.top>=e.bottom)&&!(e.left>=t.right||t.left>=e.right),_breakOverlap(t,n){const r=[t.top,n.top,t.bottom,n.bottom],i=[t.left,n.left,t.right,n.right];return[new e.Rect(r[0],i[1],r[1],i[0]),new e.Rect(r[0],i[2],r[1],i[1]),new e.Rect(r[0],i[3],r[1],i[2]),new e.Rect(r[1],i[1],r[2],i[0]),new e.Rect(r[1],i[2],r[2],i[1]),new e.Rect(r[1],i[3],r[2],i[2]),new e.Rect(r[2],i[1],r[3],i[0]),new e.Rect(r[2],i[2],r[3],i[1]),new e.Rect(r[2],i[3],r[3],i[2])].filter((e=>e.top<e.bottom&&e.left<e.right)).filter((e=>this.overlaps(e,t)||this.overlaps(e,n)))}}})(),(()=>{const{$engine:e}=n;e.Rect=class{constructor(e,t,n,r){this.top=e,this.right=t,this.bottom=n,this.left=r}get x(){return this.left}set x(e){this.left=e}get y(){return this.top}set y(e){this.top=e}get width(){return this.right-this.left}get height(){return this.bottom-this.top}get cx(){return this.left+(this.right-this.left)/2}get cy(){return this.top+(this.bottom-this.top)/2}clone(){return new e.Rect(this.top,this.right,this.bottom,this.left)}shift(e,t){return e=e||0,t=t||0,this.top+=t,this.right+=e,this.bottom+=t,this.left+=e,this}covers(e,t){return this.top<=t&&t<=this.bottom&&this.left<=e&&e<=this.right}serialize(){return{top:this.top,right:this.right,bottom:this.bottom,left:this.left}}static of(t){if(!t)return t;let{top:n,right:r,bottom:i,left:s,x:o,y:a,width:l,height:c}=t;return n=(void 0!==n?n:a)||0,s=(void 0!==s?s:o)||0,r=void 0!==r?r:s+(l||0),i=void 0!==i?i:n+(c||0),new e.Rect(n,r,i,s)}}})(),(()=>{const{$engine:e,$utils:t}=n;e.screenshotter={init(){this._dpr=1,this._quality=.7,this._emptySegmentsConfig={xStep:5,yStep:5,dominantThreshold:.95,emptySegmentMinHeightPx:700},this._running=!1,this._document=null,this._fullPage=!1,this._fnCache=new Map,this._styleCache=new Map,this._elementsMap=new Map,this._fetchPromises=new Map,this._svgToImagePromise=null,this._fetch=this._makeCacheable(this._fetch,"fetch"),this._toDataUrl=this._makeCacheable(this._toDataUrl,"toDataUrl")},async capture({fullPage:e=!1},t){if(this._running)throw new Error("already running");this._running=!0,this._fullPage=e,this._initDocument(),await new Promise((async e=>{const n=t.startedAt+t.timeout-Date.now()-2e3,r=setSafeTimeout(e,n);await this._waitAll([this._inlineStyles(),this._inlineImages(),this._inlineVideos(),this._inlineFrames(),this._inlineCanvases(),this._inlineControls()]),clearSafeTimeout(r),e()}));try{this._removeComments(),this._removeElements(),this._removeInvalidAttributes(),this._disableAnimations(),this._emulateScrolls(),this._preloadFonts(),this._fixVwAndVh(),this._fixZIndex()}catch(e){r.error(e)}const n=await this._documentToImage();return this._document=null,this._fnCache.clear(),this._styleCache.clear(),this._elementsMap.clear(),this._fetchPromises.clear(),this._svgToImagePromise=null,this._running=!1,n},onFetchResponse({id:e,data:t}){this._fetchPromises.get(e).resolve(t)},onSvgToImageResponse(e){this._svgToImagePromise&&this._svgToImagePromise.resolve(e)},_initDocument(){this._document=y.cloneNode(!0);const e=this._document.querySelectorAll("*");y.querySelectorAll("*").forEach(((t,n)=>{const r=e[n];this._elementsMap.set(t,r),this._elementsMap.set(r,t)}))},async _inlineStyles(){let e,t,n,r;{const n="__hrp:single-quote__",r="__hrp:double-quote__";e=e=>e.replaceAll("\\'",n).replaceAll('\\"',r),t=e=>e.replaceAll(n,"\\'").replaceAll(r,'\\"')}{const e=(e="",t="")=>new RegExp(`${`${e}url\\(\\s*'([^']+)'\\s*\\)${t}`}|${`${e}url\\(\\s*"([^"]+)"\\s*\\)${t}`}|${`${e}url\\(\\s*([^'") ]+)\\s*\\)${t}`}`,"g");n=e("",""),r=e("@import\\s+","\\s*;")}const i=(e,n)=>Array.from(e.matchAll(n)||[]).map((([e,n,r,i])=>{const s=t(n||r||i||"");return s?[e,s]:null})).filter(Boolean),s=async(t,n)=>{const o=i(t,r);return await this._waitAll(o.map((async([r,i])=>{let o=await this._fetch({url:i,root:n,method:"text"});o=e(o),o=await s(o,n),t=t.replaceAll(r,o)}))),t};await this._waitAll([...y.styleSheets].map((async r=>{const o=r.ownerNode,a=this._elementsMap.get(o);let l,c;if(r.href){if(c=r.href.split("/").slice(0,-1).join("/"),l=await this._fetch({url:r.href,method:"text"}),!l)return}else{c="/";const e=a.textContent,t=[...r.cssRules].map((e=>e.cssText)).join("");l=`${e}\n${t}`}l=await s(l,c),l=l.replaceAll(":root","html:is(html)").replace(/body\s*::?\s*-webkit-scrollbar/g,"foreignObject::-webkit-scrollbar").replace(/env\([^)]+\)/g,"0"),l=e(l);const m=i(l,n);await this._waitAll(m.map((async([e,t])=>{const n=await this._toDataUrl(t,c);l=l.replaceAll(e,`url("${n}")`)}))),l=t(l);const h=this._createElement("style");h.media=a.media,h.textContent=l,this._replaceElement(a,h)})))},async _inlineImages(){await this._waitAll(this._queryAll("*").map((async e=>{const t=this._getTagName(e),n=this._getStyle(e);if("img"===t){const t=this._getSource(e),r=await this._toDataUrl(t.currentSrc);e.removeAttribute("srcset"),e.setAttribute("src",r),this._setStyle(e,{width:n.width,height:n.height})}if(n.backgroundImage.startsWith("url(")){const t=n.backgroundImage.slice(n.backgroundImage.indexOf('"')+1,n.backgroundImage.lastIndexOf('"')),r=await this._toDataUrl(t);this._getStyle(e,{"background-image":`url("${r}")`,"background-size":n.backgroundSize})}if("use"===t){const t=e.getAttribute("href")||e.getAttribute("xlink:href");if(t&&t.indexOf("#")>0){const[n,r]=t.split("#"),i=await this._toDataUrl(n);e.setAttribute("href",`${i}#${r}`),e.removeAttribute("xlink:href")}}})))},async _inlineVideos(){await this._waitAll(this._queryAll("video").map((async e=>{const t=this._getSource(e),n=this._getStyle(e);if(!(t.currentSrc&&t.videoWidth>0&&t.videoHeight>0))return;const r=async e=>{const r=y.createElement("canvas");r.width=parseFloat(n.width),r.height=parseFloat(n.height);const i=r.getContext("2d"),s=t.videoWidth,o=t.videoHeight,a=r.width,l=r.height;i.drawImage(e,0,0,s,o,0,0,a,l);const c=await this._canvasToObjectUrl(r);return await this._toDataUrl(c)};let i;try{i=await r(t)}catch{const e=y.createElement("video");e.crossOrigin="anonymous",e.setAttribute("src",t.currentSrc),await new Promise(((t,n)=>{e.onloadedmetadata=t,e.onerror=e=>n(["failed to load video metadata",e])})),e.currentTime=t.currentTime,await new Promise(((t,n)=>{e.ontimeupdate=t,e.onerror=e=>n(["failed to update time",e])})),i=await r(e)}const s=this._createElement("img"),o=this._styleToCssText(n);s.setAttribute("style",o),s.src=i,this._replaceElement(e,s)})))},async _inlineFrames(){await this._waitAll(this._queryAll("iframe").map((async e=>{const t=this._getStyle(e),n=this._styleToCssText(t),r=this._createElement("div");r.setAttribute("style",n),this._setStyle(r,{background:"rgb(128 128 128 / 18%)"}),"inline"===t.display&&this._setStyle(r,{display:"inline-block"}),this._replaceElement(e,r)})))},async _inlineCanvases(){await this._waitAll(this._queryAll("canvas").map((async e=>{const t=this._getSource(e),n=this._getStyle(t),r=this._styleToCssText(n),i=this._createElement("img");i.setAttribute("style",r),i.src=t.toDataURL("image/webp",this._quality),this._replaceElement(e,i)})))},async _inlineControls(){await this._waitAll(this._queryAll("option, textarea, input").map((async e=>{const t=this._getTagName(e);if("option"!==t){if("textarea"===t){const t=e.value,n=y.createTextNode(t);return e.innerHTML="",void e.appendChild(n)}if("input"===t)if("radio"===e.type||"checkbox"===e.type)e.toggleAttribute("checked",e.checked);else if("image"===e.type&&e.src){const t=await this._toDataUrl(e.src);e.setAttribute("src",t)}else"color"!==e.type&&"date"!==e.type&&"datetime-local"!==e.type&&"email"!==e.type&&"month"!==e.type&&"number"!==e.type&&"password"!==e.type&&"range"!==e.type&&"search"!==e.type&&"tel"!==e.type&&"text"!==e.type&&"time"!==e.type&&"url"!==e.type&&"week"!==e.type||(e.setAttribute("value",e.value),this._setStyle(e,{width:this._getStyle(e).width}))}else e.toggleAttribute("selected",e.selected)})))},_removeComments(){const e=this._document.createTreeWalker(this._document,l.SHOW_COMMENT),t=[];for(;;){const n=e.nextNode();if(!n)break;t.push(n)}for(const e of t)e.remove()},_removeElements(){this._queryAll("meta").forEach((e=>e.remove())),this._queryAll("link").forEach((e=>e.remove())),this._queryAll("script").forEach((e=>e.remove())),this._queryAll("source").forEach((e=>e.remove())),this._queryAll("noscript").forEach((e=>e.remove())),this._queryAll("__hrp__").forEach((e=>e.remove())),this._queryAll("*").map((e=>{e.tagName.includes(":")&&e.remove()}))},_removeInvalidAttributes(){const e=e=>"elementtiming"!==(e=e.toLowerCase())&&(/^[a-z0-9-_]+$/.test(e)||e.startsWith("xlink:"));this._queryAll("*").map((t=>{const n=t.getAttributeNames();for(const r of n)e(r)||t.removeAttribute(r)}))},_disableAnimations(){const e=this._createElement("style");this._document.head.append(e),e.textContent="\n          * {\n            animation: none !important;\n            transition: none !important;\n          }\n        "},_emulateScrolls(){const e=(e,t)=>e.includes("px")?parseFloat(e)-t+"px":"auto";this._queryAll("*").forEach((t=>{if(this._fullPage&&t===this._document.body)return;if(this._fullPage&&t===this._document.documentElement)return;const n=this._getSource(t);if(!n)return;if(!(n.scrollTop>0||n.scrollLeft>0))return;let r=t.children;t===this._document.documentElement&&(r=this._document.body.children);for(const i of r){const r=this._getStyle(i),s=r.position;"static"===s?this._setStyle(t,{top:`-${n.scrollTop}px`,left:`-${n.scrollLeft}px`,right:"auto",bottom:"auto",position:"relative"}):"absolute"!==s&&"relative"!==s||this._setStyle(i,{top:e(r.top,n.scrollTop),left:e(r.left,n.scrollLeft),right:e(r.right,n.scrollLeft),bottom:e(r.bottom,n.scrollTop)})}}))},_preloadFonts(){const e=new Set;for(const t of y.querySelectorAll("*")){this._getStyle(t).fontFamily.split(",").map((e=>e.trim().replaceAll('"',"'").toLowerCase())).forEach((t=>e.add(t)))}const t=`\n          <div style="position: fixed; left: -100000px">\n            ${[...e].map((e=>`<div style="font-family: ${e}">a</div>`)).join("")}\n          </div>\n        `;this._document.body.insertAdjacentHTML("beforebegin",t)},_fixVwAndVh(){if(!this._fullPage)return;const e=["background-image"],t=e=>/\d+vw/.test(e)||/\d+vh/.test(e),n=this._queryAll("body *");n.forEach((n=>{const r=[...n.style];for(const i of r){if(e.includes(i))continue;const r=n.style[i];t(r)&&this._setStyle(n,{[i]:this._getStyle(n)[i]})}}));for(const r of this._queryAll("style"))for(const i of r.sheet.cssRules){if(!i.styleMap)continue;const r=[];for(const[n,s]of i.styleMap)e.includes(n)||t(s.toString())&&r.push(n);if(0===r.length)continue;const s=n.filter((e=>e.matches(i.selectorText)));for(const e of s)for(const t of r)this._setStyle(e,{[t]:this._getStyle(e)[t]})}},_fixZIndex(){const e=e=>parseInt(this._getStyle(e).zIndex)||0;this._document.querySelectorAll("body, body *").forEach((t=>{if(e(t)>=0)return;const n=t.parentElement.parentElement;for(const t of n.children)this._setStyle(t,{"z-index":e(t)})}))},async _documentToImage(){let n,r;this._fullPage?(n=window.innerWidth,r=Math.max(y.body.scrollHeight,y.documentElement.scrollHeight)):(n=window.innerWidth,r=window.innerHeight);const i=this._document.documentElement;let s=(new p).serializeToString(i);const o='xmlns:xlink="http://www.w3.org/1999/xlink"';s=s.replaceAll(`${o} ${o}`,o);const a=this._getStyle(this._document.body),l=this._getStyle(i),c="rgba(0, 0, 0, 0)"===a.backgroundColor?l.backgroundColor:a.backgroundColor,m=`\n          <svg\n            xmlns="http://www.w3.org/2000/svg"\n            width="${n}"\n            height="${r}"\n            viewBox="0 0 ${n} ${r}"\n            style="font-size: ${l.fontSize}">\n            <foreignObject\n              width="${n}"\n              height="${r}"\n              style="\n                overflow-x: ${a.overflowX};\n                overflow-y: ${a.overflowY};\n                background: ${c};\n              ">\n              ${s}\n            </foreignObject>\n          </svg>\n        `.trim();this._svgToImagePromise=t.createPromise(),e.injection.sendEvent("screenshotter.svgToImage",{dpr:this._dpr,width:n,height:r,svgCode:m,quality:this._quality});return await this._svgToImagePromise},_removeEmptySegments(e){const{xStep:t,yStep:n,dominantThreshold:r,emptySegmentMinHeightPx:i}=this._emptySegmentsConfig,s=e.width,o=e.height,a=e.getContext("2d"),l=a.getImageData(0,0,s,o).data,c=[];for(let e=0;e<l.length;e+=4*t){const t=`${l[e]},${l[e+1]},${l[e+2]},${l[e+3]}`,n=Math.floor(e/4/s);c[n]||(c[n]=[]),c[n].push(t)}const m=[];for(let e=0;e<o;e+=n){let t=0,i=null;const s={},o=c[e];for(const e of o){const n=(s[e]||0)+1;s[e]=n,t>n||(i=e,t=n)}const a=m.at(-1),l=t/o.length>r?i:null;a&&a.color===l?a.height+=n:m.push({index:e,height:1,color:l})}const h=[];for(const e of m)e.color&&(e.height<i||h.push({start:e.index*s*4,size:e.height*s*4,height:e.height}));if(0!==h.length){let t=e.height;if(h.forEach((e=>t-=e.height)),t<=0)return;e.height=t;const n=Array.from(l);for(const e of h.reverse())n.splice(e.start,e.size);const r=a.createImageData(s,e.height);for(let e=0;e<n.length;e+=1)r.data[e]=n[e];a.putImageData(r,0,0)}},async _waitAll(e){const t=await Promise.allSettled(e);for(const e of t)"rejected"===e.status&&r.error(e.reason)},_getStyle(e){const t=this._getSource(e);return t?(this._styleCache.has(t)||this._styleCache.set(t,b(t)),this._styleCache.get(t)):e.style},_styleToCssText(e){let t=[...e].map((t=>`${t}: ${e[t]};`)).join("");return t+="flex-shrink: 0;",t},_getSource(e){return y.contains(e)?e:this._elementsMap.get(e)||null},_getTagName:e=>e.tagName.toLowerCase(),_queryAll(e){return[...this._document.querySelectorAll(e)]},_createElement(e){return this._document.createElement(e)},_makeCacheable(e,n){return async(...r)=>{const i=`${n}-${JSON.stringify(r)}`;if(this._fnCache.has(i))return this._fnCache.get(i);const s=t.createPromise();let o;this._fnCache.set(i,s);try{o=await e.call(this,...r),s.resolve(o)}catch(e){throw s.reject(e),e}return o}},async _fetch({url:n,root:r=w.href,method:s="blob"}){let o;n=this._toFullUrl(n,r);try{o=await _(n)}catch{}if(o?.ok){try{return await o[s]()}catch{}if("blob"===s){o=await _(n);const e=o.headers.get("content-type").split(";")[0],t=await o.text();return new i([t],{type:e})}}const a=`${Date.now()}:${Math.random()}`,l=t.createPromise();return this._fetchPromises.set(a,l),e.injection.sendEvent("screenshotter.fetch",{id:a,url:n,method:s}),l},async _toDataUrl(e,t=w.href){if(!e)return"";if(e.startsWith("data:"))return e;const n=await this._fetch({url:e,root:t,method:"blob"});if("string"==typeof n&&n.startsWith("data:"))return n;if(!(n&&n instanceof i))return"";return await new Promise(((e,t)=>{const r=new s;r.onerror=t,r.onload=()=>e(r.result),r.readAsDataURL(n)}))},async _canvasToBlob(e){return t.canvasToBlob(e,"image/webp",this._quality)},async _canvasToObjectUrl(e){const t=await this._canvasToBlob(e);return u.createObjectURL(t)},_toFullUrl(e,t=w.href){try{return new u(e),e}catch{}return e.startsWith("//")?w.protocol+e:e.startsWith("/")?w.origin+e:`${this._toFullUrl(t)}/${e}`},_setStyle(e,t){for(const n in t){const r=t[n];e.style.setProperty(n,r,"important")}},_replaceElement(e,t){const n=this._getSource(e);this._elementsMap.delete(e),this._elementsMap.set(n,t),this._elementsMap.set(t,n),e.replaceWith(t)}}})(),(()=>{const{$engine:e}=n;e.scroller={async scroll(e="bottom",t={}){if("all"===(e=e||"bottom")){let e=null;do{if(e=window.scrollY,await this.scroll("viewport",t),t.timeout&&t.startedAt&&t.timeout>0&&Date.now()-t.startedAt>t.timeout)return this.getScrollPosition()}while(e!==window.scrollY);return this.getScrollPosition()}if("object"==typeof e&&!e.hasOwnProperty("x")&&!e.hasOwnProperty("y"))return this.scrollIntoView(e,t);if("top"===e?e={x:window.scrollX,y:0}:"bottom"===e?e={x:window.scrollX,y:y.documentElement.scrollHeight}:"viewport"===e&&(e={x:window.scrollX,y:window.scrollY+window.innerHeight}),"object"!=typeof e&&!e.hasOwnProperty("x")&&!e.hasOwnProperty("y"))throw new Error('unsupported "to" parameter passed to scroll method');let{x:n,y:r}=e;return null==n&&(n=window.scrollX),null==r&&(r=window.scrollY),window.scrollTo({top:r,left:n}),await this.waitForNotScrolling(),{x:window.scrollX,y:window.scrollY}},async scrollIntoView(e,t){if(e&&e.isConnected&&(e.nodeType!==y.TEXT_NODE||(e=e.parentElement)))return e.scrollIntoView({block:t?.scrollBlock||"nearest",inline:t?.scrollInline||"nearest"}),await this.waitForNotScrolling(),this.getScrollPosition()},async waitForNotScrolling(){let e=window.scrollX,t=window.scrollY,n=0,r=0;for(;n<100&&n-r<20;)await new Promise((e=>setSafeTimeout(e,16))),window.scrollX===e&&window.scrollY===t||(r=n,e=window.scrollX,t=window.scrollY),n++},getScrollPosition:()=>({x:window.scrollX,y:window.scrollY})}})(),(()=>{const{$engine:e}=n;e.serializer={elementId:Symbol("element_id"),elementData:Symbol("element_data"),maxElementId:-1,elements:{},deserialize(e){if(!e)return e;if("function"==typeof e)return e;if(e instanceof i)return e;if(Array.isArray(e))return e.map((e=>this.deserialize(e)));const t=e.__$ht;if(t){if("error"===t){const t=new Error(e.message);return Object.keys(e).filter((e=>"__$ht"!==e)).forEach((n=>{t[n]=e[n]})),t}if("element"===t)return this.elements[e.id];if("date"===t)return new Date(e.time)}if("object"==typeof e){const t={};for(const n in e)t[n]=this.deserialize(e[n]);return t}return e},serialize(t){if(!t)return t;if(t instanceof i)return u.createObjectURL(t);if(Array.isArray(t))return t.map((e=>this.serialize(e)));if(t instanceof Error){const e={__$ht:"error",message:t.message,stack:t.stack};return Object.keys(t).forEach((n=>{e[n]=t[n]})),e}if(t instanceof e.Rect)return t.serialize();if(t instanceof c)return Array.from(t).map((e=>this.serialize(e)));if(t instanceof a){t[this.elementId]||(t[this.elementId]=++this.maxElementId,this.elements[this.maxElementId]=t);const e={__$ht:"element",id:t[this.elementId]};return t[this.elementData]&&(e.data=this.serialize(t[this.elementData])),e}if(t instanceof Date)return{__$ht:"date",time:t.getTime()};if("object"==typeof t){const e={};return Object.keys(t).forEach((n=>{e[n]=this.serialize(t[n])})),e}return t}}})(),(()=>{const{$engine:e,$utils:t}=n;e.simulator={init(){this.eventMatchers={HTMLEvents:new Set(["load","unload","abort","error","select","change","submit","reset","focus","blur","resize","scroll"]),MouseEvents:new Set(["click","dblclick","mousedown","mouseup","mouseover","mousemove","mouseout"])}},async click(e,n){this._simulate(e,"mouseover"),await t.sleep(50),this._simulate(e,"mousedown",n),this._simulate(e,"focus"),await t.sleep(50),this._simulate(e,"mouseup",n),this._simulate(e,"click",n)},_eventType(e){for(const t in this.eventMatchers)if(this.eventMatchers[t].has(e))return t;throw new SyntaxError(`unsupported event name ${e}`)},_extend(e,t){for(let n in t)e[n]=t[n];return e},_defaultOptions(e){const t=e.getBoundingClientRect(),n=window.pageXOffset||y.documentElement.scrollLeft,r=window.pageYOffset||y.documentElement.scrollTop;return{screenX:t.left+t.width/2+n,screenY:t.top+t.height/2+r,clientX:t.left+t.width/2,clientY:t.top+t.height/2,button:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,bubbles:!0,cancelable:!0}},_simulate(e,t,n={}){const r=this._eventType(t),i=this._defaultOptions(e),s=this._extend(i,n);let o;return y.createEvent&&(o=y.createEvent(r),"HTMLEvents"===r?o.initEvent(t,s.bubbles,s.cancelable):o.initMouseEvent(t,s.bubbles,s.cancelable,y.defaultView,s.button,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,e),e.dispatchEvent(o)),e}}})(),(()=>{const{$engine:e}=n;e.state={init(){this._watchers=new Set,this._state={}},getState(){return this._state},apply(e){this._modify((()=>this._state=e))},watch(e){this._watchers.add(e)},transaction(t){this._modify((()=>t(this._state))),e.frame.send("engine.syncState",this._state)},_modify(e){e();for(const e of this._watchers)e(this._state)}}})(),(()=>{const{$engine:e}=n;e.timer={init(){this.MAX_ID=2147483647,this.lastId=0,this.idToCallback={},this._patchMethods()},_generateId(){do{this.lastId===this.MAX_ID?this.lastId=0:this.lastId++}while(this.idToCallback.hasOwnProperty(this.lastId));return this.lastId},_patchMethods(){if(window.top!==window)return window.setSafeInterval=window.setInterval,window.clearSafeInterval=window.clearInterval,window.setSafeTimeout=window.setTimeout,void(window.clearSafeTimeout=window.clearTimeout);window.setSafeInterval=(t,n,...r)=>{const i=this._generateId();return this.idToCallback[i]={cb:t,p:r,isInterval:!0},e.injection.sendEvent("timer.setInterval",{id:i,time:n}),i},window.clearSafeInterval=t=>{this.idToCallback.hasOwnProperty(t)&&(delete this.idToCallback[t],e.injection.sendEvent("timer.clearInterval",{id:t}))},window.setSafeTimeout=(t,n,...r)=>{const i=this._generateId();return this.idToCallback[i]={cb:t,p:r},e.injection.sendEvent("timer.setTimeout",{id:i,time:n}),i},window.clearSafeTimeout=t=>{this.idToCallback.hasOwnProperty(t)&&(delete this.idToCallback[t],e.injection.sendEvent("timer.clearTimeout",{id:t}))}},onTimer(t,n){if(!t)return;const r=this.idToCallback[t];if(!r)return void("interval"===n&&e.injection.sendEvent("timer.clearInterval",{id:t}));let{p:i,cb:s}=r;if(r.isInterval||delete this.idToCallback[t],"string"==typeof s)try{s=new Function(s)}catch{}"function"==typeof s&&s.apply(window,i)}}})(),(()=>{const{$engine:e,$utils:t}=n;e.trapper={init(){window===T&&(this._enabled=!1,this._trapper=null,this._target=null,this._targetLocked=!1,this._targetBeforeHover=null,this._hoverScrollTimeout=null,this._toggleWhenStateChanges(),this._onClick=this._onClick.bind(this),this._onScroll=this._onScroll.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onKeyDown=this._onKeyDown.bind(this))},cancel(){this._unlockTarget()},hover(e){if(this._setupOnce(),this._targetBeforeHover||(this._targetBeforeHover=this._target),this._setTarget(e),g(this._hoverScrollTimeout),!e)return;const t=this._getRect(e);(t.x<0||t.x>window.innerWidth||t.y<0||t.y>window.innerHeight)&&(this._hoverScrollTimeout=x((()=>{e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}),300))},unhover(){this._target&&(g(this._hoverScrollTimeout),this._setTarget(this._targetBeforeHover),this._targetBeforeHover=null)},async computeSelector(t){const n=e.locatorAi.computeAiLocator(t.container);return"element"!==t.type&&n.selector.push({$parse:t.type,at:t.at}),n.selector},_toggleWhenStateChanges(){e.state.watch((e=>{const t=e.trapperGrabbing;this._enabled!==t&&this._toggle(t)}))},_toggle(e){this._setupOnce(),this._enabled!==e&&(this._enabled=e,this._toggleTrapperStyles(e),this._togglePageInteractions(e),this._toggleHoverActiveStates(e),this._toggleGlobalListeners(e),e?(this._targetLocked=!1,y.activeElement.blur()):(this._setTarget(null),this._targetBeforeHover=null,g(this._hoverScrollTimeout)))},_setupOnce(){if(this._trapper)return;const e=y.querySelector("__hrp__");this._trapper=y.createElement("div"),this._trapper.classList.add("__hrp-trapper"),this._trapper.hidden=!0,e.append(this._trapper);const n=`\n          <style>\n            html.__hrp-trapper-enabled,\n            html.__hrp-trapper-enabled *:not([class*="__hrp-"]) {\n              cursor: pointer !important;\n              user-select: none !important;\n              pointer-events: all !important;\n              text-decoration: none !important;\n            }\n    \n            .__hrp-trapper {\n              width: 50px;\n              height: 50px;\n              position: absolute;\n              background: rgb(181 187 193 / 40%);\n              border-radius: 8px;\n              pointer-events: none;\n              z-index: ${t.maxZIndex-1};\n            }\n          </style>\n        `;e.insertAdjacentHTML("beforeend",n)},_toggleTrapperStyles(e){y.documentElement.classList.toggle("__hrp-trapper-enabled",e)},_togglePageInteractions(e){this._preventEvent||(this._preventEvent=e=>{try{e.preventDefault(),e.stopPropagation()}catch{}});const t=["click","focus","keydown","keyup","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","pointercancel","pointerdown","pointerenter","pointerleave","pointermove","pointerout","pointerover","pointerup"];for(const n of t)e?window.addEventListener(n,this._preventEvent,!0):window.removeEventListener(n,this._preventEvent,!0)},_toggleHoverActiveStates(e){this._selectorTextSymbol||(this._selectorTextSymbol=Symbol("selectorText"));const t=this._extractAllCssRules();for(const n of t)if(e){const e=n.selectorText.includes(":hover"),t=n.selectorText.includes(":active");if(!e&&!t)continue;n[this._selectorTextSymbol]=n.selectorText,n.selectorText=n.selectorText.replaceAll(":hover",":not(:hover):hover").replaceAll(":active",":not(:active):active")}else n[this._selectorTextSymbol]&&(n.selectorText=n[this._selectorTextSymbol],delete n[this._selectorTextSymbol])},_toggleGlobalListeners(e){e?(window.addEventListener("click",this._onClick,!0),window.addEventListener("scroll",this._onScroll,!0),window.addEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!0)):(window.removeEventListener("click",this._onClick,!0),window.removeEventListener("scroll",this._onScroll,!0),window.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!0))},_onMouseMove(e){if(this._targetLocked)return;const t=this._findTarget(e);this._target!==t&&this._setTarget(t)},_onScroll(e){},_onClick(t){if(this._targetLocked)return void this._unlockTarget();const n=this._findTarget(t);this._setTarget(n);const r=y.documentElement.scrollLeft,i=y.documentElement.scrollTop,{x:s,y:o,width:a,height:l}=this._getRect(this._target);this._targetLocked=!0,e.injection.sendEvent("trapper.targetLocked",{text:this._getElementText(this._target),element:this._target,mouseX:r+t.clientX,mouseY:r+t.clientY,rect:{top:i+o-10,left:r+s-10,right:r+s+a+10,bottom:i+o+l+10}})},_onKeyDown(t){"Escape"===t.key&&(this._targetLocked?this._unlockTarget():e.state.transaction((e=>{e.frameOpen=!0,e.trapperGrabbing=!1})))},_setTarget(e){if(e===this._target)return;if(this._target=e,this._trapper.hidden=!e,!e)return;const t=e.getBoundingClientRect(),n=y.documentElement.scrollTop,r=y.documentElement.scrollLeft;this._trapper.style.top=n+t.y-5+"px",this._trapper.style.left=r+t.x-5+"px",this._trapper.style.width=`${t.width+10}px`,this._trapper.style.height=`${t.height+10}px`},_unlockTarget(){this._setTarget(null),this._targetLocked=!1},_extractAllCssRules(){const e=[],n=r=>{if(r.selectorText)return void e.push(r);const i=t.noThrow((()=>r.cssRules));if(i)for(const e of i)n(e)};for(const e of y.styleSheets)n(e);return e},_findTarget(e){const t=e.clientX,n=e.clientY;let r;if(e.shiftKey||e.ctrlKey||e.altKey||e.metaKey){r=y.elementsFromPoint(t,n).map((e=>({element:e,area:this._getElementArea(e)}))).reduce(((e,t)=>e.area>t.area?t:e))?.element}else r=y.elementFromPoint(t,n);if(this._shouldIgnoreTarget(r)){const e=[],i=Symbol(),s=Symbol();for(;;){const o=r.style;if(r[i]=o.getPropertyValue("pointer-events"),r[s]=o.getPropertyPriority("pointer-events"),r.style.setProperty("pointer-events","none","important"),e.push(r),r=y.elementFromPoint(t,n),r===y.body)break;if(!this._shouldIgnoreTarget(r))break}for(const t of e)t.style.setProperty("pointer-events",t[i],t[s])}return r},_shouldIgnoreTarget(t){return this._isEmptyElement(t)||!e.inspector.isVisible(t)},_getRect:e=>e.getBBox?e.getBBox():e.getBoundingClientRect(),_getElementText(e){let t=b(e,"::before").content,n=b(e,"::after").content;"none"===t&&(t=""),"none"===n&&(n="");return[t,e.innerText||e.value||e.placeholder,n].filter(Boolean).join(" ")},_getElementArea(e){const t=this._getRect(e);return t.width*t.height},_isEmptyElement(e){const t=e.tagName.toLowerCase(),n=e.textContent.trim(),r=b(e).getPropertyValue("background-image"),i="img"===t?e.getAttribute("src"):null,s=0===n.length,o="none"===r,a=null===i||0===i.length,l="input"===t,c="select"===t,m="textarea"===t,u=e.contentEditable;return s&&o&&a&&!(l||c||m||("true"===u||""===u))&&!(e instanceof h)}}})(),(()=>{const{$engine:e,$utils:t}=n;e.waiter={async wait(e,t={}){t=this._normalizeOptions(t);const{timeout:n,polling:r}=t,i=Date.now(),s="string"==typeof e?this._checkString:"object"==typeof e&&"function"===e.__$ht?this._checkFunction:"object"==typeof e?this._checkLocator:()=>{};do{const o=await s(e,t);if(void 0!==o)return{result:o,durationMs:Date.now()-i};const a=i+n-Date.now()-20,l=Math.max(20,Math.min(r,a));await new Promise((e=>{setSafeTimeout(e,l>0?l:r)}))}while(Date.now()-i<=n)},_normalizeOptions:e=>({polling:100,contentType:"innerText",args:[],min:1,max:null,...e}),async _checkFunction(t,{args:n}){t=t.body;const r=await e.page.evaluate(t,n);if(r)return r},async _checkString(n,{contentType:r,min:i,max:s}){let o=await e.page.content(null,{contentType:r});if(o=t.occurrences.string(o,n),(null===i||o>=i)&&(null===s||o<=s))return o},async _checkLocator(t,{min:n,max:r}){const i=(await e.page.query(t,{m:!0})).length;if((null===n||i>=n)&&(null===r||i<=r))return i}}})(),(()=>{const{$startup:e,$engine:t}=n;e.engineController={init(){t.injection.init()}},e.engineController.init()})()})();